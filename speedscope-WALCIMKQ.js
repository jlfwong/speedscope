import{A as ya,a as va,b as Ie,f as ma,j as _e,k as it,l as ua,m as fa,n as ze,o as lt,p as ee,q as Fe,y as wi}from"./chunk-WXBMBICR.js";import{a as D,b as Q}from"./chunk-FW4363Y4.js";var He=D((Nt,hr)=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.default=rl;var al=/-webkit-|-moz-|-ms-/;function rl(n){return typeof n=="string"&&al.test(n)}hr.exports=Nt.default});var pr=D((At,dr)=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.default=_l;var ol=He(),il=ll(ol);function ll(n){return n&&n.__esModule?n:{default:n}}var sl=["-webkit-","-moz-",""];function _l(n,t){if(typeof t=="string"&&!(0,il.default)(t)&&t.indexOf("calc(")>-1)return sl.map(function(e){return t.replace(/calc\(/g,e+"calc(")})}dr.exports=At.default});var mr=D((Et,vr)=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.default=vl;var cl=He(),hl=dl(cl);function dl(n){return n&&n.__esModule?n:{default:n}}var pl=["-webkit-",""];function vl(n,t){if(typeof t=="string"&&!(0,hl.default)(t)&&t.indexOf("cross-fade(")>-1)return pl.map(function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")})}vr.exports=Et.default});var fr=D((Tt,ur)=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.default=fl;var ml=["-webkit-","-moz-",""],ul={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function fl(n,t){if(n==="cursor"&&ul.hasOwnProperty(t))return ml.map(function(e){return e+t})}ur.exports=Tt.default});var gr=D((Ht,yr)=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.default=bl;var yl=He(),gl=jl(yl);function jl(n){return n&&n.__esModule?n:{default:n}}var Cl=["-webkit-",""];function bl(n,t){if(typeof t=="string"&&!(0,gl.default)(t)&&t.indexOf("filter(")>-1)return Cl.map(function(e){return t.replace(/filter\(/g,e+"filter(")})}yr.exports=Ht.default});var br=D((Lt,Cr)=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.default=xl;var jr={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function xl(n,t){if(n==="display"&&jr.hasOwnProperty(t))return jr[t]}Cr.exports=Lt.default});var wr=D((Bt,Sr)=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.default=wl;var Sl={"space-around":"distribute","space-between":"justify","flex-start":"start","flex-end":"end"},xr={alignContent:"msFlexLinePack",alignSelf:"msFlexItemAlign",alignItems:"msFlexAlign",justifyContent:"msFlexPack",order:"msFlexOrder",flexGrow:"msFlexPositive",flexShrink:"msFlexNegative",flexBasis:"msFlexPreferredSize"};function wl(n,t,e){xr.hasOwnProperty(n)&&(e[xr[n]]=Sl[t]||t)}Sr.exports=Bt.default});var Nr=D((It,kr)=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.default=kl;var Rl={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},Rr={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function kl(n,t,e){n==="flexDirection"&&typeof t=="string"&&(t.indexOf("column")>-1?e.WebkitBoxOrient="vertical":e.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?e.WebkitBoxDirection="reverse":e.WebkitBoxDirection="normal"),Rr.hasOwnProperty(n)&&(e[Rr[n]]=Rl[t]||t)}kr.exports=It.default});var Er=D((zt,Ar)=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.default=Ll;var Nl=He(),Al=El(Nl);function El(n){return n&&n.__esModule?n:{default:n}}var Tl=["-webkit-","-moz-",""],Hl=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function Ll(n,t){if(typeof t=="string"&&!(0,Al.default)(t)&&Hl.test(t))return Tl.map(function(e){return e+t})}Ar.exports=zt.default});var Hr=D((Ft,Tr)=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.default=Pl;var Bl=He(),Il=zl(Bl);function zl(n){return n&&n.__esModule?n:{default:n}}var Fl=["-webkit-",""];function Pl(n,t){if(typeof t=="string"&&!(0,Il.default)(t)&&t.indexOf("image-set(")>-1)return Fl.map(function(e){return t.replace(/image-set\(/g,e+"image-set(")})}Tr.exports=Ft.default});var Br=D((Pt,Lr)=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.default=Dl;function Dl(n,t){if(n==="position"&&t==="sticky")return["-webkit-sticky","sticky"]}Lr.exports=Pt.default});var zr=D((Dt,Ir)=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.default=Ol;var Jl=["-webkit-","-moz-",""],Ml={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},Vl={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function Ol(n,t){if(Ml.hasOwnProperty(n)&&Vl.hasOwnProperty(t))return Jl.map(function(e){return e+t})}Ir.exports=Dt.default});var Pr=D((Uh,Fr)=>{"use strict";var Kl=/[A-Z]/g,Ul=/^ms-/,Jn={};function $l(n){return n in Jn?Jn[n]:Jn[n]=n.replace(Kl,"-$&").toLowerCase().replace(Ul,"-ms-")}Fr.exports=$l});var Jr=D((Jt,Dr)=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.default=Xl;var Wl=Pr(),Gl=ql(Wl);function ql(n){return n&&n.__esModule?n:{default:n}}function Xl(n){return(0,Gl.default)(n)}Dr.exports=Jt.default});var Mn=D((Mt,Mr)=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.default=Yl;function Yl(n){return n.charAt(0).toUpperCase()+n.slice(1)}Mr.exports=Mt.default});var Kr=D((Vt,Or)=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.default=is;var Zl=Jr(),Ql=Vn(Zl),es=He(),ts=Vn(es),ns=Mn(),Vr=Vn(ns);function Vn(n){return n&&n.__esModule?n:{default:n}}var as={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},rs={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function os(n,t){if((0,ts.default)(n))return n;for(var e=n.split(/,(?![^()]*(?:\([^()]*\))?\))/g),a=0,r=e.length;a<r;++a){var o=e[a],i=[o];for(var s in t){var d=(0,Ql.default)(s);if(o.indexOf(d)>-1&&d!=="order")for(var c=t[s],h=0,m=c.length;h<m;++h)i.unshift(o.replace(d,rs[c[h]]+d))}e[a]=i.join(",")}return e.join(",")}function is(n,t,e,a){if(typeof t=="string"&&as.hasOwnProperty(n)){var r=os(t,a),o=r.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(s){return!/-moz-|-ms-/.test(s)}).join(",");if(n.indexOf("Webkit")>-1)return o;var i=r.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(s){return!/-webkit-|-ms-/.test(s)}).join(",");return n.indexOf("Moz")>-1?i:(e["Webkit"+(0,Vr.default)(n)]=o,e["Moz"+(0,Vr.default)(n)]=i,r)}}Or.exports=Vt.default});var $r=D(($h,Ur)=>{"use strict";function ls(n){for(var t=5381,e=n.length;e;)t=t*33^n.charCodeAt(--e);return t>>>0}Ur.exports=ls});var Gr=D((Ot,Wr)=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.default=hs;var ss=Mn(),_s=cs(ss);function cs(n){return n&&n.__esModule?n:{default:n}}function hs(n,t,e){if(n.hasOwnProperty(t)){for(var a={},r=n[t],o=(0,_s.default)(t),i=Object.keys(e),s=0;s<i.length;s++){var d=i[s];if(d===t)for(var c=0;c<r.length;c++)a[r[c]+o]=e[t];a[d]=e[d]}return a}return e}Wr.exports=Ot.default});var Xr=D((Kt,qr)=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.default=ds;function ds(n,t,e,a,r){for(var o=0,i=n.length;o<i;++o){var s=n[o](t,e,a,r);if(s)return s}}qr.exports=Kt.default});var Qr=D((Ut,Zr)=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.default=ps;function Yr(n,t){n.indexOf(t)===-1&&n.push(t)}function ps(n,t){if(Array.isArray(t))for(var e=0,a=t.length;e<a;++e)Yr(n,t[e]);else Yr(n,t)}Zr.exports=Ut.default});var to=D(($t,eo)=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.default=vs;function vs(n){return n instanceof Object&&!Array.isArray(n)}eo.exports=$t.default});var ro=D((Gt,ao)=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.default=bs;var ms=Gr(),us=Wt(ms),fs=Xr(),no=Wt(fs),ys=Qr(),gs=Wt(ys),js=to(),Cs=Wt(js);function Wt(n){return n&&n.__esModule?n:{default:n}}function bs(n){var t=n.prefixMap,e=n.plugins;function a(r){for(var o in r){var i=r[o];if((0,Cs.default)(i))r[o]=a(i);else if(Array.isArray(i)){for(var s=[],d=0,c=i.length;d<c;++d){var h=(0,no.default)(e,o,i[d],r,t);(0,gs.default)(s,h||i[d])}s.length>0&&(r[o]=s)}else{var m=(0,no.default)(e,o,i,r,t);m&&(r[o]=m),r=(0,us.default)(t,o,r)}}return r}return a}ao.exports=Gt.default});var ho=D((Wh,co)=>{"use strict";co.exports=On;function On(n){pe.length||(qt(),lo=!0),pe[pe.length]=n}var pe=[],lo=!1,qt,de=0,xs=1024;function oo(){for(;de<pe.length;){var n=de;if(de=de+1,pe[n].call(),de>xs){for(var t=0,e=pe.length-de;t<e;t++)pe[t]=pe[t+de];pe.length-=de,de=0}}pe.length=0,de=0,lo=!1}var io=typeof global<"u"?global:self,so=io.MutationObserver||io.WebKitMutationObserver;typeof so=="function"?qt=Ss(oo):qt=_o(oo);On.requestFlush=qt;function Ss(n){var t=1,e=new so(n),a=document.createTextNode("");return e.observe(a,{characterData:!0}),function(){t=-t,a.data=t}}function _o(n){return function(){var e=setTimeout(r,0),a=setInterval(r,50);function r(){clearTimeout(e),clearInterval(a),n()}}}On.makeRequestCallFromTimer=_o});var uo=D((Gh,mo)=>{"use strict";var po=ho(),Xt=[],Kn=[],ws=po.makeRequestCallFromTimer(Rs);function Rs(){if(Kn.length)throw Kn.shift()}mo.exports=Un;function Un(n){var t;Xt.length?t=Xt.pop():t=new vo,t.task=n,po(t)}function vo(){this.task=null}vo.prototype.call=function(){try{this.task.call()}catch(n){Un.onerror?Un.onerror(n):(Kn.push(n),ws())}finally{this.task=null,Xt[Xt.length]=this}}});var ji=D((vu,Y_)=>{Y_.exports="./perf-vertx-stacks-01-collapsed-all-ZNUIGAJL.txt"});var A,Ri,Ge,fn,ba,ga,xa,Sa,me={},yn=[],ki=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function Ne(n,t){for(var e in t)n[e]=t[e];return n}function wa(n){var t=n.parentNode;t&&t.removeChild(n)}function p(n,t,e){var a,r=arguments,o={};for(a in t)a!=="key"&&a!=="ref"&&(o[a]=t[a]);if(arguments.length>3)for(e=[e],a=3;a<arguments.length;a++)e.push(r[a]);if(e!=null&&(o.children=e),typeof n=="function"&&n.defaultProps!=null)for(a in n.defaultProps)o[a]===void 0&&(o[a]=n.defaultProps[a]);return un(n,o,t&&t.key,t&&t.ref,null)}function un(n,t,e,a,r){var o={type:n,props:t,key:e,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r};return r==null&&(o.__v=o),A.vnode&&A.vnode(o),o}function ae(n){return n.children}function W(n,t){this.props=n,this.context=t}function qe(n,t){if(t==null)return n.__?qe(n.__,n.__.__k.indexOf(n)+1):null;for(var e;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null)return e.__e;return typeof n.type=="function"?qe(n):null}function Ra(n){var t,e;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,t=0;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null){n.__e=n.__c.base=e.__e;break}return Ra(n)}}function st(n){(!n.__d&&(n.__d=!0)&&Ge.push(n)&&!fn++||ga!==A.debounceRendering)&&((ga=A.debounceRendering)||ba)(Ni)}function Ni(){for(var n;fn=Ge.length;)n=Ge.sort(function(t,e){return t.__v.__b-e.__v.__b}),Ge=[],n.some(function(t){var e,a,r,o,i,s,d;t.__d&&(s=(i=(e=t).__v).__e,(d=e.__P)&&(a=[],(r=Ne({},i)).__v=r,o=gn(d,i,r,e.__n,d.ownerSVGElement!==void 0,null,a,s??qe(i)),Na(a,i),o!=s&&Ra(i)))})}function ka(n,t,e,a,r,o,i,s,d){var c,h,m,g,C,b,_,l=e&&e.__k||yn,v=l.length;if(s==me&&(s=o!=null?o[0]:v?qe(e,0):null),c=0,t.__k=Xe(t.__k,function(f){if(f!=null){if(f.__=t,f.__b=t.__b+1,(m=l[c])===null||m&&f.key==m.key&&f.type===m.type)l[c]=void 0;else for(h=0;h<v;h++){if((m=l[h])&&f.key==m.key&&f.type===m.type){l[h]=void 0;break}m=null}if(g=gn(n,f,m=m||me,a,r,o,i,s,d),(h=f.ref)&&m.ref!=h&&(_||(_=[]),m.ref&&_.push(m.ref,null,f),_.push(h,f.__c||g,f)),g!=null){var j;if(b==null&&(b=g),f.__d!==void 0)j=f.__d,f.__d=void 0;else if(o==m||g!=s||g.parentNode==null){e:if(s==null||s.parentNode!==n)n.appendChild(g),j=null;else{for(C=s,h=0;(C=C.nextSibling)&&h<v;h+=2)if(C==g)break e;n.insertBefore(g,s),j=s}t.type=="option"&&(n.value="")}s=j!==void 0?j:g.nextSibling,typeof t.type=="function"&&(t.__d=s)}else s&&m.__e==s&&s.parentNode!=n&&(s=qe(m))}return c++,f}),t.__e=b,o!=null&&typeof t.type!="function")for(c=o.length;c--;)o[c]!=null&&wa(o[c]);for(c=v;c--;)l[c]!=null&&jn(l[c],l[c]);if(_)for(c=0;c<_.length;c++)Aa(_[c],_[++c],_[++c])}function Xe(n,t,e){if(e==null&&(e=[]),n==null||typeof n=="boolean")t&&e.push(t(null));else if(Array.isArray(n))for(var a=0;a<n.length;a++)Xe(n[a],t,e);else e.push(t?t(typeof n=="string"||typeof n=="number"?un(null,n,null,null,n):n.__e!=null||n.__c!=null?un(n.type,n.props,n.key,null,n.__v):n):n);return e}function Ai(n,t,e,a,r){var o;for(o in e)o==="children"||o==="key"||o in t||_t(n,o,null,e[o],a);for(o in t)r&&typeof t[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||e[o]===t[o]||_t(n,o,t[o],e[o],a)}function ja(n,t,e){t[0]==="-"?n.setProperty(t,e):n[t]=typeof e=="number"&&ki.test(t)===!1?e+"px":e??""}function _t(n,t,e,a,r){var o,i,s,d,c;if(r?t==="className"&&(t="class"):t==="class"&&(t="className"),t==="style")if(o=n.style,typeof e=="string")o.cssText=e;else{if(typeof a=="string"&&(o.cssText="",a=null),a)for(d in a)e&&d in e||ja(o,d,"");if(e)for(c in e)a&&e[c]===a[c]||ja(o,c,e[c])}else t[0]==="o"&&t[1]==="n"?(i=t!==(t=t.replace(/Capture$/,"")),s=t.toLowerCase(),t=(s in n?s:t).slice(2),e?(a||n.addEventListener(t,Ca,i),(n.l||(n.l={}))[t]=e):n.removeEventListener(t,Ca,i)):t!=="list"&&t!=="tagName"&&t!=="form"&&t!=="type"&&t!=="size"&&!r&&t in n?n[t]=e??"":typeof e!="function"&&t!=="dangerouslySetInnerHTML"&&(t!==(t=t.replace(/^xlink:?/,""))?e==null||e===!1?n.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):n.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),e):e==null||e===!1&&!/^ar/.test(t)?n.removeAttribute(t):n.setAttribute(t,e))}function Ca(n){this.l[n.type](A.event?A.event(n):n)}function gn(n,t,e,a,r,o,i,s,d){var c,h,m,g,C,b,_,l,v,f,j=t.type;if(t.constructor!==void 0)return null;(c=A.__b)&&c(t);try{e:if(typeof j=="function"){if(l=t.props,v=(c=j.contextType)&&a[c.__c],f=c?v?v.props.value:c.__:a,e.__c?_=(h=t.__c=e.__c).__=h.__E:("prototype"in j&&j.prototype.render?t.__c=h=new j(l,f):(t.__c=h=new W(l,f),h.constructor=j,h.render=Ti),v&&v.sub(h),h.props=l,h.state||(h.state={}),h.context=f,h.__n=a,m=h.__d=!0,h.__h=[]),h.__s==null&&(h.__s=h.state),j.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=Ne({},h.__s)),Ne(h.__s,j.getDerivedStateFromProps(l,h.__s))),g=h.props,C=h.state,m)j.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(j.getDerivedStateFromProps==null&&l!==g&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(l,f),!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(l,h.__s,f)===!1||t.__v===e.__v&&!h.__){for(h.props=l,h.state=h.__s,t.__v!==e.__v&&(h.__d=!1),h.__v=t,t.__e=e.__e,t.__k=e.__k,h.__h.length&&i.push(h),c=0;c<t.__k.length;c++)t.__k[c]&&(t.__k[c].__=t);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(l,h.__s,f),h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(g,C,b)})}h.context=f,h.props=l,h.state=h.__s,(c=A.__r)&&c(t),h.__d=!1,h.__v=t,h.__P=n,c=h.render(h.props,h.state,h.context),t.__k=c!=null&&c.type==ae&&c.key==null?c.props.children:Array.isArray(c)?c:[c],h.getChildContext!=null&&(a=Ne(Ne({},a),h.getChildContext())),m||h.getSnapshotBeforeUpdate==null||(b=h.getSnapshotBeforeUpdate(g,C)),ka(n,t,e,a,r,o,i,s,d),h.base=t.__e,h.__h.length&&i.push(h),_&&(h.__E=h.__=null),h.__e=!1}else o==null&&t.__v===e.__v?(t.__k=e.__k,t.__e=e.__e):t.__e=Ei(e.__e,t,e,a,r,o,i,d);(c=A.diffed)&&c(t)}catch(x){t.__v=null,A.__e(x,t,e)}return t.__e}function Na(n,t){A.__c&&A.__c(t,n),n.some(function(e){try{n=e.__h,e.__h=[],n.some(function(a){a.call(e)})}catch(a){A.__e(a,e.__v)}})}function Ei(n,t,e,a,r,o,i,s){var d,c,h,m,g,C=e.props,b=t.props;if(r=t.type==="svg"||r,o!=null){for(d=0;d<o.length;d++)if((c=o[d])!=null&&((t.type===null?c.nodeType===3:c.localName===t.type)||n==c)){n=c,o[d]=null;break}}if(n==null){if(t.type===null)return document.createTextNode(b);n=r?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,b.is&&{is:b.is}),o=null,s=!1}if(t.type===null)C!==b&&n.data!=b&&(n.data=b);else{if(o!=null&&(o=yn.slice.call(n.childNodes)),h=(C=e.props||me).dangerouslySetInnerHTML,m=b.dangerouslySetInnerHTML,!s){if(C===me)for(C={},g=0;g<n.attributes.length;g++)C[n.attributes[g].name]=n.attributes[g].value;(m||h)&&(m&&h&&m.__html==h.__html||(n.innerHTML=m&&m.__html||""))}Ai(n,b,C,r,s),m?t.__k=[]:(t.__k=t.props.children,ka(n,t,e,a,t.type!=="foreignObject"&&r,o,i,me,s)),s||("value"in b&&(d=b.value)!==void 0&&d!==n.value&&_t(n,"value",d,C.value,!1),"checked"in b&&(d=b.checked)!==void 0&&d!==n.checked&&_t(n,"checked",d,C.checked,!1))}return n}function Aa(n,t,e){try{typeof n=="function"?n(t):n.current=t}catch(a){A.__e(a,e)}}function jn(n,t,e){var a,r,o;if(A.unmount&&A.unmount(n),(a=n.ref)&&(a.current&&a.current!==n.__e||Aa(a,null,t)),e||typeof n.type=="function"||(e=(r=n.__e)!=null),n.__e=n.__d=void 0,(a=n.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(i){A.__e(i,t)}a.base=a.__P=null}if(a=n.__k)for(o=0;o<a.length;o++)a[o]&&jn(a[o],t,e);r!=null&&wa(r)}function Ti(n,t,e){return this.constructor(n,e)}function Cn(n,t,e){var a,r,o;A.__&&A.__(n,t),r=(a=e===xa)?null:e&&e.__k||t.__k,n=p(ae,null,[n]),o=[],gn(t,(a?t:e||t).__k=n,r||me,me,t.ownerSVGElement!==void 0,e&&!a?[e]:r?null:yn.slice.call(t.childNodes),o,e||me,a),Na(o,n)}function ce(n){var t={},e={__c:"__cC"+Sa++,__:n,Consumer:function(a,r){return a.children(r)},Provider:function(a){var r,o=this;return this.getChildContext||(r=[],this.getChildContext=function(){return t[e.__c]=o,t},this.shouldComponentUpdate=function(i){o.props.value!==i.value&&r.some(function(s){s.context=i.value,st(s)})},this.sub=function(i){r.push(i);var s=i.componentWillUnmount;i.componentWillUnmount=function(){r.splice(r.indexOf(i),1),s&&s.call(i)}}),a.children}};return e.Consumer.contextType=e,e.Provider.__=e,e}A={__e:function(n,t){for(var e,a;t=t.__;)if((e=t.__c)&&!e.__)try{if(e.constructor&&e.constructor.getDerivedStateFromError!=null&&(a=!0,e.setState(e.constructor.getDerivedStateFromError(n))),e.componentDidCatch!=null&&(a=!0,e.componentDidCatch(n)),a)return st(e.__E=e)}catch(r){n=r}throw n}},Ri=function(n){return n!=null&&n.constructor===void 0},W.prototype.setState=function(n,t){var e;e=this.__s!==this.state?this.__s:this.__s=Ne({},this.state),typeof n=="function"&&(n=n(e,this.props)),n&&Ne(e,n),n!=null&&this.__v&&(t&&this.__h.push(t),st(this))},W.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),st(this))},W.prototype.render=ae,Ge=[],fn=0,ba=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,xa=me,Sa=0;var bn=class{constructor(t){this.data=t;this.prev=null;this.next=null}},ct=class{constructor(){this.head=null;this.tail=null;this.size=0}getHead(){return this.head}getTail(){return this.tail}getSize(){return this.size}append(t){this.tail?(this.tail.next=t,t.prev=this.tail,this.tail=t):this.head=this.tail=t,this.size++}prepend(t){return this.head?(this.head.prev=t,t.next=this.head,this.head=t):this.head=this.tail=t,this.size++,t}pop(){if(this.tail){let t=this.tail;return t.prev?(this.tail=t.prev,this.tail.next=null):this.head=this.tail=null,this.size--,t.prev=null,t}else return null}dequeue(){if(this.head){let t=this.head;return t.next?(this.head=t.next,this.head.prev=null):this.head=this.tail=null,this.size--,t.next=null,t}else return null}remove(t){t.prev==null?this.dequeue():t.next==null?this.pop():(t.next.prev=t.prev,t.prev.next=t.next,t.next=null,t.prev=null,this.size--)}},ht=class{constructor(t){this.capacity=t;this.list=new ct;this.map=new Map}has(t){return this.map.has(t)}get(t){let e=this.map.get(t);return e?(this.list.remove(e.listNode),this.list.prepend(e.listNode),e?e.value:null):null}getSize(){return this.list.getSize()}getCapacity(){return this.capacity}insert(t,e){let a=this.map.get(t);for(a&&this.list.remove(a.listNode);this.list.getSize()>=this.capacity;)this.map.delete(this.list.pop().data);let r=this.list.prepend(new bn(t));this.map.set(t,{value:e,listNode:r})}getOrInsert(t,e){let a=this.get(t);return a==null&&(a=e(t),this.insert(t,a)),a}removeLRU(){let t=this.list.pop();if(!t)return null;let e=t.data,a=this.map.get(e).value;return this.map.delete(e),[e,a]}clear(){this.list=new ct,this.map=new Map}};function G(n,t,e){return n<t?t:n>e?e:n}var u=class n{constructor(t,e){this.x=t;this.y=e}withX(t){return new n(t,this.y)}withY(t){return new n(this.x,t)}plus(t){return new n(this.x+t.x,this.y+t.y)}minus(t){return new n(this.x-t.x,this.y-t.y)}times(t){return new n(this.x*t,this.y*t)}timesPointwise(t){return new n(this.x*t.x,this.y*t.y)}dividedByPointwise(t){return new n(this.x/t.x,this.y/t.y)}dot(t){return this.x*t.x+this.y*t.y}equals(t){return this.x===t.x&&this.y===t.y}approxEquals(t,e=1e-9){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e}length2(){return this.dot(this)}length(){return Math.sqrt(this.length2())}abs(){return new n(Math.abs(this.x),Math.abs(this.y))}static min(t,e){return new n(Math.min(t.x,e.x),Math.min(t.y,e.y))}static max(t,e){return new n(Math.max(t.x,e.x),Math.max(t.y,e.y))}static clamp(t,e,a){return new n(G(t.x,e.x,a.x),G(t.y,e.y,a.y))}static{this.zero=new n(0,0)}static{this.unit=new n(1,1)}flatten(){return[this.x,this.y]}},T=class n{constructor(t=1,e=0,a=0,r=0,o=1,i=0){this.m00=t;this.m01=e;this.m02=a;this.m10=r;this.m11=o;this.m12=i}withScale(t){let{m00:e,m01:a,m02:r,m10:o,m11:i,m12:s}=this;return e=t.x,i=t.y,new n(e,a,r,o,i,s)}static withScale(t){return new n().withScale(t)}scaledBy(t){return n.withScale(t).times(this)}getScale(){return new u(this.m00,this.m11)}withTranslation(t){let{m00:e,m01:a,m02:r,m10:o,m11:i,m12:s}=this;return r=t.x,s=t.y,new n(e,a,r,o,i,s)}static withTranslation(t){return new n().withTranslation(t)}getTranslation(){return new u(this.m02,this.m12)}translatedBy(t){return n.withTranslation(t).times(this)}static betweenRects(t,e){return n.withTranslation(t.origin.times(-1)).scaledBy(new u(e.size.x/t.size.x,e.size.y/t.size.y)).translatedBy(e.origin)}times(t){let e=this.m00*t.m00+this.m01*t.m10,a=this.m00*t.m01+this.m01*t.m11,r=this.m00*t.m02+this.m01*t.m12+this.m02,o=this.m10*t.m00+this.m11*t.m10,i=this.m10*t.m01+this.m11*t.m11,s=this.m10*t.m02+this.m11*t.m12+this.m12;return new n(e,a,r,o,i,s)}equals(t){return this.m00==t.m00&&this.m01==t.m01&&this.m02==t.m02&&this.m10==t.m10&&this.m11==t.m11&&this.m12==t.m12}approxEquals(t,e=1e-9){return Math.abs(this.m00-t.m00)<e&&Math.abs(this.m01-t.m01)<e&&Math.abs(this.m02-t.m02)<e&&Math.abs(this.m10-t.m10)<e&&Math.abs(this.m11-t.m11)<e&&Math.abs(this.m12-t.m12)<e}timesScalar(t){let{m00:e,m01:a,m02:r,m10:o,m11:i,m12:s}=this;return new n(t*e,t*a,t*r,t*o,t*i,t*s)}det(){let{m00:t,m01:e,m02:a,m10:r,m11:o,m12:i}=this,s=0,d=0,c=1;return t*(o*c-i*d)-e*(r*c-i*s)+a*(r*d-o*s)}adj(){let{m00:t,m01:e,m02:a,m10:r,m11:o,m12:i}=this,s=0,d=0,c=1,h=+(o*c-i*d),m=-(e*c-a*d),g=+(e*i-a*o),C=-(r*c-i*s),b=+(t*c-a*s),_=-(t*i-a*r);return new n(h,m,g,C,b,_)}inverted(){let t=this.det();return t===0?null:this.adj().timesScalar(1/t)}transformVector(t){return new u(t.x*this.m00+t.y*this.m01,t.x*this.m10+t.y*this.m11)}inverseTransformVector(t){let e=this.inverted();return e?e.transformVector(t):null}transformPosition(t){return new u(t.x*this.m00+t.y*this.m01+this.m02,t.x*this.m10+t.y*this.m11+this.m12)}inverseTransformPosition(t){let e=this.inverted();return e?e.transformPosition(t):null}transformRect(t){let e=this.transformVector(t.size),a=this.transformPosition(t.origin);return e.x<0&&e.y<0?new w(a.plus(e),e.abs()):e.x<0?new w(a.withX(a.x+e.x),e.abs()):e.y<0?new w(a.withY(a.y+e.y),e.abs()):new w(a,e)}inverseTransformRect(t){let e=this.inverted();return e?e.transformRect(t):null}flatten(){return[this.m00,this.m10,0,this.m01,this.m11,0,this.m02,this.m12,1]}},w=class n{constructor(t,e){this.origin=t;this.size=e}isEmpty(){return this.width()==0||this.height()==0}width(){return this.size.x}height(){return this.size.y}left(){return this.origin.x}right(){return this.left()+this.width()}top(){return this.origin.y}bottom(){return this.top()+this.height()}topLeft(){return this.origin}topRight(){return this.origin.plus(new u(this.width(),0))}bottomRight(){return this.origin.plus(this.size)}bottomLeft(){return this.origin.plus(new u(0,this.height()))}withOrigin(t){return new n(t,this.size)}withSize(t){return new n(this.origin,t)}closestPointTo(t){return new u(G(t.x,this.left(),this.right()),G(t.y,this.top(),this.bottom()))}distanceFrom(t){return t.minus(this.closestPointTo(t)).length()}contains(t){return this.distanceFrom(t)===0}hasIntersectionWith(t){let e=Math.max(this.top(),t.top());if(Math.max(e,Math.min(this.bottom(),t.bottom()))-e===0)return!1;let r=Math.max(this.left(),t.left());return Math.max(r,Math.min(this.right(),t.right()))-r!==0}intersectWith(t){let e=u.max(this.topLeft(),t.topLeft()),a=u.max(e,u.min(this.bottomRight(),t.bottomRight()));return new n(e,a.minus(e))}equals(t){return this.origin.equals(t.origin)&&this.size.equals(t.size)}approxEquals(t){return this.origin.approxEquals(t.origin)&&this.size.approxEquals(t.size)}area(){return this.size.x*this.size.y}static{this.empty=new n(u.zero,u.zero)}static{this.unit=new n(u.zero,u.unit)}static{this.NDC=new n(new u(-1,-1),new u(2,2))}};var xn=typeof process<"u"&&process.env&&!0;function H(n){if(!xn&&!n)throw new Error("Assertion failed.")}function Hi(n,t){n.indexOf(t)===-1&&n.push(t)}function Li(n,t){let e=n.indexOf(t);e!==-1&&n.splice(e,1)}function Bi(n,t){return H(t>=0&&t<=31),n.TEXTURE0+t}var B;(C=>{class n{constructor(_=0,l=0,v=0,f=0){this.x=_;this.y=l;this.width=v;this.height=f}set(_,l,v,f){this.x=_,this.y=l,this.width=v,this.height=f}equals(_){return this.x===_.x&&this.y===_.y&&this.width===_.width&&this.height===_.height}}C.Rect=n;class t{constructor(_,l,v,f){this.redF=_;this.greenF=l;this.blueF=v;this.alphaF=f}equals(_){return this.redF===_.redF&&this.greenF===_.greenF&&this.blueF===_.blueF&&this.alphaF===_.alphaF}static{this.TRANSPARENT=new t(0,0,0,0)}}C.Color=t;let e;(k=>(k[k.ZERO=0]="ZERO",k[k.ONE=1]="ONE",k[k.SOURCE_COLOR=2]="SOURCE_COLOR",k[k.TARGET_COLOR=3]="TARGET_COLOR",k[k.INVERSE_SOURCE_COLOR=4]="INVERSE_SOURCE_COLOR",k[k.INVERSE_TARGET_COLOR=5]="INVERSE_TARGET_COLOR",k[k.SOURCE_ALPHA=6]="SOURCE_ALPHA",k[k.TARGET_ALPHA=7]="TARGET_ALPHA",k[k.INVERSE_SOURCE_ALPHA=8]="INVERSE_SOURCE_ALPHA",k[k.INVERSE_TARGET_ALPHA=9]="INVERSE_TARGET_ALPHA",k[k.CONSTANT=10]="CONSTANT",k[k.INVERSE_CONSTANT=11]="INVERSE_CONSTANT"))(e=C.BlendOperation||={});let a;(l=>(l[l.TRIANGLES=0]="TRIANGLES",l[l.TRIANGLE_STRIP=1]="TRIANGLE_STRIP"))(a=C.Primitive||={});class r{constructor(){this.resizeEventHandlers=new Set}setCopyBlendState(){this.setBlendState(1,0)}setAddBlendState(){this.setBlendState(1,1)}setPremultipliedBlendState(){this.setBlendState(1,8)}setUnpremultipliedBlendState(){this.setBlendState(6,8)}addAfterResizeEventHandler(_){this.resizeEventHandlers.add(_)}removeAfterResizeEventHandler(_){this.resizeEventHandlers.delete(_)}}C.Context=r;let o;(l=>(l[l.FLOAT=0]="FLOAT",l[l.BYTE=1]="BYTE"))(o=C.AttributeType||={});function i(b){return b==0?4:1}C.attributeByteLength=i;class s{constructor(_,l,v,f){this.name=_;this.type=l;this.count=v;this.byteOffset=f}}C.Attribute=s;class d{constructor(){this._attributes=[];this._stride=0}get attributes(){return this._attributes}get stride(){return this._stride}add(_,l,v){return this.attributes.push(new s(_,l,v,this.stride)),this._stride+=v*i(l),this}}C.VertexFormat=d;class c{uploadFloat32Array(_){this.upload(new Uint8Array(_.buffer),0)}uploadFloats(_){this.uploadFloat32Array(new Float32Array(_))}}C.VertexBuffer=c;let h;(l=>(l[l.NEAREST=0]="NEAREST",l[l.LINEAR=1]="LINEAR"))(h=C.PixelFilter||={});let m;(l=>(l[l.REPEAT=0]="REPEAT",l[l.CLAMP=1]="CLAMP"))(m=C.PixelWrap||={});class g{constructor(_,l,v){this.minFilter=_;this.magFilter=l;this.wrap=v}static{this.LINEAR_CLAMP=new g(1,1,1)}static{this.LINEAR_MIN_NEAREST_MAG_CLAMP=new g(1,0,1)}static{this.NEAREST_CLAMP=new g(0,0,1)}}C.TextureFormat=g})(B||={});var Sn;(C=>{class n extends B.Context{constructor(l=document.createElement("canvas")){super();this._attributeCount=0;this._blendOperations=0;this._contextResetHandlers=[];this._currentClearColor=B.Color.TRANSPARENT;this._currentRenderTarget=null;this._defaultViewport=new B.Rect;this._forceStateUpdate=!0;this._generation=1;this._height=0;this._oldBlendOperations=0;this._oldRenderTarget=null;this._oldViewport=new B.Rect;this._width=0;this.handleWebglContextRestored=()=>{this._attributeCount=0,this._currentClearColor=B.Color.TRANSPARENT,this._forceStateUpdate=!0,this._generation++;for(let l of this._contextResetHandlers)l()};this.ANGLE_instanced_arrays=null;this.ANGLE_instanced_arrays_generation=-1;let v=l.getContext("webgl",{alpha:!1,antialias:!1,depth:!1,preserveDrawingBuffer:!1,stencil:!1});if(v==null)throw new Error("Setup failure");this._gl=v;let f=l.style;l.width=0,l.height=0,f.width=f.height="0",l.addEventListener("webglcontextlost",j=>{j.preventDefault()}),l.addEventListener("webglcontextrestored",this.handleWebglContextRestored),this._blendOperationMap={0:this._gl.ZERO,1:this._gl.ONE,2:this._gl.SRC_COLOR,3:this._gl.DST_COLOR,4:this._gl.ONE_MINUS_SRC_COLOR,5:this._gl.ONE_MINUS_DST_COLOR,6:this._gl.SRC_ALPHA,7:this._gl.DST_ALPHA,8:this._gl.ONE_MINUS_SRC_ALPHA,9:this._gl.ONE_MINUS_DST_ALPHA,10:this._gl.CONSTANT_COLOR,11:this._gl.ONE_MINUS_CONSTANT_COLOR}}get widthInPixels(){return this._width}get heightInPixels(){return this._height}testContextLoss(){this.handleWebglContextRestored()}get gl(){return this._gl}get generation(){return this._generation}addContextResetHandler(l){Hi(this._contextResetHandlers,l)}removeContextResetHandler(l){Li(this._contextResetHandlers,l)}get currentRenderTarget(){return this._currentRenderTarget}beginFrame(){this.setRenderTarget(null)}endFrame(){}setBlendState(l,v){this._blendOperations=n._packBlendModes(l,v)}setViewport(l,v,f,j){(this._currentRenderTarget!=null?this._currentRenderTarget.viewport:this._defaultViewport).set(l,v,f,j)}get viewport(){return this._currentRenderTarget!=null?this._currentRenderTarget.viewport:this._defaultViewport}get renderTargetWidthInPixels(){return this._currentRenderTarget!=null?this._currentRenderTarget.viewport.width:this._width}get renderTargetHeightInPixels(){return this._currentRenderTarget!=null?this._currentRenderTarget.viewport.height:this._height}draw(l,v,f){this._updateRenderTargetAndViewport(),c.from(v).prepare(),h.from(f).prepare(),this._updateFormat(v.format),this._updateBlendState(),this._gl.drawArrays(l==0?this._gl.TRIANGLES:this._gl.TRIANGLE_STRIP,0,Math.floor(f.byteCount/v.format.stride)),this._forceStateUpdate=!1}resize(l,v,f,j){let x=this._gl.canvas,S=x.getBoundingClientRect();if(this._width===l&&this._height===v&&S.width===f&&S.height===j)return;let N=x.style;x.width=l,x.height=v,N.width=`${f}px`,N.height=`${j}px`,this.setViewport(0,0,l,v),this._width=l,this._height=v,this.resizeEventHandlers.forEach(F=>F())}clear(l){this._updateRenderTargetAndViewport(),this._updateBlendState(),l.equals(this._currentClearColor)||(this._gl.clearColor(l.redF,l.greenF,l.blueF,l.alphaF),this._currentClearColor=l),this._gl.clear(this._gl.COLOR_BUFFER_BIT)}setRenderTarget(l){this._currentRenderTarget=g.from(l)}createMaterial(l,v,f){let j=new c(this,l,v,f);return j.program,j}createVertexBuffer(l){return H(l>0&&l%4==0),new h(this,l)}createTexture(l,v,f,j){return new m(this,l,v,f,j)}createRenderTarget(l){return new g(this,m.from(l))}getANGLE_instanced_arrays(){if(this.ANGLE_instanced_arrays_generation!==this._generation&&(this.ANGLE_instanced_arrays=null),!this.ANGLE_instanced_arrays&&(this.ANGLE_instanced_arrays=this.gl.getExtension("ANGLE_instanced_arrays"),!this.ANGLE_instanced_arrays))throw new Error("Failed to get extension ANGLE_instanced_arrays");return this.ANGLE_instanced_arrays}_updateRenderTargetAndViewport(){let l=this._currentRenderTarget,v=l!=null?l.viewport:this._defaultViewport,f=this._gl;(this._forceStateUpdate||this._oldRenderTarget!=l)&&(f.bindFramebuffer(f.FRAMEBUFFER,l?l.framebuffer:null),this._oldRenderTarget=l),(this._forceStateUpdate||!this._oldViewport.equals(v))&&(f.viewport(v.x,this.renderTargetHeightInPixels-v.y-v.height,v.width,v.height),this._oldViewport.set(v.x,v.y,v.width,v.height))}_updateBlendState(){if(this._forceStateUpdate||this._oldBlendOperations!=this._blendOperations){let l=this._gl,v=this._blendOperations,f=this._oldBlendOperations,j=v&15,x=v>>4;H(j in this._blendOperationMap),H(x in this._blendOperationMap),v==n.COPY_BLEND_OPERATIONS?l.disable(l.BLEND):((this._forceStateUpdate||f==n.COPY_BLEND_OPERATIONS)&&l.enable(l.BLEND),l.blendFunc(this._blendOperationMap[j],this._blendOperationMap[x])),this._oldBlendOperations=v}}_updateFormat(l){let v=this._gl,f=l.attributes,j=f.length;for(let x=0;x<j;x++){let S=f[x],N=S.type==1;v.vertexAttribPointer(x,S.count,N?v.UNSIGNED_BYTE:v.FLOAT,N,l.stride,S.byteOffset)}for(;this._attributeCount<j;)v.enableVertexAttribArray(this._attributeCount),this._attributeCount++;for(;this._attributeCount>j;)this._attributeCount--,v.disableVertexAttribArray(this._attributeCount);this._attributeCount=j}getWebGLInfo(){let l=this.gl.getExtension("WEBGL_debug_renderer_info"),v=l?this.gl.getParameter(l.UNMASKED_RENDERER_WEBGL):null,f=l?this.gl.getParameter(l.UNMASKED_VENDOR_WEBGL):null,j=this.gl.getParameter(this.gl.VERSION);return{renderer:v,vendor:f,version:j}}static from(l){return H(l==null||l instanceof n),l}static _packBlendModes(l,v){return l|v<<4}static{this.COPY_BLEND_OPERATIONS=n._packBlendModes(1,0)}}C.Context=n;class t{constructor(_,l,v=0,f=null,j=!0){this._material=_;this._name=l;this._generation=v;this._location=f;this._isDirty=j}get location(){let _=n.from(this._material.context);if(this._generation!=_.generation&&(this._location=_.gl.getUniformLocation(this._material.program,this._name),this._generation=_.generation,!xn)){let l=this._material.program,v=_.gl;for(let f=0,j=v.getProgramParameter(l,v.ACTIVE_UNIFORMS);f<j;f++){let x=v.getActiveUniform(l,f);if(x&&x.name==this._name)switch(H(x.size==1),x.type){case v.FLOAT:{H(this instanceof e);break}case v.FLOAT_MAT3:{H(this instanceof s);break}case v.FLOAT_VEC2:{H(this instanceof r);break}case v.FLOAT_VEC3:{H(this instanceof o);break}case v.FLOAT_VEC4:{H(this instanceof i);break}case v.INT:{H(this instanceof a);break}case v.SAMPLER_2D:{H(this instanceof d);break}default:H(!1)}}}if(!this._location)throw new Error("Failed to get uniform location");return this._location}}class e extends t{constructor(){super(...arguments);this._x=0}set(l){l!=this._x&&(this._x=l,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform1f(this.location,this._x),this._isDirty=!1)}}class a extends t{constructor(){super(...arguments);this._x=0}set(l){l!=this._x&&(this._x=l,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform1i(this.location,this._x),this._isDirty=!1)}}class r extends t{constructor(){super(...arguments);this._x=0;this._y=0}set(l,v){(l!=this._x||v!=this._y)&&(this._x=l,this._y=v,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform2f(this.location,this._x,this._y),this._isDirty=!1)}}class o extends t{constructor(){super(...arguments);this._x=0;this._y=0;this._z=0}set(l,v,f){(l!=this._x||v!=this._y||f!=this._z)&&(this._x=l,this._y=v,this._z=f,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform3f(this.location,this._x,this._y,this._z),this._isDirty=!1)}}class i extends t{constructor(){super(...arguments);this._x=0;this._y=0;this._z=0;this._w=0}set(l,v,f,j){(l!=this._x||v!=this._y||f!=this._z||j!=this._w)&&(this._x=l,this._y=v,this._z=f,this._w=j,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform4f(this.location,this._x,this._y,this._z,this._w),this._isDirty=!1)}}class s extends t{constructor(){super(...arguments);this._values=[1,0,0,0,1,0,0,0,1]}set(l,v,f,j,x,S,N,F,Z){s._cachedValues[0]=l,s._cachedValues[1]=j,s._cachedValues[2]=N,s._cachedValues[3]=v,s._cachedValues[4]=x,s._cachedValues[5]=F,s._cachedValues[6]=f,s._cachedValues[7]=S,s._cachedValues[8]=Z;for(let L=0;L<9;L++)if(s._cachedValues[L]!=this._values[L]){let k=this._values;this._values=s._cachedValues,s._cachedValues=k,this._isDirty=!0;break}}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniformMatrix3fv(this.location,!1,this._values),this._isDirty=!1)}static{this._cachedValues=[1,0,0,0,1,0,0,0,1]}}class d extends t{constructor(){super(...arguments);this._texture=null;this._index=-1}set(l,v){(this._texture!=l||this._index!=v)&&(this._texture=m.from(l),this._index=v,this._isDirty=!0)}prepare(){let l=n.from(this._material.context),v=l.gl;H(this._texture==null||l.currentRenderTarget==null||this._texture!=l.currentRenderTarget.texture),(this._generation!=l.generation||this._isDirty)&&(v.uniform1i(this.location,this._index),this._isDirty=!1),v.activeTexture(Bi(v,this._index)),v.bindTexture(v.TEXTURE_2D,this._texture!=null&&this._texture.width>0&&this._texture.height>0?this._texture.texture:null)}}class c{constructor(_,l,v,f,j={},x=[],S=0,N=null){this._context=_;this._format=l;this._vertexSource=v;this._fragmentSource=f;this._uniformsMap=j;this._uniformsList=x;this._generation=S;this._program=N}get context(){return this._context}get format(){return this._format}get vertexSource(){return this._vertexSource}get fragmentSource(){return this._fragmentSource}setUniformFloat(_,l){let v=this._uniformsMap[_]||null;v==null&&(v=new e(this,_),this._uniformsMap[_]=v,this._uniformsList.push(v)),H(v instanceof e),v.set(l)}setUniformInt(_,l){let v=this._uniformsMap[_]||null;v==null&&(v=new a(this,_),this._uniformsMap[_]=v,this._uniformsList.push(v)),H(v instanceof a),v.set(l)}setUniformVec2(_,l,v){let f=this._uniformsMap[_]||null;f==null&&(f=new r(this,_),this._uniformsMap[_]=f,this._uniformsList.push(f)),H(f instanceof r),f.set(l,v)}setUniformVec3(_,l,v,f){let j=this._uniformsMap[_]||null;j==null&&(j=new o(this,_),this._uniformsMap[_]=j,this._uniformsList.push(j)),H(j instanceof o),j.set(l,v,f)}setUniformVec4(_,l,v,f,j){let x=this._uniformsMap[_]||null;x==null&&(x=new i(this,_),this._uniformsMap[_]=x,this._uniformsList.push(x)),H(x instanceof i),x.set(l,v,f,j)}setUniformMat3(_,l,v,f,j,x,S,N,F,Z){let L=this._uniformsMap[_]||null;L==null&&(L=new s(this,_),this._uniformsMap[_]=L,this._uniformsList.push(L)),H(L instanceof s),L.set(l,v,f,j,x,S,N,F,Z)}setUniformSampler(_,l,v){let f=this._uniformsMap[_]||null;f==null&&(f=new d(this,_),this._uniformsMap[_]=f,this._uniformsList.push(f)),H(f instanceof d),f.set(l,v)}get program(){let _=this._context.gl;if(this._generation!=this._context.generation){this._program=_.createProgram(),this._compileShader(_,_.VERTEX_SHADER,this.vertexSource),this._compileShader(_,_.FRAGMENT_SHADER,this.fragmentSource);let l=this.format.attributes;for(let v=0;v<l.length;v++)_.bindAttribLocation(this._program,v,l[v].name);if(_.linkProgram(this._program),!_.getProgramParameter(this._program,_.LINK_STATUS))throw new Error(`${_.getProgramInfoLog(this._program)}`);if(this._generation=this._context.generation,!xn)for(let v of l)for(let f=0,j=_.getProgramParameter(this.program,_.ACTIVE_ATTRIBUTES);f<j;f++){let x=_.getActiveAttrib(this.program,f);if(x&&x.name==v.name)switch(H(x.size==1),v.count){case 1:{H(x.type==_.FLOAT);break}case 2:{H(x.type==_.FLOAT_VEC2);break}case 3:{H(x.type==_.FLOAT_VEC3);break}case 4:{H(x.type==_.FLOAT_VEC4);break}default:H(!1)}}}return this._program}prepare(){this._context.gl.useProgram(this.program);for(let _ of this._uniformsList)_.prepare()}_compileShader(_,l,v){let f=_.createShader(l);if(!f)throw new Error("Failed to create shader");if(_.shaderSource(f,v),_.compileShader(f),!_.getShaderParameter(f,_.COMPILE_STATUS))throw new Error(`${_.getShaderInfoLog(f)}`);if(!this._program)throw new Error("Tried to attach shader before program was created");_.attachShader(this._program,f)}static from(_){return H(_==null||_ instanceof c),_}}class h extends B.VertexBuffer{constructor(l,v){super();this._generation=0;this._buffer=null;this._bytes=null;this._isDirty=!0;this._dirtyMin=h.INT_MAX;this._dirtyMax=0;this._totalMin=h.INT_MAX;this._totalMax=0;this._byteCount=0;this._context=l,this._byteCount=v,this._bytes=new Uint8Array(v)}get context(){return this._context}get byteCount(){return this._byteCount}move(l,v,f){H(f>=0),H(0<=l&&l+f<=this._byteCount),H(0<=v&&v+f<=this._byteCount),this._bytes&&l!=v&&f!=0&&(this._bytes.set(this._bytes.subarray(l,this._byteCount),v),this._growDirtyRegion(Math.min(l,v),Math.max(l,v)+f))}upload(l,v=0){H(0<=v&&v+l.length<=this._byteCount),H(this._bytes!=null),this._bytes.set(l,v),this._growDirtyRegion(v,v+l.length)}free(){this._buffer&&this._context.gl.deleteBuffer(this._buffer),this._generation=0}prepare(){let l=this._context.gl;this._generation!==this._context.generation&&(this._buffer=l.createBuffer(),this._generation=this._context.generation,this._isDirty=!0),l.bindBuffer(l.ARRAY_BUFFER,this._buffer),this._isDirty&&(l.bufferData(l.ARRAY_BUFFER,this._byteCount,l.DYNAMIC_DRAW),this._dirtyMin=this._totalMin,this._dirtyMax=this._totalMax,this._isDirty=!1),this._dirtyMin<this._dirtyMax&&(l.bufferSubData(l.ARRAY_BUFFER,this._dirtyMin,this._bytes.subarray(this._dirtyMin,this._dirtyMax)),this._dirtyMin=h.INT_MAX,this._dirtyMax=0)}_growDirtyRegion(l,v){this._dirtyMin=Math.min(this._dirtyMin,l),this._dirtyMax=Math.max(this._dirtyMax,v),this._totalMin=Math.min(this._totalMin,l),this._totalMax=Math.max(this._totalMax,v)}static{this.INT_MAX=2147483647}static from(l){return H(l==null||l instanceof h),l}}class m{constructor(_,l,v,f,j=null,x=null,S=0,N=!0,F=!0){this._context=_;this._format=l;this._width=v;this._height=f;this._pixels=j;this._texture=x;this._generation=S;this._isFormatDirty=N;this._isContentDirty=F}get context(){return this._context}get format(){return this._format}get width(){return this._width}get height(){return this._height}resize(_,l,v=null){this._width=_,this._height=l,this._pixels=v,this._isContentDirty=!0}setFormat(_){this._format!=_&&(this._format=_,this._isFormatDirty=!0)}get texture(){let _=this._context.gl;return this._generation!=this._context.generation&&(this._texture=_.createTexture(),this._generation=this._context.generation,this._isFormatDirty=!0,this._isContentDirty=!0),this._isFormatDirty&&(_.bindTexture(_.TEXTURE_2D,this._texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,this.format.magFilter==0?_.NEAREST:_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.format.minFilter==0?_.NEAREST:_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,this.format.wrap==0?_.REPEAT:_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,this.format.wrap==0?_.REPEAT:_.CLAMP_TO_EDGE),this._isFormatDirty=!1),this._isContentDirty&&(_.bindTexture(_.TEXTURE_2D,this._texture),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,this._width,this._height,0,_.RGBA,_.UNSIGNED_BYTE,this._pixels),this._isContentDirty=!1),this._texture}free(){this.texture&&(this._context.gl.deleteTexture(this.texture),this._generation=0)}static from(_){return H(_==null||_ instanceof m),_}}class g{constructor(_,l,v=null,f=0,j=!0,x=new B.Rect){this._context=_;this._texture=l;this._framebuffer=v;this._generation=f;this._isDirty=j;this._viewport=x}get context(){return this._context}get texture(){return this._texture}get viewport(){return this._viewport}setColor(_){this._texture!=_&&(this._texture=m.from(_),this._isDirty=!0)}get framebuffer(){let _=this._context.gl,l=this._texture.texture;return this._generation!=this._context.generation&&(this._framebuffer=_.createFramebuffer(),this._generation=this._context.generation,this._isDirty=!0),this._isDirty&&(_.bindFramebuffer(_.FRAMEBUFFER,this._framebuffer),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,l,0),H(_.checkFramebufferStatus(_.FRAMEBUFFER)==_.FRAMEBUFFER_COMPLETE),this._isDirty=!1),this._framebuffer}free(){this._framebuffer&&(this._context.gl.deleteFramebuffer(this._framebuffer),this._generation=0)}static from(_){return H(_==null||_ instanceof g),_}}})(Sn||={});function he(n,t,e){let{m00:a,m01:r,m02:o,m10:i,m11:s,m12:d}=e;n.setUniformMat3(t,a,r,o,i,s,d,0,0,1)}function wn(n,t,e){n.setUniformVec2(t,e.x,e.y)}function dt(n,t,e){n.setRenderTarget(t),n.setViewport(0,0,t.texture.width,t.texture.height),e(),n.setRenderTarget(null)}var vt=new B.VertexFormat;vt.add("configSpacePos",B.AttributeType.FLOAT,2);vt.add("color",B.AttributeType.FLOAT,3);var Ii=`
  uniform mat3 configSpaceToNDC;

  attribute vec2 configSpacePos;
  attribute vec3 color;
  varying vec3 vColor;

  void main() {
    vColor = color;
    vec2 position = (configSpaceToNDC * vec3(configSpacePos, 1)).xy;
    gl_Position = vec4(position, 1, 1);
  }
`,zi=`
  precision mediump float;
  varying vec3 vColor;

  void main() {
    gl_FragColor = vec4(vColor.rgb, 1);
  }
`,Ae=class{constructor(t){this.gl=t;this.rects=[];this.colors=[];this.buffer=null}getRectCount(){return this.rects.length}getBuffer(){if(this.buffer)return this.buffer;let t=[[0,0],[1,0],[0,1],[1,0],[0,1],[1,1]],e=new Uint8Array(vt.stride*t.length*this.rects.length),a=new Float32Array(e.buffer),r=0;for(let o=0;o<this.rects.length;o++){let i=this.rects[o],s=this.colors[o];for(let d of t)a[r++]=i.origin.x+d[0]*i.size.x,a[r++]=i.origin.y+d[1]*i.size.y,a[r++]=s.r,a[r++]=s.g,a[r++]=s.b}if(r!==a.length)throw new Error("Buffer expected to be full but wasn't");return this.buffer=this.gl.createVertexBuffer(e.length),this.buffer.upload(e),this.buffer}addRect(t,e){this.rects.push(t),this.colors.push(e),this.buffer&&(this.buffer.free(),this.buffer=null)}free(){this.buffer&&(this.buffer.free(),this.buffer=null)}},pt=class{constructor(t){this.gl=t;this.material=t.createMaterial(vt,Ii,zi)}render(t){he(this.material,"configSpaceToNDC",(()=>{let e=T.betweenRects(t.configSpaceSrcRect,t.physicalSpaceDstRect),a=new u(this.gl.viewport.width,this.gl.viewport.height);return T.withTranslation(new u(-1,1)).times(T.withScale(new u(2,-2).dividedByPointwise(a))).times(e)})()),this.gl.setUnpremultipliedBlendState(),this.gl.draw(B.Primitive.TRIANGLES,this.material,t.batch.getBuffer())}};var V=class n{constructor(t=0,e=0,a=0,r=1){this.r=t;this.g=e;this.b=a;this.a=r}static fromLumaChromaHue(t,e,a){let r=a/60,o=e*(1-Math.abs(r%2-1)),[i,s,d]=r<1?[e,o,0]:r<2?[o,e,0]:r<3?[0,e,o]:r<4?[0,o,e]:r<5?[o,0,e]:[e,0,o],c=t-(.3*i+.59*s+.11*d);return new n(G(i+c,0,1),G(s+c,0,1),G(d+c,0,1),1)}static fromCSSHex(t){if(t.length!==7||t[0]!=="#")throw new Error(`Invalid color input ${t}`);let e=parseInt(t.substr(1,2),16)/255,a=parseInt(t.substr(3,2),16)/255,r=parseInt(t.substr(5,2),16)/255;if(e<0||e>1||a<0||a>1||r<0||r>1)throw new Error(`Invalid color input ${t}`);return new n(e,a,r)}withAlpha(t){return new n(this.r,this.g,this.b,t)}toCSS(){return`rgba(${(255*this.r).toFixed()}, ${(255*this.g).toFixed()}, ${(255*this.b).toFixed()}, ${this.a.toFixed(2)})`}};var mt=class{constructor(t,e,a){this.gl=t;this.rectangleBatchRenderer=e;this.textureRenderer=a;this.texture=t.createTexture(B.TextureFormat.NEAREST_CLAMP,4096,4096),this.renderTarget=t.createRenderTarget(this.texture),this.rowCache=new ht(this.texture.height),this.clearLineBatch=new Ae(t),this.clearLineBatch.addRect(w.unit,new V(0,0,0,0)),t.addContextResetHandler(()=>{this.rowCache.clear()})}has(t){return this.rowCache.has(t)}getResolution(){return this.texture.width}getCapacity(){return this.texture.height}allocateLine(t){if(this.rowCache.getSize()<this.rowCache.getCapacity()){let e=this.rowCache.getSize();return this.rowCache.insert(t,e),e}else{let[,e]=this.rowCache.removeLRU();return this.rowCache.insert(t,e),e}}writeToAtlasIfNeeded(t,e){dt(this.gl,this.renderTarget,()=>{for(let a of t){let r=this.rowCache.get(a);if(r!=null)continue;r=this.allocateLine(a);let o=new w(new u(0,r),new u(this.texture.width,1));this.rectangleBatchRenderer.render({batch:this.clearLineBatch,configSpaceSrcRect:w.unit,physicalSpaceDstRect:o}),e(o,a)}})}renderViaAtlas(t,e){let a=this.rowCache.get(t);if(a==null)return!1;let r=new w(new u(0,a),new u(this.texture.width,1));return this.textureRenderer.render({texture:this.texture,srcRect:r,dstRect:e}),!0}};var Fi=`
  uniform mat3 uvTransform;
  uniform mat3 positionTransform;

  attribute vec2 position;
  attribute vec2 uv;
  varying vec2 vUv;

  void main() {
    vUv = (uvTransform * vec3(uv, 1)).xy;
    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);
  }
`,Pi=`
  precision mediump float;

  varying vec2 vUv;
  uniform sampler2D texture;

  void main() {
   gl_FragColor = texture2D(texture, vUv);
  }
`,ut=class{constructor(t){this.gl=t;let e=new B.VertexFormat;e.add("position",B.AttributeType.FLOAT,2),e.add("uv",B.AttributeType.FLOAT,2);let a=[{pos:[-1,1],uv:[0,1]},{pos:[1,1],uv:[1,1]},{pos:[-1,-1],uv:[0,0]},{pos:[1,-1],uv:[1,0]}],r=[];for(let o of a)r.push(o.pos[0]),r.push(o.pos[1]),r.push(o.uv[0]),r.push(o.uv[1]);this.buffer=t.createVertexBuffer(e.stride*a.length),this.buffer.upload(new Uint8Array(new Float32Array(r).buffer)),this.material=t.createMaterial(e,Fi,Pi)}render(t){this.material.setUniformSampler("texture",t.texture,0),he(this.material,"uvTransform",(()=>{let{srcRect:e,texture:a}=t,o=T.withTranslation(new u(0,1)).times(T.withScale(new u(1,-1))).times(T.betweenRects(new w(u.zero,new u(a.width,a.height)),w.unit)).transformRect(e);return T.betweenRects(w.unit,o)})()),he(this.material,"positionTransform",(()=>{let{dstRect:e}=t,{viewport:a}=this.gl,r=new u(a.width,a.height),i=T.withScale(new u(1,-1)).times(T.betweenRects(new w(u.zero,r),w.NDC)).transformRect(e);return T.betweenRects(w.NDC,i)})()),this.gl.setUnpremultipliedBlendState(),this.gl.draw(B.Primitive.TRIANGLE_STRIP,this.material,this.buffer)}};var Rn=new B.VertexFormat;Rn.add("position",B.AttributeType.FLOAT,2);var Di=`
  attribute vec2 position;

  void main() {
    gl_Position = vec4(position, 0, 1);
  }
`,Ji=n=>{let{r:t,g:e,b:a}=V.fromCSSHex(n.fgSecondaryColor),r=`${t.toFixed(1)}, ${e.toFixed(1)}, ${a.toFixed(1)}`;return`
    precision mediump float;

    uniform mat3 configSpaceToPhysicalViewSpace;
    uniform vec2 physicalSize;
    uniform vec2 physicalOrigin;
    uniform vec2 configSpaceViewportOrigin;
    uniform vec2 configSpaceViewportSize;
    uniform float framebufferHeight;

    void main() {
      vec2 origin = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportOrigin, 1.0)).xy;
      vec2 size = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportSize, 0.0)).xy;

      vec2 halfSize = physicalSize / 2.0;

      float borderWidth = 2.0;

      origin = floor(origin * halfSize) / halfSize + borderWidth * vec2(1.0, 1.0);
      size = floor(size * halfSize) / halfSize - 2.0 * borderWidth * vec2(1.0, 1.0);

      vec2 coord = gl_FragCoord.xy;
      coord.x = coord.x - physicalOrigin.x;
      coord.y = framebufferHeight - coord.y - physicalOrigin.y;
      vec2 clamped = clamp(coord, origin, origin + size);
      vec2 gap = clamped - coord;
      float maxdist = max(abs(gap.x), abs(gap.y));

      // TOOD(jlfwong): Could probably optimize this to use mix somehow.
      if (maxdist == 0.0) {
        // Inside viewport rectangle
        gl_FragColor = vec4(0, 0, 0, 0);
      } else if (maxdist < borderWidth) {
        // Inside viewport rectangle at border
        gl_FragColor = vec4(${r}, 0.8);
      } else {
        // Outside viewport rectangle
        gl_FragColor = vec4(${r}, 0.5);
      }
    }
  `},ft=class{constructor(t,e){this.gl=t;let a=[[-1,1],[1,1],[-1,-1],[1,-1]],r=[];for(let o of a)r.push(o[0]),r.push(o[1]);this.buffer=t.createVertexBuffer(Rn.stride*a.length),this.buffer.upload(new Uint8Array(new Float32Array(r).buffer)),this.material=t.createMaterial(Rn,Di,Ji(e))}render(t){he(this.material,"configSpaceToPhysicalViewSpace",t.configSpaceToPhysicalViewSpace),wn(this.material,"configSpaceViewportOrigin",t.configSpaceViewportRect.origin),wn(this.material,"configSpaceViewportSize",t.configSpaceViewportRect.size);let e=this.gl.viewport;this.material.setUniformVec2("physicalOrigin",e.x,e.y),this.material.setUniformVec2("physicalSize",e.width,e.height),this.material.setUniformFloat("framebufferHeight",this.gl.renderTargetHeightInPixels),this.gl.setBlendState(B.BlendOperation.SOURCE_ALPHA,B.BlendOperation.INVERSE_SOURCE_ALPHA),this.gl.draw(B.Primitive.TRIANGLE_STRIP,this.material,this.buffer)}};var yt=new B.VertexFormat;yt.add("position",B.AttributeType.FLOAT,2);yt.add("uv",B.AttributeType.FLOAT,2);var Mi=`
  uniform mat3 uvTransform;
  uniform mat3 positionTransform;

  attribute vec2 position;
  attribute vec2 uv;
  varying vec2 vUv;

  void main() {
    vUv = (uvTransform * vec3(uv, 1)).xy;
    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);
  }
`,Vi=n=>`
  precision mediump float;

  uniform vec2 uvSpacePixelSize;
  uniform float renderOutlines;

  varying vec2 vUv;
  uniform sampler2D colorTexture;

  // https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue
  vec3 hcl2rgb(float H, float C, float L) {
    float hPrime = H / 60.0;
    float X = C * (1.0 - abs(mod(hPrime, 2.0) - 1.0));
    vec3 RGB =
      hPrime < 1.0 ? vec3(C, X, 0) :
      hPrime < 2.0 ? vec3(X, C, 0) :
      hPrime < 3.0 ? vec3(0, C, X) :
      hPrime < 4.0 ? vec3(0, X, C) :
      hPrime < 5.0 ? vec3(X, 0, C) :
      vec3(C, 0, X);

    float m = L - dot(RGB, vec3(0.30, 0.59, 0.11));
    return RGB + vec3(m, m, m);
  }

  float triangle(float x) {
    return 2.0 * abs(fract(x) - 0.5) - 1.0;
  }

  ${n}

  void main() {
    vec4 here = texture2D(colorTexture, vUv);

    if (here.z == 0.0) {
      // Background color
      gl_FragColor = vec4(0, 0, 0, 0);
      return;
    }

    // Sample the 4 surrounding pixels in the depth texture to determine
    // if we should draw a boundary here or not.
    vec4 N = texture2D(colorTexture, vUv + vec2(0, uvSpacePixelSize.y));
    vec4 E = texture2D(colorTexture, vUv + vec2(uvSpacePixelSize.x, 0));
    vec4 S = texture2D(colorTexture, vUv + vec2(0, -uvSpacePixelSize.y));
    vec4 W = texture2D(colorTexture, vUv + vec2(-uvSpacePixelSize.x, 0));

    // NOTE: For outline checks, we intentionally check both the right
    // and the left to determine if we're an edge. If a rectangle is a single
    // pixel wide, we don't want to render it as an outline, so this method
    // of checking ensures that we don't outline single physical-space
    // pixel width rectangles.
    if (
      renderOutlines > 0.0 &&
      (
        here.y == N.y && here.y != S.y || // Top edge
        here.y == S.y && here.y != N.y || // Bottom edge
        here.x == E.x && here.x != W.x || // Left edge
        here.x == W.x && here.x != E.x
      )
    ) {
      // We're on an edge! Draw transparent.
      gl_FragColor = vec4(0, 0, 0, 0);
    } else {
      // Not on an edge. Draw the appropriate color.
      gl_FragColor = vec4(colorForBucket(here.z), here.a);
    }
  }
`,gt=class{constructor(t,e){this.gl=t;let a=[{pos:[-1,1],uv:[0,1]},{pos:[1,1],uv:[1,1]},{pos:[-1,-1],uv:[0,0]},{pos:[1,-1],uv:[1,0]}],r=[];for(let o of a)r.push(o.pos[0]),r.push(o.pos[1]),r.push(o.uv[0]),r.push(o.uv[1]);this.buffer=t.createVertexBuffer(yt.stride*a.length),this.buffer.uploadFloats(r),this.material=t.createMaterial(yt,Mi,Vi(e.colorForBucketGLSL))}render(t){let{srcRect:e,rectInfoTexture:a}=t,o=T.withTranslation(new u(0,1)).times(T.withScale(new u(1,-1))).times(T.betweenRects(new w(u.zero,new u(a.width,a.height)),w.unit)).transformRect(e),i=T.betweenRects(w.unit,o),{dstRect:s}=t,d=new u(this.gl.viewport.width,this.gl.viewport.height),h=T.withScale(new u(1,-1)).times(T.betweenRects(new w(u.zero,d),w.NDC)).transformRect(s),m=T.betweenRects(w.NDC,h),g=u.unit.dividedByPointwise(new u(t.rectInfoTexture.width,t.rectInfoTexture.height));this.material.setUniformSampler("colorTexture",t.rectInfoTexture,0),he(this.material,"uvTransform",i),this.material.setUniformFloat("renderOutlines",t.renderOutlines?1:0),this.material.setUniformVec2("uvSpacePixelSize",g.x,g.y),he(this.material,"positionTransform",m),this.gl.setUnpremultipliedBlendState(),this.gl.draw(B.Primitive.TRIANGLE_STRIP,this.material,this.buffer)}};var jt=class{constructor(t,e){this.animationFrameRequest=null;this.beforeFrameHandlers=new Set;this.onBeforeFrame=()=>{this.animationFrameRequest=null,this.gl.setViewport(0,0,this.gl.renderTargetWidthInPixels,this.gl.renderTargetHeightInPixels);let t=V.fromCSSHex(this.theme.bgPrimaryColor);this.gl.clear(new B.Color(t.r,t.g,t.b,t.a));for(let e of this.beforeFrameHandlers)e()};this.gl=new Sn.Context(t),this.rectangleBatchRenderer=new pt(this.gl),this.textureRenderer=new ut(this.gl),this.viewportRectangleRenderer=new ft(this.gl,e),this.flamechartColorPassRenderer=new gt(this.gl,e),this.theme=e,this.gl.addAfterResizeEventHandler(this.onBeforeFrame);let a=this.gl.getWebGLInfo();a&&console.log(`WebGL initialized. renderer: ${a.renderer}, vendor: ${a.vendor}, version: ${a.version}`),window.testContextLoss=()=>{this.gl.testContextLoss()}}addBeforeFrameHandler(t){this.beforeFrameHandlers.add(t)}removeBeforeFrameHandler(t){this.beforeFrameHandlers.delete(t)}requestFrame(){this.animationFrameRequest||(this.animationFrameRequest=requestAnimationFrame(this.onBeforeFrame))}setViewport(t,e){let{origin:a,size:r}=t,o=this.gl.viewport;this.gl.setViewport(a.x,a.y,r.x,r.y),e();let{x:i,y:s,width:d,height:c}=o;this.gl.setViewport(i,s,d,c)}renderBehind(t,e){let a=t.getBoundingClientRect(),r=new w(new u(a.left*window.devicePixelRatio,a.top*window.devicePixelRatio),new u(a.width*window.devicePixelRatio,a.height*window.devicePixelRatio));this.setViewport(r,e)}};var we=Fe(n=>t=>n.get(t.key)||0),ue=ee(({theme:n,frameToColorBucket:t})=>{let e=we(t);return a=>{let r=e(a)/255;return n.colorForBucket(r).toCSS()}}),fe=ee(({theme:n,canvas:t})=>new jt(t,n)),Ea=Fe(n=>new mt(n.gl,n.rectangleBatchRenderer,n.textureRenderer)),Ta=ee(({profile:n,flattenRecursion:t})=>t?n.getProfileWithRecursionFlattened():n),ye=Fe(n=>{let t=[];n.forEachFrame(o=>t.push(o));function e(o){return(o.file||"")+o.name}function a(o,i){return e(o)>e(i)?1:-1}t.sort(a);let r=new Map;for(let o=0;o<t.length;o++)r.set(t[o].key,Math.floor(255*o/t.length));return r});var Pe,re,Ha,Ye=0,kn=[],La=A.__r,Ba=A.diffed,Ia=A.__c,za=A.unmount;function Ze(n,t){A.__h&&A.__h(re,n,Ye||t),Ye=0;var e=re.__H||(re.__H={__:[],__h:[]});return n>=e.__.length&&e.__.push({}),e.__[n]}function te(n){return Ye=1,Fa(Pa,n)}function Fa(n,t,e){var a=Ze(Pe++,2);return a.__c||(a.__c=re,a.__=[e?e(t):Pa(void 0,t),function(r){var o=n(a.__[0],r);a.__[0]!==o&&(a.__[0]=o,a.__c.setState({}))}]),a.__}function ne(n,t){var e=Ze(Pe++,3);!A.__s&&Tn(e.__H,t)&&(e.__=n,e.__H=t,re.__H.__h.push(e))}function En(n,t){var e=Ze(Pe++,4);!A.__s&&Tn(e.__H,t)&&(e.__=n,e.__H=t,re.__h.push(e))}function Re(n){return Ye=5,P(function(){return{current:n}},[])}function P(n,t){var e=Ze(Pe++,7);return Tn(e.__H,t)?(e.__H=t,e.__h=n,e.__=n()):e.__}function E(n,t){return Ye=8,P(function(){return n},t)}function oe(n){var t=re.context[n.__c],e=Ze(Pe++,9);return e.__c=n,t?(e.__==null&&(e.__=!0,t.sub(re)),t.props.value):n.__}function Oi(){kn.some(function(n){if(n.__P)try{n.__H.__h.forEach(Nn),n.__H.__h.forEach(An),n.__H.__h=[]}catch(t){return n.__H.__h=[],A.__e(t,n.__v),!0}}),kn=[]}function Nn(n){n.t&&n.t()}function An(n){var t=n.__();typeof t=="function"&&(n.t=t)}function Tn(n,t){return!n||t.some(function(e,a){return e!==n[a]})}function Pa(n,t){return typeof t=="function"?t(n):t}A.__r=function(n){La&&La(n),Pe=0,(re=n.__c).__H&&(re.__H.__h.forEach(Nn),re.__H.__h.forEach(An),re.__H.__h=[])},A.diffed=function(n){Ba&&Ba(n);var t=n.__c;if(t){var e=t.__H;e&&e.__h.length&&(kn.push(t)!==1&&Ha===A.requestAnimationFrame||((Ha=A.requestAnimationFrame)||function(a){var r,o=function(){clearTimeout(i),cancelAnimationFrame(r),setTimeout(a)},i=setTimeout(o,100);typeof window<"u"&&(r=requestAnimationFrame(o))})(Oi))}},A.__c=function(n,t){t.some(function(e){try{e.__h.forEach(Nn),e.__h=e.__h.filter(function(a){return!a.__||An(a)})}catch(a){t.some(function(r){r.__h&&(r.__h=[])}),t=[],A.__e(a,e.__v)}}),Ia&&Ia(n,t)},A.unmount=function(n){za&&za(n);var t=n.__c;if(t){var e=t.__H;if(e)try{e.__.forEach(function(a){return a.t&&a.t()})}catch(a){A.__e(a,t.__v)}}};function $a(n,t){for(var e in t)n[e]=t[e];return n}function Ln(n,t){for(var e in n)if(e!=="__source"&&!(e in t))return!0;for(var a in t)if(a!=="__source"&&n[a]!==t[a])return!0;return!1}var ah=function(n){var t,e;function a(r){var o;return(o=n.call(this,r)||this).isPureReactComponent=!0,o}return e=n,(t=a).prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e,a.prototype.shouldComponentUpdate=function(r,o){return Ln(this.props,r)||Ln(this.state,o)},a}(W);function O(n,t){function e(r){var o=this.props.ref,i=o==r.ref;return!i&&o&&(o.call?o(null):o.current=null),t?!t(this.props,r)||!i:Ln(this.props,r)}function a(r){return this.shouldComponentUpdate=e,p(n,$a({},r))}return a.prototype.isReactComponent=!0,a.displayName="Memo("+(n.displayName||n.name)+")",a.t=!0,a}var Da=A.__b;A.__b=function(n){n.type&&n.type.t&&n.ref&&(n.props.ref=n.ref,n.ref=null),Da&&Da(n)};var Ui=A.__e;function Wa(n){return n&&((n=$a({},n)).__c=null,n.__k=n.__k&&n.__k.map(Wa)),n}function Ja(){this.__u=0,this.o=null,this.__b=null}function Ga(n){var t=n.__.__c;return t&&t.u&&t.u(n)}function Ct(){this.i=null,this.l=null}A.__e=function(n,t,e){if(n.then){for(var a,r=t;r=r.__;)if((a=r.__c)&&a.__c)return a.__c(n,t.__c)}Ui(n,t,e)},(Ja.prototype=new W).__c=function(n,t){var e=this;e.o==null&&(e.o=[]),e.o.push(t);var a=Ga(e.__v),r=!1,o=function(){r||(r=!0,a?a(i):i())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){o(),t.__c&&t.__c()};var i=function(){var s;if(!--e.__u)for(e.__v.__k[0]=e.state.u,e.setState({u:e.__b=null});s=e.o.pop();)s.forceUpdate()};e.__u++||e.setState({u:e.__b=e.__v.__k[0]}),n.then(o,o)},Ja.prototype.render=function(n,t){return this.__b&&(this.__v.__k[0]=Wa(this.__b),this.__b=null),[p(W,null,t.u?null:n.children),t.u&&n.fallback]};var Ma=function(n,t,e){if(++e[1]===e[0]&&n.l.delete(t),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.l.size))for(e=n.i;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;n.i=e=e[2]}};(Ct.prototype=new W).u=function(n){var t=this,e=Ga(t.__v),a=t.l.get(n);return a[0]++,function(r){var o=function(){t.props.revealOrder?(a.push(r),Ma(t,n,a)):r()};e?e(o):o()}},Ct.prototype.render=function(n){this.i=null,this.l=new Map;var t=Xe(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&t.reverse();for(var e=t.length;e--;)this.l.set(t[e],this.i=[1,0,this.i]);return n.children},Ct.prototype.componentDidUpdate=Ct.prototype.componentDidMount=function(){var n=this;n.l.forEach(function(t,e){Ma(n,e,t)})};var rh=function(){function n(){}var t=n.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},n}();var Va=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;W.prototype.isReactComponent={};var $i=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103;var Oa=A.event;function Hn(n,t){n["UNSAFE_"+t]&&!n[t]&&Object.defineProperty(n,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}A.event=function(n){Oa&&(n=Oa(n)),n.persist=function(){};var t=!1,e=!1,a=n.stopPropagation;n.stopPropagation=function(){a.call(n),t=!0};var r=n.preventDefault;return n.preventDefault=function(){r.call(n),e=!0},n.isPropagationStopped=function(){return t},n.isDefaultPrevented=function(){return e},n.nativeEvent=n};var Ka={configurable:!0,get:function(){return this.class}},Ua=A.vnode;A.vnode=function(n){n.$$typeof=$i;var t=n.type,e=n.props;if(t){if(e.class!=e.className&&(Ka.enumerable="className"in e,e.className!=null&&(e.class=e.className),Object.defineProperty(e,"className",Ka)),typeof t!="function"){var a,r,o;for(o in e.defaultValue&&e.value!==void 0&&(e.value||e.value===0||(e.value=e.defaultValue),delete e.defaultValue),Array.isArray(e.value)&&e.multiple&&t==="select"&&(Xe(e.children).forEach(function(i){e.value.indexOf(i.props.value)!=-1&&(i.props.selected=!0)}),delete e.value),e)if(a=Va.test(o))break;if(a)for(o in r=n.props={},e)r[Va.test(o)?o.replace(/[A-Z0-9]/,"-$&").toLowerCase():o]=e[o]}(function(i){var s=n.type,d=n.props;if(d&&typeof s=="string"){var c={};for(var h in d)/^on(Ani|Tra|Tou)/.test(h)&&(d[h.toLowerCase()]=d[h],delete d[h]),c[h.toLowerCase()]=h;if(c.ondoubleclick&&(d.ondblclick=d[c.ondoubleclick],delete d[c.ondoubleclick]),c.onbeforeinput&&(d.onbeforeinput=d[c.onbeforeinput],delete d[c.onbeforeinput]),c.onchange&&(s==="textarea"||s.toLowerCase()==="input"&&!/^fil|che|ra/i.test(d.type))){var m=c.oninput||"oninput";d[m]||(d[m]=d[c.onchange],delete d[c.onchange])}}})(),typeof t=="function"&&!t.m&&t.prototype&&(Hn(t.prototype,"componentWillMount"),Hn(t.prototype,"componentWillReceiveProps"),Hn(t.prototype,"componentWillUpdate"),t.m=!0)}Ua&&Ua(n)};var q=class{constructor(t,e){this.state=t;this.observers=[];this.set=this.set.bind(this),this.get=this.get.bind(this)}set(t){this.state!==t&&(this.state=t,this.observers.forEach(e=>e()))}get(){return this.state}subscribe(t){this.observers.push(t)}unsubscribe(t){let e=this.observers.indexOf(t);e!==-1&&this.observers.splice(e,1)}};function z(n){let[t,e]=te(n.get());return En(()=>{e(n.get());function a(){e(n.get())}return n.subscribe(a),()=>{n.unsubscribe(a)}},[n]),t}function Wi(n){switch(n){case"time-ordered":return 0;case"left-heavy":return 1;case"sandwich":return 2;default:return null}}function qa(n=window.location.hash){try{if(!n.startsWith("#"))return{};let t=n.substr(1).split("&"),e={};for(let a of t){let[r,o]=a.split("=");if(o=decodeURIComponent(o),r==="profileURL")e.profileURL=o;else if(r==="title")e.title=o;else if(r==="localProfilePath")e.localProfilePath=o;else if(r==="view"){let i=Wi(o);i!==null?e.viewMode=i:console.error(`Ignoring invalid view specifier: ${o}`)}}return e}catch(t){return console.error("Error when loading hash fragment."),console.error(t),{}}}var bt={hover:null,selectedNode:null,configSpaceViewportRect:w.empty,logicalSpaceViewportSize:u.zero},xt=class extends q{constructor(){super(...arguments);this.setProfileGroup=e=>{this.set({name:e.name,indexToView:e.indexToView,profiles:e.profiles.map(a=>({profile:a,chronoViewState:bt,leftHeavyViewState:bt,sandwichViewState:{callerCallee:null}}))})};this.setProfileIndexToView=e=>{this.state!=null&&(e=G(e,0,this.state.profiles.length-1),this.set({...this.state,indexToView:e}))};this.setSelectedFrame=e=>{this.state==null||this.getActiveProfile()==null||this.updateActiveSandwichViewState(r=>e==null?{callerCallee:null}:{callerCallee:{invertedCallerFlamegraph:bt,calleeFlamegraph:bt,selectedFrame:e}})}}set(e){let a=this.state;a!=null&&e!=null&&lt(a,e)||super.set(e)}getActiveProfile(){return this.state==null?null:this.state.profiles[this.state?.indexToView]||null}updateActiveProfileState(e){if(this.state==null)return;let{indexToView:a,profiles:r}=this.state;this.set({...this.state,profiles:r.map((o,i)=>i!=a?o:e(o))})}updateActiveSandwichViewState(e){this.updateActiveProfileState(a=>({...a,sandwichViewState:e(a.sandwichViewState)}))}updateFlamechartState(e,a){switch(e){case"CHRONO":{this.updateActiveProfileState(r=>({...r,chronoViewState:a(r.chronoViewState)}));break}case"LEFT_HEAVY":{this.updateActiveProfileState(r=>({...r,leftHeavyViewState:a(r.leftHeavyViewState)}));break}case"SANDWICH_CALLEES":{this.updateActiveSandwichViewState(r=>({...r,callerCallee:r.callerCallee==null?null:{...r.callerCallee,calleeFlamegraph:a(r.callerCallee.calleeFlamegraph)}}));break}case"SANDWICH_INVERTED_CALLERS":{this.updateActiveSandwichViewState(r=>({...r,callerCallee:r.callerCallee==null?null:{...r.callerCallee,invertedCallerFlamegraph:a(r.callerCallee.invertedCallerFlamegraph)}}));break}}}setFlamechartHoveredNode(e,a){this.updateFlamechartState(e,r=>({...r,hover:a}))}setSelectedNode(e,a){this.updateFlamechartState(e,r=>({...r,selectedNode:a}))}setConfigSpaceViewportRect(e,a){this.updateFlamechartState(e,r=>({...r,configSpaceViewportRect:a}))}setLogicalSpaceViewportSize(e,a){this.updateFlamechartState(e,r=>({...r,logicalSpaceViewportSize:a}))}clearHoverNode(){this.setFlamechartHoveredNode("CHRONO",null),this.setFlamechartHoveredNode("LEFT_HEAVY",null),this.setFlamechartHoveredNode("SANDWICH_CALLEES",null),this.setFlamechartHoveredNode("SANDWICH_INVERTED_CALLERS",null)}};var ge=new q(!1,"flattenRecursion"),De=new q(!1,"searchIsActive"),Je=new q("","searchQueryAtom"),ke=new q(0,"viewMode"),X=new xt(null,"profileGroup");ke.subscribe(()=>{X.clearHoverNode()});var Ya=qa(),Za=new q(Ya,"hashParams"),Ee=new q(null,"glCanvas"),In=new q(!1,"dragActive"),Xa=window.location.protocol,St=Xa==="http:"||Xa==="https:",Gi=St&&Ya.profileURL!=null,zn=new q(Gi,"loading"),Fn=new q(!1,"error");var Qe=new q({field:1,direction:1},"tableSortMethod");function wt(){let n=z(ge),t=z(X);if(!t||t.indexToView>=t.profiles.length)return null;let e=t.indexToView,a=t.profiles[e];return{...t.profiles[t.indexToView],profile:Ta({profile:a.profile,flattenRecursion:n}),index:t.indexToView}}var Rt="speedscope-color-scheme";function qi(){let n=window.localStorage&&window.localStorage[Rt];return n==="DARK"?1:n==="LIGHT"?2:0}function Xi(){return matchMedia("(prefers-color-scheme: dark)")}function Yi(n){if(Xi().matches)switch(n){case 0:return 2;case 2:return 1;case 1:return 0}else switch(n){case 0:return 1;case 1:return 2;case 2:return 0}}var Pn=class extends q{constructor(){super(...arguments);this.cycleToNextColorScheme=()=>{this.set(Yi(this.get()))}}},Te=new Pn(qi(),"colorScheme");Te.subscribe(()=>{let n=Te.get();switch(n){case 1:{window.localStorage[Rt]="DARK";break}case 2:{window.localStorage[Rt]="LIGHT";break}case 0:{delete window.localStorage[Rt];break}default:return n}return n});var Qa=.2,er=.1,tr=.2,nr=.1,Zi=n=>{let t=it(30*n),e=360*(.9*n),a=Qa+er*t,r=tr-nr*t;return V.fromLumaChromaHue(r,a,e)},Qi=`
  vec3 colorForBucket(float t) {
    float x = triangle(30.0 * t);
    float H = 360.0 * (0.9 * t);
    float C = ${Qa.toFixed(1)} + ${er.toFixed(1)} * x;
    float L = ${tr.toFixed(1)} - ${nr.toFixed(1)} * x;
    return hcl2rgb(H, C, L);
  }
`,Dn={fgPrimaryColor:"#D0D0D0",fgSecondaryColor:"#666666",bgPrimaryColor:"#060606",bgSecondaryColor:"#0C0C0C",altFgPrimaryColor:"#D0D0D0",altFgSecondaryColor:"#666666",altBgPrimaryColor:"#000000",altBgSecondaryColor:"#0C0C0C",selectionPrimaryColor:"#00769B",selectionSecondaryColor:"#004E75",weightColor:"#0F8A42",searchMatchTextColor:"#0C0C0C",searchMatchPrimaryColor:"#A66F1C",searchMatchSecondaryColor:"#D6AE24",colorForBucket:Zi,colorForBucketGLSL:Qi};var ar=.25,rr=.2,or=.8,ir=.15,el=n=>{let t=it(30*n),e=360*(.9*n),a=ar+rr*t,r=or-ir*t;return V.fromLumaChromaHue(r,a,e)},tl=`
  vec3 colorForBucket(float t) {
    float x = triangle(30.0 * t);
    float H = 360.0 * (0.9 * t);
    float C = ${ar.toFixed(1)} + ${rr.toFixed(1)} * x;
    float L = ${or.toFixed(1)} - ${ir.toFixed(1)} * x;
    return hcl2rgb(H, C, L);
  }
`,kt={fgPrimaryColor:"#000000",fgSecondaryColor:"#BDBDBD",bgPrimaryColor:"#FFFFFF",bgSecondaryColor:"#F6F6F6",altFgPrimaryColor:"#FFFFFF",altFgSecondaryColor:"#BDBDBD",altBgPrimaryColor:"#000000",altBgSecondaryColor:"#222222",selectionPrimaryColor:"#2F80ED",selectionSecondaryColor:"#8EB7ED",weightColor:"#6FCF97",searchMatchTextColor:"#000000",searchMatchPrimaryColor:"#FFAC02",searchMatchSecondaryColor:"#FEDC62",colorForBucket:el,colorForBucketGLSL:tl};var sr=ce(kt);function I(){return oe(sr)}function K(n){return Fe(n)}function lr(){return matchMedia("(prefers-color-scheme: dark)")}function _r(n){switch(n){case 0:return"System";case 1:return"Dark";case 2:return"Light"}}function nl(n,t){switch(n){case 0:return t?Dn:kt;case 1:return Dn;case 2:return kt}}function cr(n){let[t,e]=te(()=>lr().matches),a=E(i=>{e(i.matches)},[e]);ne(()=>{let i=lr();return i.addEventListener("change",a),()=>{i.removeEventListener("change",a)}},[a]);let r=z(Te),o=nl(r,t);return p(sr.Provider,{value:o,children:n.children})}var jo=Q(pr()),Co=Q(mr()),bo=Q(fr()),xo=Q(gr()),So=Q(br()),wo=Q(wr()),Ro=Q(Nr()),ko=Q(Er()),No=Q(Hr()),Ao=Q(Br()),Eo=Q(zr()),To=Q(Kr()),Ho=Q($r()),Lo=Q(ro()),Bo=Q(uo()),R=["Webkit"],$n=["Moz"],J=["ms"],Y=["Webkit","Moz"],$=["Webkit","ms"],et=["Webkit","Moz","ms"],ks={plugins:[jo.default,Co.default,bo.default,xo.default,So.default,wo.default,Ro.default,ko.default,No.default,Ao.default,Eo.default,To.default],prefixMap:{transform:$,transformOrigin:$,transformOriginX:$,transformOriginY:$,backfaceVisibility:R,perspective:R,perspectiveOrigin:R,transformStyle:R,transformOriginZ:R,animation:R,animationDelay:R,animationDirection:R,animationFillMode:R,animationDuration:R,animationIterationCount:R,animationName:R,animationPlayState:R,animationTimingFunction:R,appearance:Y,userSelect:et,fontKerning:R,textEmphasisPosition:R,textEmphasis:R,textEmphasisStyle:R,textEmphasisColor:R,boxDecorationBreak:R,clipPath:R,maskImage:R,maskMode:R,maskRepeat:R,maskPosition:R,maskClip:R,maskOrigin:R,maskSize:R,maskComposite:R,mask:R,maskBorderSource:R,maskBorderMode:R,maskBorderSlice:R,maskBorderWidth:R,maskBorderOutset:R,maskBorderRepeat:R,maskBorder:R,maskType:R,textDecorationStyle:Y,textDecorationSkip:Y,textDecorationLine:Y,textDecorationColor:Y,filter:R,fontFeatureSettings:Y,breakAfter:et,breakBefore:et,breakInside:et,columnCount:Y,columnFill:Y,columnGap:Y,columnRule:Y,columnRuleColor:Y,columnRuleStyle:Y,columnRuleWidth:Y,columns:Y,columnSpan:Y,columnWidth:Y,writingMode:$,flex:$,flexBasis:R,flexDirection:$,flexGrow:R,flexFlow:$,flexShrink:R,flexWrap:$,alignContent:R,alignItems:R,alignSelf:R,justifyContent:R,order:R,transitionDelay:R,transitionDuration:R,transitionProperty:R,transitionTimingFunction:R,backdropFilter:R,scrollSnapType:$,scrollSnapPointsX:$,scrollSnapPointsY:$,scrollSnapDestination:$,scrollSnapCoordinate:$,shapeImageThreshold:R,shapeImageMargin:R,shapeImageOutside:R,hyphens:et,flowInto:$,flowFrom:$,regionFragment:$,boxSizing:$n,textAlignLast:$n,tabSize:$n,wrapFlow:J,wrapThrough:J,wrapMargin:J,touchAction:J,gridTemplateColumns:J,gridTemplateRows:J,gridTemplateAreas:J,gridTemplate:J,gridAutoColumns:J,gridAutoRows:J,gridAutoFlow:J,grid:J,gridRowStart:J,gridColumnStart:J,gridRowEnd:J,gridRow:J,gridColumn:J,gridColumnEnd:J,gridColumnGap:J,gridRowGap:J,gridArea:J,gridGap:J,textSizeAdjust:$,borderImage:R,borderImageOutset:R,borderImageRepeat:R,borderImageSlice:R,borderImageSource:R,borderImageWidth:R}},Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},As=function(){function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function Es(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var fo=typeof Map<"u",Wn=function(){function n(){Es(this,n),this.elements={},this.keyOrder=[]}return As(n,[{key:"forEach",value:function(){function t(e){for(var a=0;a<this.keyOrder.length;a++)e(this.elements[this.keyOrder[a]],this.keyOrder[a])}return t}()},{key:"set",value:function(){function t(e,a,r){if(!this.elements.hasOwnProperty(e))this.keyOrder.push(e);else if(r){var o=this.keyOrder.indexOf(e);this.keyOrder.splice(o,1),this.keyOrder.push(e)}if(a==null){this.elements[e]=a;return}if(fo&&a instanceof Map||a instanceof n){var i=this.elements.hasOwnProperty(e)?this.elements[e]:new n;a.forEach(function(h,m){i.set(m,h,r)}),this.elements[e]=i;return}if(!Array.isArray(a)&&(typeof a>"u"?"undefined":Ns(a))==="object"){for(var s=this.elements.hasOwnProperty(e)?this.elements[e]:new n,d=Object.keys(a),c=0;c<d.length;c+=1)s.set(d[c],a[d[c]],r);this.elements[e]=s;return}this.elements[e]=a}return t}()},{key:"get",value:function(){function t(e){return this.elements[e]}return t}()},{key:"has",value:function(){function t(e){return this.elements.hasOwnProperty(e)}return t}()},{key:"addStyleType",value:function(){function t(e){var a=this;if(fo&&e instanceof Map||e instanceof n)e.forEach(function(i,s){a.set(s,i,!0)});else for(var r=Object.keys(e),o=0;o<r.length;o++)this.set(r[o],e[r[o]],!0)}return t}()}]),n}(),Ts=/([A-Z])/g,Hs=function(t){return"-"+String(t.toLowerCase())},Ls=function(t){var e=t.replace(Ts,Hs);return e[0]==="m"&&e[1]==="s"&&e[2]==="-"?"-"+String(e):e},Yt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function Bs(n,t){return n+t.charAt(0).toUpperCase()+t.substring(1)}var Is=["Webkit","ms","Moz","O"];Object.keys(Yt).forEach(function(n){Is.forEach(function(t){Yt[Bs(t,n)]=Yt[n]})});var Io=function(t,e){return typeof e=="number"?Yt[t]?""+e:e+"px":""+e},zs=function(t,e){return Ps(Io(t,e))},tt=function(t,e){return(0,Ho.default)(t).toString(36)},Fs=function(t){return tt(JSON.stringify(t))},Ps=function(t){return t[t.length-10]==="!"&&t.slice(-11)===" !important"?t:String(t)+" !important"};function Ds(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}else return Array.from(n)}var Js=(0,Lo.default)(ks),Ms=[function(){function n(t,e,a){return t[0]!==":"?null:a(e+t)}return n}(),function(){function n(t,e,a){if(t[0]!=="@")return null;var r=a(e);return[String(t)+"{"+String(r.join(""))+"}"]}return n}()],Gn=function n(t,e,a,r,o){for(var i=new Wn,s=0;s<e.length;s++)i.addStyleType(e[s]);var d=new Wn,c=[];i.forEach(function(m,g){var C=a.some(function(b){var _=b(g,t,function(l){return n(l,[m],a,r,o)});if(_!=null)return Array.isArray(_)?c.push.apply(c,Ds(_)):(console.warn("WARNING: Selector handlers should return an array of rules.Returning a string containing multiple rules is deprecated.",b),c.push("@media all {"+String(_)+"}")),!0});C||d.set(g,m,!0)});var h=Ks(t,d,r,o,a);return h&&c.unshift(h),c},Vs=function(t,e,a){if(e)for(var r=Object.keys(e),o=0;o<r.length;o++){var i=r[o];t.has(i)&&t.set(i,e[i](t.get(i),a),!1)}},yo=function(t,e,a){return String(Ls(t))+":"+String(a(t,e))+";"},Os=function(t,e){return t[e]=!0,t},Ks=function(t,e,a,r,o){Vs(e,a,o);var i=Object.keys(e.elements).reduce(Os,Object.create(null)),s=Js(e.elements),d=Object.keys(s);if(d.length!==e.keyOrder.length){for(var c=0;c<d.length;c++)if(!i[d[c]]){var h=void 0;if(d[c][0]==="W"?h=d[c][6].toLowerCase()+d[c].slice(7):d[c][1]==="o"?h=d[c][3].toLowerCase()+d[c].slice(4):h=d[c][2].toLowerCase()+d[c].slice(3),h&&i[h]){var m=e.keyOrder.indexOf(h);e.keyOrder.splice(m,0,d[c])}else e.keyOrder.unshift(d[c])}}for(var g=r===!1?Io:zs,C=[],b=0;b<e.keyOrder.length;b++){var _=e.keyOrder[b],l=s[_];if(Array.isArray(l))for(var v=0;v<l.length;v++)C.push(yo(_,l[v],g));else C.push(yo(_,l,g))}return C.length?String(t)+"{"+String(C.join(""))+"}":""},go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function Us(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}else return Array.from(n)}var ie=null,$s=function(t){if(ie==null&&(ie=document.querySelector("style[data-aphrodite]"),ie==null)){var e=document.head||document.getElementsByTagName("head")[0];ie=document.createElement("style"),ie.type="text/css",ie.setAttribute("data-aphrodite",""),e.appendChild(ie)}var a=ie.styleSheet||ie.sheet;if(a.insertRule){var r=a.cssRules.length;t.forEach(function(o){try{a.insertRule(o,r),r+=1}catch{}})}else ie.innerText=(ie.innerText||"")+t.join("")},qn={fontFamily:function(){function n(t){return Array.isArray(t)?t.map(n).join(","):(typeof t>"u"?"undefined":go(t))==="object"?(Fo(t.src,"@font-face",[t],!1),'"'+String(t.fontFamily)+'"'):t}return n}(),animationName:function(){function n(t,e){if(Array.isArray(t))return t.map(function(o){return n(o,e)}).join(",");if((typeof t>"u"?"undefined":go(t))==="object"){var a="keyframe_"+String(Fs(t)),r="@keyframes "+a+"{";return t instanceof Wn?t.forEach(function(o,i){r+=Gn(i,[o],e,qn,!1).join("")}):Object.keys(t).forEach(function(o){r+=Gn(o,[t[o]],e,qn,!1).join("")}),r+="}",zo(a,[r]),a}else return t}return n}()},Me={},Zt=[],Ve=!1,zo=function(t,e){var a;if(!Me[t]){if(!Ve){if(typeof document>"u")throw new Error("Cannot automatically buffer without a document");Ve=!0,(0,Bo.default)(Xs)}(a=Zt).push.apply(a,Us(e)),Me[t]=!0}},Fo=function(t,e,a,r){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[];if(!Me[t]){var i=Gn(e,a,o,qn,r);zo(t,i)}},Ws=function(){Zt=[],Me={},Ve=!1,ie=null};var Gs=function(){if(Ve)throw new Error("Cannot buffer while already buffering");Ve=!0},Po=function(){Ve=!1;var t=Zt;return Zt=[],t},qs=function(){return Po().join("")},Xs=function(){var t=Po();t.length>0&&$s(t)},Ys=function(){return Object.keys(Me)},Zs=function(t){t.forEach(function(e){Me[e]=!0})},Qs=function n(t,e,a,r){for(var o=0;o<t.length;o+=1)t[o]&&(Array.isArray(t[o])?r+=n(t[o],e,a,r):(e.push(t[o]._name),a.push(t[o]._definition),r+=t[o]._len));return r},e_=function(t,e,a){var r=[],o=[],i=Qs(e,r,o,0);if(r.length===0)return"";var s=void 0;return s=r.length===1?"_"+String(r[0]):"_"+String(tt(r.join()))+String((i%36).toString(36)),Fo(s,"."+String(s),o,t,a),s},t_=function(t,e){return String(e)+"_"+String(tt(t))},n_=function(){return tt},Do=n_(),a_={create:function(){function n(t){for(var e={},a=Object.keys(t),r=0;r<a.length;r+=1){var o=a[r],i=t[o],s=JSON.stringify(i);e[o]={_len:s.length,_name:Do(s,o),_definition:i}}return e}return n}(),rehydrate:function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Zs(t)}return n}()},r_=typeof window<"u"?null:{renderStatic:function(){function n(t){Ws(),Gs();var e=t(),a=qs();return{html:e,css:{content:a,renderedClassNames:Ys()}}}return n}()},o_=null;function Jo(n,t){return{StyleSheet:Object.assign({},a_,{extend:function(){function e(a){var r=a.map(function(o){return o.selectorHandler}).filter(function(o){return o});return Jo(n,t.concat(r))}return e}()}),StyleSheetServer:r_,StyleSheetTestUtils:o_,minify:function(){function e(a){Do=a?tt:t_}return e}(),css:function(){function e(){for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return e_(n,r,t)}return e}()}}var i_=!0,nt=Jo(i_,Ms),M=nt.StyleSheet,qh=nt.StyleSheetServer,Xh=nt.StyleSheetTestUtils,y=nt.css,Yh=nt.minify;var U=M.create({fillY:{height:"100%"},fillX:{width:"100%"},hbox:{display:"flex",flexDirection:"row",position:"relative",overflow:"hidden"},vbox:{display:"flex",flexDirection:"column",position:"relative",overflow:"hidden"}});function l_(n,t){let e=n.toLocaleLowerCase(),a=t.toLocaleLowerCase(),r=0,o=[];for(;;){let i=e.indexOf(a,r);if(i===-1)return o;o.push([i,i+t.length]),r=i+t.length}}var Qt=class{constructor(t,e){this.profile=t;this.searchQuery=e;this.matches=null}getMatchForFrame(t){return this.matches||(this.matches=new Map,this.profile.forEachFrame(e=>{let a=l_(e.name,this.searchQuery);this.matches.set(e,a.length===0?null:a)})),this.matches.get(t)||null}},en=class{constructor(t,e){this.flamechart=t;this.profileResults=e;this.matches=null}getResults(){if(this.matches==null){let t=[],e=new Map,a=(o,i)=>{let{node:s}=o;if(this.profileResults.getMatchForFrame(s.frame)){let d=new w(new u(o.start,i),new u(o.end-o.start,1));e.set(s,t.length),t.push({configSpaceBounds:d,node:s})}o.children.forEach(d=>{a(d,i+1)})},r=this.flamechart.getLayers();r.length>0&&r[0].forEach(o=>a(o,0)),this.matches={matches:t,indexForNode:e}}return this.matches}count(){return this.getResults().matches.length}indexOf(t){let e=this.getResults().indexForNode.get(t);return e===void 0?null:e}at(t){let e=this.getResults().matches;if(t<0||t>=e.length)throw new Error(`Index ${t} out of bounds in list of ${e.length} matches.`);return e[t]}};function Mo(n){n.stopPropagation()}var Le=ce(null),Vo=({children:n})=>{let t=wt(),e=t?t.profile:null,a=z(De),r=z(Je),o=P(()=>!e||!a||r.length===0?null:new Qt(e,r),[a,r,e]);return p(Le.Provider,{value:o},n)},tn=O(({numResults:n,resultIndex:t,selectNext:e,selectPrev:a})=>{let r=I(),o=s_(r),i=z(De),s=z(Je),d=Je.set,c=De.set,h=E(_=>{let l=_.target.value;d(l)},[d]),m=Re(null),g=E(()=>c(!1),[c]),C=E(_=>{_.shiftKey?a():e()},[a,e]),b=E(_=>{_.stopPropagation(),_.key==="Escape"&&c(!1),_.key==="Enter"&&C(_),_.key=="f"&&(_.metaKey||_.ctrlKey)&&(m.current&&m.current.select(),_.preventDefault())},[c,C]);return ne(()=>{let _=l=>{l.key=="f"&&(l.metaKey||l.ctrlKey)&&(l.preventDefault(),m.current?m.current.select():(c(!0),requestAnimationFrame(()=>{m.current&&m.current.select()})))};return window.addEventListener("keydown",_),()=>{window.removeEventListener("keydown",_)}},[c]),i?p("div",{className:y(o.searchView)},p("span",{className:y(o.icon)},"\u{1F50D}"),p("span",{className:y(o.inputContainer)},p("input",{className:y(o.input),value:s,onInput:h,onKeyDown:b,onKeyUp:Mo,onKeyPress:Mo,ref:m})),n!=null&&p(ae,null,p("span",{className:y(o.resultCount)},t==null?"?":t+1,"/",n),p("button",{className:y(o.icon,o.button),onClick:a},"\u2B05\uFE0F"),p("button",{className:y(o.icon,o.button),onClick:e},"\u27A1\uFE0F")),p("svg",{className:y(o.icon),onClick:g,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p("path",{d:"M4.99999 4.16217L11.6427 10.8048M11.6427 4.16217L4.99999 10.8048",stroke:r.altFgSecondaryColor}))):null}),s_=K(n=>M.create({searchView:{position:"absolute",top:0,right:10,height:20,width:16*13,borderWidth:2,borderColor:n.altFgPrimaryColor,borderStyle:"solid",fontSize:10,boxSizing:"border-box",background:n.altBgSecondaryColor,color:n.altFgPrimaryColor,display:"flex",alignItems:"center"},inputContainer:{flexShrink:1,flexGrow:1,display:"flex"},input:{width:"100%",border:"none",background:"none",fontSize:10,lineHeight:"20px",color:n.altFgPrimaryColor,":focus":{border:"none",outline:"none"},"::selection":{color:n.altFgPrimaryColor,background:n.selectionPrimaryColor}},resultCount:{verticalAlign:"middle"},icon:{flexShrink:0,verticalAlign:"middle",height:"100%",margin:"0px 2px 0px 2px",fontSize:10},button:{display:"inline",background:"none",border:"none",padding:0,":focus":{outline:"none"}}}));function Oo(n){return n.replace(/\\([a-fA-F0-9]{2})/g,(t,e)=>{let a=parseInt(e,16);return String.fromCharCode(a)})}function Ko(n){let t=n.split(`
`);if(!t.length||(t[t.length-1]===""&&t.pop(),!t.length))return null;let e=new Map,a=/^(\d+):(.+)$/,r=/^([\$\w]+):([\$\w-]+)$/;for(let o of t){let i=a.exec(o);if(i){e.set(`wasm-function[${i[1]}]`,Oo(i[2]));continue}let s=r.exec(o);if(s){e.set(s[1],Oo(s[2]));continue}return null}return o=>e.has(o.name)?{name:e.get(o.name)}:null}var be=class{constructor(t){this.source=t;this.layers=[];this.totalWeight=0;this.minFrameWidth=1;let e=[],a=(o,i)=>{let s=va(e),d={node:o,parent:s,children:[],start:i,end:i};s&&s.children.push(d),e.push(d)};this.minFrameWidth=1/0;let r=(o,i)=>{console.assert(e.length>0);let s=e.pop();if(s.end=i,s.end-s.start===0)return;let d=e.length;for(;this.layers.length<=d;)this.layers.push([]);this.layers[d].push(s),this.minFrameWidth=Math.min(this.minFrameWidth,s.end-s.start)};this.totalWeight=t.getTotalWeight(),t.forEachCall(a,r),isFinite(this.minFrameWidth)||(this.minFrameWidth=1)}getTotalWeight(){return this.totalWeight}getLayers(){return this.layers}getColorBucketForFrame(t){return this.source.getColorBucketForFrame(t)}getMinFrameWidth(){return this.minFrameWidth}formatValue(t){return this.source.formatValue(t)}getClampedViewportWidth(t){let e=this.getTotalWeight(),a=Math.pow(2,40),r=G(3*this.getMinFrameWidth(),e/a,e);return G(t,r,e)}getClampedConfigSpaceViewportRect({configSpaceViewportRect:t,renderInverted:e}){let a=new u(this.getTotalWeight(),this.getLayers().length),r=this.getClampedViewportWidth(t.size.x),o=t.size.withX(r),i=u.clamp(t.origin,new u(0,e?0:-1),u.max(u.zero,a.minus(o).plus(new u(0,1))));return new w(i,t.size.withX(r))}};var __=1e4,nn=class{constructor(t,e,a){this.batch=t;this.bounds=e;this.numPrecedingRectanglesInRow=a;this.children=[]}getBatch(){return this.batch}getBounds(){return this.bounds}getRectCount(){return this.batch.getRectCount()}getChildren(){return this.children}getParity(){return this.numPrecedingRectanglesInRow%2}forEachLeafNodeWithinBounds(t,e){this.bounds.hasIntersectionWith(t)&&e(this)}},Xn=class{constructor(t){this.children=t;this.rectCount=0;if(t.length===0)throw new Error("Empty interior node");let e=1/0,a=-1/0,r=1/0,o=-1/0;for(let i of t){this.rectCount+=i.getRectCount();let s=i.getBounds();e=Math.min(e,s.left()),a=Math.max(a,s.right()),r=Math.min(r,s.top()),o=Math.max(o,s.bottom())}this.bounds=new w(new u(e,r),new u(a-e,o-r))}getBounds(){return this.bounds}getRectCount(){return this.rectCount}getChildren(){return this.children}forEachLeafNodeWithinBounds(t,e){if(this.bounds.hasIntersectionWith(t))for(let a of this.children)a.forEachLeafNodeWithinBounds(t,e)}},an=class n{get key(){return`${this.stackDepth}_${this.index}_${this.zoomLevel}`}constructor(t){this.stackDepth=t.stackDepth,this.zoomLevel=t.zoomLevel,this.index=t.index}static getOrInsert(t,e){return t.getOrInsert(new n(e))}},rn=class{constructor(t,e,a,r,o,i={inverted:!1}){this.gl=t;this.rowAtlas=e;this.flamechart=a;this.rectangleBatchRenderer=r;this.colorPassRenderer=o;this.options=i;this.layers=[];this.rectInfoTexture=null;this.rectInfoRenderTarget=null;this.atlasKeys=new ma;let s=a.getLayers().length;for(let d=0;d<s;d++){let c=[],h=i.inverted?s-1-d:d,m=1/0,g=-1/0,C=new Ae(this.gl),b=0,_=a.getLayers()[d];for(let l=0;l<_.length;l++){let v=_[l];C.getRectCount()>=__&&(c.push(new nn(C,new w(new u(m,h),new u(g-m,1)),b)),m=1/0,g=-1/0,C=new Ae(this.gl));let f=new w(new u(v.start,h),new u(v.end-v.start,1));m=Math.min(m,f.left()),g=Math.max(g,f.right());let j=new V((1+l%255)/256,(1+d%255)/256,(1+this.flamechart.getColorBucketForFrame(v.node.frame))/256);C.addRect(f,j),b++}C.getRectCount()>0&&c.push(new nn(C,new w(new u(m,h),new u(g-m,1)),b)),this.layers.push(new Xn(c))}}getRectInfoTexture(t,e){if(this.rectInfoTexture){let a=this.rectInfoTexture;(a.width!=t||a.height!=e)&&a.resize(t,e)}else this.rectInfoTexture=this.gl.createTexture(B.TextureFormat.NEAREST_CLAMP,t,e);return this.rectInfoTexture}getRectInfoRenderTarget(t,e){let a=this.getRectInfoTexture(t,e);return this.rectInfoRenderTarget&&this.rectInfoRenderTarget.texture!=a&&(this.rectInfoRenderTarget.texture.free(),this.rectInfoRenderTarget.setColor(a)),this.rectInfoRenderTarget||(this.rectInfoRenderTarget=this.gl.createRenderTarget(a)),this.rectInfoRenderTarget}free(){this.rectInfoRenderTarget&&this.rectInfoRenderTarget.free(),this.rectInfoTexture&&this.rectInfoTexture.free()}configSpaceBoundsForKey(t){let{stackDepth:e,zoomLevel:a,index:r}=t,i=this.flamechart.getTotalWeight()/Math.pow(2,a),s=this.flamechart.getLayers().length,d=this.options.inverted?s-1-e:e;return new w(new u(i*r,d),new u(i,1))}render(t){let{configSpaceSrcRect:e,physicalSpaceDstRect:a}=t,r=[],o=T.betweenRects(e,a);if(e.isEmpty())return;let i=0;for(;;){let j=an.getOrInsert(this.atlasKeys,{stackDepth:0,zoomLevel:i,index:0}),x=this.configSpaceBoundsForKey(j);if(o.transformRect(x).width()<this.rowAtlas.getResolution())break;i++}let s=Math.max(0,Math.floor(e.top())),d=Math.min(this.layers.length,Math.ceil(e.bottom())),c=this.flamechart.getTotalWeight(),h=Math.pow(2,i),m=Math.floor(h*e.left()/c),g=Math.ceil(h*e.right()/c),C=this.flamechart.getLayers().length;for(let j=s;j<d;j++)for(let x=m;x<=g;x++){let S=this.options.inverted?C-1-j:j,N=an.getOrInsert(this.atlasKeys,{stackDepth:S,zoomLevel:i,index:x});this.configSpaceBoundsForKey(N).hasIntersectionWith(e)&&r.push(N)}let b=this.rowAtlas.getCapacity(),_=r.slice(0,b),l=r.slice(b);this.rowAtlas.writeToAtlasIfNeeded(_,(j,x)=>{let S=this.configSpaceBoundsForKey(x);this.layers[x.stackDepth].forEachLeafNodeWithinBounds(S,N=>{this.rectangleBatchRenderer.render({batch:N.getBatch(),configSpaceSrcRect:S,physicalSpaceDstRect:j})})});let v=this.getRectInfoRenderTarget(a.width(),a.height());dt(this.gl,v,()=>{this.gl.clear(new B.Color(0,0,0,0));let j=new w(u.zero,new u(this.gl.viewport.width,this.gl.viewport.height)),x=T.betweenRects(e,j);for(let S of _){let N=this.configSpaceBoundsForKey(S);this.rowAtlas.renderViaAtlas(S,x.transformRect(N))}for(let S of l){let N=this.configSpaceBoundsForKey(S),F=x.transformRect(N);this.layers[S.stackDepth].forEachLeafNodeWithinBounds(N,Z=>{this.rectangleBatchRenderer.render({batch:Z.getBatch(),configSpaceSrcRect:N,physicalSpaceDstRect:F})})}});let f=this.getRectInfoTexture(a.width(),a.height());this.colorPassRenderer.render({rectInfoTexture:f,srcRect:new w(u.zero,new u(f.width,f.height)),dstRect:a,renderOutlines:t.renderOutlines})}};var ve=K(n=>M.create({hoverCount:{color:n.weightColor},fill:{width:"100%",height:"100%",position:"absolute",left:0,top:0},minimap:{height:100,borderBottom:`2px solid ${n.fgSecondaryColor}`},panZoomView:{flex:1},detailView:{display:"grid",height:150,overflow:"hidden",gridTemplateColumns:"120px 120px 1fr",gridTemplateRows:"repeat(4, 1fr)",borderTop:`2px solid ${n.fgSecondaryColor}`,fontSize:10,position:"absolute",background:n.bgPrimaryColor,width:"100vw",bottom:0},stackTraceViewPadding:{padding:5},stackTraceView:{height:150,lineHeight:`${12}px`,overflow:"auto","::-webkit-scrollbar":{background:n.bgPrimaryColor},"::-webkit-scrollbar-thumb":{background:n.fgSecondaryColor,borderRadius:20,border:`3px solid ${n.bgPrimaryColor}`,":hover":{background:n.fgPrimaryColor}}},stackLine:{whiteSpace:"nowrap"},stackFileLine:{color:n.fgSecondaryColor},statsTable:{display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:`repeat(3, ${20}px)`,gridGap:"1px 1px",textAlign:"center",paddingRight:1},statsTableHeader:{gridColumn:"1 / 3"},statsTableCell:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},thisInstanceCell:{background:n.selectionPrimaryColor,color:n.altFgPrimaryColor},allInstancesCell:{background:n.selectionSecondaryColor,color:n.altFgPrimaryColor},barDisplay:{position:"absolute",top:0,left:0,background:"rgba(0, 0, 0, 0.2)",width:"100%"}}));var Zn="\u2026",on=new Map,Uo=-1;function xe(n,t){return window.devicePixelRatio!==Uo&&(on.clear(),Uo=window.devicePixelRatio),on.has(t)||on.set(t,n.measureText(t).width),on.get(t)}function Yn(n,t){if(n.length<=t)return{trimmedString:n,trimmedLength:n.length,prefixLength:n.length,suffixLength:0,originalString:n,originalLength:n.length};let e=Math.floor(t/2),a=t-e-1,r=n.substring(0,e),o=n.substring(n.length-a,n.length),i=r+Zn+o;return{trimmedString:i,trimmedLength:i.length,prefixLength:r.length,suffixLength:o.length,originalString:n,originalLength:n.length}}function Wo(n,t,e){if(xe(n,t)<=e)return Yn(t,t.length);let[a]=ua(0,t.length,r=>xe(n,Yn(t,Math.floor(r)).trimmedString),e);return Yn(t,Math.floor(a))}function $o(n,t){return t<n.prefixLength?0:t<n.originalLength-n.suffixLength?2:1}function Go(n,t){let e=[],a=n.originalLength-n.trimmedLength,r=!1;for(let[o,i]of t){let s=$o(n,o),d=$o(n,i-1);switch(s){case 0:{switch(d){case 0:{e.push([o,i]);break}case 2:{e.push([o,n.prefixLength+1]),r=!0;break}case 1:{e.push([o,i-a]);break}}break}case 2:{switch(d){case 0:throw new Error("Unexpected highlight range starts in elided and ends in prefix");case 2:{r||(e.push([n.prefixLength,n.prefixLength+1]),r=!0);break}case 1:{r?e.push([n.trimmedLength-n.suffixLength,i-a]):(e.push([n.prefixLength,i-a]),r=!0);break}}break}case 1:{switch(d){case 0:throw new Error("Unexpected highlight range starts in suffix and ends in prefix");case 2:throw new Error("Unexpected highlight range starts in suffix and ends in elided");case 1:{e.push([o-a,i-a]);break}}break}}}return e}var ln=class extends W{constructor(){super(...arguments);this.container=null;this.containerRef=e=>{this.container=e||null};this.overlayCanvas=null;this.overlayCtx=null;this.onWindowResize=()=>{this.onBeforeFrame()};this.onBeforeFrame=()=>{this.maybeClearInteractionLock(),this.resizeOverlayCanvasIfNeeded(),this.renderRects(),this.renderOverlays()};this.renderCanvas=()=>{this.props.canvasContext.requestFrame()};this.frameHadWheelEvent=!1;this.framesWithoutWheelEvents=0;this.interactionLock=null;this.maybeClearInteractionLock=()=>{this.interactionLock&&(this.frameHadWheelEvent||(this.framesWithoutWheelEvents++,this.framesWithoutWheelEvents>=2&&(this.interactionLock=null,this.framesWithoutWheelEvents=0)),this.props.canvasContext.requestFrame()),this.frameHadWheelEvent=!1};this.onWheel=e=>{if(e.preventDefault(),this.frameHadWheelEvent=!0,(e.metaKey||e.ctrlKey)&&this.interactionLock!=="pan"){let r=1+e.deltaY/100;e.ctrlKey&&(r=1+e.deltaY/40),r=G(r,.1,10),this.zoom(r)}else this.interactionLock!=="zoom"&&this.pan(new u(e.deltaX,e.deltaY));this.renderCanvas()};this.dragStartConfigSpaceMouse=null;this.dragConfigSpaceViewportOffset=null;this.draggingMode=null;this.onMouseDown=e=>{let a=this.configSpaceMouse(e);a&&(this.props.configSpaceViewportRect.contains(a)?(this.draggingMode=1,this.dragConfigSpaceViewportOffset=a.minus(this.props.configSpaceViewportRect.origin)):this.draggingMode=0,this.dragStartConfigSpaceMouse=a,window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),this.updateCursor(a))};this.onWindowMouseMove=e=>{if(!this.dragStartConfigSpaceMouse)return;let a=this.configSpaceMouse(e);if(a){if(this.updateCursor(a),a=new w(new u(0,0),this.configSpaceSize()).closestPointTo(a),this.draggingMode===0){let r=this.dragStartConfigSpaceMouse,o=a;if(!r||!o)return;let i=Math.min(r.x,o.x),d=Math.max(r.x,o.x)-i,c=this.props.configSpaceViewportRect.height();this.props.setConfigSpaceViewportRect(new w(new u(i,o.y-c/2),new u(d,c)))}else if(this.draggingMode===1){if(!this.dragConfigSpaceViewportOffset)return;let r=a.minus(this.dragConfigSpaceViewportOffset);this.props.setConfigSpaceViewportRect(this.props.configSpaceViewportRect.withOrigin(r))}}};this.updateCursor=e=>{this.draggingMode===1?(document.body.style.cursor="grabbing",document.body.style.cursor="-webkit-grabbing"):this.draggingMode===0?document.body.style.cursor="col-resize":this.props.configSpaceViewportRect.contains(e)?(document.body.style.cursor="grab",document.body.style.cursor="-webkit-grab"):document.body.style.cursor="col-resize"};this.onMouseLeave=()=>{this.draggingMode==null&&(document.body.style.cursor="default")};this.onMouseMove=e=>{let a=this.configSpaceMouse(e);a&&this.updateCursor(a)};this.onWindowMouseUp=e=>{this.draggingMode=null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp);let a=this.configSpaceMouse(e);a&&this.updateCursor(a)};this.overlayCanvasRef=e=>{e?(this.overlayCanvas=e,this.overlayCtx=this.overlayCanvas.getContext("2d"),this.renderCanvas()):(this.overlayCanvas=null,this.overlayCtx=null)}}physicalViewSize(){return new u(this.overlayCanvas?this.overlayCanvas.width:0,this.overlayCanvas?this.overlayCanvas.height:0)}getStyle(){return ve(this.props.theme)}minimapOrigin(){return new u(0,20*window.devicePixelRatio)}configSpaceSize(){return new u(this.props.flamechart.getTotalWeight(),this.props.flamechart.getLayers().length)}configSpaceToPhysicalViewSpace(){let e=this.minimapOrigin();return T.betweenRects(new w(new u(0,0),this.configSpaceSize()),new w(e,this.physicalViewSize().minus(e)))}logicalToPhysicalViewSpace(){return T.withScale(new u(window.devicePixelRatio,window.devicePixelRatio))}windowToLogicalViewSpace(){if(!this.container)return new T;let e=this.container.getBoundingClientRect();return T.withTranslation(new u(-e.left,-e.top))}renderRects(){this.container&&(this.physicalViewSize().x<2||this.props.canvasContext.renderBehind(this.container,()=>{this.props.flamechartRenderer.render({configSpaceSrcRect:new w(new u(0,0),this.configSpaceSize()),physicalSpaceDstRect:new w(this.minimapOrigin(),this.physicalViewSize().minus(this.minimapOrigin())),renderOutlines:!1}),this.props.canvasContext.viewportRectangleRenderer.render({configSpaceViewportRect:this.props.configSpaceViewportRect,configSpaceToPhysicalViewSpace:this.configSpaceToPhysicalViewSpace()})}))}renderOverlays(){let e=this.overlayCtx;if(!e)return;let a=this.physicalViewSize();e.clearRect(0,0,a.x,a.y);let r=this.configSpaceToPhysicalViewSpace(),o=0,i=this.configSpaceSize().x,d=(this.configSpaceToPhysicalViewSpace().inverted()||new T).times(this.logicalToPhysicalViewSpace()).transformVector(new u(200,1)).x,c=20*window.devicePixelRatio,h=10*window.devicePixelRatio,m=(c-h)/2;e.font=`${h}px/${c}px "Source Code Pro", Courier, monospace`,e.textBaseline="top";let C=Math.pow(10,Math.floor(Math.log10(d)));d/C>5?C*=5:d/C>2&&(C*=2);let b=this.props.theme;{e.fillStyle=V.fromCSSHex(b.bgPrimaryColor).withAlpha(.8).toCSS(),e.fillRect(0,0,a.x,c),e.textBaseline="top";for(let _=Math.ceil(o/C)*C;_<i;_+=C){let l=Math.round(r.transformPosition(new u(_,0)).x),v=this.props.flamechart.formatValue(_),f=Math.ceil(xe(e,v));e.fillStyle=b.fgPrimaryColor,e.fillText(v,l-f-m,m),e.fillStyle=b.fgSecondaryColor,e.fillRect(l,0,1,a.y)}}}componentWillReceiveProps(e){this.props.flamechart!==e.flamechart?this.renderCanvas():this.props.configSpaceViewportRect!=e.configSpaceViewportRect?this.renderCanvas():this.props.canvasContext!==e.canvasContext&&(this.props.canvasContext&&this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame),e.canvasContext&&(e.canvasContext.addBeforeFrameHandler(this.onBeforeFrame),e.canvasContext.requestFrame()))}componentDidMount(){window.addEventListener("resize",this.onWindowResize),this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize),this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)}resizeOverlayCanvasIfNeeded(){if(!this.overlayCanvas)return;let{width:e,height:a}=this.overlayCanvas.getBoundingClientRect();if(e=Math.floor(e),a=Math.floor(a),e===0||a===0)return;let r=e*window.devicePixelRatio,o=a*window.devicePixelRatio;r===this.overlayCanvas.width&&o===this.overlayCanvas.height||(this.overlayCanvas.width=r,this.overlayCanvas.height=o)}pan(e){this.interactionLock="pan";let a=this.logicalToPhysicalViewSpace().transformVector(e),r=this.configSpaceToPhysicalViewSpace().inverseTransformVector(a);r&&this.props.transformViewport(T.withTranslation(r))}zoom(e){this.interactionLock="zoom";let a=this.props.configSpaceViewportRect,r=a.origin.plus(a.size.times(1/2));if(!r)return;let o=T.withTranslation(r.times(-1)).scaledBy(new u(e,1)).translatedBy(r);this.props.transformViewport(o)}configSpaceMouse(e){let a=this.windowToLogicalViewSpace().transformPosition(new u(e.clientX,e.clientY)),r=this.logicalToPhysicalViewSpace().transformPosition(a);return this.configSpaceToPhysicalViewSpace().inverseTransformPosition(r)}render(){let e=this.getStyle();return p("div",{ref:this.containerRef,onWheel:this.onWheel,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,className:y(e.minimap,U.vbox)},p("canvas",{width:1,height:1,ref:this.overlayCanvasRef,className:y(e.fill)}))}};function _n(n){let t=c_(I());return p("span",{className:y(t.stackChit),style:{backgroundColor:n.color}})}var c_=K(n=>M.create({stackChit:{position:"relative",top:-1,display:"inline-block",verticalAlign:"middle",marginRight:"0.5em",border:`1px solid ${n.fgSecondaryColor}`,width:8,height:8}}));function qo(n){let t=ve(I()),e=n.formatter(n.selectedTotal),a=n.formatter(n.selectedSelf),r=100*n.selectedTotal/n.grandTotal,o=100*n.selectedSelf/n.grandTotal;return p("div",{className:y(t.statsTable)},p("div",{className:y(n.cellStyle,t.statsTableCell,t.statsTableHeader)},n.title),p("div",{className:y(n.cellStyle,t.statsTableCell)},"Total"),p("div",{className:y(n.cellStyle,t.statsTableCell)},"Self"),p("div",{className:y(n.cellStyle,t.statsTableCell)},e),p("div",{className:y(n.cellStyle,t.statsTableCell)},a),p("div",{className:y(n.cellStyle,t.statsTableCell)},_e(r),p("div",{className:y(t.barDisplay),style:{height:`${r}%`}})),p("div",{className:y(n.cellStyle,t.statsTableCell)},_e(o),p("div",{className:y(t.barDisplay),style:{height:`${o}%`}})))}function h_(n){let t=ve(I()),e=[],a=n.node;for(;a&&!a.isRoot();a=a.parent){let r=[],{frame:o}=a;if(r.push(p(_n,{color:n.getFrameColor(o)})),e.length&&r.push(p("span",{className:y(t.stackFileLine)},"> ")),r.push(o.name),o.file){let i=o.file;o.line!=null&&(i+=`:${o.line}`,o.col!=null&&(i+=`:${o.col}`)),r.push(p("span",{className:y(t.stackFileLine)}," (",i,")"))}e.push(p("div",{className:y(t.stackLine)},r))}return p("div",{className:y(t.stackTraceView)},p("div",{className:y(t.stackTraceViewPadding)},e))}function Xo(n){let t=ve(I()),{flamechart:e,selectedNode:a}=n,{frame:r}=a;return p("div",{className:y(t.detailView)},p(qo,{title:"This Instance",cellStyle:t.thisInstanceCell,grandTotal:e.getTotalWeight(),selectedTotal:a.getTotalWeight(),selectedSelf:a.getSelfWeight(),formatter:e.formatValue.bind(e)}),p(qo,{title:"All Instances",cellStyle:t.allInstancesCell,grandTotal:e.getTotalWeight(),selectedTotal:r.getTotalWeight(),selectedSelf:r.getSelfWeight(),formatter:e.formatValue.bind(e)}),p(h_,{node:a,getFrameColor:n.getCSSColorForFrame}))}var at=class{constructor(){this.argsBatch=[]}text(t){this.argsBatch.push(t)}fill(t,e){if(this.argsBatch.length!==0){t.fillStyle=e;for(let a of this.argsBatch)t.fillText(a.text,a.x,a.y);this.argsBatch=[]}}},Be=class{constructor(){this.argsBatch=[]}rect(t){this.argsBatch.push(t)}drawPath(t){t.beginPath();for(let e of this.argsBatch)t.rect(e.x,e.y,e.w,e.h);t.closePath(),this.argsBatch=[]}fill(t,e){this.argsBatch.length!==0&&(t.fillStyle=e,this.drawPath(t),t.fill())}stroke(t,e,a){this.argsBatch.length!==0&&(t.strokeStyle=e,t.lineWidth=a,this.drawPath(t),t.stroke())}};var Oe=class extends W{constructor(){super(...arguments);this.container=null;this.containerRef=e=>{this.container=e||null};this.overlayCanvas=null;this.overlayCtx=null;this.hoveredLabel=null;this.overlayCanvasRef=e=>{e?(this.overlayCanvas=e,this.overlayCtx=this.overlayCanvas.getContext("2d"),this.renderCanvas()):(this.overlayCanvas=null,this.overlayCtx=null)};this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT=20;this.onWindowResize=()=>{this.updateConfigSpaceViewport(),this.onBeforeFrame()};this.frameHadWheelEvent=!1;this.framesWithoutWheelEvents=0;this.interactionLock=null;this.maybeClearInteractionLock=()=>{this.interactionLock&&(this.frameHadWheelEvent||(this.framesWithoutWheelEvents++,this.framesWithoutWheelEvents>=2&&(this.interactionLock=null,this.framesWithoutWheelEvents=0)),this.props.canvasContext.requestFrame()),this.frameHadWheelEvent=!1};this.onBeforeFrame=()=>{this.resizeOverlayCanvasIfNeeded(),this.renderRects(),this.renderOverlays(),this.maybeClearInteractionLock()};this.renderCanvas=()=>{this.props.canvasContext.requestFrame()};this.lastDragPos=null;this.mouseDownPos=null;this.onMouseDown=e=>{this.mouseDownPos=this.lastDragPos=new u(e.offsetX,e.offsetY),this.updateCursor(),window.addEventListener("mouseup",this.onWindowMouseUp)};this.onMouseDrag=e=>{if(!this.lastDragPos)return;let a=new u(e.offsetX,e.offsetY);this.pan(this.lastDragPos.minus(a)),this.lastDragPos=a,this.hoveredLabel&&this.props.onNodeHover(null)};this.onDblClick=e=>{if(this.hoveredLabel){let a=this.hoveredLabel.configSpaceBounds,r=new w(a.origin.minus(new u(0,1)),a.size.withY(this.props.configSpaceViewportRect.height()));this.props.setConfigSpaceViewportRect(r)}};this.onClick=e=>{let a=new u(e.offsetX,e.offsetY),r=this.mouseDownPos;this.mouseDownPos=null,!(r&&a.minus(r).length()>5)&&(this.hoveredLabel?(this.props.onNodeSelect(this.hoveredLabel.node),this.renderCanvas()):this.props.onNodeSelect(null))};this.onWindowMouseUp=e=>{this.lastDragPos=null,this.updateCursor(),window.removeEventListener("mouseup",this.onWindowMouseUp)};this.onMouseMove=e=>{if(this.updateCursor(),this.lastDragPos){e.preventDefault(),this.onMouseDrag(e);return}let a=new u(e.offsetX,e.offsetY),r=this.logicalToPhysicalViewSpace().transformPosition(a),o=this.configSpaceToPhysicalViewSpace().inverseTransformPosition(r);if(!o)return;let i=(d,c=0)=>{let h=d.end-d.start,m=this.props.renderInverted?this.configSpaceSize().y-1-c:c,g=new w(new u(d.start,m),new u(h,1));if(o.x<g.left()||o.x>g.right())return null;g.contains(o)&&(this.hoveredLabel={configSpaceBounds:g,node:d.node});for(let C of d.children)i(C,c+1)};(()=>{this.hoveredLabel=null})();for(let d of this.props.flamechart.getLayers()[0]||[])i(d);this.hoveredLabel?this.props.onNodeHover({node:this.hoveredLabel.node,event:e}):this.props.onNodeHover(null),this.renderCanvas()};this.onMouseLeave=e=>{this.hoveredLabel=null,this.props.onNodeHover(null),this.renderCanvas()};this.onWheel=e=>{e.preventDefault(),this.frameHadWheelEvent=!0;let a=e.metaKey||e.ctrlKey,r=e.deltaY,o=e.deltaX;if(e.deltaMode===e.DOM_DELTA_LINE&&(r*=this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT,o*=this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT),a&&this.interactionLock!=="pan"){let i=1+r/100;e.ctrlKey&&(i=1+r/40),i=G(i,.1,10),this.zoom(new u(e.offsetX,e.offsetY),i)}else this.interactionLock!=="zoom"&&this.pan(new u(o,r));this.renderCanvas()};this.onWindowKeyPress=e=>{if(!this.container)return;let{width:a,height:r}=this.container.getBoundingClientRect();e.key==="="||e.key==="+"?(this.zoom(new u(a/2,r/2),.5),e.preventDefault()):(e.key==="-"||e.key==="_")&&(this.zoom(new u(a/2,r/2),2),e.preventDefault()),!(e.ctrlKey||e.shiftKey||e.metaKey)&&(e.key==="0"?this.zoom(new u(a/2,r/2),1e9):e.key==="ArrowRight"||e.code==="KeyD"?this.pan(new u(100,0)):e.key==="ArrowLeft"||e.code==="KeyA"?this.pan(new u(-100,0)):e.key==="ArrowUp"||e.code==="KeyW"?this.pan(new u(0,-100)):e.key==="ArrowDown"||e.code==="KeyS"?this.pan(new u(0,100)):e.key==="Escape"&&(this.props.onNodeSelect(null),this.renderCanvas()))}}getStyle(){return ve(this.props.theme)}setConfigSpaceViewportRect(e){this.props.setConfigSpaceViewportRect(e)}configSpaceSize(){return new u(this.props.flamechart.getTotalWeight(),this.props.flamechart.getLayers().length)}physicalViewSize(){return new u(this.overlayCanvas?this.overlayCanvas.width:0,this.overlayCanvas?this.overlayCanvas.height:0)}physicalBounds(){if(this.props.renderInverted){let e=this.physicalViewSize().y,a=(this.configSpaceSize().y+1)*this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT*window.devicePixelRatio;if(a<e)return new w(new u(0,e-a),this.physicalViewSize())}return new w(new u(0,0),this.physicalViewSize())}configSpaceToPhysicalViewSpace(){return T.betweenRects(this.props.configSpaceViewportRect,this.physicalBounds())}logicalToPhysicalViewSpace(){return T.withScale(new u(window.devicePixelRatio,window.devicePixelRatio))}resizeOverlayCanvasIfNeeded(){if(!this.overlayCanvas)return;let{width:e,height:a}=this.overlayCanvas.getBoundingClientRect();if(e=Math.floor(e),a=Math.floor(a),e===0||a===0)return;let r=e*window.devicePixelRatio,o=a*window.devicePixelRatio;r===this.overlayCanvas.width&&o===this.overlayCanvas.height||(this.overlayCanvas.width=r,this.overlayCanvas.height=o)}renderOverlays(){let e=this.overlayCtx;if(!e||this.props.configSpaceViewportRect.isEmpty())return;let a=this.configSpaceToPhysicalViewSpace(),r=10*window.devicePixelRatio,o=this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT*window.devicePixelRatio,i=this.physicalViewSize();e.clearRect(0,0,i.x,i.y),e.font=`${r}px/${o}px "Source Code Pro", Courier, monospace`,e.textBaseline="alphabetic";let s=xe(e,"M"+Zn+"M"),d=(a.inverseTransformVector(new u(s,0))||new u(0,0)).x,c=5*window.devicePixelRatio,h=new at,m=new at,g=new Be,C=new Be,b=new Be,_=new Be,l=(S,N=0)=>{let F=S.end-S.start,Z=this.props.renderInverted?this.configSpaceSize().y-1-N:N,L=new w(new u(S.start,Z),new u(F,1));if(!(F<d)&&!(L.left()>this.props.configSpaceViewportRect.right())&&!(L.right()<this.props.configSpaceViewportRect.left())){if(this.props.renderInverted){if(L.bottom()<this.props.configSpaceViewportRect.top())return}else if(L.top()>this.props.configSpaceViewportRect.bottom())return;if(L.hasIntersectionWith(this.props.configSpaceViewportRect)){let k=a.transformRect(L);if(k.left()<0&&(k=k.withOrigin(k.origin.withX(0)).withSize(k.size.withX(k.size.x+k.left()))),k.right()>i.x&&(k=k.withSize(k.size.withX(i.x-k.left()))),k.width()>s){let se=this.props.searchResults?.getMatchForFrame(S.node.frame),Se=Wo(e,S.node.frame.name,k.width()-2*c);if(se){let Si=Go(Se,se),_a=0,mn=k.left()+c,ca=(o-r)/2-2;for(let[ha,da]of Si){mn+=xe(e,Se.trimmedString.substring(_a,ha));let pa=xe(e,Se.trimmedString.substring(ha,da));g.rect({x:mn,y:k.top()+ca,w:pa,h:o-2*ca}),mn+=pa,_a=da}}(this.props.searchResults!=null&&!se?m:h).text({text:Se.trimmedString,x:k.left()+c,y:Math.round(k.bottom()-(o-r)/2)})}}for(let k of S.children)l(k,N+1)}},v=2*window.devicePixelRatio;e.strokeStyle=this.props.theme.selectionSecondaryColor;let f=(a.inverseTransformVector(new u(1,0))||new u(0,0)).x,j=(S,N=0)=>{if(!this.props.selectedNode&&this.props.searchResults==null)return;let F=S.end-S.start,Z=this.props.renderInverted?this.configSpaceSize().y-1-N:N,L=new w(new u(S.start,Z),new u(F,1));if(!(F<f)&&!(L.left()>this.props.configSpaceViewportRect.right())&&!(L.right()<this.props.configSpaceViewportRect.left())&&!(L.top()>this.props.configSpaceViewportRect.bottom())){if(L.hasIntersectionWith(this.props.configSpaceViewportRect)){if(this.props.searchResults?.getMatchForFrame(S.node.frame)){let k=a.transformRect(L);_.rect({x:Math.round(k.left()+v/2),y:Math.round(k.top()+v/2),w:Math.round(Math.max(0,k.width()-v)),h:Math.round(Math.max(0,k.height()-v))})}if(this.props.selectedNode!=null&&S.node.frame===this.props.selectedNode.frame){let k=S.node===this.props.selectedNode?C:b,se=a.transformRect(L);k.rect({x:Math.round(se.left()+1+v/2),y:Math.round(se.top()+1+v/2),w:Math.round(Math.max(0,se.width()-2-v)),h:Math.round(Math.max(0,se.height()-2-v))})}}for(let k of S.children)j(k,N+1)}};for(let S of this.props.flamechart.getLayers()[0]||[])j(S);for(let S of this.props.flamechart.getLayers()[0]||[])l(S);let x=this.props.theme;if(_.fill(e,x.searchMatchPrimaryColor),g.fill(e,x.searchMatchSecondaryColor),m.fill(e,x.fgSecondaryColor),h.fill(e,this.props.searchResults!=null?x.searchMatchTextColor:x.fgPrimaryColor),b.stroke(e,x.selectionSecondaryColor,v),C.stroke(e,x.selectionPrimaryColor,v),this.hoveredLabel){let S=x.fgPrimaryColor;this.props.selectedNode===this.hoveredLabel.node&&(S=x.selectionPrimaryColor),e.lineWidth=2*devicePixelRatio,e.strokeStyle=S;let N=a.transformRect(this.hoveredLabel.configSpaceBounds);e.strokeRect(Math.round(N.left()),Math.round(N.top()),Math.round(Math.max(0,N.width())),Math.round(Math.max(0,N.height())))}this.renderTimeIndicators()}renderTimeIndicators(){let e=this.overlayCtx;if(!e)return;let a=this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT*window.devicePixelRatio,r=this.physicalViewSize(),o=this.configSpaceToPhysicalViewSpace(),i=10*window.devicePixelRatio,s=(a-i)/2,d=this.props.configSpaceViewportRect.left(),c=this.props.configSpaceViewportRect.right(),m=(this.configSpaceToPhysicalViewSpace().inverted()||new T).times(this.logicalToPhysicalViewSpace()).transformVector(new u(200,1)).x,C=Math.pow(10,Math.floor(Math.log10(m)));m/C>5?C*=5:m/C>2&&(C*=2);let b=this.props.theme;{let _=this.props.renderInverted?r.y-a:0;e.fillStyle=V.fromCSSHex(b.bgPrimaryColor).withAlpha(.8).toCSS(),e.fillRect(0,_,r.x,a),e.textBaseline="top";for(let l=Math.ceil(d/C)*C;l<c;l+=C){let v=Math.round(o.transformPosition(new u(l,0)).x),f=this.props.flamechart.formatValue(l),j=xe(e,f);e.fillStyle=b.fgPrimaryColor,e.fillText(f,v-j-s,_+s),e.fillStyle=b.fgSecondaryColor,e.fillRect(v,0,1,r.y)}}}updateConfigSpaceViewport(){if(!this.container)return;let{logicalSpaceViewportSize:e}=this.props,a=this.container.getBoundingClientRect(),{width:r,height:o}=a;if(r<2||o<2)return;if(this.props.configSpaceViewportRect.isEmpty()){let s=o/this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT;this.props.renderInverted?this.setConfigSpaceViewportRect(new w(new u(0,this.configSpaceSize().y-s+1),new u(this.configSpaceSize().x,s))):this.setConfigSpaceViewportRect(new w(new u(0,-1),new u(this.configSpaceSize().x,s)))}else!e.equals(u.zero)&&(e.x!==r||e.y!==o)&&this.setConfigSpaceViewportRect(this.props.configSpaceViewportRect.withSize(this.props.configSpaceViewportRect.size.timesPointwise(new u(r/e.x,o/e.y))));let i=new u(r,o);i.equals(e)||this.props.setLogicalSpaceViewportSize(i)}renderRects(){this.container&&(this.updateConfigSpaceViewport(),!this.props.configSpaceViewportRect.isEmpty()&&this.props.canvasContext.renderBehind(this.container,()=>{this.props.flamechartRenderer.render({physicalSpaceDstRect:this.physicalBounds(),configSpaceSrcRect:this.props.configSpaceViewportRect,renderOutlines:!0})}))}pan(e){this.interactionLock="pan";let a=this.logicalToPhysicalViewSpace().transformVector(e),r=this.configSpaceToPhysicalViewSpace().inverseTransformVector(a);this.hoveredLabel&&this.props.onNodeHover(null),r&&this.props.transformViewport(T.withTranslation(r))}zoom(e,a){this.interactionLock="zoom";let r=this.logicalToPhysicalViewSpace().transformPosition(e),o=this.configSpaceToPhysicalViewSpace().inverseTransformPosition(r);if(!o)return;let i=T.withTranslation(o.times(-1)).scaledBy(new u(a,1)).translatedBy(o);this.props.transformViewport(i)}updateCursor(){this.lastDragPos?(document.body.style.cursor="grabbing",document.body.style.cursor="-webkit-grabbing"):document.body.style.cursor="default"}shouldComponentUpdate(){return!1}componentWillReceiveProps(e){this.props.flamechart!==e.flamechart?(this.hoveredLabel=null,this.renderCanvas()):this.props.searchResults!==e.searchResults?this.renderCanvas():this.props.selectedNode!==e.selectedNode?this.renderCanvas():this.props.configSpaceViewportRect!==e.configSpaceViewportRect?this.renderCanvas():this.props.canvasContext!==e.canvasContext&&(this.props.canvasContext&&this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame),e.canvasContext&&(e.canvasContext.addBeforeFrameHandler(this.onBeforeFrame),e.canvasContext.requestFrame()))}componentDidMount(){this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keydown",this.onWindowKeyPress)}componentWillUnmount(){this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keydown",this.onWindowKeyPress)}render(){let e=this.getStyle();return p("div",{className:y(e.panZoomView,U.vbox),onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onClick:this.onClick,onDblClick:this.onDblClick,onWheel:this.onWheel,ref:this.containerRef},p("canvas",{width:1,height:1,ref:this.overlayCanvasRef,className:y(e.fill)}))}};function hn(n){let t=p_(I()),{containerSize:e,offset:a}=n,r=e.x,o=e.y,i=7,s=E(d=>{if(!d)return;let c=d.getBoundingClientRect(),h=a.x+i;h+c.width>r-1&&(h=r-c.width-1,h<1&&(h=1)),d.style.left=`${h}px`;let m=a.y+i;m+c.height>o-1&&(m=a.y-c.height-1,m<1&&(m=1)),d.style.top=`${m}px`},[r,o,a.x,a.y]);return p("div",{className:y(t.hoverTip),ref:s},p("div",{className:y(t.hoverTipRow)},n.children))}var cn=2,p_=K(n=>M.create({hoverTip:{position:"absolute",background:n.bgPrimaryColor,border:"1px solid black",maxWidth:900,paddingTop:cn,paddingBottom:cn,pointerEvents:"none",userSelect:"none",fontSize:10,fontFamily:'"Source Code Pro", Courier, monospace',zIndex:2},hoverTipRow:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflowX:"hidden",paddingLeft:cn,paddingRight:cn,maxWidth:900}}));var Yo=ce(null),Qn=({flamechart:n,selectedNode:t,setSelectedNode:e,configSpaceViewportRect:a,setConfigSpaceViewportRect:r,children:o})=>{let i=oe(Le),s=P(()=>i==null?null:new en(n,i),[n,i]);return p(Yo.Provider,{value:{results:s,flamechart:n,selectedNode:t,setSelectedNode:e,configSpaceViewportRect:a,setConfigSpaceViewportRect:r}},o)},Zo=O(()=>{let n=oe(Yo),t=n==null?null:n.results,e=n==null?null:n.selectedNode,a=n==null?null:n.setSelectedNode,r=n==null?null:n.configSpaceViewportRect,o=n==null?null:n.setConfigSpaceViewportRect,i=n==null?null:n.flamechart,s=t==null?null:t.count(),d=P(()=>t==null||e==null?null:t.indexOf(e),[t,e]),c=E(g=>{if(!a||!i||!r||!o)return;let C=g.configSpaceBounds,b=new w(C.origin.minus(new u(0,1)),C.size.withY(r.height()));a(g.node),o(i.getClampedConfigSpaceViewportRect({configSpaceViewportRect:b}))},[r,o,a,i]),{selectPrev:h,selectNext:m}=P(()=>s==null||s===0||t==null?{selectPrev:()=>{},selectNext:()=>{}}:{selectPrev:()=>{if(!t?.at||s==null||s===0)return;let g=d==null?s-1:d-1;g<0&&(g=s-1);let C=t.at(g);c(C)},selectNext:()=>{if(!t?.at||s==null||s===0)return;let g=d==null?0:d+1;g>=s&&(g=0);let C=t.at(g);c(C)}},[s,d,t,c]);return p(tn,{resultIndex:d,numResults:s,selectPrev:h,selectNext:m})});var le=class extends W{};var rt=class extends le{constructor(){super(...arguments);this.setConfigSpaceViewportRect=e=>{let a=150/20,r=this.configSpaceSize(),o=this.props.flamechart.getClampedViewportWidth(e.size.x),i=e.size.withX(o),s=u.clamp(e.origin,new u(0,-1),u.max(u.zero,r.minus(i).plus(new u(0,a+1))));this.props.setConfigSpaceViewportRect(new w(s,e.size.withX(o)))};this.setLogicalSpaceViewportSize=e=>{this.props.setLogicalSpaceViewportSize(e)};this.transformViewport=e=>{let a=e.transformRect(this.props.configSpaceViewportRect);this.setConfigSpaceViewportRect(a)};this.onNodeHover=e=>{this.props.setNodeHover(e)};this.onNodeClick=e=>{this.props.setSelectedNode(e)};this.container=null;this.containerRef=e=>{this.container=e||null}}getStyle(){return ve(this.props.theme)}configSpaceSize(){return new u(this.props.flamechart.getTotalWeight(),this.props.flamechart.getLayers().length)}formatValue(e){let a=this.props.flamechart.getTotalWeight(),r=100*e/a,o=_e(r);return`${this.props.flamechart.formatValue(e)} (${o})`}renderTooltip(){if(!this.container)return null;let{hover:e}=this.props;if(!e)return null;let{width:a,height:r,left:o,top:i}=this.container.getBoundingClientRect(),s=new u(e.event.clientX-o,e.event.clientY-i),d=e.node.frame,c=this.getStyle();return p(hn,{containerSize:new u(a,r),offset:s},p("span",{className:y(c.hoverCount)},this.formatValue(e.node.getTotalWeight()))," ",d.name,d.file?p("div",null,d.file,":",d.line):void 0)}render(){let e=this.getStyle();return p("div",{className:y(e.fill,U.vbox),ref:this.containerRef},p(ln,{theme:this.props.theme,configSpaceViewportRect:this.props.configSpaceViewportRect,transformViewport:this.transformViewport,flamechart:this.props.flamechart,flamechartRenderer:this.props.flamechartRenderer,canvasContext:this.props.canvasContext,setConfigSpaceViewportRect:this.setConfigSpaceViewportRect}),p(Le.Consumer,null,a=>p(ae,null,p(Oe,{theme:this.props.theme,canvasContext:this.props.canvasContext,flamechart:this.props.flamechart,flamechartRenderer:this.props.flamechartRenderer,renderInverted:!1,onNodeHover:this.onNodeHover,onNodeSelect:this.onNodeClick,selectedNode:this.props.selectedNode,transformViewport:this.transformViewport,configSpaceViewportRect:this.props.configSpaceViewportRect,setConfigSpaceViewportRect:this.setConfigSpaceViewportRect,logicalSpaceViewportSize:this.props.logicalSpaceViewportSize,setLogicalSpaceViewportSize:this.setLogicalSpaceViewportSize,searchResults:a}),p(Zo,null))),this.renderTooltip(),this.props.selectedNode&&p(Xo,{flamechart:this.props.flamechart,getCSSColorForFrame:this.props.getCSSColorForFrame,selectedNode:this.props.selectedNode}))}};function Ke(n){return{setNodeHover:E(t=>{X.setFlamechartHoveredNode(n,t)},[n]),setLogicalSpaceViewportSize:E(t=>{X.setLogicalSpaceViewportSize(n,t)},[n]),setConfigSpaceViewportRect:E(t=>{X.setConfigSpaceViewportRect(n,t)},[n]),setSelectedNode:E(t=>{X.setSelectedNode(n,t)},[n])}}var v_=ee(({profile:n,getColorBucketForFrame:t})=>new be({getTotalWeight:n.getTotalWeight.bind(n),forEachCall:n.forEachCall.bind(n),formatValue:n.formatValue.bind(n),getColorBucketForFrame:t})),Ue=n=>ee(({canvasContext:t,flamechart:e})=>new rn(t.gl,Ea(t),e,t.rectangleBatchRenderer,t.flamechartColorPassRenderer,n)),m_=Ue(),ei=O(n=>{let{activeProfileState:t,glCanvas:e}=n,{profile:a,chronoViewState:r}=t,o=I(),i=fe({theme:o,canvas:e}),s=ye(a),d=we(s),c=ue({theme:o,frameToColorBucket:s}),h=v_({profile:a,getColorBucketForFrame:d}),m=m_({canvasContext:i,flamechart:h}),g=Ke("CHRONO");return p(Qn,{flamechart:h,selectedNode:r.selectedNode,setSelectedNode:g.setSelectedNode,configSpaceViewportRect:r.configSpaceViewportRect,setConfigSpaceViewportRect:g.setConfigSpaceViewportRect},p(rt,{theme:o,renderInverted:!1,flamechart:h,flamechartRenderer:m,canvasContext:i,getCSSColorForFrame:c,...r,...g}))}),u_=ee(({profile:n,getColorBucketForFrame:t})=>new be({getTotalWeight:n.getTotalNonIdleWeight.bind(n),forEachCall:n.forEachCallGrouped.bind(n),formatValue:n.formatValue.bind(n),getColorBucketForFrame:t})),f_=Ue(),ti=O(n=>{let{activeProfileState:t,glCanvas:e}=n,{profile:a,leftHeavyViewState:r}=t,o=I(),i=fe({theme:o,canvas:e}),s=ye(a),d=we(s),c=ue({theme:o,frameToColorBucket:s}),h=u_({profile:a,getColorBucketForFrame:d}),m=f_({canvasContext:i,flamechart:h}),g=Ke("LEFT_HEAVY");return p(Qn,{flamechart:h,selectedNode:r.selectedNode,setSelectedNode:g.setSelectedNode,configSpaceViewportRect:r.configSpaceViewportRect,setConfigSpaceViewportRect:g.setConfigSpaceViewportRect},p(rt,{theme:o,renderInverted:!1,flamechart:h,flamechartRenderer:m,canvasContext:i,getCSSColorForFrame:c,...r,...g}))});function ai(n,t){return C_(n,t)}var ea=97,ri=122,oi=65,y_=90,g_=48,j_=57;function ni(n){let t=n.charCodeAt(0);return ea<=t&&t<=ri?1:oi<=t&&t<=y_?2:g_<=t&&t<=j_?3:0}function ta(n,t){if(n===t)return!0;let e=t.charCodeAt(0);return ea<=e&&e<=ri?n.charCodeAt(0)===e-ea+oi:!1}function C_(n,t){if(t.length==0)return{matchedRanges:[],score:0};let e=0,a=-1,r=-1,o=n.length,i=t.length;for(let s=0;s<o;s++){let d=n[s],c=t[e];if(ta(d,c)&&(a<0&&(a=s),e++,e==i)){r=s+1;break}}if(r==-1)return null;e--;for(let s=r-1;s>=a;s--){let d=n[s],c=t[e];if(ta(d,c)&&(e--,e<0))return a=s,k_(n,t,a,r)}throw new Error("Implementation error. This must be a bug in fzfFuzzyMatchV1")}var na=16,ii=-3,aa=-1,ra=na/2,b_=na/2,x_=ra+aa,S_=-(ii+aa),w_=2;function R_(n,t){return n===0&&t!==0?ra:n===1&&t==2||n!==3&&t==3?x_:t===0?b_:0}function k_(n,t,e,a){let r=0,o=0,i=!1,s=0,d=0,c=new Array(t.length),h=0;e>0&&(h=ni(n[e-1]));for(let g=e;g<a;g++){let C=n[g],b=ni(C);if(ta(C,t[r])){c[r]=g,o+=na;let _=R_(h,b);s==0?d=_:(_===ra&&(d=_),_=Math.max(_,d,S_)),r===0?o+=_*w_:o+=_,i=!1,s++,r++}else i?o+=aa:o+=ii,i=!0,s=0,d=0;h=b}if(r!==t.length)throw new Error("fzfCalculateScore should only be called when pattern is found between sidx and eidx");let m=[[c[0],c[0]+1]];for(let g=1;g<c.length;g++){let C=c[g],b=m[m.length-1];b[1]===C?b[1]=C+1:m.push([C,C+1])}return{score:o,matchedRanges:m}}function N_(n,t,e){let a=[],r=0;for(let o of t)a.push(n.slice(r,o[0])),a.push(p("span",{className:e},n.slice(o[0],o[1]))),r=o[1];return a.push(n.slice(r)),p("span",null,a)}function A_({setProfileIndexToView:n,setHoveredProfileIndex:t,profile:e,selected:a,hovered:r,profileCount:o,nodeRef:i,closeProfileSelect:s,indexInProfileGroup:d,matchedRanges:c,indexInFilteredListView:h}){let m=ci(I()),g=E(()=>{s(),n(d)},[s,n,d]),C=E(f=>{t(d)},[t,d]),b=e.getName(),_=1+Math.floor(Math.log10(o)),l=y(m.highlighted),v=P(()=>N_(b,c,l),[b,c,l]);return p("div",{ref:i,onMouseUp:g,onMouseEnter:C,title:b,className:y(m.profileRow,h%2===0&&m.profileRowEven,a&&m.profileRowSelected,r&&m.profileRowHovered)},p("span",{className:y(m.profileIndex,a&&m.profileIndexSelected),style:{width:_+"em"}},d+1,":")," ",v)}function li(n){n.stopPropagation()}function E_(n,t){let e=[];for(let a=0;a<n.length;a++){let r=n[a],o=ai(r.getName(),t);o&&e.push({indexInProfileGroup:a,profile:r,...o})}return Ie(e,a=>-a.score),e}function _i({profiles:n,closeProfileSelect:t,indexToView:e,visible:a,setProfileIndexToView:r}){let o=ci(I()),[i,s]=te(""),d=E(j=>{let x=j.target.value;s(x)},[s]),c=E(j=>{j&&(a?j.select():j.blur())},[a]),h=P(()=>E_(n,i),[n,i]),[m,g]=te(0),C=Re(null);ne(()=>{a&&(g(null),C.current!==null&&C.current.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"}))},[a]);let b=E(j=>{j.stopPropagation();let x=null;switch(j.key){case"Enter":{m!=null&&(t(),r(m));break}case"Escape":{t();break}case"ArrowDown":{if(j.preventDefault(),x=0,m!=null){let S=h.findIndex(N=>N.indexInProfileGroup===m);S!==-1&&(x=S+1)}break}case"ArrowUp":{if(j.preventDefault(),x=h.length-1,m!=null){let S=h.findIndex(N=>N.indexInProfileGroup===m);S!==-1&&(x=S-1)}break}}if(x!=null&&x>=0&&x<h.length){let S=h[x].indexInProfileGroup;g(S),l(!0)}},[t,r,m,h]),[_,l]=te(!1);ne(()=>{h.length>0&&(g(h[0].indexInProfileGroup),l(!0))},[g,h]);let v=E(j=>{_&&j&&(j.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"}),l(!1))},[_,l]),f=E(j=>{C.current=j,v(j)},[C,v]);return p("div",{className:y(o.profileSelectOuter)},p("div",{className:y(o.caret)}),p("div",{className:y(o.profileSelectBox)},p("div",{className:y(o.filterInputContainer)},p("input",{type:"text",className:y(o.filterInput),ref:c,placeholder:"Filter...",value:i,onInput:d,onKeyDown:b,onKeyUp:li,onKeyPress:li})),p("div",{className:y(o.profileSelectScrolling)},h.map(({profile:j,matchedRanges:x,indexInProfileGroup:S},N)=>{let F,Z=S===e,L=S===m;return Z&&L?F=f:Z?F=C:L&&(F=v),p(A_,{setHoveredProfileIndex:g,indexInProfileGroup:S,indexInFilteredListView:N,hovered:S==m,selected:S===e,profile:j,profileCount:n.length,nodeRef:F,matchedRanges:x,setProfileIndexToView:r,closeProfileSelect:t})}),h.length===0?p("div",{className:y(o.profileRow)},'No results match filter "',i,'"'):null)))}var si=10,ci=K(n=>M.create({filterInputContainer:{display:"flex",flexDirection:"column",padding:5,alignItems:"stretch"},filterInput:{color:n.altFgPrimaryColor,background:n.altBgSecondaryColor,borderRadius:5,padding:5,":focus":{border:"none",outline:"none"},"::selection":{color:n.altFgPrimaryColor,background:n.selectionPrimaryColor}},caret:{width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottom:"5px solid black"},highlighted:{background:n.selectionSecondaryColor},padding:{height:si,background:n.altBgPrimaryColor},profileRow:{height:18,border:"1px solid transparent",textAlign:"left",paddingLeft:10,paddingRight:10,background:n.altBgPrimaryColor,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",cursor:"pointer"},profileRowHovered:{border:`1px solid ${n.selectionPrimaryColor}`},profileRowSelected:{background:n.selectionPrimaryColor},profileRowEven:{background:n.altBgSecondaryColor},profileSelectScrolling:{maxHeight:`min(calc(100vh - ${20-2*si}px), ${20*20}px)`,overflow:"auto","::-webkit-scrollbar":{background:n.altBgPrimaryColor},"::-webkit-scrollbar-thumb":{background:n.altFgSecondaryColor,borderRadius:20,border:`3px solid ${n.altBgPrimaryColor}`,":hover":{background:n.altBgPrimaryColor}}},profileSelectBox:{width:"100%",paddingBottom:10,background:n.altBgPrimaryColor,color:n.altFgPrimaryColor},profileSelectOuter:{width:"100%",maxWidth:480,margin:"0 auto",position:"relative",zIndex:1,alignItems:"center",display:"flex",flexDirection:"column"},profileIndex:{textAlign:"right",display:"inline-block",color:n.altFgSecondaryColor},profileIndexSelected:{color:n.altFgPrimaryColor}}));function oa(n,t){return E(()=>n(t),[n,t])}function H_(n){let t=dn(I()),e=oa(ke.set,0),a=oa(ke.set,1),r=oa(ke.set,2);return n.activeProfileState?p("div",{className:y(t.toolbarLeft)},p("div",{className:y(t.toolbarTab,n.viewMode===0&&t.toolbarTabActive),onClick:e},p("span",{className:y(t.emoji)},"\u{1F570}"),"Time Order"),p("div",{className:y(t.toolbarTab,n.viewMode===1&&t.toolbarTabActive),onClick:a},p("span",{className:y(t.emoji)},"\u2B05\uFE0F"),"Left Heavy"),p("div",{className:y(t.toolbarTab,n.viewMode===2&&t.toolbarTabActive),onClick:r},p("span",{className:y(t.emoji)},"\u{1F96A}"),"Sandwich")):null}var L_=(()=>{let n=null;return t=>{let e=t?.profiles.map(a=>a.profile)||null;return(n===null||e!=null&&!lt(n,e))&&(n=e),n}})();function B_(n){let t=dn(I()),{activeProfileState:e,profileGroup:a}=n,r=L_(a),[o,i]=te(!1),s=E(()=>{i(!0)},[i]),d=E(()=>{i(!1)},[i]);return ne(()=>{let c=h=>{h.key==="t"&&(h.preventDefault(),i(!0))};return window.addEventListener("keypress",c),()=>{window.removeEventListener("keypress",c)}},[i]),ne(()=>{let c=h=>{h.key==="t"&&(h.preventDefault(),i(!0))};return window.addEventListener("keypress",c),()=>{window.removeEventListener("keypress",c)}},[i]),e&&a&&r?a.profiles.length===1?p(ae,null,e.profile.getName()):p("div",{className:y(t.toolbarCenter),onMouseLeave:d},p("span",{onMouseOver:s},e.profile.getName()," ",p("span",{className:y(t.toolbarProfileIndex)},"(",e.index+1,"/",a.profiles.length,")")),p("div",{style:{display:o?"block":"none"}},p(_i,{setProfileIndexToView:n.setProfileIndexToView,indexToView:a.indexToView,profiles:r,closeProfileSelect:d,visible:o}))):p(ae,null,"\u{1F52C}speedscope")}function I_(n){let t=dn(I()),e=z(Te),a=p("div",{className:y(t.toolbarTab),onClick:n.saveFile},p("span",{className:y(t.emoji)},"\u2934\uFE0F"),"Export"),r=p("div",{className:y(t.toolbarTab),onClick:n.browseForFile},p("span",{className:y(t.emoji)},"\u2935\uFE0F"),"Import"),o=p("div",{className:y(t.toolbarTab),onClick:Te.cycleToNextColorScheme},p("span",{className:y(t.emoji)},"\u{1F3A8}"),p("span",{className:y(t.toolbarTabColorSchemeToggle)},_r(e))),i=p("div",{className:y(t.toolbarTab)},p("a",{href:"https://github.com/jlfwong/speedscope#usage",className:y(t.noLinkStyle),target:"_blank"},p("span",{className:y(t.emoji)},"\u2753"),"Help"));return p("div",{className:y(t.toolbarRight)},n.activeProfileState&&a,r,o,i)}function hi(n){let t=dn(I());return p("div",{className:y(t.toolbar)},p(H_,{...n}),p(B_,{...n}),p(I_,{...n}))}var dn=K(n=>M.create({toolbar:{height:20,flexShrink:0,background:n.altBgPrimaryColor,color:n.altFgPrimaryColor,textAlign:"center",fontFamily:'"Source Code Pro", Courier, monospace',fontSize:12,lineHeight:"18px",userSelect:"none"},toolbarLeft:{position:"absolute",height:20,overflow:"hidden",top:0,left:0,marginRight:2,textAlign:"left"},toolbarCenter:{paddingTop:1,height:20},toolbarRight:{height:20,overflow:"hidden",position:"absolute",top:0,right:0,marginRight:2,textAlign:"right"},toolbarProfileIndex:{color:n.altFgSecondaryColor},toolbarTab:{background:n.altBgSecondaryColor,marginTop:2,height:18,lineHeight:"18px",paddingLeft:2,paddingRight:8,display:"inline-block",marginLeft:2,transition:"all 0.07s ease-in",":hover":{background:n.selectionSecondaryColor}},toolbarTabActive:{background:n.selectionPrimaryColor,":hover":{background:n.selectionPrimaryColor}},toolbarTabColorSchemeToggle:{display:"inline-block",textAlign:"center",minWidth:"50px"},emoji:{display:"inline-block",verticalAlign:"middle",paddingTop:"0px",marginRight:"0.3em"},noLinkStyle:{textDecoration:"none",color:"inherit"}}));var z_=import("./source-map-5DQ363YZ.js"),F_=!1;async function di(n,t){let e=await z_,a=null,r=null;try{r=JSON.parse(n),a=new e.SourceMapConsumer(r)}catch{return null}let o=[];a.eachMapping(function(s){o.push({...s,generatedColumn:s.generatedColumn+1,originalColumn:s.originalColumn+1})},{},e.SourceMapConsumer.GENERATED_ORDER);let i=t.replace(/\.[^/]*$/,"");return s=>{let d=!1;if((r?.file&&r?.file===s.file||("/"+s.file?.replace(/\.[^/]*$/,"")).endsWith("/"+i))&&(d=!0),!d||s.line==null||s.col==null)return null;let c=fa(o,g=>g.generatedLine>s.line?!0:g.generatedLine<s.line?!1:g.generatedColumn>=s.col);if(c===-1)c=o.length-1;else{if(c===0)return null;c--}let h=o[c],m={};if(h.name!=null)m.name=h.name;else if(h.source!=null){let g=a?.sourceContentFor(h.source,!0);if(g){let b=g.split(`
`)[h.originalLine-1];if(b){let _=/\w+/.exec(b.substr(h.originalColumn-1));_&&(m.name=_[0])}}}switch(m.name){case"constructor":{m.name=s.name+" constructor";break}case"function":{m.name=s.name;break}case"const":case"export":{m.name=s.name;break}}return m.name&&s.name.includes(m.name)&&(m.name=s.name),h.source!=null&&(m.file=h.source,m.line=h.originalLine,m.col=h.originalColumn),F_&&(console.groupCollapsed(`Remapping "${s.name}" -> "${m.name}"`),console.log("before",{...s}),console.log("item @ index",h),console.log("item @ index + 1",o[c+1]),console.log("after",m),console.groupEnd()),m}}var pi=({items:n,axis:t,renderItems:e,className:a,initialIndexInView:r})=>{let[o,i]=te(null),[s,d]=te(0),c=Re(null),h=t==="x"?"width":"height",m=t==="x"?"left":"top",g=t==="x"?"scrollLeft":"scrollTop",C=r?n.reduce((S,N,F)=>F<r?S+N.size:S,0):0,b=Re(C),_=E(S=>{S?requestAnimationFrame(()=>{i(S.getBoundingClientRect()[h]),b.current!=null&&(S.scrollTo({[m]:b.current}),b.current=null)}):i(null),c.current=S},[i,h,m]),l=P(()=>{if(c.current==null||o==null||s==null)return null;let S=s-o/4,N=s+o+o/4,F=0,Z=0,L=0;for(;L<n.length;L++){let Se=n[L];if(Z=F,F+=Se.size,F>=S)break}let k=L;for(;L<n.length;L++){let Se=n[L];if(F+=Se.size,F>=N)break}let se=Math.min(L,n.length-1);return{firstVisibleIndex:k,lastVisibleIndex:se,invisiblePrefixSize:Z}},[o,s,n]),v=P(()=>n.reduce((S,N)=>S+N.size,0),[n]),f=E(()=>{c.current!=null&&d(c.current[g])},[g]);ne(()=>{let S=()=>{c.current!=null&&i(c.current.getBoundingClientRect()[h])};return window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}},[h]);let j=P(()=>l?e(l.firstVisibleIndex,l.lastVisibleIndex):null,[e,l]),x=P(()=>p("div",{style:{height:v}},p("div",{style:{transform:`translateY(${l?.invisiblePrefixSize||0}px)`}},j)),[l,j,v]);return p("div",{className:a,ref:_,onScroll:f},x)};function vi(n){let t=pn(I());return p("div",{className:y(t.hBarDisplay)},p("div",{className:y(t.hBarDisplayFilled),style:{width:`${n.perc}%`}}))}function ia(n){let t=I(),e=pn(t),{activeDirection:a}=n,r=a===0?t.fgPrimaryColor:t.fgSecondaryColor,o=a===1?t.fgPrimaryColor:t.fgSecondaryColor;return p("svg",{width:"8",height:"10",viewBox:"0 0 8 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:y(e.sortIcon)},p("path",{d:"M0 4L4 0L8 4H0Z",fill:r}),p("path",{d:"M0 4L4 0L8 4H0Z",transform:"translate(0 10) scale(1 -1)",fill:o}))}function J_(n,t,e){let a=[],r=0;for(let o of t)a.push(n.slice(r,o[0])),a.push(p("span",{className:e},n.slice(o[0],o[1]))),r=o[1];return a.push(n.slice(r)),p("span",null,a)}var M_=({frame:n,matchedRanges:t,profile:e,index:a,selectedFrame:r,setSelectedFrame:o,getCSSColorForFrame:i})=>{let s=pn(I()),d=n.getTotalWeight(),c=n.getSelfWeight(),h=100*d/e.getTotalNonIdleWeight(),m=100*c/e.getTotalNonIdleWeight(),g=n===r;return p("tr",{key:`${a}`,onClick:o.bind(null,n),className:y(s.tableRow,a%2==0&&s.tableRowEven,g&&s.tableRowSelected)},p("td",{className:y(s.numericCell)},e.formatValue(d)," (",_e(h),")",p(vi,{perc:h})),p("td",{className:y(s.numericCell)},e.formatValue(c)," (",_e(m),")",p(vi,{perc:m})),p("td",{title:n.file,className:y(s.textCell)},p(_n,{color:i(n)}),t?J_(n.name,t,y(s.matched,g&&s.matchedSelected)):n.name))},V_=O(({profile:n,sortMethod:t,setSortMethod:e,selectedFrame:a,setSelectedFrame:r,getCSSColorForFrame:o,searchQuery:i,searchIsActive:s})=>{let d=pn(I()),c=E((l,v)=>{if(v.preventDefault(),t.field==l)e({field:l,direction:t.direction===0?1:0});else switch(l){case 0:{e({field:l,direction:0});break}case 1:{e({field:l,direction:1});break}case 2:{e({field:l,direction:1});break}}},[t,e]),h=oe(ot),m=E((l,v)=>{if(!h)return null;let f=[];for(let j=l;j<=v;j++){let x=h.rowList[j],S=h.getSearchMatchForFrame(x);f.push(M_({frame:x,matchedRanges:S??null,index:j,profile:n,selectedFrame:a,setSelectedFrame:r,getCSSColorForFrame:o}))}return f.length===0&&(s?f.push(p("tr",null,p("td",{className:y(d.emptyState)},'No symbol names match query "',i,'".'))):f.push(p("tr",null,p("td",{className:y(d.emptyState)},"No symbols found.")))),p("table",{className:y(d.tableView)},f)},[h,n,a,r,o,s,i,d.emptyState,d.tableView]),g=P(()=>h==null?[]:h.rowList.map(l=>({size:20})),[h]),C=E(l=>c(2,l),[c]),b=E(l=>c(1,l),[c]),_=E(l=>c(0,l),[c]);return p("div",{className:y(U.vbox,d.profileTableView)},p("table",{className:y(d.tableView)},p("thead",{className:y(d.tableHeader)},p("tr",null,p("th",{className:y(d.numericCell),onClick:C},p(ia,{activeDirection:t.field===2?t.direction:null}),"Total"),p("th",{className:y(d.numericCell),onClick:b},p(ia,{activeDirection:t.field===1?t.direction:null}),"Self"),p("th",{className:y(d.textCell),onClick:_},p(ia,{activeDirection:t.field===0?t.direction:null}),"Symbol Name")))),p(pi,{axis:"y",items:g,className:y(d.scrollView),renderItems:m,initialIndexInView:a==null?null:h?.getIndexForFrame(a)}))}),pn=K(n=>M.create({profileTableView:{background:n.bgPrimaryColor,height:"100%"},scrollView:{overflowY:"auto",overflowX:"hidden",flexGrow:1,"::-webkit-scrollbar":{background:n.bgPrimaryColor},"::-webkit-scrollbar-thumb":{background:n.fgSecondaryColor,borderRadius:20,border:`3px solid ${n.bgPrimaryColor}`,":hover":{background:n.fgPrimaryColor}}},tableView:{width:"100%",fontSize:10,background:n.bgPrimaryColor},tableHeader:{borderBottom:`2px solid ${n.bgSecondaryColor}`,textAlign:"left",color:n.fgPrimaryColor,userSelect:"none"},sortIcon:{position:"relative",top:1,marginRight:20/4},tableRow:{background:n.bgPrimaryColor,height:20},tableRowEven:{background:n.bgSecondaryColor},tableRowSelected:{background:n.selectionPrimaryColor,color:n.altFgPrimaryColor},numericCell:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",position:"relative",textAlign:"right",paddingRight:20,width:6*20,minWidth:6*20},textCell:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",width:"100%",maxWidth:0},hBarDisplay:{position:"absolute",background:V.fromCSSHex(n.weightColor).withAlpha(.2).toCSS(),bottom:2,height:2,width:`calc(100% - ${2*20}px)`,right:20},hBarDisplayFilled:{height:"100%",position:"absolute",background:n.weightColor,right:0},matched:{borderBottom:`2px solid ${n.fgPrimaryColor}`},matchedSelected:{borderColor:n.altFgPrimaryColor},emptyState:{textAlign:"center",fontWeight:"bold"}})),mi=O(n=>{let{activeProfileState:t}=n,{profile:e,sandwichViewState:a}=t;if(!e)throw new Error("profile missing");let r=z(Qe),o=I(),{callerCallee:i}=a,s=i?i.selectedFrame:null,d=ye(e),c=ue({theme:o,frameToColorBucket:d}),h=E(C=>{X.setSelectedFrame(C)},[]),m=z(De),g=z(Je);return p(V_,{profile:e,selectedFrame:s,getCSSColorForFrame:c,sortMethod:r,setSelectedFrame:h,setSortMethod:Qe.set,searchIsActive:m,searchQuery:g})});var $e=class extends le{constructor(){super(...arguments);this.setConfigSpaceViewportRect=e=>{this.props.setConfigSpaceViewportRect(this.clampViewportToFlamegraph(e))};this.setLogicalSpaceViewportSize=e=>{this.props.setLogicalSpaceViewportSize(e)};this.transformViewport=e=>{this.setConfigSpaceViewportRect(e.transformRect(this.props.configSpaceViewportRect))};this.container=null;this.containerRef=e=>{this.container=e||null};this.setNodeHover=e=>{this.props.setNodeHover(e)}}clampViewportToFlamegraph(e){let{flamechart:a,renderInverted:r}=this.props;return a.getClampedConfigSpaceViewportRect({configSpaceViewportRect:e,renderInverted:r})}formatValue(e){let a=this.props.flamechart.getTotalWeight(),r=100*e/a,o=_e(r);return`${this.props.flamechart.formatValue(e)} (${o})`}renderTooltip(){if(!this.container)return null;let{hover:e}=this.props;if(!e)return null;let{width:a,height:r,left:o,top:i}=this.container.getBoundingClientRect(),s=new u(e.event.clientX-o,e.event.clientY-i),d=O_(this.props.theme),c=e.node.frame;return p(hn,{containerSize:new u(a,r),offset:s},p("span",{className:y(d.hoverCount)},this.formatValue(e.node.getTotalWeight()))," ",c.name,c.file?p("div",null,c.file,":",c.line):void 0)}render(){return p("div",{className:y(U.fillY,U.fillX,U.vbox),ref:this.containerRef},p(Oe,{theme:this.props.theme,selectedNode:null,onNodeHover:this.setNodeHover,onNodeSelect:ze,configSpaceViewportRect:this.props.configSpaceViewportRect,setConfigSpaceViewportRect:this.setConfigSpaceViewportRect,transformViewport:this.transformViewport,flamechart:this.props.flamechart,flamechartRenderer:this.props.flamechartRenderer,canvasContext:this.props.canvasContext,renderInverted:this.props.renderInverted,logicalSpaceViewportSize:this.props.logicalSpaceViewportSize,setLogicalSpaceViewportSize:this.setLogicalSpaceViewportSize,searchResults:null}),this.renderTooltip())}},O_=K(n=>M.create({hoverCount:{color:n.weightColor}}));var K_=ee(({profile:n,frame:t,flattenRecursion:e})=>{let a=n.getInvertedProfileForCallersOf(t);return e?a.getProfileWithRecursionFlattened():a}),U_=ee(({invertedCallerProfile:n,getColorBucketForFrame:t})=>new be({getTotalWeight:n.getTotalNonIdleWeight.bind(n),forEachCall:n.forEachCallGrouped.bind(n),formatValue:n.formatValue.bind(n),getColorBucketForFrame:t})),$_=Ue({inverted:!0}),ui=O(n=>{let{activeProfileState:t}=n,{profile:e,sandwichViewState:a}=t,r=z(ge),o=z(Ee),i=I();if(!e)throw new Error("profile missing");if(!o)throw new Error("glCanvas missing");let{callerCallee:s}=a;if(!s)throw new Error("callerCallee missing");let{selectedFrame:d}=s,c=ye(e),h=we(c),m=ue({theme:i,frameToColorBucket:c}),g=fe({theme:i,canvas:o}),C=U_({invertedCallerProfile:K_({profile:e,frame:d,flattenRecursion:r}),getColorBucketForFrame:h}),b=$_({canvasContext:g,flamechart:C});return p($e,{theme:i,renderInverted:!0,flamechart:C,flamechartRenderer:b,canvasContext:g,getCSSColorForFrame:m,...Ke("SANDWICH_INVERTED_CALLERS"),...s.invertedCallerFlamegraph,setSelectedNode:ze})});var W_=ee(({profile:n,frame:t,flattenRecursion:e})=>{let a=n.getProfileForCalleesOf(t);return e?a.getProfileWithRecursionFlattened():a}),G_=ee(({calleeProfile:n,getColorBucketForFrame:t})=>new be({getTotalWeight:n.getTotalNonIdleWeight.bind(n),forEachCall:n.forEachCallGrouped.bind(n),formatValue:n.formatValue.bind(n),getColorBucketForFrame:t})),q_=Ue(),fi=O(n=>{let{activeProfileState:t}=n,{profile:e,sandwichViewState:a}=t,r=z(ge),o=z(Ee),i=I();if(!e)throw new Error("profile missing");if(!o)throw new Error("glCanvas missing");let{callerCallee:s}=a;if(!s)throw new Error("callerCallee missing");let{selectedFrame:d}=s,c=ye(e),h=we(c),m=ue({theme:i,frameToColorBucket:c}),g=fe({theme:i,canvas:o}),C=G_({calleeProfile:W_({profile:e,frame:d,flattenRecursion:r}),getColorBucketForFrame:h}),b=q_({canvasContext:g,flamechart:C});return p($e,{theme:i,renderInverted:!1,flamechart:C,flamechartRenderer:b,canvasContext:g,getCSSColorForFrame:m,...Ke("SANDWICH_CALLEES"),...s.calleeFlamegraph,setSelectedNode:ze})});var yi=O(()=>{let n=oe(ot),t=n!=null?n.rowList:null,e=n?.selectedFrame!=null?n.getIndexForFrame(n.selectedFrame):null,a=t!=null?t.length:null,{selectPrev:r,selectNext:o}=P(()=>t==null||a==null||a===0||n==null?{selectPrev:()=>{},selectNext:()=>{}}:{selectPrev:()=>{let i=e==null?a-1:e-1;i<0&&(i=a-1),n.setSelectedFrame(t[i])},selectNext:()=>{let i=e==null?0:e+1;i>=a&&(i=0),n.setSelectedFrame(t[i])}},[e,t,a,n]);return p(tn,{resultIndex:e,numResults:a,selectPrev:r,selectNext:o})});var la=class extends le{constructor(){super(...arguments);this.setSelectedFrame=e=>{this.props.setSelectedFrame(e)};this.onWindowKeyPress=e=>{e.key==="Escape"&&this.setSelectedFrame(null)}}componentDidMount(){window.addEventListener("keydown",this.onWindowKeyPress)}componentWillUnmount(){window.removeEventListener("keydown",this.onWindowKeyPress)}render(){let e=X_(this.props.theme),{selectedFrame:a}=this.props,r=null;return a&&(r=p("div",{className:y(U.fillY,e.callersAndCallees,U.vbox)},p("div",{className:y(U.hbox,e.panZoomViewWraper)},p("div",{className:y(e.flamechartLabelParent)},p("div",{className:y(e.flamechartLabel)},"Callers")),p(ui,{glCanvas:this.props.glCanvas,activeProfileState:this.props.activeProfileState})),p("div",{className:y(e.divider)}),p("div",{className:y(U.hbox,e.panZoomViewWraper)},p("div",{className:y(e.flamechartLabelParent,e.flamechartLabelParentBottom)},p("div",{className:y(e.flamechartLabel,e.flamechartLabelBottom)},"Callees")),p(fi,{glCanvas:this.props.glCanvas,activeProfileState:this.props.activeProfileState})))),p("div",{className:y(U.hbox,U.fillY)},p("div",{className:y(e.tableView)},p(mi,{activeProfileState:this.props.activeProfileState}),p(yi,null)),r)}},X_=K(n=>M.create({tableView:{position:"relative",flex:1},panZoomViewWraper:{flex:1},flamechartLabelParent:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",fontSize:12,width:12*1.2,borderRight:`1px solid ${n.fgSecondaryColor}`},flamechartLabelParentBottom:{justifyContent:"flex-start"},flamechartLabel:{transform:"rotate(-90deg)",transformOrigin:"50% 50% 0",width:12*1.2,flexShrink:1},flamechartLabelBottom:{transform:"rotate(-90deg)",display:"flex",justifyContent:"flex-end"},callersAndCallees:{flex:1,borderLeft:`2px solid ${n.fgSecondaryColor}`},divider:{height:2,background:n.fgSecondaryColor}})),ot=ce(null),gi=O(n=>{let{activeProfileState:t,glCanvas:e}=n,{sandwichViewState:a,index:r}=t,{callerCallee:o}=a,i=I(),s=E(l=>{X.setSelectedFrame(l)},[]),d=t.profile,c=z(Qe),h=oe(Le),m=o?o.selectedFrame:null,g=P(()=>{let l=[];switch(d.forEachFrame(v=>{h&&!h.getMatchForFrame(v)||l.push(v)}),c.field){case 0:{Ie(l,v=>v.name.toLowerCase());break}case 1:{Ie(l,v=>v.getSelfWeight());break}case 2:{Ie(l,v=>v.getTotalWeight());break}}return c.direction===1&&l.reverse(),l},[d,h,c]),C=P(()=>{let l=new Map;for(let v=0;v<g.length;v++)l.set(g[v],v);return v=>{let f=l.get(v);return f??null}},[g]),b=P(()=>l=>h==null?null:h.getMatchForFrame(l),[h]),_={rowList:g,selectedFrame:m,setSelectedFrame:s,getIndexForFrame:C,getSearchMatchForFrame:b};return p(ot.Provider,{value:_},p(la,{theme:i,activeProfileState:t,glCanvas:e,setSelectedFrame:s,selectedFrame:m,profileIndex:r}))});var We=import("./import-OIHRKYQB.js");We.then(()=>{});import("./demangle-cpp-P7QR5U2F.js").then(()=>{});import("./source-map-5DQ363YZ.js").then(()=>{});async function Ci(n,t){return(await We).importProfileGroupFromText(n,t)}async function Z_(n,t){return(await We).importProfileGroupFromBase64(n,t)}async function Q_(n,t){return(await We).importProfilesFromArrayBuffer(n,t)}async function ec(n){return(await We).importProfilesFromFile(n)}async function tc(n){return(await We).importFromFileSystemDirectoryEntry(n)}var nc=ji();function ac(n){return n!=null&&n.isDirectory}var sa=class extends le{constructor(){super(...arguments);this.canvas=null;this.ref=e=>{e instanceof HTMLCanvasElement?this.canvas=e:this.canvas=null,this.props.setGLCanvas(this.canvas)};this.container=null;this.containerRef=e=>{e instanceof HTMLElement?this.container=e:this.container=null};this.maybeResize=()=>{if(!this.container||!this.props.canvasContext)return;let{width:e,height:a}=this.container.getBoundingClientRect(),r=e,o=a,i=e*window.devicePixelRatio,s=a*window.devicePixelRatio;this.props.canvasContext.gl.resize(i,s,r,o)};this.onWindowResize=()=>{this.props.canvasContext&&this.props.canvasContext.requestFrame()}}componentWillReceiveProps(e){this.props.canvasContext!==e.canvasContext&&(this.props.canvasContext&&this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize),e.canvasContext&&(e.canvasContext.addBeforeFrameHandler(this.maybeResize),e.canvasContext.requestFrame()))}componentDidMount(){window.addEventListener("resize",this.onWindowResize)}componentWillUnmount(){this.props.canvasContext&&this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize),window.removeEventListener("resize",this.onWindowResize)}render(){let e=bi(this.props.theme);return p("div",{ref:this.containerRef,className:y(e.glCanvasView)},p("canvas",{ref:this.ref,width:1,height:1}))}},vn=class extends le{constructor(){super(...arguments);this.loadExample=()=>{this.loadProfile(async()=>{let e="perf-vertx-stacks-01-collapsed-all.txt",a=await fetch(nc).then(r=>r.text());return await Ci(e,a)})};this.onDrop=e=>{if(this.props.setDragActive(!1),e.preventDefault(),!e.dataTransfer)return;let a=e.dataTransfer.items[0];if("webkitGetAsEntry"in a){let o=a.webkitGetAsEntry();if(o&&ac(o)&&o.name.endsWith(".trace")){console.log("Importing as Instruments.app .trace file");let i=o;this.loadProfile(async()=>await tc(i));return}}let r=e.dataTransfer.files.item(0);r&&this.loadFromFile(r)};this.onDragOver=e=>{this.props.setDragActive(!0),e.preventDefault()};this.onDragLeave=e=>{this.props.setDragActive(!1),e.preventDefault()};this.onWindowKeyPress=async e=>{if(e.key==="1")this.props.setViewMode(0);else if(e.key==="2")this.props.setViewMode(1);else if(e.key==="3")this.props.setViewMode(2);else if(e.key==="r"){let{flattenRecursion:a}=this.props;this.props.setFlattenRecursion(!a)}else if(e.key==="n"){let{activeProfileState:a}=this.props;a&&this.props.setProfileIndexToView(a.index+1)}else if(e.key==="p"){let{activeProfileState:a}=this.props;a&&this.props.setProfileIndexToView(a.index-1)}};this.saveFile=()=>{if(this.props.profileGroup){let{name:e,indexToView:a,profiles:r}=this.props.profileGroup,o={name:e,indexToView:a,profiles:r.map(i=>i.profile)};ya(o)}};this.browseForFile=()=>{let e=document.createElement("input");e.type="file",e.addEventListener("change",this.onFileSelect),e.click()};this.onWindowKeyDown=async e=>{e.key==="s"&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),this.saveFile()):e.key==="o"&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.browseForFile())};this.onDocumentPaste=e=>{if(document.activeElement!=null&&document.activeElement.nodeName==="INPUT")return;e.preventDefault(),e.stopPropagation();let a=e.clipboardData;if(!a)return;let r=a.getData("text");this.loadProfile(async()=>await Ci("From Clipboard",r))};this.onFileSelect=e=>{let a=e.target.files.item(0);a&&this.loadFromFile(a)}}async loadProfile(e){if(this.props.setError(!1),this.props.setLoading(!0),await new Promise(r=>setTimeout(r,0)),!this.props.glCanvas)return;console.time("import");let a=null;try{a=await e()}catch(r){console.log("Failed to load format",r),this.props.setError(!0);return}if(a==null){alert("Unrecognized format! See documentation about supported formats."),this.props.setLoading(!1);return}else if(a.profiles.length===0){alert("Successfully imported profile, but it's empty!"),this.props.setLoading(!1);return}this.props.hashParams.title&&(a={...a,name:this.props.hashParams.title}),document.title=`${a.name} - speedscope`,this.props.hashParams.viewMode&&this.props.setViewMode(this.props.hashParams.viewMode);for(let r of a.profiles)await r.demangle();for(let r of a.profiles){let o=this.props.hashParams.title||r.getName();r.setName(o)}console.timeEnd("import"),this.props.setProfileGroup(a),this.props.setLoading(!1)}getStyle(){return bi(this.props.theme)}loadFromFile(e){this.loadProfile(async()=>{let a=await ec(e);if(a){for(let r of a.profiles)r.getName()||r.setName(e.name);return a}if(this.props.profileGroup&&this.props.activeProfileState){let r=new FileReader,o=new Promise(h=>{r.addEventListener("loadend",()=>{if(typeof r.result!="string")throw new Error("Expected reader.result to be a string");h(r.result)})});r.readAsText(e);let i=await o,s=null,d=Ko(i);d&&(console.log("Importing as emscripten symbol map"),s=d);let c=await di(i,e.name);if(!s&&c&&(console.log("Importing as JavaScript source map"),s=c),s!=null)return{name:this.props.profileGroup.name||"profile",indexToView:this.props.profileGroup.indexToView,profiles:this.props.profileGroup.profiles.map(h=>{let m=h.profile.shallowClone();return m.remapSymbols(s),m})}}return null})}componentDidMount(){window.addEventListener("keydown",this.onWindowKeyDown),window.addEventListener("keypress",this.onWindowKeyPress),document.addEventListener("paste",this.onDocumentPaste),this.maybeLoadHashParamProfile()}componentWillUnmount(){window.removeEventListener("keydown",this.onWindowKeyDown),window.removeEventListener("keypress",this.onWindowKeyPress),document.removeEventListener("paste",this.onDocumentPaste)}async maybeLoadHashParamProfile(){let{profileURL:e}=this.props.hashParams;if(e){if(!St){alert(`Cannot load a profile URL when loading from "${window.location.protocol}" URL protocol`);return}this.loadProfile(async()=>{let a=await fetch(e),r=new URL(e,window.location.href).pathname;return r.includes("/")&&(r=r.slice(r.lastIndexOf("/")+1)),await Q_(r,await a.arrayBuffer())})}else if(this.props.hashParams.localProfilePath){window.speedscope={loadFileFromBase64:(r,o)=>{this.loadProfile(()=>Z_(r,o))}};let a=document.createElement("script");a.src=`file:///${this.props.hashParams.localProfilePath}`,document.head.appendChild(a)}}renderLanding(){let e=this.getStyle();return p("div",{className:y(e.landingContainer)},p("div",{className:y(e.landingMessage)},p("p",{className:y(e.landingP)},"\u{1F44B} Hi there! Welcome to \u{1F52C}speedscope, an interactive"," ",p("a",{className:y(e.link),href:"http://www.brendangregg.com/FlameGraphs/cpuflamegraphs.html"},"flamegraph")," ","visualizer. Use it to help you make your software faster."),St?p("p",{className:y(e.landingP)},"Drag and drop a profile file onto this window to get started, click the big blue button below to browse for a profile to explore, or"," ",p("a",{tabIndex:0,className:y(e.link),onClick:this.loadExample},"click here")," ","to load an example profile."):p("p",{className:y(e.landingP)},"Drag and drop a profile file onto this window to get started, or click the big blue button below to browse for a profile to explore."),p("div",{className:y(e.browseButtonContainer)},p("input",{type:"file",name:"file",id:"file",onChange:this.onFileSelect,className:y(e.hide)}),p("label",{for:"file",className:y(e.browseButton),tabIndex:0},"Browse")),p("p",{className:y(e.landingP)},"See the"," ",p("a",{className:y(e.link),href:"https://github.com/jlfwong/speedscope#usage",target:"_blank"},"documentation")," ","for information about supported file formats, keyboard shortcuts, and how to navigate around the profile."),p("p",{className:y(e.landingP)},"speedscope is open source. Please"," ",p("a",{className:y(e.link),target:"_blank",href:"https://github.com/jlfwong/speedscope/issues"},"report any issues on GitHub"),".")))}renderError(){let e=this.getStyle();return p("div",{className:y(e.error)},p("div",null,"\u{1F63F} Something went wrong."),p("div",null,"Check the JS console for more details."))}renderLoadingBar(){let e=this.getStyle();return p("div",{className:y(e.loading)})}renderContent(){let{viewMode:e,activeProfileState:a,error:r,loading:o,glCanvas:i}=this.props;if(r)return this.renderError();if(o)return this.renderLoadingBar();if(!a||!i)return this.renderLanding();switch(e){case 0:return p(ei,{activeProfileState:a,glCanvas:i});case 1:return p(ti,{activeProfileState:a,glCanvas:i});case 2:return p(gi,{activeProfileState:a,glCanvas:i})}}render(){let e=this.getStyle();return p("div",{onDrop:this.onDrop,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,className:y(e.root,this.props.dragActive&&e.dragTargetRoot)},p(sa,{setGLCanvas:this.props.setGLCanvas,canvasContext:this.props.canvasContext,theme:this.props.theme}),p(hi,{saveFile:this.saveFile,browseForFile:this.browseForFile,...this.props}),p("div",{className:y(e.contentContainer)},this.renderContent()),this.props.dragActive&&p("div",{className:y(e.dragTarget)}))}},bi=K(n=>M.create({glCanvasView:{position:"absolute",width:"100vw",height:"100vh",zIndex:-1,pointerEvents:"none"},error:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},loading:{height:3,marginBottom:-3,background:n.selectionPrimaryColor,transformOrigin:"0% 50%",animationName:[{from:{transform:"scaleX(0)"},to:{transform:"scaleX(1)"}}],animationTimingFunction:"cubic-bezier(0, 1, 0, 1)",animationDuration:"30s"},root:{width:"100vw",height:"100vh",overflow:"hidden",display:"flex",flexDirection:"column",position:"relative",fontFamily:'"Source Code Pro", Courier, monospace',lineHeight:"20px",color:n.fgPrimaryColor},dragTargetRoot:{cursor:"copy"},dragTarget:{boxSizing:"border-box",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:`5px dashed ${n.selectionPrimaryColor}`,pointerEvents:"none"},contentContainer:{position:"relative",display:"flex",overflow:"hidden",flexDirection:"column",flex:1},landingContainer:{display:"flex",alignItems:"center",justifyContent:"center",flex:1},landingMessage:{maxWidth:600},landingP:{marginBottom:16},hide:{display:"none"},browseButtonContainer:{display:"flex",alignItems:"center",justifyContent:"center"},browseButton:{marginBottom:16,height:72,flex:1,maxWidth:256,textAlign:"center",fontSize:36,lineHeight:"72px",background:n.selectionPrimaryColor,color:n.altFgPrimaryColor,transition:"all 0.07s ease-in",":hover":{background:n.selectionSecondaryColor}},link:{color:n.selectionPrimaryColor,cursor:"pointer",textDecoration:"none",transition:"all 0.07s ease-in",":hover":{color:n.selectionSecondaryColor}}}));var xi=O(()=>{let n=z(Ee),t=I(),e=P(()=>n?fe({theme:t,canvas:n}):null,[t,n]);return p(Vo,null,p(vn,{activeProfileState:wt(),canvasContext:e,setGLCanvas:Ee.set,setLoading:zn.set,setError:Fn.set,setProfileGroup:X.setProfileGroup,setDragActive:In.set,setViewMode:ke.set,setFlattenRecursion:ge.set,setProfileIndexToView:X.setProfileIndexToView,profileGroup:z(X),theme:t,flattenRecursion:z(ge),viewMode:z(ke),hashParams:z(Za),glCanvas:n,dragActive:z(In),loading:z(zn),error:z(Fn)}))});console.log(`speedscope v${wi().version}`);Cn(p(cr,null,p(xi,null)),document.body,document.body.lastElementChild||void 0);
//# sourceMappingURL=speedscope-WALCIMKQ.js.map
