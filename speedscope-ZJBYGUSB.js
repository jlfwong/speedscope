import{A as xa,a as ga,b as we,f as ja,j as ce,k as ct,l as Ca,m as ba,n as ze,o as ht,p as ae,q as Fe,y as Ni}from"./chunk-VR5NBJHX.js";import{a as M,b as ee}from"./chunk-FW4363Y4.js";var Le=M((Ht,ur)=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.default=ll;var il=/-webkit-|-moz-|-ms-/;function ll(n){return typeof n=="string"&&il.test(n)}ur.exports=Ht.default});var yr=M((Lt,fr)=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.default=dl;var sl=Le(),_l=cl(sl);function cl(n){return n&&n.__esModule?n:{default:n}}var hl=["-webkit-","-moz-",""];function dl(n,t){if(typeof t=="string"&&!(0,_l.default)(t)&&t.indexOf("calc(")>-1)return hl.map(function(e){return t.replace(/calc\(/g,e+"calc(")})}fr.exports=Lt.default});var jr=M((Bt,gr)=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.default=fl;var pl=Le(),vl=ml(pl);function ml(n){return n&&n.__esModule?n:{default:n}}var ul=["-webkit-",""];function fl(n,t){if(typeof t=="string"&&!(0,vl.default)(t)&&t.indexOf("cross-fade(")>-1)return ul.map(function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")})}gr.exports=Bt.default});var br=M((It,Cr)=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.default=jl;var yl=["-webkit-","-moz-",""],gl={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function jl(n,t){if(n==="cursor"&&gl.hasOwnProperty(t))return yl.map(function(e){return e+t})}Cr.exports=It.default});var Sr=M((zt,xr)=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.default=wl;var Cl=Le(),bl=xl(Cl);function xl(n){return n&&n.__esModule?n:{default:n}}var Sl=["-webkit-",""];function wl(n,t){if(typeof t=="string"&&!(0,bl.default)(t)&&t.indexOf("filter(")>-1)return Sl.map(function(e){return t.replace(/filter\(/g,e+"filter(")})}xr.exports=zt.default});var kr=M((Ft,Rr)=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.default=Rl;var wr={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function Rl(n,t){if(n==="display"&&wr.hasOwnProperty(t))return wr[t]}Rr.exports=Ft.default});var Er=M((Dt,Ar)=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.default=Nl;var kl={"space-around":"distribute","space-between":"justify","flex-start":"start","flex-end":"end"},Nr={alignContent:"msFlexLinePack",alignSelf:"msFlexItemAlign",alignItems:"msFlexAlign",justifyContent:"msFlexPack",order:"msFlexOrder",flexGrow:"msFlexPositive",flexShrink:"msFlexNegative",flexBasis:"msFlexPreferredSize"};function Nl(n,t,e){Nr.hasOwnProperty(n)&&(e[Nr[n]]=kl[t]||t)}Ar.exports=Dt.default});var Lr=M((Pt,Hr)=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.default=El;var Al={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},Tr={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function El(n,t,e){n==="flexDirection"&&typeof t=="string"&&(t.indexOf("column")>-1?e.WebkitBoxOrient="vertical":e.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?e.WebkitBoxDirection="reverse":e.WebkitBoxDirection="normal"),Tr.hasOwnProperty(n)&&(e[Tr[n]]=Al[t]||t)}Hr.exports=Pt.default});var Ir=M((Mt,Br)=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.default=zl;var Tl=Le(),Hl=Ll(Tl);function Ll(n){return n&&n.__esModule?n:{default:n}}var Bl=["-webkit-","-moz-",""],Il=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function zl(n,t){if(typeof t=="string"&&!(0,Hl.default)(t)&&Il.test(t))return Bl.map(function(e){return e+t})}Br.exports=Mt.default});var Fr=M((Jt,zr)=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.default=Jl;var Fl=Le(),Dl=Pl(Fl);function Pl(n){return n&&n.__esModule?n:{default:n}}var Ml=["-webkit-",""];function Jl(n,t){if(typeof t=="string"&&!(0,Dl.default)(t)&&t.indexOf("image-set(")>-1)return Ml.map(function(e){return t.replace(/image-set\(/g,e+"image-set(")})}zr.exports=Jt.default});var Pr=M((Vt,Dr)=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.default=Vl;function Vl(n,t){if(n==="position"&&t==="sticky")return["-webkit-sticky","sticky"]}Dr.exports=Vt.default});var Jr=M((Ot,Mr)=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.default=$l;var Ol=["-webkit-","-moz-",""],Kl={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},Ul={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function $l(n,t){if(Kl.hasOwnProperty(n)&&Ul.hasOwnProperty(t))return Ol.map(function(e){return e+t})}Mr.exports=Ot.default});var Or=M((Wh,Vr)=>{"use strict";var Wl=/[A-Z]/g,Gl=/^ms-/,Kn={};function ql(n){return n in Kn?Kn[n]:Kn[n]=n.replace(Wl,"-$&").toLowerCase().replace(Gl,"-ms-")}Vr.exports=ql});var Ur=M((Kt,Kr)=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.default=Ql;var Xl=Or(),Yl=Zl(Xl);function Zl(n){return n&&n.__esModule?n:{default:n}}function Ql(n){return(0,Yl.default)(n)}Kr.exports=Kt.default});var Un=M((Ut,$r)=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.default=es;function es(n){return n.charAt(0).toUpperCase()+n.slice(1)}$r.exports=Ut.default});var qr=M(($t,Gr)=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.default=_s;var ts=Ur(),ns=$n(ts),as=Le(),rs=$n(as),os=Un(),Wr=$n(os);function $n(n){return n&&n.__esModule?n:{default:n}}var is={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},ls={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function ss(n,t){if((0,rs.default)(n))return n;for(var e=n.split(/,(?![^()]*(?:\([^()]*\))?\))/g),a=0,r=e.length;a<r;++a){var o=e[a],i=[o];for(var s in t){var h=(0,ns.default)(s);if(o.indexOf(h)>-1&&h!=="order")for(var c=t[s],d=0,u=c.length;d<u;++d)i.unshift(o.replace(h,ls[c[d]]+h))}e[a]=i.join(",")}return e.join(",")}function _s(n,t,e,a){if(typeof t=="string"&&is.hasOwnProperty(n)){var r=ss(t,a),o=r.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(s){return!/-moz-|-ms-/.test(s)}).join(",");if(n.indexOf("Webkit")>-1)return o;var i=r.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(s){return!/-webkit-|-ms-/.test(s)}).join(",");return n.indexOf("Moz")>-1?i:(e["Webkit"+(0,Wr.default)(n)]=o,e["Moz"+(0,Wr.default)(n)]=i,r)}}Gr.exports=$t.default});var Yr=M((Gh,Xr)=>{"use strict";function cs(n){for(var t=5381,e=n.length;e;)t=t*33^n.charCodeAt(--e);return t>>>0}Xr.exports=cs});var Qr=M((Wt,Zr)=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.default=vs;var hs=Un(),ds=ps(hs);function ps(n){return n&&n.__esModule?n:{default:n}}function vs(n,t,e){if(n.hasOwnProperty(t)){for(var a={},r=n[t],o=(0,ds.default)(t),i=Object.keys(e),s=0;s<i.length;s++){var h=i[s];if(h===t)for(var c=0;c<r.length;c++)a[r[c]+o]=e[t];a[h]=e[h]}return a}return e}Zr.exports=Wt.default});var to=M((Gt,eo)=>{"use strict";Object.defineProperty(Gt,"__esModule",{value:!0});Gt.default=ms;function ms(n,t,e,a,r){for(var o=0,i=n.length;o<i;++o){var s=n[o](t,e,a,r);if(s)return s}}eo.exports=Gt.default});var ro=M((qt,ao)=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.default=us;function no(n,t){n.indexOf(t)===-1&&n.push(t)}function us(n,t){if(Array.isArray(t))for(var e=0,a=t.length;e<a;++e)no(n,t[e]);else no(n,t)}ao.exports=qt.default});var io=M((Xt,oo)=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.default=fs;function fs(n){return n instanceof Object&&!Array.isArray(n)}oo.exports=Xt.default});var _o=M((Zt,so)=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.default=ws;var ys=Qr(),gs=Yt(ys),js=to(),lo=Yt(js),Cs=ro(),bs=Yt(Cs),xs=io(),Ss=Yt(xs);function Yt(n){return n&&n.__esModule?n:{default:n}}function ws(n){var t=n.prefixMap,e=n.plugins;function a(r){for(var o in r){var i=r[o];if((0,Ss.default)(i))r[o]=a(i);else if(Array.isArray(i)){for(var s=[],h=0,c=i.length;h<c;++h){var d=(0,lo.default)(e,o,i[h],r,t);(0,bs.default)(s,d||i[h])}s.length>0&&(r[o]=s)}else{var u=(0,lo.default)(e,o,i,r,t);u&&(r[o]=u),r=(0,gs.default)(t,o,r)}}return r}return a}so.exports=Zt.default});var fo=M((qh,uo)=>{"use strict";uo.exports=Wn;function Wn(n){ve.length||(Qt(),po=!0),ve[ve.length]=n}var ve=[],po=!1,Qt,pe=0,Rs=1024;function co(){for(;pe<ve.length;){var n=pe;if(pe=pe+1,ve[n].call(),pe>Rs){for(var t=0,e=ve.length-pe;t<e;t++)ve[t]=ve[t+pe];ve.length-=pe,pe=0}}ve.length=0,pe=0,po=!1}var ho=typeof global<"u"?global:self,vo=ho.MutationObserver||ho.WebKitMutationObserver;typeof vo=="function"?Qt=ks(co):Qt=mo(co);Wn.requestFlush=Qt;function ks(n){var t=1,e=new vo(n),a=document.createTextNode("");return e.observe(a,{characterData:!0}),function(){t=-t,a.data=t}}function mo(n){return function(){var e=setTimeout(r,0),a=setInterval(r,50);function r(){clearTimeout(e),clearInterval(a),n()}}}Wn.makeRequestCallFromTimer=mo});var Co=M((Xh,jo)=>{"use strict";var yo=fo(),en=[],Gn=[],Ns=yo.makeRequestCallFromTimer(As);function As(){if(Gn.length)throw Gn.shift()}jo.exports=qn;function qn(n){var t;en.length?t=en.pop():t=new go,t.task=n,yo(t)}function go(){this.task=null}go.prototype.call=function(){try{this.task.call()}catch(n){qn.onerror?qn.onerror(n):(Gn.push(n),Ns())}finally{this.task=null,en[en.length]=this}}});var Si=M((yu,ec)=>{ec.exports="./perf-vertx-stacks-01-collapsed-all-ZNUIGAJL.txt"});var A,Ai,Xe,Cn,ka,Sa,Na,Aa,fe={},bn=[],Ei=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function Ae(n,t){for(var e in t)n[e]=t[e];return n}function Ea(n){var t=n.parentNode;t&&t.removeChild(n)}function p(n,t,e){var a,r=arguments,o={};for(a in t)a!=="key"&&a!=="ref"&&(o[a]=t[a]);if(arguments.length>3)for(e=[e],a=3;a<arguments.length;a++)e.push(r[a]);if(e!=null&&(o.children=e),typeof n=="function"&&n.defaultProps!=null)for(a in n.defaultProps)o[a]===void 0&&(o[a]=n.defaultProps[a]);return jn(n,o,t&&t.key,t&&t.ref,null)}function jn(n,t,e,a,r){var o={type:n,props:t,key:e,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:r};return r==null&&(o.__v=o),A.vnode&&A.vnode(o),o}function oe(n){return n.children}function q(n,t){this.props=n,this.context=t}function Ye(n,t){if(t==null)return n.__?Ye(n.__,n.__.__k.indexOf(n)+1):null;for(var e;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null)return e.__e;return typeof n.type=="function"?Ye(n):null}function Ta(n){var t,e;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,t=0;t<n.__k.length;t++)if((e=n.__k[t])!=null&&e.__e!=null){n.__e=n.__c.base=e.__e;break}return Ta(n)}}function dt(n){(!n.__d&&(n.__d=!0)&&Xe.push(n)&&!Cn++||Sa!==A.debounceRendering)&&((Sa=A.debounceRendering)||ka)(Ti)}function Ti(){for(var n;Cn=Xe.length;)n=Xe.sort(function(t,e){return t.__v.__b-e.__v.__b}),Xe=[],n.some(function(t){var e,a,r,o,i,s,h;t.__d&&(s=(i=(e=t).__v).__e,(h=e.__P)&&(a=[],(r=Ae({},i)).__v=r,o=xn(h,i,r,e.__n,h.ownerSVGElement!==void 0,null,a,s??Ye(i)),La(a,i),o!=s&&Ta(i)))})}function Ha(n,t,e,a,r,o,i,s,h){var c,d,u,g,j,C,_,l=e&&e.__k||bn,v=l.length;if(s==fe&&(s=o!=null?o[0]:v?Ye(e,0):null),c=0,t.__k=Ze(t.__k,function(f){if(f!=null){if(f.__=t,f.__b=t.__b+1,(u=l[c])===null||u&&f.key==u.key&&f.type===u.type)l[c]=void 0;else for(d=0;d<v;d++){if((u=l[d])&&f.key==u.key&&f.type===u.type){l[d]=void 0;break}u=null}if(g=xn(n,f,u=u||fe,a,r,o,i,s,h),(d=f.ref)&&u.ref!=d&&(_||(_=[]),u.ref&&_.push(u.ref,null,f),_.push(d,f.__c||g,f)),g!=null){var b;if(C==null&&(C=g),f.__d!==void 0)b=f.__d,f.__d=void 0;else if(o==u||g!=s||g.parentNode==null){e:if(s==null||s.parentNode!==n)n.appendChild(g),b=null;else{for(j=s,d=0;(j=j.nextSibling)&&d<v;d+=2)if(j==g)break e;n.insertBefore(g,s),b=s}t.type=="option"&&(n.value="")}s=b!==void 0?b:g.nextSibling,typeof t.type=="function"&&(t.__d=s)}else s&&u.__e==s&&s.parentNode!=n&&(s=Ye(u))}return c++,f}),t.__e=C,o!=null&&typeof t.type!="function")for(c=o.length;c--;)o[c]!=null&&Ea(o[c]);for(c=v;c--;)l[c]!=null&&Sn(l[c],l[c]);if(_)for(c=0;c<_.length;c++)Ba(_[c],_[++c],_[++c])}function Ze(n,t,e){if(e==null&&(e=[]),n==null||typeof n=="boolean")t&&e.push(t(null));else if(Array.isArray(n))for(var a=0;a<n.length;a++)Ze(n[a],t,e);else e.push(t?t(typeof n=="string"||typeof n=="number"?jn(null,n,null,null,n):n.__e!=null||n.__c!=null?jn(n.type,n.props,n.key,null,n.__v):n):n);return e}function Hi(n,t,e,a,r){var o;for(o in e)o==="children"||o==="key"||o in t||pt(n,o,null,e[o],a);for(o in t)r&&typeof t[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||e[o]===t[o]||pt(n,o,t[o],e[o],a)}function wa(n,t,e){t[0]==="-"?n.setProperty(t,e):n[t]=typeof e=="number"&&Ei.test(t)===!1?e+"px":e??""}function pt(n,t,e,a,r){var o,i,s,h,c;if(r?t==="className"&&(t="class"):t==="class"&&(t="className"),t==="style")if(o=n.style,typeof e=="string")o.cssText=e;else{if(typeof a=="string"&&(o.cssText="",a=null),a)for(h in a)e&&h in e||wa(o,h,"");if(e)for(c in e)a&&e[c]===a[c]||wa(o,c,e[c])}else t[0]==="o"&&t[1]==="n"?(i=t!==(t=t.replace(/Capture$/,"")),s=t.toLowerCase(),t=(s in n?s:t).slice(2),e?(a||n.addEventListener(t,Ra,i),(n.l||(n.l={}))[t]=e):n.removeEventListener(t,Ra,i)):t!=="list"&&t!=="tagName"&&t!=="form"&&t!=="type"&&t!=="size"&&!r&&t in n?n[t]=e??"":typeof e!="function"&&t!=="dangerouslySetInnerHTML"&&(t!==(t=t.replace(/^xlink:?/,""))?e==null||e===!1?n.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):n.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),e):e==null||e===!1&&!/^ar/.test(t)?n.removeAttribute(t):n.setAttribute(t,e))}function Ra(n){this.l[n.type](A.event?A.event(n):n)}function xn(n,t,e,a,r,o,i,s,h){var c,d,u,g,j,C,_,l,v,f,b=t.type;if(t.constructor!==void 0)return null;(c=A.__b)&&c(t);try{e:if(typeof b=="function"){if(l=t.props,v=(c=b.contextType)&&a[c.__c],f=c?v?v.props.value:c.__:a,e.__c?_=(d=t.__c=e.__c).__=d.__E:("prototype"in b&&b.prototype.render?t.__c=d=new b(l,f):(t.__c=d=new q(l,f),d.constructor=b,d.render=Bi),v&&v.sub(d),d.props=l,d.state||(d.state={}),d.context=f,d.__n=a,u=d.__d=!0,d.__h=[]),d.__s==null&&(d.__s=d.state),b.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=Ae({},d.__s)),Ae(d.__s,b.getDerivedStateFromProps(l,d.__s))),g=d.props,j=d.state,u)b.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(b.getDerivedStateFromProps==null&&l!==g&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(l,f),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(l,d.__s,f)===!1||t.__v===e.__v&&!d.__){for(d.props=l,d.state=d.__s,t.__v!==e.__v&&(d.__d=!1),d.__v=t,t.__e=e.__e,t.__k=e.__k,d.__h.length&&i.push(d),c=0;c<t.__k.length;c++)t.__k[c]&&(t.__k[c].__=t);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(l,d.__s,f),d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(g,j,C)})}d.context=f,d.props=l,d.state=d.__s,(c=A.__r)&&c(t),d.__d=!1,d.__v=t,d.__P=n,c=d.render(d.props,d.state,d.context),t.__k=c!=null&&c.type==oe&&c.key==null?c.props.children:Array.isArray(c)?c:[c],d.getChildContext!=null&&(a=Ae(Ae({},a),d.getChildContext())),u||d.getSnapshotBeforeUpdate==null||(C=d.getSnapshotBeforeUpdate(g,j)),Ha(n,t,e,a,r,o,i,s,h),d.base=t.__e,d.__h.length&&i.push(d),_&&(d.__E=d.__=null),d.__e=!1}else o==null&&t.__v===e.__v?(t.__k=e.__k,t.__e=e.__e):t.__e=Li(e.__e,t,e,a,r,o,i,h);(c=A.diffed)&&c(t)}catch(S){t.__v=null,A.__e(S,t,e)}return t.__e}function La(n,t){A.__c&&A.__c(t,n),n.some(function(e){try{n=e.__h,e.__h=[],n.some(function(a){a.call(e)})}catch(a){A.__e(a,e.__v)}})}function Li(n,t,e,a,r,o,i,s){var h,c,d,u,g,j=e.props,C=t.props;if(r=t.type==="svg"||r,o!=null){for(h=0;h<o.length;h++)if((c=o[h])!=null&&((t.type===null?c.nodeType===3:c.localName===t.type)||n==c)){n=c,o[h]=null;break}}if(n==null){if(t.type===null)return document.createTextNode(C);n=r?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,C.is&&{is:C.is}),o=null,s=!1}if(t.type===null)j!==C&&n.data!=C&&(n.data=C);else{if(o!=null&&(o=bn.slice.call(n.childNodes)),d=(j=e.props||fe).dangerouslySetInnerHTML,u=C.dangerouslySetInnerHTML,!s){if(j===fe)for(j={},g=0;g<n.attributes.length;g++)j[n.attributes[g].name]=n.attributes[g].value;(u||d)&&(u&&d&&u.__html==d.__html||(n.innerHTML=u&&u.__html||""))}Hi(n,C,j,r,s),u?t.__k=[]:(t.__k=t.props.children,Ha(n,t,e,a,t.type!=="foreignObject"&&r,o,i,fe,s)),s||("value"in C&&(h=C.value)!==void 0&&h!==n.value&&pt(n,"value",h,j.value,!1),"checked"in C&&(h=C.checked)!==void 0&&h!==n.checked&&pt(n,"checked",h,j.checked,!1))}return n}function Ba(n,t,e){try{typeof n=="function"?n(t):n.current=t}catch(a){A.__e(a,e)}}function Sn(n,t,e){var a,r,o;if(A.unmount&&A.unmount(n),(a=n.ref)&&(a.current&&a.current!==n.__e||Ba(a,null,t)),e||typeof n.type=="function"||(e=(r=n.__e)!=null),n.__e=n.__d=void 0,(a=n.__c)!=null){if(a.componentWillUnmount)try{a.componentWillUnmount()}catch(i){A.__e(i,t)}a.base=a.__P=null}if(a=n.__k)for(o=0;o<a.length;o++)a[o]&&Sn(a[o],t,e);r!=null&&Ea(r)}function Bi(n,t,e){return this.constructor(n,e)}function wn(n,t,e){var a,r,o;A.__&&A.__(n,t),r=(a=e===Na)?null:e&&e.__k||t.__k,n=p(oe,null,[n]),o=[],xn(t,(a?t:e||t).__k=n,r||fe,fe,t.ownerSVGElement!==void 0,e&&!a?[e]:r?null:bn.slice.call(t.childNodes),o,e||fe,a),La(o,n)}function he(n){var t={},e={__c:"__cC"+Aa++,__:n,Consumer:function(a,r){return a.children(r)},Provider:function(a){var r,o=this;return this.getChildContext||(r=[],this.getChildContext=function(){return t[e.__c]=o,t},this.shouldComponentUpdate=function(i){o.props.value!==i.value&&r.some(function(s){s.context=i.value,dt(s)})},this.sub=function(i){r.push(i);var s=i.componentWillUnmount;i.componentWillUnmount=function(){r.splice(r.indexOf(i),1),s&&s.call(i)}}),a.children}};return e.Consumer.contextType=e,e.Provider.__=e,e}A={__e:function(n,t){for(var e,a;t=t.__;)if((e=t.__c)&&!e.__)try{if(e.constructor&&e.constructor.getDerivedStateFromError!=null&&(a=!0,e.setState(e.constructor.getDerivedStateFromError(n))),e.componentDidCatch!=null&&(a=!0,e.componentDidCatch(n)),a)return dt(e.__E=e)}catch(r){n=r}throw n}},Ai=function(n){return n!=null&&n.constructor===void 0},q.prototype.setState=function(n,t){var e;e=this.__s!==this.state?this.__s:this.__s=Ae({},this.state),typeof n=="function"&&(n=n(e,this.props)),n&&Ae(e,n),n!=null&&this.__v&&(t&&this.__h.push(t),dt(this))},q.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),dt(this))},q.prototype.render=oe,Xe=[],Cn=0,ka=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Na=fe,Aa=0;var Rn=class{constructor(t){this.data=t;this.prev=null;this.next=null}},vt=class{constructor(){this.head=null;this.tail=null;this.size=0}getHead(){return this.head}getTail(){return this.tail}getSize(){return this.size}append(t){this.tail?(this.tail.next=t,t.prev=this.tail,this.tail=t):this.head=this.tail=t,this.size++}prepend(t){return this.head?(this.head.prev=t,t.next=this.head,this.head=t):this.head=this.tail=t,this.size++,t}pop(){if(this.tail){let t=this.tail;return t.prev?(this.tail=t.prev,this.tail.next=null):this.head=this.tail=null,this.size--,t.prev=null,t}else return null}dequeue(){if(this.head){let t=this.head;return t.next?(this.head=t.next,this.head.prev=null):this.head=this.tail=null,this.size--,t.next=null,t}else return null}remove(t){t.prev==null?this.dequeue():t.next==null?this.pop():(t.next.prev=t.prev,t.prev.next=t.next,t.next=null,t.prev=null,this.size--)}},mt=class{constructor(t){this.capacity=t;this.list=new vt;this.map=new Map}has(t){return this.map.has(t)}get(t){let e=this.map.get(t);return e?(this.list.remove(e.listNode),this.list.prepend(e.listNode),e?e.value:null):null}getSize(){return this.list.getSize()}getCapacity(){return this.capacity}insert(t,e){let a=this.map.get(t);for(a&&this.list.remove(a.listNode);this.list.getSize()>=this.capacity;)this.map.delete(this.list.pop().data);let r=this.list.prepend(new Rn(t));this.map.set(t,{value:e,listNode:r})}getOrInsert(t,e){let a=this.get(t);return a==null&&(a=e(t),this.insert(t,a)),a}removeLRU(){let t=this.list.pop();if(!t)return null;let e=t.data,a=this.map.get(e).value;return this.map.delete(e),[e,a]}clear(){this.list=new vt,this.map=new Map}};function X(n,t,e){return n<t?t:n>e?e:n}var m=class n{constructor(t,e){this.x=t;this.y=e}withX(t){return new n(t,this.y)}withY(t){return new n(this.x,t)}plus(t){return new n(this.x+t.x,this.y+t.y)}minus(t){return new n(this.x-t.x,this.y-t.y)}times(t){return new n(this.x*t,this.y*t)}timesPointwise(t){return new n(this.x*t.x,this.y*t.y)}dividedByPointwise(t){return new n(this.x/t.x,this.y/t.y)}dot(t){return this.x*t.x+this.y*t.y}equals(t){return this.x===t.x&&this.y===t.y}approxEquals(t,e=1e-9){return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e}length2(){return this.dot(this)}length(){return Math.sqrt(this.length2())}abs(){return new n(Math.abs(this.x),Math.abs(this.y))}static min(t,e){return new n(Math.min(t.x,e.x),Math.min(t.y,e.y))}static max(t,e){return new n(Math.max(t.x,e.x),Math.max(t.y,e.y))}static clamp(t,e,a){return new n(X(t.x,e.x,a.x),X(t.y,e.y,a.y))}static{this.zero=new n(0,0)}static{this.unit=new n(1,1)}flatten(){return[this.x,this.y]}},H=class n{constructor(t=1,e=0,a=0,r=0,o=1,i=0){this.m00=t;this.m01=e;this.m02=a;this.m10=r;this.m11=o;this.m12=i}withScale(t){let{m00:e,m01:a,m02:r,m10:o,m11:i,m12:s}=this;return e=t.x,i=t.y,new n(e,a,r,o,i,s)}static withScale(t){return new n().withScale(t)}scaledBy(t){return n.withScale(t).times(this)}getScale(){return new m(this.m00,this.m11)}withTranslation(t){let{m00:e,m01:a,m02:r,m10:o,m11:i,m12:s}=this;return r=t.x,s=t.y,new n(e,a,r,o,i,s)}static withTranslation(t){return new n().withTranslation(t)}getTranslation(){return new m(this.m02,this.m12)}translatedBy(t){return n.withTranslation(t).times(this)}static betweenRects(t,e){return n.withTranslation(t.origin.times(-1)).scaledBy(new m(e.size.x/t.size.x,e.size.y/t.size.y)).translatedBy(e.origin)}times(t){let e=this.m00*t.m00+this.m01*t.m10,a=this.m00*t.m01+this.m01*t.m11,r=this.m00*t.m02+this.m01*t.m12+this.m02,o=this.m10*t.m00+this.m11*t.m10,i=this.m10*t.m01+this.m11*t.m11,s=this.m10*t.m02+this.m11*t.m12+this.m12;return new n(e,a,r,o,i,s)}equals(t){return this.m00==t.m00&&this.m01==t.m01&&this.m02==t.m02&&this.m10==t.m10&&this.m11==t.m11&&this.m12==t.m12}approxEquals(t,e=1e-9){return Math.abs(this.m00-t.m00)<e&&Math.abs(this.m01-t.m01)<e&&Math.abs(this.m02-t.m02)<e&&Math.abs(this.m10-t.m10)<e&&Math.abs(this.m11-t.m11)<e&&Math.abs(this.m12-t.m12)<e}timesScalar(t){let{m00:e,m01:a,m02:r,m10:o,m11:i,m12:s}=this;return new n(t*e,t*a,t*r,t*o,t*i,t*s)}det(){let{m00:t,m01:e,m02:a,m10:r,m11:o,m12:i}=this,s=0,h=0,c=1;return t*(o*c-i*h)-e*(r*c-i*s)+a*(r*h-o*s)}adj(){let{m00:t,m01:e,m02:a,m10:r,m11:o,m12:i}=this,s=0,h=0,c=1,d=+(o*c-i*h),u=-(e*c-a*h),g=+(e*i-a*o),j=-(r*c-i*s),C=+(t*c-a*s),_=-(t*i-a*r);return new n(d,u,g,j,C,_)}inverted(){let t=this.det();return t===0?null:this.adj().timesScalar(1/t)}transformVector(t){return new m(t.x*this.m00+t.y*this.m01,t.x*this.m10+t.y*this.m11)}inverseTransformVector(t){let e=this.inverted();return e?e.transformVector(t):null}transformPosition(t){return new m(t.x*this.m00+t.y*this.m01+this.m02,t.x*this.m10+t.y*this.m11+this.m12)}inverseTransformPosition(t){let e=this.inverted();return e?e.transformPosition(t):null}transformRect(t){let e=this.transformVector(t.size),a=this.transformPosition(t.origin);return e.x<0&&e.y<0?new k(a.plus(e),e.abs()):e.x<0?new k(a.withX(a.x+e.x),e.abs()):e.y<0?new k(a.withY(a.y+e.y),e.abs()):new k(a,e)}inverseTransformRect(t){let e=this.inverted();return e?e.transformRect(t):null}flatten(){return[this.m00,this.m10,0,this.m01,this.m11,0,this.m02,this.m12,1]}},k=class n{constructor(t,e){this.origin=t;this.size=e}isEmpty(){return this.width()==0||this.height()==0}width(){return this.size.x}height(){return this.size.y}left(){return this.origin.x}right(){return this.left()+this.width()}top(){return this.origin.y}bottom(){return this.top()+this.height()}topLeft(){return this.origin}topRight(){return this.origin.plus(new m(this.width(),0))}bottomRight(){return this.origin.plus(this.size)}bottomLeft(){return this.origin.plus(new m(0,this.height()))}withOrigin(t){return new n(t,this.size)}withSize(t){return new n(this.origin,t)}closestPointTo(t){return new m(X(t.x,this.left(),this.right()),X(t.y,this.top(),this.bottom()))}distanceFrom(t){return t.minus(this.closestPointTo(t)).length()}contains(t){return this.distanceFrom(t)===0}hasIntersectionWith(t){let e=Math.max(this.top(),t.top());if(Math.max(e,Math.min(this.bottom(),t.bottom()))-e===0)return!1;let r=Math.max(this.left(),t.left());return Math.max(r,Math.min(this.right(),t.right()))-r!==0}intersectWith(t){let e=m.max(this.topLeft(),t.topLeft()),a=m.max(e,m.min(this.bottomRight(),t.bottomRight()));return new n(e,a.minus(e))}equals(t){return this.origin.equals(t.origin)&&this.size.equals(t.size)}approxEquals(t){return this.origin.approxEquals(t.origin)&&this.size.approxEquals(t.size)}area(){return this.size.x*this.size.y}static{this.empty=new n(m.zero,m.zero)}static{this.unit=new n(m.zero,m.unit)}static{this.NDC=new n(new m(-1,-1),new m(2,2))}};var kn=typeof process<"u"&&process.env&&!0;function L(n){if(!kn&&!n)throw new Error("Assertion failed.")}function Ii(n,t){n.indexOf(t)===-1&&n.push(t)}function zi(n,t){let e=n.indexOf(t);e!==-1&&n.splice(e,1)}function Fi(n,t){return L(t>=0&&t<=31),n.TEXTURE0+t}var B;(j=>{class n{constructor(_=0,l=0,v=0,f=0){this.x=_;this.y=l;this.width=v;this.height=f}set(_,l,v,f){this.x=_,this.y=l,this.width=v,this.height=f}equals(_){return this.x===_.x&&this.y===_.y&&this.width===_.width&&this.height===_.height}}j.Rect=n;class t{constructor(_,l,v,f){this.redF=_;this.greenF=l;this.blueF=v;this.alphaF=f}equals(_){return this.redF===_.redF&&this.greenF===_.greenF&&this.blueF===_.blueF&&this.alphaF===_.alphaF}static{this.TRANSPARENT=new t(0,0,0,0)}}j.Color=t;let e;(x=>(x[x.ZERO=0]="ZERO",x[x.ONE=1]="ONE",x[x.SOURCE_COLOR=2]="SOURCE_COLOR",x[x.TARGET_COLOR=3]="TARGET_COLOR",x[x.INVERSE_SOURCE_COLOR=4]="INVERSE_SOURCE_COLOR",x[x.INVERSE_TARGET_COLOR=5]="INVERSE_TARGET_COLOR",x[x.SOURCE_ALPHA=6]="SOURCE_ALPHA",x[x.TARGET_ALPHA=7]="TARGET_ALPHA",x[x.INVERSE_SOURCE_ALPHA=8]="INVERSE_SOURCE_ALPHA",x[x.INVERSE_TARGET_ALPHA=9]="INVERSE_TARGET_ALPHA",x[x.CONSTANT=10]="CONSTANT",x[x.INVERSE_CONSTANT=11]="INVERSE_CONSTANT"))(e=j.BlendOperation||={});let a;(l=>(l[l.TRIANGLES=0]="TRIANGLES",l[l.TRIANGLE_STRIP=1]="TRIANGLE_STRIP"))(a=j.Primitive||={});class r{constructor(){this.resizeEventHandlers=new Set}setCopyBlendState(){this.setBlendState(1,0)}setAddBlendState(){this.setBlendState(1,1)}setPremultipliedBlendState(){this.setBlendState(1,8)}setUnpremultipliedBlendState(){this.setBlendState(6,8)}addAfterResizeEventHandler(_){this.resizeEventHandlers.add(_)}removeAfterResizeEventHandler(_){this.resizeEventHandlers.delete(_)}}j.Context=r;let o;(l=>(l[l.FLOAT=0]="FLOAT",l[l.BYTE=1]="BYTE"))(o=j.AttributeType||={});function i(C){return C==0?4:1}j.attributeByteLength=i;class s{constructor(_,l,v,f){this.name=_;this.type=l;this.count=v;this.byteOffset=f}}j.Attribute=s;class h{constructor(){this._attributes=[];this._stride=0}get attributes(){return this._attributes}get stride(){return this._stride}add(_,l,v){return this.attributes.push(new s(_,l,v,this.stride)),this._stride+=v*i(l),this}}j.VertexFormat=h;class c{uploadFloat32Array(_){this.upload(new Uint8Array(_.buffer),0)}uploadFloats(_){this.uploadFloat32Array(new Float32Array(_))}}j.VertexBuffer=c;let d;(l=>(l[l.NEAREST=0]="NEAREST",l[l.LINEAR=1]="LINEAR"))(d=j.PixelFilter||={});let u;(l=>(l[l.REPEAT=0]="REPEAT",l[l.CLAMP=1]="CLAMP"))(u=j.PixelWrap||={});class g{constructor(_,l,v){this.minFilter=_;this.magFilter=l;this.wrap=v}static{this.LINEAR_CLAMP=new g(1,1,1)}static{this.LINEAR_MIN_NEAREST_MAG_CLAMP=new g(1,0,1)}static{this.NEAREST_CLAMP=new g(0,0,1)}}j.TextureFormat=g})(B||={});var Nn;(j=>{class n extends B.Context{constructor(l=document.createElement("canvas")){super();this._attributeCount=0;this._blendOperations=0;this._contextResetHandlers=[];this._currentClearColor=B.Color.TRANSPARENT;this._currentRenderTarget=null;this._defaultViewport=new B.Rect;this._forceStateUpdate=!0;this._generation=1;this._height=0;this._oldBlendOperations=0;this._oldRenderTarget=null;this._oldViewport=new B.Rect;this._width=0;this.handleWebglContextRestored=()=>{this._attributeCount=0,this._currentClearColor=B.Color.TRANSPARENT,this._forceStateUpdate=!0,this._generation++;for(let l of this._contextResetHandlers)l()};this.ANGLE_instanced_arrays=null;this.ANGLE_instanced_arrays_generation=-1;let v=l.getContext("webgl",{alpha:!1,antialias:!1,depth:!1,preserveDrawingBuffer:!1,stencil:!1});if(v==null)throw new Error("Setup failure");this._gl=v;let f=l.style;l.width=0,l.height=0,f.width=f.height="0",l.addEventListener("webglcontextlost",b=>{b.preventDefault()}),l.addEventListener("webglcontextrestored",this.handleWebglContextRestored),this._blendOperationMap={0:this._gl.ZERO,1:this._gl.ONE,2:this._gl.SRC_COLOR,3:this._gl.DST_COLOR,4:this._gl.ONE_MINUS_SRC_COLOR,5:this._gl.ONE_MINUS_DST_COLOR,6:this._gl.SRC_ALPHA,7:this._gl.DST_ALPHA,8:this._gl.ONE_MINUS_SRC_ALPHA,9:this._gl.ONE_MINUS_DST_ALPHA,10:this._gl.CONSTANT_COLOR,11:this._gl.ONE_MINUS_CONSTANT_COLOR}}get widthInPixels(){return this._width}get heightInPixels(){return this._height}testContextLoss(){this.handleWebglContextRestored()}get gl(){return this._gl}get generation(){return this._generation}addContextResetHandler(l){Ii(this._contextResetHandlers,l)}removeContextResetHandler(l){zi(this._contextResetHandlers,l)}get currentRenderTarget(){return this._currentRenderTarget}beginFrame(){this.setRenderTarget(null)}endFrame(){}setBlendState(l,v){this._blendOperations=n._packBlendModes(l,v)}setViewport(l,v,f,b){(this._currentRenderTarget!=null?this._currentRenderTarget.viewport:this._defaultViewport).set(l,v,f,b)}get viewport(){return this._currentRenderTarget!=null?this._currentRenderTarget.viewport:this._defaultViewport}get renderTargetWidthInPixels(){return this._currentRenderTarget!=null?this._currentRenderTarget.viewport.width:this._width}get renderTargetHeightInPixels(){return this._currentRenderTarget!=null?this._currentRenderTarget.viewport.height:this._height}draw(l,v,f){this._updateRenderTargetAndViewport(),c.from(v).prepare(),d.from(f).prepare(),this._updateFormat(v.format),this._updateBlendState(),this._gl.drawArrays(l==0?this._gl.TRIANGLES:this._gl.TRIANGLE_STRIP,0,Math.floor(f.byteCount/v.format.stride)),this._forceStateUpdate=!1}resize(l,v,f,b){let S=this._gl.canvas,w=S.getBoundingClientRect();if(this._width===l&&this._height===v&&w.width===f&&w.height===b)return;let T=S.style;S.width=l,S.height=v,T.width=`${f}px`,T.height=`${b}px`,this.setViewport(0,0,l,v),this._width=l,this._height=v,this.resizeEventHandlers.forEach(D=>D())}clear(l){this._updateRenderTargetAndViewport(),this._updateBlendState(),l.equals(this._currentClearColor)||(this._gl.clearColor(l.redF,l.greenF,l.blueF,l.alphaF),this._currentClearColor=l),this._gl.clear(this._gl.COLOR_BUFFER_BIT)}setRenderTarget(l){this._currentRenderTarget=g.from(l)}createMaterial(l,v,f){let b=new c(this,l,v,f);return b.program,b}createVertexBuffer(l){return L(l>0&&l%4==0),new d(this,l)}createTexture(l,v,f,b){return new u(this,l,v,f,b)}createRenderTarget(l){return new g(this,u.from(l))}getANGLE_instanced_arrays(){if(this.ANGLE_instanced_arrays_generation!==this._generation&&(this.ANGLE_instanced_arrays=null),!this.ANGLE_instanced_arrays&&(this.ANGLE_instanced_arrays=this.gl.getExtension("ANGLE_instanced_arrays"),!this.ANGLE_instanced_arrays))throw new Error("Failed to get extension ANGLE_instanced_arrays");return this.ANGLE_instanced_arrays}_updateRenderTargetAndViewport(){let l=this._currentRenderTarget,v=l!=null?l.viewport:this._defaultViewport,f=this._gl;(this._forceStateUpdate||this._oldRenderTarget!=l)&&(f.bindFramebuffer(f.FRAMEBUFFER,l?l.framebuffer:null),this._oldRenderTarget=l),(this._forceStateUpdate||!this._oldViewport.equals(v))&&(f.viewport(v.x,this.renderTargetHeightInPixels-v.y-v.height,v.width,v.height),this._oldViewport.set(v.x,v.y,v.width,v.height))}_updateBlendState(){if(this._forceStateUpdate||this._oldBlendOperations!=this._blendOperations){let l=this._gl,v=this._blendOperations,f=this._oldBlendOperations,b=v&15,S=v>>4;L(b in this._blendOperationMap),L(S in this._blendOperationMap),v==n.COPY_BLEND_OPERATIONS?l.disable(l.BLEND):((this._forceStateUpdate||f==n.COPY_BLEND_OPERATIONS)&&l.enable(l.BLEND),l.blendFunc(this._blendOperationMap[b],this._blendOperationMap[S])),this._oldBlendOperations=v}}_updateFormat(l){let v=this._gl,f=l.attributes,b=f.length;for(let S=0;S<b;S++){let w=f[S],T=w.type==1;v.vertexAttribPointer(S,w.count,T?v.UNSIGNED_BYTE:v.FLOAT,T,l.stride,w.byteOffset)}for(;this._attributeCount<b;)v.enableVertexAttribArray(this._attributeCount),this._attributeCount++;for(;this._attributeCount>b;)this._attributeCount--,v.disableVertexAttribArray(this._attributeCount);this._attributeCount=b}getWebGLInfo(){let l=this.gl.getExtension("WEBGL_debug_renderer_info"),v=l?this.gl.getParameter(l.UNMASKED_RENDERER_WEBGL):null,f=l?this.gl.getParameter(l.UNMASKED_VENDOR_WEBGL):null,b=this.gl.getParameter(this.gl.VERSION);return{renderer:v,vendor:f,version:b}}static from(l){return L(l==null||l instanceof n),l}static _packBlendModes(l,v){return l|v<<4}static{this.COPY_BLEND_OPERATIONS=n._packBlendModes(1,0)}}j.Context=n;class t{constructor(_,l,v=0,f=null,b=!0){this._material=_;this._name=l;this._generation=v;this._location=f;this._isDirty=b}get location(){let _=n.from(this._material.context);if(this._generation!=_.generation&&(this._location=_.gl.getUniformLocation(this._material.program,this._name),this._generation=_.generation,!kn)){let l=this._material.program,v=_.gl;for(let f=0,b=v.getProgramParameter(l,v.ACTIVE_UNIFORMS);f<b;f++){let S=v.getActiveUniform(l,f);if(S&&S.name==this._name)switch(L(S.size==1),S.type){case v.FLOAT:{L(this instanceof e);break}case v.FLOAT_MAT3:{L(this instanceof s);break}case v.FLOAT_VEC2:{L(this instanceof r);break}case v.FLOAT_VEC3:{L(this instanceof o);break}case v.FLOAT_VEC4:{L(this instanceof i);break}case v.INT:{L(this instanceof a);break}case v.SAMPLER_2D:{L(this instanceof h);break}default:L(!1)}}}if(!this._location)throw new Error("Failed to get uniform location");return this._location}}class e extends t{constructor(){super(...arguments);this._x=0}set(l){l!=this._x&&(this._x=l,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform1f(this.location,this._x),this._isDirty=!1)}}class a extends t{constructor(){super(...arguments);this._x=0}set(l){l!=this._x&&(this._x=l,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform1i(this.location,this._x),this._isDirty=!1)}}class r extends t{constructor(){super(...arguments);this._x=0;this._y=0}set(l,v){(l!=this._x||v!=this._y)&&(this._x=l,this._y=v,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform2f(this.location,this._x,this._y),this._isDirty=!1)}}class o extends t{constructor(){super(...arguments);this._x=0;this._y=0;this._z=0}set(l,v,f){(l!=this._x||v!=this._y||f!=this._z)&&(this._x=l,this._y=v,this._z=f,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform3f(this.location,this._x,this._y,this._z),this._isDirty=!1)}}class i extends t{constructor(){super(...arguments);this._x=0;this._y=0;this._z=0;this._w=0}set(l,v,f,b){(l!=this._x||v!=this._y||f!=this._z||b!=this._w)&&(this._x=l,this._y=v,this._z=f,this._w=b,this._isDirty=!0)}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniform4f(this.location,this._x,this._y,this._z,this._w),this._isDirty=!1)}}class s extends t{constructor(){super(...arguments);this._values=[1,0,0,0,1,0,0,0,1]}set(l,v,f,b,S,w,T,D,ne){s._cachedValues[0]=l,s._cachedValues[1]=b,s._cachedValues[2]=T,s._cachedValues[3]=v,s._cachedValues[4]=S,s._cachedValues[5]=D,s._cachedValues[6]=f,s._cachedValues[7]=w,s._cachedValues[8]=ne;for(let R=0;R<9;R++)if(s._cachedValues[R]!=this._values[R]){let x=this._values;this._values=s._cachedValues,s._cachedValues=x,this._isDirty=!0;break}}prepare(){let l=n.from(this._material.context);(this._generation!=l.generation||this._isDirty)&&(l.gl.uniformMatrix3fv(this.location,!1,this._values),this._isDirty=!1)}static{this._cachedValues=[1,0,0,0,1,0,0,0,1]}}class h extends t{constructor(){super(...arguments);this._texture=null;this._index=-1}set(l,v){(this._texture!=l||this._index!=v)&&(this._texture=u.from(l),this._index=v,this._isDirty=!0)}prepare(){let l=n.from(this._material.context),v=l.gl;L(this._texture==null||l.currentRenderTarget==null||this._texture!=l.currentRenderTarget.texture),(this._generation!=l.generation||this._isDirty)&&(v.uniform1i(this.location,this._index),this._isDirty=!1),v.activeTexture(Fi(v,this._index)),v.bindTexture(v.TEXTURE_2D,this._texture!=null&&this._texture.width>0&&this._texture.height>0?this._texture.texture:null)}}class c{constructor(_,l,v,f,b={},S=[],w=0,T=null){this._context=_;this._format=l;this._vertexSource=v;this._fragmentSource=f;this._uniformsMap=b;this._uniformsList=S;this._generation=w;this._program=T}get context(){return this._context}get format(){return this._format}get vertexSource(){return this._vertexSource}get fragmentSource(){return this._fragmentSource}setUniformFloat(_,l){let v=this._uniformsMap[_]||null;v==null&&(v=new e(this,_),this._uniformsMap[_]=v,this._uniformsList.push(v)),L(v instanceof e),v.set(l)}setUniformInt(_,l){let v=this._uniformsMap[_]||null;v==null&&(v=new a(this,_),this._uniformsMap[_]=v,this._uniformsList.push(v)),L(v instanceof a),v.set(l)}setUniformVec2(_,l,v){let f=this._uniformsMap[_]||null;f==null&&(f=new r(this,_),this._uniformsMap[_]=f,this._uniformsList.push(f)),L(f instanceof r),f.set(l,v)}setUniformVec3(_,l,v,f){let b=this._uniformsMap[_]||null;b==null&&(b=new o(this,_),this._uniformsMap[_]=b,this._uniformsList.push(b)),L(b instanceof o),b.set(l,v,f)}setUniformVec4(_,l,v,f,b){let S=this._uniformsMap[_]||null;S==null&&(S=new i(this,_),this._uniformsMap[_]=S,this._uniformsList.push(S)),L(S instanceof i),S.set(l,v,f,b)}setUniformMat3(_,l,v,f,b,S,w,T,D,ne){let R=this._uniformsMap[_]||null;R==null&&(R=new s(this,_),this._uniformsMap[_]=R,this._uniformsList.push(R)),L(R instanceof s),R.set(l,v,f,b,S,w,T,D,ne)}setUniformSampler(_,l,v){let f=this._uniformsMap[_]||null;f==null&&(f=new h(this,_),this._uniformsMap[_]=f,this._uniformsList.push(f)),L(f instanceof h),f.set(l,v)}get program(){let _=this._context.gl;if(this._generation!=this._context.generation){this._program=_.createProgram(),this._compileShader(_,_.VERTEX_SHADER,this.vertexSource),this._compileShader(_,_.FRAGMENT_SHADER,this.fragmentSource);let l=this.format.attributes;for(let v=0;v<l.length;v++)_.bindAttribLocation(this._program,v,l[v].name);if(_.linkProgram(this._program),!_.getProgramParameter(this._program,_.LINK_STATUS))throw new Error(`${_.getProgramInfoLog(this._program)}`);if(this._generation=this._context.generation,!kn)for(let v of l)for(let f=0,b=_.getProgramParameter(this.program,_.ACTIVE_ATTRIBUTES);f<b;f++){let S=_.getActiveAttrib(this.program,f);if(S&&S.name==v.name)switch(L(S.size==1),v.count){case 1:{L(S.type==_.FLOAT);break}case 2:{L(S.type==_.FLOAT_VEC2);break}case 3:{L(S.type==_.FLOAT_VEC3);break}case 4:{L(S.type==_.FLOAT_VEC4);break}default:L(!1)}}}return this._program}prepare(){this._context.gl.useProgram(this.program);for(let _ of this._uniformsList)_.prepare()}_compileShader(_,l,v){let f=_.createShader(l);if(!f)throw new Error("Failed to create shader");if(_.shaderSource(f,v),_.compileShader(f),!_.getShaderParameter(f,_.COMPILE_STATUS))throw new Error(`${_.getShaderInfoLog(f)}`);if(!this._program)throw new Error("Tried to attach shader before program was created");_.attachShader(this._program,f)}static from(_){return L(_==null||_ instanceof c),_}}class d extends B.VertexBuffer{constructor(l,v){super();this._generation=0;this._buffer=null;this._bytes=null;this._isDirty=!0;this._dirtyMin=d.INT_MAX;this._dirtyMax=0;this._totalMin=d.INT_MAX;this._totalMax=0;this._byteCount=0;this._context=l,this._byteCount=v,this._bytes=new Uint8Array(v)}get context(){return this._context}get byteCount(){return this._byteCount}move(l,v,f){L(f>=0),L(0<=l&&l+f<=this._byteCount),L(0<=v&&v+f<=this._byteCount),this._bytes&&l!=v&&f!=0&&(this._bytes.set(this._bytes.subarray(l,this._byteCount),v),this._growDirtyRegion(Math.min(l,v),Math.max(l,v)+f))}upload(l,v=0){L(0<=v&&v+l.length<=this._byteCount),L(this._bytes!=null),this._bytes.set(l,v),this._growDirtyRegion(v,v+l.length)}free(){this._buffer&&this._context.gl.deleteBuffer(this._buffer),this._generation=0}prepare(){let l=this._context.gl;this._generation!==this._context.generation&&(this._buffer=l.createBuffer(),this._generation=this._context.generation,this._isDirty=!0),l.bindBuffer(l.ARRAY_BUFFER,this._buffer),this._isDirty&&(l.bufferData(l.ARRAY_BUFFER,this._byteCount,l.DYNAMIC_DRAW),this._dirtyMin=this._totalMin,this._dirtyMax=this._totalMax,this._isDirty=!1),this._dirtyMin<this._dirtyMax&&(l.bufferSubData(l.ARRAY_BUFFER,this._dirtyMin,this._bytes.subarray(this._dirtyMin,this._dirtyMax)),this._dirtyMin=d.INT_MAX,this._dirtyMax=0)}_growDirtyRegion(l,v){this._dirtyMin=Math.min(this._dirtyMin,l),this._dirtyMax=Math.max(this._dirtyMax,v),this._totalMin=Math.min(this._totalMin,l),this._totalMax=Math.max(this._totalMax,v)}static{this.INT_MAX=2147483647}static from(l){return L(l==null||l instanceof d),l}}class u{constructor(_,l,v,f,b=null,S=null,w=0,T=!0,D=!0){this._context=_;this._format=l;this._width=v;this._height=f;this._pixels=b;this._texture=S;this._generation=w;this._isFormatDirty=T;this._isContentDirty=D}get context(){return this._context}get format(){return this._format}get width(){return this._width}get height(){return this._height}resize(_,l,v=null){this._width=_,this._height=l,this._pixels=v,this._isContentDirty=!0}setFormat(_){this._format!=_&&(this._format=_,this._isFormatDirty=!0)}get texture(){let _=this._context.gl;return this._generation!=this._context.generation&&(this._texture=_.createTexture(),this._generation=this._context.generation,this._isFormatDirty=!0,this._isContentDirty=!0),this._isFormatDirty&&(_.bindTexture(_.TEXTURE_2D,this._texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,this.format.magFilter==0?_.NEAREST:_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.format.minFilter==0?_.NEAREST:_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,this.format.wrap==0?_.REPEAT:_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,this.format.wrap==0?_.REPEAT:_.CLAMP_TO_EDGE),this._isFormatDirty=!1),this._isContentDirty&&(_.bindTexture(_.TEXTURE_2D,this._texture),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,this._width,this._height,0,_.RGBA,_.UNSIGNED_BYTE,this._pixels),this._isContentDirty=!1),this._texture}free(){this.texture&&(this._context.gl.deleteTexture(this.texture),this._generation=0)}static from(_){return L(_==null||_ instanceof u),_}}class g{constructor(_,l,v=null,f=0,b=!0,S=new B.Rect){this._context=_;this._texture=l;this._framebuffer=v;this._generation=f;this._isDirty=b;this._viewport=S}get context(){return this._context}get texture(){return this._texture}get viewport(){return this._viewport}setColor(_){this._texture!=_&&(this._texture=u.from(_),this._isDirty=!0)}get framebuffer(){let _=this._context.gl,l=this._texture.texture;return this._generation!=this._context.generation&&(this._framebuffer=_.createFramebuffer(),this._generation=this._context.generation,this._isDirty=!0),this._isDirty&&(_.bindFramebuffer(_.FRAMEBUFFER,this._framebuffer),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,l,0),L(_.checkFramebufferStatus(_.FRAMEBUFFER)==_.FRAMEBUFFER_COMPLETE),this._isDirty=!1),this._framebuffer}free(){this._framebuffer&&(this._context.gl.deleteFramebuffer(this._framebuffer),this._generation=0)}static from(_){return L(_==null||_ instanceof g),_}}})(Nn||={});function de(n,t,e){let{m00:a,m01:r,m02:o,m10:i,m11:s,m12:h}=e;n.setUniformMat3(t,a,r,o,i,s,h,0,0,1)}function An(n,t,e){n.setUniformVec2(t,e.x,e.y)}function ut(n,t,e){n.setRenderTarget(t),n.setViewport(0,0,t.texture.width,t.texture.height),e(),n.setRenderTarget(null)}var yt=new B.VertexFormat;yt.add("configSpacePos",B.AttributeType.FLOAT,2);yt.add("color",B.AttributeType.FLOAT,3);var Di=`
  uniform mat3 configSpaceToNDC;

  attribute vec2 configSpacePos;
  attribute vec3 color;
  varying vec3 vColor;

  void main() {
    vColor = color;
    vec2 position = (configSpaceToNDC * vec3(configSpacePos, 1)).xy;
    gl_Position = vec4(position, 1, 1);
  }
`,Pi=`
  precision mediump float;
  varying vec3 vColor;

  void main() {
    gl_FragColor = vec4(vColor.rgb, 1);
  }
`,Ee=class{constructor(t){this.gl=t;this.rects=[];this.colors=[];this.buffer=null}getRectCount(){return this.rects.length}getBuffer(){if(this.buffer)return this.buffer;let t=[[0,0],[1,0],[0,1],[1,0],[0,1],[1,1]],e=new Uint8Array(yt.stride*t.length*this.rects.length),a=new Float32Array(e.buffer),r=0;for(let o=0;o<this.rects.length;o++){let i=this.rects[o],s=this.colors[o];for(let h of t)a[r++]=i.origin.x+h[0]*i.size.x,a[r++]=i.origin.y+h[1]*i.size.y,a[r++]=s.r,a[r++]=s.g,a[r++]=s.b}if(r!==a.length)throw new Error("Buffer expected to be full but wasn't");return this.buffer=this.gl.createVertexBuffer(e.length),this.buffer.upload(e),this.buffer}addRect(t,e){this.rects.push(t),this.colors.push(e),this.buffer&&(this.buffer.free(),this.buffer=null)}free(){this.buffer&&(this.buffer.free(),this.buffer=null)}},ft=class{constructor(t){this.gl=t;this.material=t.createMaterial(yt,Di,Pi)}render(t){de(this.material,"configSpaceToNDC",(()=>{let e=H.betweenRects(t.configSpaceSrcRect,t.physicalSpaceDstRect),a=new m(this.gl.viewport.width,this.gl.viewport.height);return H.withTranslation(new m(-1,1)).times(H.withScale(new m(2,-2).dividedByPointwise(a))).times(e)})()),this.gl.setUnpremultipliedBlendState(),this.gl.draw(B.Primitive.TRIANGLES,this.material,t.batch.getBuffer())}};var O=class n{constructor(t=0,e=0,a=0,r=1){this.r=t;this.g=e;this.b=a;this.a=r}static fromLumaChromaHue(t,e,a){let r=a/60,o=e*(1-Math.abs(r%2-1)),[i,s,h]=r<1?[e,o,0]:r<2?[o,e,0]:r<3?[0,e,o]:r<4?[0,o,e]:r<5?[o,0,e]:[e,0,o],c=t-(.3*i+.59*s+.11*h);return new n(X(i+c,0,1),X(s+c,0,1),X(h+c,0,1),1)}static fromCSSHex(t){if(t.length!==7||t[0]!=="#")throw new Error(`Invalid color input ${t}`);let e=parseInt(t.substr(1,2),16)/255,a=parseInt(t.substr(3,2),16)/255,r=parseInt(t.substr(5,2),16)/255;if(e<0||e>1||a<0||a>1||r<0||r>1)throw new Error(`Invalid color input ${t}`);return new n(e,a,r)}withAlpha(t){return new n(this.r,this.g,this.b,t)}toCSS(){return`rgba(${(255*this.r).toFixed()}, ${(255*this.g).toFixed()}, ${(255*this.b).toFixed()}, ${this.a.toFixed(2)})`}};var gt=class{constructor(t,e,a){this.gl=t;this.rectangleBatchRenderer=e;this.textureRenderer=a;this.texture=t.createTexture(B.TextureFormat.NEAREST_CLAMP,4096,4096),this.renderTarget=t.createRenderTarget(this.texture),this.rowCache=new mt(this.texture.height),this.clearLineBatch=new Ee(t),this.clearLineBatch.addRect(k.unit,new O(0,0,0,0)),t.addContextResetHandler(()=>{this.rowCache.clear()})}has(t){return this.rowCache.has(t)}getResolution(){return this.texture.width}getCapacity(){return this.texture.height}allocateLine(t){if(this.rowCache.getSize()<this.rowCache.getCapacity()){let e=this.rowCache.getSize();return this.rowCache.insert(t,e),e}else{let[,e]=this.rowCache.removeLRU();return this.rowCache.insert(t,e),e}}writeToAtlasIfNeeded(t,e){ut(this.gl,this.renderTarget,()=>{for(let a of t){let r=this.rowCache.get(a);if(r!=null)continue;r=this.allocateLine(a);let o=new k(new m(0,r),new m(this.texture.width,1));this.rectangleBatchRenderer.render({batch:this.clearLineBatch,configSpaceSrcRect:k.unit,physicalSpaceDstRect:o}),e(o,a)}})}renderViaAtlas(t,e){let a=this.rowCache.get(t);if(a==null)return!1;let r=new k(new m(0,a),new m(this.texture.width,1));return this.textureRenderer.render({texture:this.texture,srcRect:r,dstRect:e}),!0}};var Mi=`
  uniform mat3 uvTransform;
  uniform mat3 positionTransform;

  attribute vec2 position;
  attribute vec2 uv;
  varying vec2 vUv;

  void main() {
    vUv = (uvTransform * vec3(uv, 1)).xy;
    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);
  }
`,Ji=`
  precision mediump float;

  varying vec2 vUv;
  uniform sampler2D texture;

  void main() {
   gl_FragColor = texture2D(texture, vUv);
  }
`,jt=class{constructor(t){this.gl=t;let e=new B.VertexFormat;e.add("position",B.AttributeType.FLOAT,2),e.add("uv",B.AttributeType.FLOAT,2);let a=[{pos:[-1,1],uv:[0,1]},{pos:[1,1],uv:[1,1]},{pos:[-1,-1],uv:[0,0]},{pos:[1,-1],uv:[1,0]}],r=[];for(let o of a)r.push(o.pos[0]),r.push(o.pos[1]),r.push(o.uv[0]),r.push(o.uv[1]);this.buffer=t.createVertexBuffer(e.stride*a.length),this.buffer.upload(new Uint8Array(new Float32Array(r).buffer)),this.material=t.createMaterial(e,Mi,Ji)}render(t){this.material.setUniformSampler("texture",t.texture,0),de(this.material,"uvTransform",(()=>{let{srcRect:e,texture:a}=t,o=H.withTranslation(new m(0,1)).times(H.withScale(new m(1,-1))).times(H.betweenRects(new k(m.zero,new m(a.width,a.height)),k.unit)).transformRect(e);return H.betweenRects(k.unit,o)})()),de(this.material,"positionTransform",(()=>{let{dstRect:e}=t,{viewport:a}=this.gl,r=new m(a.width,a.height),i=H.withScale(new m(1,-1)).times(H.betweenRects(new k(m.zero,r),k.NDC)).transformRect(e);return H.betweenRects(k.NDC,i)})()),this.gl.setUnpremultipliedBlendState(),this.gl.draw(B.Primitive.TRIANGLE_STRIP,this.material,this.buffer)}};var En=new B.VertexFormat;En.add("position",B.AttributeType.FLOAT,2);var Vi=`
  attribute vec2 position;

  void main() {
    gl_Position = vec4(position, 0, 1);
  }
`,Oi=n=>{let{r:t,g:e,b:a}=O.fromCSSHex(n.fgSecondaryColor),r=`${t.toFixed(1)}, ${e.toFixed(1)}, ${a.toFixed(1)}`;return`
    precision mediump float;

    uniform mat3 configSpaceToPhysicalViewSpace;
    uniform vec2 physicalSize;
    uniform vec2 physicalOrigin;
    uniform vec2 configSpaceViewportOrigin;
    uniform vec2 configSpaceViewportSize;
    uniform float framebufferHeight;

    void main() {
      vec2 origin = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportOrigin, 1.0)).xy;
      vec2 size = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportSize, 0.0)).xy;

      vec2 halfSize = physicalSize / 2.0;

      float borderWidth = 2.0;

      origin = floor(origin * halfSize) / halfSize + borderWidth * vec2(1.0, 1.0);
      size = floor(size * halfSize) / halfSize - 2.0 * borderWidth * vec2(1.0, 1.0);

      vec2 coord = gl_FragCoord.xy;
      coord.x = coord.x - physicalOrigin.x;
      coord.y = framebufferHeight - coord.y - physicalOrigin.y;
      vec2 clamped = clamp(coord, origin, origin + size);
      vec2 gap = clamped - coord;
      float maxdist = max(abs(gap.x), abs(gap.y));

      // TOOD(jlfwong): Could probably optimize this to use mix somehow.
      if (maxdist == 0.0) {
        // Inside viewport rectangle
        gl_FragColor = vec4(0, 0, 0, 0);
      } else if (maxdist < borderWidth) {
        // Inside viewport rectangle at border
        gl_FragColor = vec4(${r}, 0.8);
      } else {
        // Outside viewport rectangle
        gl_FragColor = vec4(${r}, 0.5);
      }
    }
  `},Ct=class{constructor(t,e){this.gl=t;let a=[[-1,1],[1,1],[-1,-1],[1,-1]],r=[];for(let o of a)r.push(o[0]),r.push(o[1]);this.buffer=t.createVertexBuffer(En.stride*a.length),this.buffer.upload(new Uint8Array(new Float32Array(r).buffer)),this.material=t.createMaterial(En,Vi,Oi(e))}render(t){de(this.material,"configSpaceToPhysicalViewSpace",t.configSpaceToPhysicalViewSpace),An(this.material,"configSpaceViewportOrigin",t.configSpaceViewportRect.origin),An(this.material,"configSpaceViewportSize",t.configSpaceViewportRect.size);let e=this.gl.viewport;this.material.setUniformVec2("physicalOrigin",e.x,e.y),this.material.setUniformVec2("physicalSize",e.width,e.height),this.material.setUniformFloat("framebufferHeight",this.gl.renderTargetHeightInPixels),this.gl.setBlendState(B.BlendOperation.SOURCE_ALPHA,B.BlendOperation.INVERSE_SOURCE_ALPHA),this.gl.draw(B.Primitive.TRIANGLE_STRIP,this.material,this.buffer)}};var bt=new B.VertexFormat;bt.add("position",B.AttributeType.FLOAT,2);bt.add("uv",B.AttributeType.FLOAT,2);var Ki=`
  uniform mat3 uvTransform;
  uniform mat3 positionTransform;

  attribute vec2 position;
  attribute vec2 uv;
  varying vec2 vUv;

  void main() {
    vUv = (uvTransform * vec3(uv, 1)).xy;
    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);
  }
`,Ui=n=>`
  precision mediump float;

  uniform vec2 uvSpacePixelSize;
  uniform float renderOutlines;

  varying vec2 vUv;
  uniform sampler2D colorTexture;

  // https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue
  vec3 hcl2rgb(float H, float C, float L) {
    float hPrime = H / 60.0;
    float X = C * (1.0 - abs(mod(hPrime, 2.0) - 1.0));
    vec3 RGB =
      hPrime < 1.0 ? vec3(C, X, 0) :
      hPrime < 2.0 ? vec3(X, C, 0) :
      hPrime < 3.0 ? vec3(0, C, X) :
      hPrime < 4.0 ? vec3(0, X, C) :
      hPrime < 5.0 ? vec3(X, 0, C) :
      vec3(C, 0, X);

    float m = L - dot(RGB, vec3(0.30, 0.59, 0.11));
    return RGB + vec3(m, m, m);
  }

  float triangle(float x) {
    return 2.0 * abs(fract(x) - 0.5) - 1.0;
  }

  ${n}

  void main() {
    vec4 here = texture2D(colorTexture, vUv);

    if (here.z == 0.0) {
      // Background color
      gl_FragColor = vec4(0, 0, 0, 0);
      return;
    }

    // Sample the 4 surrounding pixels in the depth texture to determine
    // if we should draw a boundary here or not.
    vec4 N = texture2D(colorTexture, vUv + vec2(0, uvSpacePixelSize.y));
    vec4 E = texture2D(colorTexture, vUv + vec2(uvSpacePixelSize.x, 0));
    vec4 S = texture2D(colorTexture, vUv + vec2(0, -uvSpacePixelSize.y));
    vec4 W = texture2D(colorTexture, vUv + vec2(-uvSpacePixelSize.x, 0));

    // NOTE: For outline checks, we intentionally check both the right
    // and the left to determine if we're an edge. If a rectangle is a single
    // pixel wide, we don't want to render it as an outline, so this method
    // of checking ensures that we don't outline single physical-space
    // pixel width rectangles.
    if (
      renderOutlines > 0.0 &&
      (
        here.y == N.y && here.y != S.y || // Top edge
        here.y == S.y && here.y != N.y || // Bottom edge
        here.x == E.x && here.x != W.x || // Left edge
        here.x == W.x && here.x != E.x
      )
    ) {
      // We're on an edge! Draw transparent.
      gl_FragColor = vec4(0, 0, 0, 0);
    } else {
      // Not on an edge. Draw the appropriate color.
      gl_FragColor = vec4(colorForBucket(here.z), here.a);
    }
  }
`,xt=class{constructor(t,e){this.gl=t;let a=[{pos:[-1,1],uv:[0,1]},{pos:[1,1],uv:[1,1]},{pos:[-1,-1],uv:[0,0]},{pos:[1,-1],uv:[1,0]}],r=[];for(let o of a)r.push(o.pos[0]),r.push(o.pos[1]),r.push(o.uv[0]),r.push(o.uv[1]);this.buffer=t.createVertexBuffer(bt.stride*a.length),this.buffer.uploadFloats(r),this.material=t.createMaterial(bt,Ki,Ui(e.colorForBucketGLSL))}render(t){let{srcRect:e,rectInfoTexture:a}=t,o=H.withTranslation(new m(0,1)).times(H.withScale(new m(1,-1))).times(H.betweenRects(new k(m.zero,new m(a.width,a.height)),k.unit)).transformRect(e),i=H.betweenRects(k.unit,o),{dstRect:s}=t,h=new m(this.gl.viewport.width,this.gl.viewport.height),d=H.withScale(new m(1,-1)).times(H.betweenRects(new k(m.zero,h),k.NDC)).transformRect(s),u=H.betweenRects(k.NDC,d),g=m.unit.dividedByPointwise(new m(t.rectInfoTexture.width,t.rectInfoTexture.height));this.material.setUniformSampler("colorTexture",t.rectInfoTexture,0),de(this.material,"uvTransform",i),this.material.setUniformFloat("renderOutlines",t.renderOutlines?1:0),this.material.setUniformVec2("uvSpacePixelSize",g.x,g.y),de(this.material,"positionTransform",u),this.gl.setUnpremultipliedBlendState(),this.gl.draw(B.Primitive.TRIANGLE_STRIP,this.material,this.buffer)}};var St=class{constructor(t,e){this.animationFrameRequest=null;this.beforeFrameHandlers=new Set;this.onBeforeFrame=()=>{this.animationFrameRequest=null,this.gl.setViewport(0,0,this.gl.renderTargetWidthInPixels,this.gl.renderTargetHeightInPixels);let t=O.fromCSSHex(this.theme.bgPrimaryColor);this.gl.clear(new B.Color(t.r,t.g,t.b,t.a));for(let e of this.beforeFrameHandlers)e()};this.gl=new Nn.Context(t),this.rectangleBatchRenderer=new ft(this.gl),this.textureRenderer=new jt(this.gl),this.viewportRectangleRenderer=new Ct(this.gl,e),this.flamechartColorPassRenderer=new xt(this.gl,e),this.theme=e,this.gl.addAfterResizeEventHandler(this.onBeforeFrame);let a=this.gl.getWebGLInfo();a&&console.log(`WebGL initialized. renderer: ${a.renderer}, vendor: ${a.vendor}, version: ${a.version}`),window.testContextLoss=()=>{this.gl.testContextLoss()}}addBeforeFrameHandler(t){this.beforeFrameHandlers.add(t)}removeBeforeFrameHandler(t){this.beforeFrameHandlers.delete(t)}requestFrame(){this.animationFrameRequest||(this.animationFrameRequest=requestAnimationFrame(this.onBeforeFrame))}setViewport(t,e){let{origin:a,size:r}=t,o=this.gl.viewport;this.gl.setViewport(a.x,a.y,r.x,r.y),e();let{x:i,y:s,width:h,height:c}=o;this.gl.setViewport(i,s,h,c)}renderBehind(t,e){let a=t.getBoundingClientRect(),r=new k(new m(a.left*window.devicePixelRatio,a.top*window.devicePixelRatio),new m(a.width*window.devicePixelRatio,a.height*window.devicePixelRatio));this.setViewport(r,e)}};var Re=Fe(n=>t=>n.get(t.key)||0),ye=ae(({theme:n,frameToColorBucket:t})=>{let e=Re(t);return a=>{let r=e(a)/255;return n.colorForBucket(r).toCSS()}}),ge=ae(({theme:n,canvas:t})=>new St(t,n)),Ia=Fe(n=>new gt(n.gl,n.rectangleBatchRenderer,n.textureRenderer)),za=ae(({profile:n,flattenRecursion:t})=>t?n.getProfileWithRecursionFlattened():n),je=Fe(n=>{let t=[];n.forEachFrame(o=>t.push(o));function e(o){return(o.file||"")+o.name}function a(o,i){return e(o)>e(i)?1:-1}t.sort(a);let r=new Map;for(let o=0;o<t.length;o++)r.set(t[o].key,Math.floor(255*o/t.length));return r});var De,ie,Fa,Qe=0,Tn=[],Da=A.__r,Pa=A.diffed,Ma=A.__c,Ja=A.unmount;function et(n,t){A.__h&&A.__h(ie,n,Qe||t),Qe=0;var e=ie.__H||(ie.__H={__:[],__h:[]});return n>=e.__.length&&e.__.push({}),e.__[n]}function te(n){return Qe=1,Va(Oa,n)}function Va(n,t,e){var a=et(De++,2);return a.__c||(a.__c=ie,a.__=[e?e(t):Oa(void 0,t),function(r){var o=n(a.__[0],r);a.__[0]!==o&&(a.__[0]=o,a.__c.setState({}))}]),a.__}function re(n,t){var e=et(De++,3);!A.__s&&In(e.__H,t)&&(e.__=n,e.__H=t,ie.__H.__h.push(e))}function Bn(n,t){var e=et(De++,4);!A.__s&&In(e.__H,t)&&(e.__=n,e.__H=t,ie.__h.push(e))}function ke(n){return Qe=5,F(function(){return{current:n}},[])}function F(n,t){var e=et(De++,7);return In(e.__H,t)?(e.__H=t,e.__h=n,e.__=n()):e.__}function E(n,t){return Qe=8,F(function(){return n},t)}function le(n){var t=ie.context[n.__c],e=et(De++,9);return e.__c=n,t?(e.__==null&&(e.__=!0,t.sub(ie)),t.props.value):n.__}function $i(){Tn.some(function(n){if(n.__P)try{n.__H.__h.forEach(Hn),n.__H.__h.forEach(Ln),n.__H.__h=[]}catch(t){return n.__H.__h=[],A.__e(t,n.__v),!0}}),Tn=[]}function Hn(n){n.t&&n.t()}function Ln(n){var t=n.__();typeof t=="function"&&(n.t=t)}function In(n,t){return!n||t.some(function(e,a){return e!==n[a]})}function Oa(n,t){return typeof t=="function"?t(n):t}A.__r=function(n){Da&&Da(n),De=0,(ie=n.__c).__H&&(ie.__H.__h.forEach(Hn),ie.__H.__h.forEach(Ln),ie.__H.__h=[])},A.diffed=function(n){Pa&&Pa(n);var t=n.__c;if(t){var e=t.__H;e&&e.__h.length&&(Tn.push(t)!==1&&Fa===A.requestAnimationFrame||((Fa=A.requestAnimationFrame)||function(a){var r,o=function(){clearTimeout(i),cancelAnimationFrame(r),setTimeout(a)},i=setTimeout(o,100);typeof window<"u"&&(r=requestAnimationFrame(o))})($i))}},A.__c=function(n,t){t.some(function(e){try{e.__h.forEach(Hn),e.__h=e.__h.filter(function(a){return!a.__||Ln(a)})}catch(a){t.some(function(r){r.__h&&(r.__h=[])}),t=[],A.__e(a,e.__v)}}),Ma&&Ma(n,t)},A.unmount=function(n){Ja&&Ja(n);var t=n.__c;if(t){var e=t.__H;if(e)try{e.__.forEach(function(a){return a.t&&a.t()})}catch(a){A.__e(a,t.__v)}}};function Ya(n,t){for(var e in t)n[e]=t[e];return n}function Fn(n,t){for(var e in n)if(e!=="__source"&&!(e in t))return!0;for(var a in t)if(a!=="__source"&&n[a]!==t[a])return!0;return!1}var oh=function(n){var t,e;function a(r){var o;return(o=n.call(this,r)||this).isPureReactComponent=!0,o}return e=n,(t=a).prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e,a.prototype.shouldComponentUpdate=function(r,o){return Fn(this.props,r)||Fn(this.state,o)},a}(q);function K(n,t){function e(r){var o=this.props.ref,i=o==r.ref;return!i&&o&&(o.call?o(null):o.current=null),t?!t(this.props,r)||!i:Fn(this.props,r)}function a(r){return this.shouldComponentUpdate=e,p(n,Ya({},r))}return a.prototype.isReactComponent=!0,a.displayName="Memo("+(n.displayName||n.name)+")",a.t=!0,a}var Ka=A.__b;A.__b=function(n){n.type&&n.type.t&&n.ref&&(n.props.ref=n.ref,n.ref=null),Ka&&Ka(n)};var Gi=A.__e;function Za(n){return n&&((n=Ya({},n)).__c=null,n.__k=n.__k&&n.__k.map(Za)),n}function Ua(){this.__u=0,this.o=null,this.__b=null}function Qa(n){var t=n.__.__c;return t&&t.u&&t.u(n)}function wt(){this.i=null,this.l=null}A.__e=function(n,t,e){if(n.then){for(var a,r=t;r=r.__;)if((a=r.__c)&&a.__c)return a.__c(n,t.__c)}Gi(n,t,e)},(Ua.prototype=new q).__c=function(n,t){var e=this;e.o==null&&(e.o=[]),e.o.push(t);var a=Qa(e.__v),r=!1,o=function(){r||(r=!0,a?a(i):i())};t.__c=t.componentWillUnmount,t.componentWillUnmount=function(){o(),t.__c&&t.__c()};var i=function(){var s;if(!--e.__u)for(e.__v.__k[0]=e.state.u,e.setState({u:e.__b=null});s=e.o.pop();)s.forceUpdate()};e.__u++||e.setState({u:e.__b=e.__v.__k[0]}),n.then(o,o)},Ua.prototype.render=function(n,t){return this.__b&&(this.__v.__k[0]=Za(this.__b),this.__b=null),[p(q,null,t.u?null:n.children),t.u&&n.fallback]};var $a=function(n,t,e){if(++e[1]===e[0]&&n.l.delete(t),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.l.size))for(e=n.i;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;n.i=e=e[2]}};(wt.prototype=new q).u=function(n){var t=this,e=Qa(t.__v),a=t.l.get(n);return a[0]++,function(r){var o=function(){t.props.revealOrder?(a.push(r),$a(t,n,a)):r()};e?e(o):o()}},wt.prototype.render=function(n){this.i=null,this.l=new Map;var t=Ze(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&t.reverse();for(var e=t.length;e--;)this.l.set(t[e],this.i=[1,0,this.i]);return n.children},wt.prototype.componentDidUpdate=wt.prototype.componentDidMount=function(){var n=this;n.l.forEach(function(t,e){$a(n,e,t)})};var ih=function(){function n(){}var t=n.prototype;return t.getChildContext=function(){return this.props.context},t.render=function(e){return e.children},n}();var Wa=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;q.prototype.isReactComponent={};var qi=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103;var Ga=A.event;function zn(n,t){n["UNSAFE_"+t]&&!n[t]&&Object.defineProperty(n,t,{configurable:!1,get:function(){return this["UNSAFE_"+t]},set:function(e){this["UNSAFE_"+t]=e}})}A.event=function(n){Ga&&(n=Ga(n)),n.persist=function(){};var t=!1,e=!1,a=n.stopPropagation;n.stopPropagation=function(){a.call(n),t=!0};var r=n.preventDefault;return n.preventDefault=function(){r.call(n),e=!0},n.isPropagationStopped=function(){return t},n.isDefaultPrevented=function(){return e},n.nativeEvent=n};var qa={configurable:!0,get:function(){return this.class}},Xa=A.vnode;A.vnode=function(n){n.$$typeof=qi;var t=n.type,e=n.props;if(t){if(e.class!=e.className&&(qa.enumerable="className"in e,e.className!=null&&(e.class=e.className),Object.defineProperty(e,"className",qa)),typeof t!="function"){var a,r,o;for(o in e.defaultValue&&e.value!==void 0&&(e.value||e.value===0||(e.value=e.defaultValue),delete e.defaultValue),Array.isArray(e.value)&&e.multiple&&t==="select"&&(Ze(e.children).forEach(function(i){e.value.indexOf(i.props.value)!=-1&&(i.props.selected=!0)}),delete e.value),e)if(a=Wa.test(o))break;if(a)for(o in r=n.props={},e)r[Wa.test(o)?o.replace(/[A-Z0-9]/,"-$&").toLowerCase():o]=e[o]}(function(i){var s=n.type,h=n.props;if(h&&typeof s=="string"){var c={};for(var d in h)/^on(Ani|Tra|Tou)/.test(d)&&(h[d.toLowerCase()]=h[d],delete h[d]),c[d.toLowerCase()]=d;if(c.ondoubleclick&&(h.ondblclick=h[c.ondoubleclick],delete h[c.ondoubleclick]),c.onbeforeinput&&(h.onbeforeinput=h[c.onbeforeinput],delete h[c.onbeforeinput]),c.onchange&&(s==="textarea"||s.toLowerCase()==="input"&&!/^fil|che|ra/i.test(h.type))){var u=c.oninput||"oninput";h[u]||(h[u]=h[c.onchange],delete h[c.onchange])}}})(),typeof t=="function"&&!t.m&&t.prototype&&(zn(t.prototype,"componentWillMount"),zn(t.prototype,"componentWillReceiveProps"),zn(t.prototype,"componentWillUpdate"),t.m=!0)}Xa&&Xa(n)};var W=class{constructor(t,e){this.state=t;this.observers=[];this.set=this.set.bind(this),this.get=this.get.bind(this)}set(t){this.state!==t&&(this.state=t,this.observers.forEach(e=>e()))}get(){return this.state}subscribe(t){this.observers.push(t)}unsubscribe(t){let e=this.observers.indexOf(t);e!==-1&&this.observers.splice(e,1)}};function z(n){let[t,e]=te(n.get());return Bn(()=>{e(n.get());function a(){e(n.get())}return n.subscribe(a),()=>{n.unsubscribe(a)}},[n]),t}function Xi(n){switch(n){case"time-ordered":return 0;case"left-heavy":return 1;case"sandwich":return 2;default:return null}}function er(n=window.location.hash){try{if(!n.startsWith("#"))return{};let t=n.substr(1).split("&"),e={};for(let a of t){let[r,o]=a.split("=");if(o=decodeURIComponent(o),r==="profileURL")e.profileURL=o;else if(r==="title")e.title=o;else if(r==="localProfilePath")e.localProfilePath=o;else if(r==="view"){let i=Xi(o);i!==null?e.viewMode=i:console.error(`Ignoring invalid view specifier: ${o}`)}}return e}catch(t){return console.error("Error when loading hash fragment."),console.error(t),{}}}var Rt={hover:null,selectedNode:null,configSpaceViewportRect:k.empty,logicalSpaceViewportSize:m.zero},kt=class extends W{constructor(){super(...arguments);this.setProfileGroup=e=>{this.set({name:e.name,indexToView:e.indexToView,profiles:e.profiles.map(a=>({profile:a,chronoViewState:Rt,leftHeavyViewState:Rt,sandwichViewState:{callerCallee:null}}))})};this.setProfileIndexToView=e=>{this.state!=null&&(e=X(e,0,this.state.profiles.length-1),this.set({...this.state,indexToView:e}))};this.setSelectedFrame=e=>{this.state==null||this.getActiveProfile()==null||this.updateActiveSandwichViewState(r=>e==null?{callerCallee:null}:{callerCallee:{invertedCallerFlamegraph:Rt,calleeFlamegraph:Rt,selectedFrame:e}})}}set(e){let a=this.state;a!=null&&e!=null&&ht(a,e)||super.set(e)}getActiveProfile(){return this.state==null?null:this.state.profiles[this.state?.indexToView]||null}updateActiveProfileState(e){if(this.state==null)return;let{indexToView:a,profiles:r}=this.state;this.set({...this.state,profiles:r.map((o,i)=>i!=a?o:e(o))})}updateActiveSandwichViewState(e){this.updateActiveProfileState(a=>({...a,sandwichViewState:e(a.sandwichViewState)}))}updateFlamechartState(e,a){switch(e){case"CHRONO":{this.updateActiveProfileState(r=>({...r,chronoViewState:a(r.chronoViewState)}));break}case"LEFT_HEAVY":{this.updateActiveProfileState(r=>({...r,leftHeavyViewState:a(r.leftHeavyViewState)}));break}case"SANDWICH_CALLEES":{this.updateActiveSandwichViewState(r=>({...r,callerCallee:r.callerCallee==null?null:{...r.callerCallee,calleeFlamegraph:a(r.callerCallee.calleeFlamegraph)}}));break}case"SANDWICH_INVERTED_CALLERS":{this.updateActiveSandwichViewState(r=>({...r,callerCallee:r.callerCallee==null?null:{...r.callerCallee,invertedCallerFlamegraph:a(r.callerCallee.invertedCallerFlamegraph)}}));break}}}setFlamechartHoveredNode(e,a){this.updateFlamechartState(e,r=>({...r,hover:a}))}setSelectedNode(e,a){this.updateFlamechartState(e,r=>({...r,selectedNode:a}))}setConfigSpaceViewportRect(e,a){this.updateFlamechartState(e,r=>({...r,configSpaceViewportRect:a}))}setLogicalSpaceViewportSize(e,a){this.updateFlamechartState(e,r=>({...r,logicalSpaceViewportSize:a}))}clearHoverNode(){this.setFlamechartHoveredNode("CHRONO",null),this.setFlamechartHoveredNode("LEFT_HEAVY",null),this.setFlamechartHoveredNode("SANDWICH_CALLEES",null),this.setFlamechartHoveredNode("SANDWICH_INVERTED_CALLERS",null)}};var Ce=new W(!1,"flattenRecursion"),Pe=new W(!1,"searchIsActive"),Me=new W("","searchQueryAtom"),Ne=new W(0,"viewMode"),Y=new kt(null,"profileGroup");Ne.subscribe(()=>{Y.clearHoverNode()});var nr=er(),ar=new W(nr,"hashParams"),Te=new W(null,"glCanvas"),Pn=new W(!1,"dragActive"),tr=window.location.protocol,Nt=tr==="http:"||tr==="https:",Yi=Nt&&nr.profileURL!=null,Mn=new W(Yi,"loading"),Jn=new W(!1,"error"),tt=new W(null,"minimapMousePosition");var nt=new W({field:1,direction:1},"tableSortMethod");function At(){let n=z(Ce),t=z(Y);if(!t||t.indexToView>=t.profiles.length)return null;let e=t.indexToView,a=t.profiles[e];return{...t.profiles[t.indexToView],profile:za({profile:a.profile,flattenRecursion:n}),index:t.indexToView}}var Et="speedscope-color-scheme";function Zi(){let n=window.localStorage&&window.localStorage[Et];return n==="DARK"?1:n==="LIGHT"?2:0}function Qi(){return matchMedia("(prefers-color-scheme: dark)")}function el(n){if(Qi().matches)switch(n){case 0:return 2;case 2:return 1;case 1:return 0}else switch(n){case 0:return 1;case 1:return 2;case 2:return 0}}var Vn=class extends W{constructor(){super(...arguments);this.cycleToNextColorScheme=()=>{this.set(el(this.get()))}}},He=new Vn(Zi(),"colorScheme");He.subscribe(()=>{let n=He.get();switch(n){case 1:{window.localStorage[Et]="DARK";break}case 2:{window.localStorage[Et]="LIGHT";break}case 0:{delete window.localStorage[Et];break}default:return n}return n});var rr=.2,or=.1,ir=.2,lr=.1,tl=n=>{let t=ct(30*n),e=360*(.9*n),a=rr+or*t,r=ir-lr*t;return O.fromLumaChromaHue(r,a,e)},nl=`
  vec3 colorForBucket(float t) {
    float x = triangle(30.0 * t);
    float H = 360.0 * (0.9 * t);
    float C = ${rr.toFixed(1)} + ${or.toFixed(1)} * x;
    float L = ${ir.toFixed(1)} - ${lr.toFixed(1)} * x;
    return hcl2rgb(H, C, L);
  }
`,On={fgPrimaryColor:"#D0D0D0",fgSecondaryColor:"#666666",bgPrimaryColor:"#060606",bgSecondaryColor:"#0C0C0C",altFgPrimaryColor:"#D0D0D0",altFgSecondaryColor:"#666666",altBgPrimaryColor:"#000000",altBgSecondaryColor:"#0C0C0C",selectionPrimaryColor:"#00769B",selectionSecondaryColor:"#004E75",weightColor:"#0F8A42",searchMatchTextColor:"#0C0C0C",searchMatchPrimaryColor:"#A66F1C",searchMatchSecondaryColor:"#D6AE24",colorForBucket:tl,colorForBucketGLSL:nl};var sr=.25,_r=.2,cr=.8,hr=.15,al=n=>{let t=ct(30*n),e=360*(.9*n),a=sr+_r*t,r=cr-hr*t;return O.fromLumaChromaHue(r,a,e)},rl=`
  vec3 colorForBucket(float t) {
    float x = triangle(30.0 * t);
    float H = 360.0 * (0.9 * t);
    float C = ${sr.toFixed(1)} + ${_r.toFixed(1)} * x;
    float L = ${cr.toFixed(1)} - ${hr.toFixed(1)} * x;
    return hcl2rgb(H, C, L);
  }
`,Tt={fgPrimaryColor:"#000000",fgSecondaryColor:"#BDBDBD",bgPrimaryColor:"#FFFFFF",bgSecondaryColor:"#F6F6F6",altFgPrimaryColor:"#FFFFFF",altFgSecondaryColor:"#BDBDBD",altBgPrimaryColor:"#000000",altBgSecondaryColor:"#222222",selectionPrimaryColor:"#2F80ED",selectionSecondaryColor:"#8EB7ED",weightColor:"#6FCF97",searchMatchTextColor:"#000000",searchMatchPrimaryColor:"#FFAC02",searchMatchSecondaryColor:"#FEDC62",colorForBucket:al,colorForBucketGLSL:rl};var pr=he(Tt);function I(){return le(pr)}function U(n){return Fe(n)}function dr(){return matchMedia("(prefers-color-scheme: dark)")}function vr(n){switch(n){case 0:return"System";case 1:return"Dark";case 2:return"Light"}}function ol(n,t){switch(n){case 0:return t?On:Tt;case 1:return On;case 2:return Tt}}function mr(n){let[t,e]=te(()=>dr().matches),a=E(i=>{e(i.matches)},[e]);re(()=>{let i=dr();return i.addEventListener("change",a),()=>{i.removeEventListener("change",a)}},[a]);let r=z(He),o=ol(r,t);return p(pr.Provider,{value:o,children:n.children})}var wo=ee(yr()),Ro=ee(jr()),ko=ee(br()),No=ee(Sr()),Ao=ee(kr()),Eo=ee(Er()),To=ee(Lr()),Ho=ee(Ir()),Lo=ee(Fr()),Bo=ee(Pr()),Io=ee(Jr()),zo=ee(qr()),Fo=ee(Yr()),Do=ee(_o()),Po=ee(Co()),N=["Webkit"],Xn=["Moz"],J=["ms"],Z=["Webkit","Moz"],G=["Webkit","ms"],at=["Webkit","Moz","ms"],Es={plugins:[wo.default,Ro.default,ko.default,No.default,Ao.default,Eo.default,To.default,Ho.default,Lo.default,Bo.default,Io.default,zo.default],prefixMap:{transform:G,transformOrigin:G,transformOriginX:G,transformOriginY:G,backfaceVisibility:N,perspective:N,perspectiveOrigin:N,transformStyle:N,transformOriginZ:N,animation:N,animationDelay:N,animationDirection:N,animationFillMode:N,animationDuration:N,animationIterationCount:N,animationName:N,animationPlayState:N,animationTimingFunction:N,appearance:Z,userSelect:at,fontKerning:N,textEmphasisPosition:N,textEmphasis:N,textEmphasisStyle:N,textEmphasisColor:N,boxDecorationBreak:N,clipPath:N,maskImage:N,maskMode:N,maskRepeat:N,maskPosition:N,maskClip:N,maskOrigin:N,maskSize:N,maskComposite:N,mask:N,maskBorderSource:N,maskBorderMode:N,maskBorderSlice:N,maskBorderWidth:N,maskBorderOutset:N,maskBorderRepeat:N,maskBorder:N,maskType:N,textDecorationStyle:Z,textDecorationSkip:Z,textDecorationLine:Z,textDecorationColor:Z,filter:N,fontFeatureSettings:Z,breakAfter:at,breakBefore:at,breakInside:at,columnCount:Z,columnFill:Z,columnGap:Z,columnRule:Z,columnRuleColor:Z,columnRuleStyle:Z,columnRuleWidth:Z,columns:Z,columnSpan:Z,columnWidth:Z,writingMode:G,flex:G,flexBasis:N,flexDirection:G,flexGrow:N,flexFlow:G,flexShrink:N,flexWrap:G,alignContent:N,alignItems:N,alignSelf:N,justifyContent:N,order:N,transitionDelay:N,transitionDuration:N,transitionProperty:N,transitionTimingFunction:N,backdropFilter:N,scrollSnapType:G,scrollSnapPointsX:G,scrollSnapPointsY:G,scrollSnapDestination:G,scrollSnapCoordinate:G,shapeImageThreshold:N,shapeImageMargin:N,shapeImageOutside:N,hyphens:at,flowInto:G,flowFrom:G,regionFragment:G,boxSizing:Xn,textAlignLast:Xn,tabSize:Xn,wrapFlow:J,wrapThrough:J,wrapMargin:J,touchAction:J,gridTemplateColumns:J,gridTemplateRows:J,gridTemplateAreas:J,gridTemplate:J,gridAutoColumns:J,gridAutoRows:J,gridAutoFlow:J,grid:J,gridRowStart:J,gridColumnStart:J,gridRowEnd:J,gridRow:J,gridColumn:J,gridColumnEnd:J,gridColumnGap:J,gridRowGap:J,gridArea:J,gridGap:J,textSizeAdjust:G,borderImage:N,borderImageOutset:N,borderImageRepeat:N,borderImageSlice:N,borderImageSource:N,borderImageWidth:N}},Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Hs=function(){function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}}();function Ls(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var bo=typeof Map<"u",Yn=function(){function n(){Ls(this,n),this.elements={},this.keyOrder=[]}return Hs(n,[{key:"forEach",value:function(){function t(e){for(var a=0;a<this.keyOrder.length;a++)e(this.elements[this.keyOrder[a]],this.keyOrder[a])}return t}()},{key:"set",value:function(){function t(e,a,r){if(!this.elements.hasOwnProperty(e))this.keyOrder.push(e);else if(r){var o=this.keyOrder.indexOf(e);this.keyOrder.splice(o,1),this.keyOrder.push(e)}if(a==null){this.elements[e]=a;return}if(bo&&a instanceof Map||a instanceof n){var i=this.elements.hasOwnProperty(e)?this.elements[e]:new n;a.forEach(function(d,u){i.set(u,d,r)}),this.elements[e]=i;return}if(!Array.isArray(a)&&(typeof a>"u"?"undefined":Ts(a))==="object"){for(var s=this.elements.hasOwnProperty(e)?this.elements[e]:new n,h=Object.keys(a),c=0;c<h.length;c+=1)s.set(h[c],a[h[c]],r);this.elements[e]=s;return}this.elements[e]=a}return t}()},{key:"get",value:function(){function t(e){return this.elements[e]}return t}()},{key:"has",value:function(){function t(e){return this.elements.hasOwnProperty(e)}return t}()},{key:"addStyleType",value:function(){function t(e){var a=this;if(bo&&e instanceof Map||e instanceof n)e.forEach(function(i,s){a.set(s,i,!0)});else for(var r=Object.keys(e),o=0;o<r.length;o++)this.set(r[o],e[r[o]],!0)}return t}()}]),n}(),Bs=/([A-Z])/g,Is=function(t){return"-"+String(t.toLowerCase())},zs=function(t){var e=t.replace(Bs,Is);return e[0]==="m"&&e[1]==="s"&&e[2]==="-"?"-"+String(e):e},tn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function Fs(n,t){return n+t.charAt(0).toUpperCase()+t.substring(1)}var Ds=["Webkit","ms","Moz","O"];Object.keys(tn).forEach(function(n){Ds.forEach(function(t){tn[Fs(t,n)]=tn[n]})});var Mo=function(t,e){return typeof e=="number"?tn[t]?""+e:e+"px":""+e},Ps=function(t,e){return Js(Mo(t,e))},rt=function(t,e){return(0,Fo.default)(t).toString(36)},Ms=function(t){return rt(JSON.stringify(t))},Js=function(t){return t[t.length-10]==="!"&&t.slice(-11)===" !important"?t:String(t)+" !important"};function Vs(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}else return Array.from(n)}var Os=(0,Do.default)(Es),Ks=[function(){function n(t,e,a){return t[0]!==":"?null:a(e+t)}return n}(),function(){function n(t,e,a){if(t[0]!=="@")return null;var r=a(e);return[String(t)+"{"+String(r.join(""))+"}"]}return n}()],Zn=function n(t,e,a,r,o){for(var i=new Yn,s=0;s<e.length;s++)i.addStyleType(e[s]);var h=new Yn,c=[];i.forEach(function(u,g){var j=a.some(function(C){var _=C(g,t,function(l){return n(l,[u],a,r,o)});if(_!=null)return Array.isArray(_)?c.push.apply(c,Vs(_)):(console.warn("WARNING: Selector handlers should return an array of rules.Returning a string containing multiple rules is deprecated.",C),c.push("@media all {"+String(_)+"}")),!0});j||h.set(g,u,!0)});var d=Ws(t,h,r,o,a);return d&&c.unshift(d),c},Us=function(t,e,a){if(e)for(var r=Object.keys(e),o=0;o<r.length;o++){var i=r[o];t.has(i)&&t.set(i,e[i](t.get(i),a),!1)}},xo=function(t,e,a){return String(zs(t))+":"+String(a(t,e))+";"},$s=function(t,e){return t[e]=!0,t},Ws=function(t,e,a,r,o){Us(e,a,o);var i=Object.keys(e.elements).reduce($s,Object.create(null)),s=Os(e.elements),h=Object.keys(s);if(h.length!==e.keyOrder.length){for(var c=0;c<h.length;c++)if(!i[h[c]]){var d=void 0;if(h[c][0]==="W"?d=h[c][6].toLowerCase()+h[c].slice(7):h[c][1]==="o"?d=h[c][3].toLowerCase()+h[c].slice(4):d=h[c][2].toLowerCase()+h[c].slice(3),d&&i[d]){var u=e.keyOrder.indexOf(d);e.keyOrder.splice(u,0,h[c])}else e.keyOrder.unshift(h[c])}}for(var g=r===!1?Mo:Ps,j=[],C=0;C<e.keyOrder.length;C++){var _=e.keyOrder[C],l=s[_];if(Array.isArray(l))for(var v=0;v<l.length;v++)j.push(xo(_,l[v],g));else j.push(xo(_,l,g))}return j.length?String(t)+"{"+String(j.join(""))+"}":""},So=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function Gs(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}else return Array.from(n)}var se=null,qs=function(t){if(se==null&&(se=document.querySelector("style[data-aphrodite]"),se==null)){var e=document.head||document.getElementsByTagName("head")[0];se=document.createElement("style"),se.type="text/css",se.setAttribute("data-aphrodite",""),e.appendChild(se)}var a=se.styleSheet||se.sheet;if(a.insertRule){var r=a.cssRules.length;t.forEach(function(o){try{a.insertRule(o,r),r+=1}catch{}})}else se.innerText=(se.innerText||"")+t.join("")},Qn={fontFamily:function(){function n(t){return Array.isArray(t)?t.map(n).join(","):(typeof t>"u"?"undefined":So(t))==="object"?(Vo(t.src,"@font-face",[t],!1),'"'+String(t.fontFamily)+'"'):t}return n}(),animationName:function(){function n(t,e){if(Array.isArray(t))return t.map(function(o){return n(o,e)}).join(",");if((typeof t>"u"?"undefined":So(t))==="object"){var a="keyframe_"+String(Ms(t)),r="@keyframes "+a+"{";return t instanceof Yn?t.forEach(function(o,i){r+=Zn(i,[o],e,Qn,!1).join("")}):Object.keys(t).forEach(function(o){r+=Zn(o,[t[o]],e,Qn,!1).join("")}),r+="}",Jo(a,[r]),a}else return t}return n}()},Je={},nn=[],Ve=!1,Jo=function(t,e){var a;if(!Je[t]){if(!Ve){if(typeof document>"u")throw new Error("Cannot automatically buffer without a document");Ve=!0,(0,Po.default)(Qs)}(a=nn).push.apply(a,Gs(e)),Je[t]=!0}},Vo=function(t,e,a,r){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[];if(!Je[t]){var i=Zn(e,a,o,Qn,r);Jo(t,i)}},Xs=function(){nn=[],Je={},Ve=!1,se=null};var Ys=function(){if(Ve)throw new Error("Cannot buffer while already buffering");Ve=!0},Oo=function(){Ve=!1;var t=nn;return nn=[],t},Zs=function(){return Oo().join("")},Qs=function(){var t=Oo();t.length>0&&qs(t)},e_=function(){return Object.keys(Je)},t_=function(t){t.forEach(function(e){Je[e]=!0})},n_=function n(t,e,a,r){for(var o=0;o<t.length;o+=1)t[o]&&(Array.isArray(t[o])?r+=n(t[o],e,a,r):(e.push(t[o]._name),a.push(t[o]._definition),r+=t[o]._len));return r},a_=function(t,e,a){var r=[],o=[],i=n_(e,r,o,0);if(r.length===0)return"";var s=void 0;return s=r.length===1?"_"+String(r[0]):"_"+String(rt(r.join()))+String((i%36).toString(36)),Vo(s,"."+String(s),o,t,a),s},r_=function(t,e){return String(e)+"_"+String(rt(t))},o_=function(){return rt},Ko=o_(),i_={create:function(){function n(t){for(var e={},a=Object.keys(t),r=0;r<a.length;r+=1){var o=a[r],i=t[o],s=JSON.stringify(i);e[o]={_len:s.length,_name:Ko(s,o),_definition:i}}return e}return n}(),rehydrate:function(){function n(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];t_(t)}return n}()},l_=typeof window<"u"?null:{renderStatic:function(){function n(t){Xs(),Ys();var e=t(),a=Zs();return{html:e,css:{content:a,renderedClassNames:e_()}}}return n}()},s_=null;function Uo(n,t){return{StyleSheet:Object.assign({},i_,{extend:function(){function e(a){var r=a.map(function(o){return o.selectorHandler}).filter(function(o){return o});return Uo(n,t.concat(r))}return e}()}),StyleSheetServer:l_,StyleSheetTestUtils:s_,minify:function(){function e(a){Ko=a?rt:r_}return e}(),css:function(){function e(){for(var a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];return a_(n,r,t)}return e}()}}var __=!0,ot=Uo(__,Ks),V=ot.StyleSheet,Yh=ot.StyleSheetServer,Zh=ot.StyleSheetTestUtils,y=ot.css,Qh=ot.minify;var $=V.create({fillY:{height:"100%"},fillX:{width:"100%"},hbox:{display:"flex",flexDirection:"row",position:"relative",overflow:"hidden"},vbox:{display:"flex",flexDirection:"column",position:"relative",overflow:"hidden"}});function c_(n,t){let e=n.toLocaleLowerCase(),a=t.toLocaleLowerCase(),r=0,o=[];for(;;){let i=e.indexOf(a,r);if(i===-1)return o;o.push([i,i+t.length]),r=i+t.length}}var an=class{constructor(t,e){this.profile=t;this.searchQuery=e;this.matches=null}getMatchForFrame(t){return this.matches||(this.matches=new Map,this.profile.forEachFrame(e=>{let a=c_(e.name,this.searchQuery);this.matches.set(e,a.length===0?null:a)})),this.matches.get(t)||null}},rn=class{constructor(t,e){this.flamechart=t;this.profileResults=e;this.matches=null}getResults(){if(this.matches==null){let t=[],e=new Map,a=(o,i)=>{let{node:s}=o;if(this.profileResults.getMatchForFrame(s.frame)){let h=new k(new m(o.start,i),new m(o.end-o.start,1));e.set(s,t.length),t.push({configSpaceBounds:h,node:s})}o.children.forEach(h=>{a(h,i+1)})},r=this.flamechart.getLayers();r.length>0&&r[0].forEach(o=>a(o,0)),this.matches={matches:t,indexForNode:e}}return this.matches}count(){return this.getResults().matches.length}indexOf(t){let e=this.getResults().indexForNode.get(t);return e===void 0?null:e}at(t){let e=this.getResults().matches;if(t<0||t>=e.length)throw new Error(`Index ${t} out of bounds in list of ${e.length} matches.`);return e[t]}};function $o(n){n.stopPropagation()}var Be=he(null),Wo=({children:n})=>{let t=At(),e=t?t.profile:null,a=z(Pe),r=z(Me),o=F(()=>!e||!a||r.length===0?null:new an(e,r),[a,r,e]);return p(Be.Provider,{value:o},n)},on=K(({numResults:n,resultIndex:t,selectNext:e,selectPrev:a})=>{let r=I(),o=h_(r),i=z(Pe),s=z(Me),h=Me.set,c=Pe.set,d=E(_=>{let l=_.target.value;h(l)},[h]),u=ke(null),g=E(()=>c(!1),[c]),j=E(_=>{_.shiftKey?a():e()},[a,e]),C=E(_=>{_.stopPropagation(),_.key==="Escape"&&c(!1),_.key==="Enter"&&j(_),_.key=="f"&&(_.metaKey||_.ctrlKey)&&(u.current&&u.current.select(),_.preventDefault())},[c,j]);return re(()=>{let _=l=>{l.key=="f"&&(l.metaKey||l.ctrlKey)&&(l.preventDefault(),u.current?u.current.select():(c(!0),requestAnimationFrame(()=>{u.current&&u.current.select()})))};return window.addEventListener("keydown",_),()=>{window.removeEventListener("keydown",_)}},[c]),i?p("div",{className:y(o.searchView)},p("span",{className:y(o.icon)},"\u{1F50D}"),p("span",{className:y(o.inputContainer)},p("input",{className:y(o.input),value:s,onInput:d,onKeyDown:C,onKeyUp:$o,onKeyPress:$o,ref:u})),n!=null&&p(oe,null,p("span",{className:y(o.resultCount)},t==null?"?":t+1,"/",n),p("button",{className:y(o.icon,o.button),onClick:a},"\u2B05\uFE0F"),p("button",{className:y(o.icon,o.button),onClick:e},"\u27A1\uFE0F")),p("svg",{className:y(o.icon),onClick:g,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p("path",{d:"M4.99999 4.16217L11.6427 10.8048M11.6427 4.16217L4.99999 10.8048",stroke:r.altFgSecondaryColor}))):null}),h_=U(n=>V.create({searchView:{position:"absolute",top:0,right:10,height:20,width:16*13,borderWidth:2,borderColor:n.altFgPrimaryColor,borderStyle:"solid",fontSize:10,boxSizing:"border-box",background:n.altBgSecondaryColor,color:n.altFgPrimaryColor,display:"flex",alignItems:"center"},inputContainer:{flexShrink:1,flexGrow:1,display:"flex"},input:{width:"100%",border:"none",background:"none",fontSize:10,lineHeight:"20px",color:n.altFgPrimaryColor,":focus":{border:"none",outline:"none"},"::selection":{color:n.altFgPrimaryColor,background:n.selectionPrimaryColor}},resultCount:{verticalAlign:"middle"},icon:{flexShrink:0,verticalAlign:"middle",height:"100%",margin:"0px 2px 0px 2px",fontSize:10},button:{display:"inline",background:"none",border:"none",padding:0,":focus":{outline:"none"}}}));function Go(n){return n.replace(/\\([a-fA-F0-9]{2})/g,(t,e)=>{let a=parseInt(e,16);return String.fromCharCode(a)})}function qo(n){let t=n.split(`
`);if(!t.length||(t[t.length-1]===""&&t.pop(),!t.length))return null;let e=new Map,a=/^(\d+):(.+)$/,r=/^([\$\w]+):([\$\w-]+)$/;for(let o of t){let i=a.exec(o);if(i){e.set(`wasm-function[${i[1]}]`,Go(i[2]));continue}let s=r.exec(o);if(s){e.set(s[1],Go(s[2]));continue}return null}return o=>e.has(o.name)?{name:e.get(o.name)}:null}var xe=class{constructor(t){this.source=t;this.layers=[];this.totalWeight=0;this.minFrameWidth=1;let e=[],a=(o,i)=>{let s=ga(e),h={node:o,parent:s,children:[],start:i,end:i};s&&s.children.push(h),e.push(h)};this.minFrameWidth=1/0;let r=(o,i)=>{console.assert(e.length>0);let s=e.pop();if(s.end=i,s.end-s.start===0)return;let h=e.length;for(;this.layers.length<=h;)this.layers.push([]);this.layers[h].push(s),this.minFrameWidth=Math.min(this.minFrameWidth,s.end-s.start)};this.totalWeight=t.getTotalWeight(),t.forEachCall(a,r),isFinite(this.minFrameWidth)||(this.minFrameWidth=1)}getTotalWeight(){return this.totalWeight}getLayers(){return this.layers}getColorBucketForFrame(t){return this.source.getColorBucketForFrame(t)}getMinFrameWidth(){return this.minFrameWidth}formatValue(t){return this.source.formatValue(t)}getClampedViewportWidth(t){let e=this.getTotalWeight(),a=Math.pow(2,40),r=X(3*this.getMinFrameWidth(),e/a,e);return X(t,r,e)}getClampedConfigSpaceViewportRect({configSpaceViewportRect:t,renderInverted:e}){let a=new m(this.getTotalWeight(),this.getLayers().length),r=this.getClampedViewportWidth(t.size.x),o=t.size.withX(r),i=m.clamp(t.origin,new m(0,e?0:-1),m.max(m.zero,a.minus(o).plus(new m(0,1))));return new k(i,t.size.withX(r))}};var d_=1e4,ln=class{constructor(t,e,a){this.batch=t;this.bounds=e;this.numPrecedingRectanglesInRow=a;this.children=[]}getBatch(){return this.batch}getBounds(){return this.bounds}getRectCount(){return this.batch.getRectCount()}getChildren(){return this.children}getParity(){return this.numPrecedingRectanglesInRow%2}forEachLeafNodeWithinBounds(t,e){this.bounds.hasIntersectionWith(t)&&e(this)}},ea=class{constructor(t){this.children=t;this.rectCount=0;if(t.length===0)throw new Error("Empty interior node");let e=1/0,a=-1/0,r=1/0,o=-1/0;for(let i of t){this.rectCount+=i.getRectCount();let s=i.getBounds();e=Math.min(e,s.left()),a=Math.max(a,s.right()),r=Math.min(r,s.top()),o=Math.max(o,s.bottom())}this.bounds=new k(new m(e,r),new m(a-e,o-r))}getBounds(){return this.bounds}getRectCount(){return this.rectCount}getChildren(){return this.children}forEachLeafNodeWithinBounds(t,e){if(this.bounds.hasIntersectionWith(t))for(let a of this.children)a.forEachLeafNodeWithinBounds(t,e)}},sn=class n{get key(){return`${this.stackDepth}_${this.index}_${this.zoomLevel}`}constructor(t){this.stackDepth=t.stackDepth,this.zoomLevel=t.zoomLevel,this.index=t.index}static getOrInsert(t,e){return t.getOrInsert(new n(e))}},_n=class{constructor(t,e,a,r,o,i={inverted:!1}){this.gl=t;this.rowAtlas=e;this.flamechart=a;this.rectangleBatchRenderer=r;this.colorPassRenderer=o;this.options=i;this.layers=[];this.rectInfoTexture=null;this.rectInfoRenderTarget=null;this.atlasKeys=new ja;let s=a.getLayers().length;for(let h=0;h<s;h++){let c=[],d=i.inverted?s-1-h:h,u=1/0,g=-1/0,j=new Ee(this.gl),C=0,_=a.getLayers()[h];for(let l=0;l<_.length;l++){let v=_[l];j.getRectCount()>=d_&&(c.push(new ln(j,new k(new m(u,d),new m(g-u,1)),C)),u=1/0,g=-1/0,j=new Ee(this.gl));let f=new k(new m(v.start,d),new m(v.end-v.start,1));u=Math.min(u,f.left()),g=Math.max(g,f.right());let b=new O((1+l%255)/256,(1+h%255)/256,(1+this.flamechart.getColorBucketForFrame(v.node.frame))/256);j.addRect(f,b),C++}j.getRectCount()>0&&c.push(new ln(j,new k(new m(u,d),new m(g-u,1)),C)),this.layers.push(new ea(c))}}getRectInfoTexture(t,e){if(this.rectInfoTexture){let a=this.rectInfoTexture;(a.width!=t||a.height!=e)&&a.resize(t,e)}else this.rectInfoTexture=this.gl.createTexture(B.TextureFormat.NEAREST_CLAMP,t,e);return this.rectInfoTexture}getRectInfoRenderTarget(t,e){let a=this.getRectInfoTexture(t,e);return this.rectInfoRenderTarget&&this.rectInfoRenderTarget.texture!=a&&(this.rectInfoRenderTarget.texture.free(),this.rectInfoRenderTarget.setColor(a)),this.rectInfoRenderTarget||(this.rectInfoRenderTarget=this.gl.createRenderTarget(a)),this.rectInfoRenderTarget}free(){this.rectInfoRenderTarget&&this.rectInfoRenderTarget.free(),this.rectInfoTexture&&this.rectInfoTexture.free()}configSpaceBoundsForKey(t){let{stackDepth:e,zoomLevel:a,index:r}=t,i=this.flamechart.getTotalWeight()/Math.pow(2,a),s=this.flamechart.getLayers().length,h=this.options.inverted?s-1-e:e;return new k(new m(i*r,h),new m(i,1))}render(t){let{configSpaceSrcRect:e,physicalSpaceDstRect:a}=t,r=[],o=H.betweenRects(e,a);if(e.isEmpty())return;let i=0;for(;;){let b=sn.getOrInsert(this.atlasKeys,{stackDepth:0,zoomLevel:i,index:0}),S=this.configSpaceBoundsForKey(b);if(o.transformRect(S).width()<this.rowAtlas.getResolution())break;i++}let s=Math.max(0,Math.floor(e.top())),h=Math.min(this.layers.length,Math.ceil(e.bottom())),c=this.flamechart.getTotalWeight(),d=Math.pow(2,i),u=Math.floor(d*e.left()/c),g=Math.ceil(d*e.right()/c),j=this.flamechart.getLayers().length;for(let b=s;b<h;b++)for(let S=u;S<=g;S++){let w=this.options.inverted?j-1-b:b,T=sn.getOrInsert(this.atlasKeys,{stackDepth:w,zoomLevel:i,index:S});this.configSpaceBoundsForKey(T).hasIntersectionWith(e)&&r.push(T)}let C=this.rowAtlas.getCapacity(),_=r.slice(0,C),l=r.slice(C);this.rowAtlas.writeToAtlasIfNeeded(_,(b,S)=>{let w=this.configSpaceBoundsForKey(S);this.layers[S.stackDepth].forEachLeafNodeWithinBounds(w,T=>{this.rectangleBatchRenderer.render({batch:T.getBatch(),configSpaceSrcRect:w,physicalSpaceDstRect:b})})});let v=this.getRectInfoRenderTarget(a.width(),a.height());ut(this.gl,v,()=>{this.gl.clear(new B.Color(0,0,0,0));let b=new k(m.zero,new m(this.gl.viewport.width,this.gl.viewport.height)),S=H.betweenRects(e,b);for(let w of _){let T=this.configSpaceBoundsForKey(w);this.rowAtlas.renderViaAtlas(w,S.transformRect(T))}for(let w of l){let T=this.configSpaceBoundsForKey(w),D=S.transformRect(T);this.layers[w.stackDepth].forEachLeafNodeWithinBounds(T,ne=>{this.rectangleBatchRenderer.render({batch:ne.getBatch(),configSpaceSrcRect:T,physicalSpaceDstRect:D})})}});let f=this.getRectInfoTexture(a.width(),a.height());this.colorPassRenderer.render({rectInfoTexture:f,srcRect:new k(m.zero,new m(f.width,f.height)),dstRect:a,renderOutlines:t.renderOutlines})}};var ue=U(n=>V.create({hoverCount:{color:n.weightColor},fill:{width:"100%",height:"100%",position:"absolute",left:0,top:0},minimap:{height:100,borderBottom:`2px solid ${n.fgSecondaryColor}`},panZoomView:{flex:1},detailView:{display:"grid",height:150,overflow:"hidden",gridTemplateColumns:"120px 120px 1fr",gridTemplateRows:"repeat(4, 1fr)",borderTop:`2px solid ${n.fgSecondaryColor}`,fontSize:10,position:"absolute",background:n.bgPrimaryColor,width:"100vw",bottom:0},stackTraceViewPadding:{padding:5},stackTraceView:{height:150,lineHeight:`${12}px`,overflow:"auto","::-webkit-scrollbar":{background:n.bgPrimaryColor},"::-webkit-scrollbar-thumb":{background:n.fgSecondaryColor,borderRadius:20,border:`3px solid ${n.bgPrimaryColor}`,":hover":{background:n.fgPrimaryColor}}},stackLine:{whiteSpace:"nowrap"},stackFileLine:{color:n.fgSecondaryColor},statsTable:{display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:`repeat(3, ${20}px)`,gridGap:"1px 1px",textAlign:"center",paddingRight:1},statsTableHeader:{gridColumn:"1 / 3"},statsTableCell:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},thisInstanceCell:{background:n.selectionPrimaryColor,color:n.altFgPrimaryColor},allInstancesCell:{background:n.selectionSecondaryColor,color:n.altFgPrimaryColor},barDisplay:{position:"absolute",top:0,left:0,background:"rgba(0, 0, 0, 0.2)",width:"100%"}}));var na="\u2026",cn=new Map,Xo=-1;function Se(n,t){return window.devicePixelRatio!==Xo&&(cn.clear(),Xo=window.devicePixelRatio),cn.has(t)||cn.set(t,n.measureText(t).width),cn.get(t)}function ta(n,t){if(n.length<=t)return{trimmedString:n,trimmedLength:n.length,prefixLength:n.length,suffixLength:0,originalString:n,originalLength:n.length};let e=Math.floor(t/2),a=t-e-1,r=n.substring(0,e),o=n.substring(n.length-a,n.length),i=r+na+o;return{trimmedString:i,trimmedLength:i.length,prefixLength:r.length,suffixLength:o.length,originalString:n,originalLength:n.length}}function Zo(n,t,e){if(Se(n,t)<=e)return ta(t,t.length);let[a]=Ca(0,t.length,r=>Se(n,ta(t,Math.floor(r)).trimmedString),e);return ta(t,Math.floor(a))}function Yo(n,t){return t<n.prefixLength?0:t<n.originalLength-n.suffixLength?2:1}function Qo(n,t){let e=[],a=n.originalLength-n.trimmedLength,r=!1;for(let[o,i]of t){let s=Yo(n,o),h=Yo(n,i-1);switch(s){case 0:{switch(h){case 0:{e.push([o,i]);break}case 2:{e.push([o,n.prefixLength+1]),r=!0;break}case 1:{e.push([o,i-a]);break}}break}case 2:{switch(h){case 0:throw new Error("Unexpected highlight range starts in elided and ends in prefix");case 2:{r||(e.push([n.prefixLength,n.prefixLength+1]),r=!0);break}case 1:{r?e.push([n.trimmedLength-n.suffixLength,i-a]):(e.push([n.prefixLength,i-a]),r=!0);break}}break}case 1:{switch(h){case 0:throw new Error("Unexpected highlight range starts in suffix and ends in prefix");case 2:throw new Error("Unexpected highlight range starts in suffix and ends in elided");case 1:{e.push([o-a,i-a]);break}}break}}}return e}var hn=class extends q{constructor(){super(...arguments);this.container=null;this.containerRef=e=>{this.container=e||null};this.overlayCanvas=null;this.overlayCtx=null;this.onWindowResize=()=>{this.onBeforeFrame()};this.onBeforeFrame=()=>{this.maybeClearInteractionLock(),this.resizeOverlayCanvasIfNeeded(),this.renderRects(),this.renderOverlays()};this.renderCanvas=()=>{this.props.canvasContext.requestFrame()};this.frameHadWheelEvent=!1;this.framesWithoutWheelEvents=0;this.interactionLock=null;this.maybeClearInteractionLock=()=>{this.interactionLock&&(this.frameHadWheelEvent||(this.framesWithoutWheelEvents++,this.framesWithoutWheelEvents>=2&&(this.interactionLock=null,this.framesWithoutWheelEvents=0)),this.props.canvasContext.requestFrame()),this.frameHadWheelEvent=!1};this.onWheel=e=>{if(e.preventDefault(),this.frameHadWheelEvent=!0,(e.metaKey||e.ctrlKey)&&this.interactionLock!=="pan"){let r=1+e.deltaY/100;e.ctrlKey&&(r=1+e.deltaY/40),r=X(r,.1,10),this.zoom(r)}else this.interactionLock!=="zoom"&&this.pan(new m(e.deltaX,e.deltaY));this.renderCanvas()};this.dragStartConfigSpaceMouse=null;this.dragConfigSpaceViewportOffset=null;this.draggingMode=null;this.onMouseDown=e=>{let a=this.configSpaceMouse(e);a&&(this.props.configSpaceViewportRect.contains(a)?(this.draggingMode=1,this.dragConfigSpaceViewportOffset=a.minus(this.props.configSpaceViewportRect.origin)):this.draggingMode=0,this.dragStartConfigSpaceMouse=a,window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),this.updateCursor(a))};this.onWindowMouseMove=e=>{if(!this.dragStartConfigSpaceMouse)return;let a=this.configSpaceMouse(e);if(a){if(this.updateCursor(a),a=new k(new m(0,0),this.configSpaceSize()).closestPointTo(a),this.draggingMode===0){let r=this.dragStartConfigSpaceMouse,o=a;if(!r||!o)return;let i=Math.min(r.x,o.x),h=Math.max(r.x,o.x)-i,c=this.props.configSpaceViewportRect.height();this.props.setConfigSpaceViewportRect(new k(new m(i,o.y-c/2),new m(h,c)))}else if(this.draggingMode===1){if(!this.dragConfigSpaceViewportOffset)return;let r=a.minus(this.dragConfigSpaceViewportOffset);this.props.setConfigSpaceViewportRect(this.props.configSpaceViewportRect.withOrigin(r))}}};this.updateCursor=e=>{this.draggingMode===1?(document.body.style.cursor="grabbing",document.body.style.cursor="-webkit-grabbing"):this.draggingMode===0?document.body.style.cursor="col-resize":this.props.configSpaceViewportRect.contains(e)?(document.body.style.cursor="grab",document.body.style.cursor="-webkit-grab"):document.body.style.cursor="col-resize"};this.onMouseLeave=()=>{this.draggingMode==null&&(document.body.style.cursor="default"),tt.set(null)};this.onMouseMove=e=>{let a=this.configSpaceMouse(e);a&&(this.updateCursor(a),tt.set(a))};this.onWindowMouseUp=e=>{this.draggingMode=null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp);let a=this.configSpaceMouse(e);a&&this.updateCursor(a)};this.overlayCanvasRef=e=>{e?(this.overlayCanvas=e,this.overlayCtx=this.overlayCanvas.getContext("2d"),this.renderCanvas()):(this.overlayCanvas=null,this.overlayCtx=null)}}physicalViewSize(){return new m(this.overlayCanvas?this.overlayCanvas.width:0,this.overlayCanvas?this.overlayCanvas.height:0)}getStyle(){return ue(this.props.theme)}minimapOrigin(){return new m(0,20*window.devicePixelRatio)}configSpaceSize(){return new m(this.props.flamechart.getTotalWeight(),this.props.flamechart.getLayers().length)}configSpaceToPhysicalViewSpace(){let e=this.minimapOrigin();return H.betweenRects(new k(new m(0,0),this.configSpaceSize()),new k(e,this.physicalViewSize().minus(e)))}logicalToPhysicalViewSpace(){return H.withScale(new m(window.devicePixelRatio,window.devicePixelRatio))}windowToLogicalViewSpace(){if(!this.container)return new H;let e=this.container.getBoundingClientRect();return H.withTranslation(new m(-e.left,-e.top))}renderRects(){this.container&&(this.physicalViewSize().x<2||this.props.canvasContext.renderBehind(this.container,()=>{this.props.flamechartRenderer.render({configSpaceSrcRect:new k(new m(0,0),this.configSpaceSize()),physicalSpaceDstRect:new k(this.minimapOrigin(),this.physicalViewSize().minus(this.minimapOrigin())),renderOutlines:!1}),this.props.canvasContext.viewportRectangleRenderer.render({configSpaceViewportRect:this.props.configSpaceViewportRect,configSpaceToPhysicalViewSpace:this.configSpaceToPhysicalViewSpace()})}))}renderOverlays(){let e=this.overlayCtx;if(!e)return;let a=this.physicalViewSize();e.clearRect(0,0,a.x,a.y);let r=this.configSpaceToPhysicalViewSpace(),o=0,i=this.configSpaceSize().x,h=(this.configSpaceToPhysicalViewSpace().inverted()||new H).times(this.logicalToPhysicalViewSpace()).transformVector(new m(200,1)).x,c=20*window.devicePixelRatio,d=10*window.devicePixelRatio,u=(c-d)/2;e.font=`${d}px/${c}px "Source Code Pro", Courier, monospace`,e.textBaseline="top";let j=Math.pow(10,Math.floor(Math.log10(h)));h/j>5?j*=5:h/j>2&&(j*=2);let C=this.props.theme;{e.fillStyle=O.fromCSSHex(C.bgPrimaryColor).withAlpha(.8).toCSS(),e.fillRect(0,0,a.x,c),e.textBaseline="top";for(let _=Math.ceil(o/j)*j;_<i;_+=j){let l=Math.round(r.transformPosition(new m(_,0)).x),v=this.props.flamechart.formatValue(_),f=Math.ceil(Se(e,v));e.fillStyle=C.fgPrimaryColor,e.fillText(v,l-f-u,u),e.fillStyle=C.fgSecondaryColor,e.fillRect(l,0,1,a.y)}}}componentWillReceiveProps(e){this.props.flamechart!==e.flamechart?this.renderCanvas():this.props.configSpaceViewportRect!=e.configSpaceViewportRect?this.renderCanvas():this.props.canvasContext!==e.canvasContext&&(this.props.canvasContext&&this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame),e.canvasContext&&(e.canvasContext.addBeforeFrameHandler(this.onBeforeFrame),e.canvasContext.requestFrame()))}componentDidMount(){window.addEventListener("resize",this.onWindowResize),this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize),this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)}resizeOverlayCanvasIfNeeded(){if(!this.overlayCanvas)return;let{width:e,height:a}=this.overlayCanvas.getBoundingClientRect();if(e=Math.floor(e),a=Math.floor(a),e===0||a===0)return;let r=e*window.devicePixelRatio,o=a*window.devicePixelRatio;r===this.overlayCanvas.width&&o===this.overlayCanvas.height||(this.overlayCanvas.width=r,this.overlayCanvas.height=o)}pan(e){this.interactionLock="pan";let a=this.logicalToPhysicalViewSpace().transformVector(e),r=this.configSpaceToPhysicalViewSpace().inverseTransformVector(a);r&&this.props.transformViewport(H.withTranslation(r))}zoom(e){this.interactionLock="zoom";let a=this.props.configSpaceViewportRect,r=a.origin.plus(a.size.times(1/2));if(!r)return;let o=H.withTranslation(r.times(-1)).scaledBy(new m(e,1)).translatedBy(r);this.props.transformViewport(o)}configSpaceMouse(e){let a=this.windowToLogicalViewSpace().transformPosition(new m(e.clientX,e.clientY)),r=this.logicalToPhysicalViewSpace().transformPosition(a);return this.configSpaceToPhysicalViewSpace().inverseTransformPosition(r)}render(){let e=this.getStyle();return p("div",{ref:this.containerRef,onWheel:this.onWheel,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,className:y(e.minimap,$.vbox)},p("canvas",{width:1,height:1,ref:this.overlayCanvasRef,className:y(e.fill)}))}};function pn(n){let t=p_(I());return p("span",{className:y(t.stackChit),style:{backgroundColor:n.color}})}var p_=U(n=>V.create({stackChit:{position:"relative",top:-1,display:"inline-block",verticalAlign:"middle",marginRight:"0.5em",border:`1px solid ${n.fgSecondaryColor}`,width:8,height:8}}));function ei(n){let t=ue(I()),e=n.formatter(n.selectedTotal),a=n.formatter(n.selectedSelf),r=100*n.selectedTotal/n.grandTotal,o=100*n.selectedSelf/n.grandTotal;return p("div",{className:y(t.statsTable)},p("div",{className:y(n.cellStyle,t.statsTableCell,t.statsTableHeader)},n.title),p("div",{className:y(n.cellStyle,t.statsTableCell)},"Total"),p("div",{className:y(n.cellStyle,t.statsTableCell)},"Self"),p("div",{className:y(n.cellStyle,t.statsTableCell)},e),p("div",{className:y(n.cellStyle,t.statsTableCell)},a),p("div",{className:y(n.cellStyle,t.statsTableCell)},ce(r),p("div",{className:y(t.barDisplay),style:{height:`${r}%`}})),p("div",{className:y(n.cellStyle,t.statsTableCell)},ce(o),p("div",{className:y(t.barDisplay),style:{height:`${o}%`}})))}function v_(n){let t=ue(I()),e=[],a=n.node;for(;a&&!a.isRoot();a=a.parent){let r=[],{frame:o}=a;if(r.push(p(pn,{color:n.getFrameColor(o)})),e.length&&r.push(p("span",{className:y(t.stackFileLine)},"> ")),r.push(o.name),o.file){let i=o.file;o.line!=null&&(i+=`:${o.line}`,o.col!=null&&(i+=`:${o.col}`)),r.push(p("span",{className:y(t.stackFileLine)}," (",i,")"))}e.push(p("div",{className:y(t.stackLine)},r))}return p("div",{className:y(t.stackTraceView)},p("div",{className:y(t.stackTraceViewPadding)},e))}function ti(n){let t=ue(I()),{flamechart:e,selectedNode:a}=n,{frame:r}=a;return p("div",{className:y(t.detailView)},p(ei,{title:"This Instance",cellStyle:t.thisInstanceCell,grandTotal:e.getTotalWeight(),selectedTotal:a.getTotalWeight(),selectedSelf:a.getSelfWeight(),formatter:e.formatValue.bind(e)}),p(ei,{title:"All Instances",cellStyle:t.allInstancesCell,grandTotal:e.getTotalWeight(),selectedTotal:r.getTotalWeight(),selectedSelf:r.getSelfWeight(),formatter:e.formatValue.bind(e)}),p(v_,{node:a,getFrameColor:n.getCSSColorForFrame}))}var it=class{constructor(){this.argsBatch=[]}text(t){this.argsBatch.push(t)}fill(t,e){if(this.argsBatch.length!==0){t.fillStyle=e;for(let a of this.argsBatch)t.fillText(a.text,a.x,a.y);this.argsBatch=[]}}},Ie=class{constructor(){this.argsBatch=[]}rect(t){this.argsBatch.push(t)}drawPath(t){t.beginPath();for(let e of this.argsBatch)t.rect(e.x,e.y,e.w,e.h);t.closePath(),this.argsBatch=[]}fill(t,e){this.argsBatch.length!==0&&(t.fillStyle=e,this.drawPath(t),t.fill())}stroke(t,e,a){this.argsBatch.length!==0&&(t.strokeStyle=e,t.lineWidth=a,this.drawPath(t),t.stroke())}};var Oe=class extends q{constructor(){super(...arguments);this.container=null;this.containerRef=e=>{this.container=e||null};this.overlayCanvas=null;this.overlayCtx=null;this.hoveredLabel=null;this.overlayCanvasRef=e=>{e?(this.overlayCanvas=e,this.overlayCtx=this.overlayCanvas.getContext("2d"),this.renderCanvas()):(this.overlayCanvas=null,this.overlayCtx=null)};this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT=20;this.onWindowResize=()=>{this.updateConfigSpaceViewport(),this.onBeforeFrame()};this.frameHadWheelEvent=!1;this.framesWithoutWheelEvents=0;this.interactionLock=null;this.maybeClearInteractionLock=()=>{this.interactionLock&&(this.frameHadWheelEvent||(this.framesWithoutWheelEvents++,this.framesWithoutWheelEvents>=2&&(this.interactionLock=null,this.framesWithoutWheelEvents=0)),this.props.canvasContext.requestFrame()),this.frameHadWheelEvent=!1};this.onBeforeFrame=()=>{this.resizeOverlayCanvasIfNeeded(),this.renderRects(),this.renderOverlays(),this.maybeClearInteractionLock()};this.renderCanvas=()=>{this.props.canvasContext.requestFrame()};this.lastDragPos=null;this.mouseDownPos=null;this.currentMousePos=null;this.onMouseDown=e=>{this.mouseDownPos=this.lastDragPos=new m(e.offsetX,e.offsetY),this.updateCursor(),window.addEventListener("mouseup",this.onWindowMouseUp)};this.onMouseDrag=e=>{if(!this.lastDragPos)return;let a=new m(e.offsetX,e.offsetY);this.pan(this.lastDragPos.minus(a)),this.lastDragPos=a,this.hoveredLabel&&this.props.onNodeHover(null)};this.onDblClick=e=>{if(this.hoveredLabel){let a=this.hoveredLabel.configSpaceBounds,r=new k(a.origin.minus(new m(0,1)),a.size.withY(this.props.configSpaceViewportRect.height()));this.props.setConfigSpaceViewportRect(r)}};this.onClick=e=>{let a=new m(e.offsetX,e.offsetY),r=this.mouseDownPos;this.mouseDownPos=null,!(r&&a.minus(r).length()>5)&&(this.hoveredLabel?(this.props.onNodeSelect(this.hoveredLabel.node),this.renderCanvas()):this.props.onNodeSelect(null))};this.onWindowMouseUp=e=>{this.lastDragPos=null,this.updateCursor(),window.removeEventListener("mouseup",this.onWindowMouseUp)};this.onMouseMove=e=>{if(this.currentMousePos=new m(e.offsetX,e.offsetY),this.updateCursor(),this.lastDragPos){e.preventDefault(),this.onMouseDrag(e);return}let a=new m(e.offsetX,e.offsetY),r=this.logicalToPhysicalViewSpace().transformPosition(a),o=this.configSpaceToPhysicalViewSpace().inverseTransformPosition(r);if(!o)return;let i=(h,c=0)=>{let d=h.end-h.start,u=this.props.renderInverted?this.configSpaceSize().y-1-c:c,g=new k(new m(h.start,u),new m(d,1));if(o.x<g.left()||o.x>g.right())return null;g.contains(o)&&(this.hoveredLabel={configSpaceBounds:g,node:h.node});for(let j of h.children)i(j,c+1)};(()=>{this.hoveredLabel=null})();for(let h of this.props.flamechart.getLayers()[0]||[])i(h);this.hoveredLabel?this.props.onNodeHover({node:this.hoveredLabel.node,event:e}):this.props.onNodeHover(null),this.renderCanvas()};this.onMouseLeave=e=>{this.currentMousePos=null,this.hoveredLabel=null,this.props.onNodeHover(null),this.renderCanvas()};this.onWheel=e=>{e.preventDefault(),this.frameHadWheelEvent=!0;let a=e.metaKey||e.ctrlKey,r=e.deltaY,o=e.deltaX;if(e.deltaMode===e.DOM_DELTA_LINE&&(r*=this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT,o*=this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT),a&&this.interactionLock!=="pan"){let i=1+r/100;e.ctrlKey&&(i=1+r/40),i=X(i,.1,10),this.zoom(new m(e.offsetX,e.offsetY),i)}else this.interactionLock!=="zoom"&&this.pan(new m(o,r));this.renderCanvas()};this.onWindowKeyPress=e=>{if(!this.container)return;let{width:a,height:r}=this.container.getBoundingClientRect(),o=tt.get(),i,s=!0;if(o){let c=this.props.configSpaceViewportRect,d=o.x>=c.left()&&o.x<=c.right()&&o.y>=c.top()&&o.y<=c.bottom(),u=new m(o.x-c.width()/2,o.y-c.height()/2);this.props.setConfigSpaceViewportRect(c.withOrigin(u)),d||(s=!1),i=new m(a/2,r/2)}else i=this.currentMousePos||new m(a/2,r/2);let h=1;switch(e.key){case"=":case"+":h=.5;break;case"-":case"_":h=2;break}s&&requestAnimationFrame(()=>{this.zoom(i,h),e.preventDefault()}),!(e.ctrlKey||e.shiftKey||e.metaKey)&&(e.key==="0"?this.zoom(i,1e9):e.key==="ArrowRight"||e.code==="KeyD"?this.pan(new m(100,0)):e.key==="ArrowLeft"||e.code==="KeyA"?this.pan(new m(-100,0)):e.key==="ArrowUp"||e.code==="KeyW"?this.pan(new m(0,-100)):e.key==="ArrowDown"||e.code==="KeyS"?this.pan(new m(0,100)):e.key==="Escape"&&(this.props.onNodeSelect(null),this.renderCanvas()))}}getStyle(){return ue(this.props.theme)}setConfigSpaceViewportRect(e){this.props.setConfigSpaceViewportRect(e)}configSpaceSize(){return new m(this.props.flamechart.getTotalWeight(),this.props.flamechart.getLayers().length)}physicalViewSize(){return new m(this.overlayCanvas?this.overlayCanvas.width:0,this.overlayCanvas?this.overlayCanvas.height:0)}physicalBounds(){if(this.props.renderInverted){let e=this.physicalViewSize().y,a=(this.configSpaceSize().y+1)*this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT*window.devicePixelRatio;if(a<e)return new k(new m(0,e-a),this.physicalViewSize())}return new k(new m(0,0),this.physicalViewSize())}configSpaceToPhysicalViewSpace(){return H.betweenRects(this.props.configSpaceViewportRect,this.physicalBounds())}logicalToPhysicalViewSpace(){return H.withScale(new m(window.devicePixelRatio,window.devicePixelRatio))}resizeOverlayCanvasIfNeeded(){if(!this.overlayCanvas)return;let{width:e,height:a}=this.overlayCanvas.getBoundingClientRect();if(e=Math.floor(e),a=Math.floor(a),e===0||a===0)return;let r=e*window.devicePixelRatio,o=a*window.devicePixelRatio;r===this.overlayCanvas.width&&o===this.overlayCanvas.height||(this.overlayCanvas.width=r,this.overlayCanvas.height=o)}renderOverlays(){let e=this.overlayCtx;if(!e||this.props.configSpaceViewportRect.isEmpty())return;let a=this.configSpaceToPhysicalViewSpace(),r=10*window.devicePixelRatio,o=this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT*window.devicePixelRatio,i=this.physicalViewSize();e.clearRect(0,0,i.x,i.y),e.font=`${r}px/${o}px "Source Code Pro", Courier, monospace`,e.textBaseline="alphabetic";let s=Se(e,"M"+na+"M"),h=(a.inverseTransformVector(new m(s,0))||new m(0,0)).x,c=5*window.devicePixelRatio,d=new it,u=new it,g=new Ie,j=new Ie,C=new Ie,_=new Ie,l=(w,T=0)=>{let D=w.end-w.start,ne=this.props.renderInverted?this.configSpaceSize().y-1-T:T,R=new k(new m(w.start,ne),new m(D,1));if(!(D<h)&&!(R.left()>this.props.configSpaceViewportRect.right())&&!(R.right()<this.props.configSpaceViewportRect.left())){if(this.props.renderInverted){if(R.bottom()<this.props.configSpaceViewportRect.top())return}else if(R.top()>this.props.configSpaceViewportRect.bottom())return;if(R.hasIntersectionWith(this.props.configSpaceViewportRect)){let x=a.transformRect(R);if(x.left()<0&&(x=x.withOrigin(x.origin.withX(0)).withSize(x.size.withX(x.size.x+x.left()))),x.right()>i.x&&(x=x.withSize(x.size.withX(i.x-x.left()))),x.width()>s){let P=this.props.searchResults?.getMatchForFrame(w.node.frame),Q=Zo(e,w.node.frame.name,x.width()-2*c);if(P){let _t=Qo(Q,P),qe=0,gn=x.left()+c,ma=(o-r)/2-2;for(let[ua,fa]of _t){gn+=Se(e,Q.trimmedString.substring(qe,ua));let ya=Se(e,Q.trimmedString.substring(ua,fa));g.rect({x:gn,y:x.top()+ma,w:ya,h:o-2*ma}),gn+=ya,qe=fa}}(this.props.searchResults!=null&&!P?u:d).text({text:Q.trimmedString,x:x.left()+c,y:Math.round(x.bottom()-(o-r)/2)})}}for(let x of w.children)l(x,T+1)}},v=2*window.devicePixelRatio;e.strokeStyle=this.props.theme.selectionSecondaryColor;let f=(a.inverseTransformVector(new m(1,0))||new m(0,0)).x,b=(w,T=0)=>{if(!this.props.selectedNode&&this.props.searchResults==null)return;let D=w.end-w.start,ne=this.props.renderInverted?this.configSpaceSize().y-1-T:T,R=new k(new m(w.start,ne),new m(D,1));if(!(D<f)&&!(R.left()>this.props.configSpaceViewportRect.right())&&!(R.right()<this.props.configSpaceViewportRect.left())&&!(R.top()>this.props.configSpaceViewportRect.bottom())){if(R.hasIntersectionWith(this.props.configSpaceViewportRect)){if(this.props.searchResults?.getMatchForFrame(w.node.frame)){let x=a.transformRect(R);_.rect({x:Math.round(x.left()+v/2),y:Math.round(x.top()+v/2),w:Math.round(Math.max(0,x.width()-v)),h:Math.round(Math.max(0,x.height()-v))})}if(this.props.selectedNode!=null&&w.node.frame===this.props.selectedNode.frame){let x=w.node===this.props.selectedNode?j:C,P=a.transformRect(R);x.rect({x:Math.round(P.left()+1+v/2),y:Math.round(P.top()+1+v/2),w:Math.round(Math.max(0,P.width()-2-v)),h:Math.round(Math.max(0,P.height()-2-v))})}}for(let x of w.children)b(x,T+1)}};for(let w of this.props.flamechart.getLayers()[0]||[])b(w);for(let w of this.props.flamechart.getLayers()[0]||[])l(w);let S=this.props.theme;if(_.fill(e,S.searchMatchPrimaryColor),g.fill(e,S.searchMatchSecondaryColor),u.fill(e,S.fgSecondaryColor),d.fill(e,this.props.searchResults!=null?S.searchMatchTextColor:S.fgPrimaryColor),C.stroke(e,S.selectionSecondaryColor,v),j.stroke(e,S.selectionPrimaryColor,v),this.hoveredLabel){let w=S.fgPrimaryColor;this.props.selectedNode===this.hoveredLabel.node&&(w=S.selectionPrimaryColor),e.lineWidth=2*devicePixelRatio,e.strokeStyle=w;let T=a.transformRect(this.hoveredLabel.configSpaceBounds);e.strokeRect(Math.round(T.left()),Math.round(T.top()),Math.round(Math.max(0,T.width())),Math.round(Math.max(0,T.height())))}this.renderTimeIndicators()}renderTimeIndicators(){let e=this.overlayCtx;if(!e)return;let a=this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT*window.devicePixelRatio,r=this.physicalViewSize(),o=this.configSpaceToPhysicalViewSpace(),i=10*window.devicePixelRatio,s=(a-i)/2,h=this.props.configSpaceViewportRect.left(),c=this.props.configSpaceViewportRect.right(),u=(this.configSpaceToPhysicalViewSpace().inverted()||new H).times(this.logicalToPhysicalViewSpace()).transformVector(new m(200,1)).x,j=Math.pow(10,Math.floor(Math.log10(u)));u/j>5?j*=5:u/j>2&&(j*=2);let C=this.props.theme;{let _=this.props.renderInverted?r.y-a:0;e.fillStyle=O.fromCSSHex(C.bgPrimaryColor).withAlpha(.8).toCSS(),e.fillRect(0,_,r.x,a),e.textBaseline="top";for(let l=Math.ceil(h/j)*j;l<c;l+=j){let v=Math.round(o.transformPosition(new m(l,0)).x),f=this.props.flamechart.formatValue(l),b=Se(e,f);e.fillStyle=C.fgPrimaryColor,e.fillText(f,v-b-s,_+s),e.fillStyle=C.fgSecondaryColor,e.fillRect(v,0,1,r.y)}}}updateConfigSpaceViewport(){if(!this.container)return;let{logicalSpaceViewportSize:e}=this.props,a=this.container.getBoundingClientRect(),{width:r,height:o}=a;if(r<2||o<2)return;if(this.props.configSpaceViewportRect.isEmpty()){let s=o/this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT;this.props.renderInverted?this.setConfigSpaceViewportRect(new k(new m(0,this.configSpaceSize().y-s+1),new m(this.configSpaceSize().x,s))):this.setConfigSpaceViewportRect(new k(new m(0,-1),new m(this.configSpaceSize().x,s)))}else!e.equals(m.zero)&&(e.x!==r||e.y!==o)&&this.setConfigSpaceViewportRect(this.props.configSpaceViewportRect.withSize(this.props.configSpaceViewportRect.size.timesPointwise(new m(r/e.x,o/e.y))));let i=new m(r,o);i.equals(e)||this.props.setLogicalSpaceViewportSize(i)}renderRects(){this.container&&(this.updateConfigSpaceViewport(),!this.props.configSpaceViewportRect.isEmpty()&&this.props.canvasContext.renderBehind(this.container,()=>{this.props.flamechartRenderer.render({physicalSpaceDstRect:this.physicalBounds(),configSpaceSrcRect:this.props.configSpaceViewportRect,renderOutlines:!0})}))}pan(e){this.interactionLock="pan";let a=this.logicalToPhysicalViewSpace().transformVector(e),r=this.configSpaceToPhysicalViewSpace().inverseTransformVector(a);this.hoveredLabel&&this.props.onNodeHover(null),r&&this.props.transformViewport(H.withTranslation(r))}zoom(e,a){this.interactionLock="zoom";let r=this.logicalToPhysicalViewSpace().transformPosition(e),o=this.configSpaceToPhysicalViewSpace().inverseTransformPosition(r);if(!o)return;let i=H.withTranslation(o.times(-1)).scaledBy(new m(a,1)).translatedBy(o);this.props.transformViewport(i)}updateCursor(){this.lastDragPos?(document.body.style.cursor="grabbing",document.body.style.cursor="-webkit-grabbing"):document.body.style.cursor="default"}shouldComponentUpdate(){return!1}componentWillReceiveProps(e){this.props.flamechart!==e.flamechart?(this.hoveredLabel=null,this.renderCanvas()):this.props.searchResults!==e.searchResults?this.renderCanvas():this.props.selectedNode!==e.selectedNode?this.renderCanvas():this.props.configSpaceViewportRect!==e.configSpaceViewportRect?this.renderCanvas():this.props.canvasContext!==e.canvasContext&&(this.props.canvasContext&&this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame),e.canvasContext&&(e.canvasContext.addBeforeFrameHandler(this.onBeforeFrame),e.canvasContext.requestFrame()))}componentDidMount(){this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keydown",this.onWindowKeyPress)}componentWillUnmount(){this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keydown",this.onWindowKeyPress)}render(){let e=this.getStyle();return p("div",{className:y(e.panZoomView,$.vbox),onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onClick:this.onClick,onDblClick:this.onDblClick,onWheel:this.onWheel,ref:this.containerRef},p("canvas",{width:1,height:1,ref:this.overlayCanvasRef,className:y(e.fill)}))}};function mn(n){let t=u_(I()),{containerSize:e,offset:a}=n,r=e.x,o=e.y,i=7,s=E(h=>{if(!h)return;let c=h.getBoundingClientRect(),d=a.x+i;d+c.width>r-1&&(d=r-c.width-1,d<1&&(d=1)),h.style.left=`${d}px`;let u=a.y+i;u+c.height>o-1&&(u=a.y-c.height-1,u<1&&(u=1)),h.style.top=`${u}px`},[r,o,a.x,a.y]);return p("div",{className:y(t.hoverTip),ref:s},p("div",{className:y(t.hoverTipRow)},n.children))}var vn=2,u_=U(n=>V.create({hoverTip:{position:"absolute",background:n.bgPrimaryColor,border:"1px solid black",maxWidth:900,paddingTop:vn,paddingBottom:vn,pointerEvents:"none",userSelect:"none",fontSize:10,fontFamily:'"Source Code Pro", Courier, monospace',zIndex:2},hoverTipRow:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflowX:"hidden",paddingLeft:vn,paddingRight:vn,maxWidth:900}}));var ni=he(null),aa=({flamechart:n,selectedNode:t,setSelectedNode:e,configSpaceViewportRect:a,setConfigSpaceViewportRect:r,children:o})=>{let i=le(Be),s=F(()=>i==null?null:new rn(n,i),[n,i]);return p(ni.Provider,{value:{results:s,flamechart:n,selectedNode:t,setSelectedNode:e,configSpaceViewportRect:a,setConfigSpaceViewportRect:r}},o)},ai=K(()=>{let n=le(ni),t=n==null?null:n.results,e=n==null?null:n.selectedNode,a=n==null?null:n.setSelectedNode,r=n==null?null:n.configSpaceViewportRect,o=n==null?null:n.setConfigSpaceViewportRect,i=n==null?null:n.flamechart,s=t==null?null:t.count(),h=F(()=>t==null||e==null?null:t.indexOf(e),[t,e]),c=E(g=>{if(!a||!i||!r||!o)return;let j=g.configSpaceBounds,C=new k(j.origin.minus(new m(0,1)),j.size.withY(r.height()));a(g.node),o(i.getClampedConfigSpaceViewportRect({configSpaceViewportRect:C}))},[r,o,a,i]),{selectPrev:d,selectNext:u}=F(()=>s==null||s===0||t==null?{selectPrev:()=>{},selectNext:()=>{}}:{selectPrev:()=>{if(!t?.at||s==null||s===0)return;let g=h==null?s-1:h-1;g<0&&(g=s-1);let j=t.at(g);c(j)},selectNext:()=>{if(!t?.at||s==null||s===0)return;let g=h==null?0:h+1;g>=s&&(g=0);let j=t.at(g);c(j)}},[s,h,t,c]);return p(on,{resultIndex:h,numResults:s,selectPrev:d,selectNext:u})});var _e=class extends q{};var lt=class extends _e{constructor(){super(...arguments);this.setConfigSpaceViewportRect=e=>{let a=150/20,r=this.configSpaceSize(),o=this.props.flamechart.getClampedViewportWidth(e.size.x),i=e.size.withX(o),s=m.clamp(e.origin,new m(0,-1),m.max(m.zero,r.minus(i).plus(new m(0,a+1))));this.props.setConfigSpaceViewportRect(new k(s,e.size.withX(o)))};this.setLogicalSpaceViewportSize=e=>{this.props.setLogicalSpaceViewportSize(e)};this.transformViewport=e=>{let a=e.transformRect(this.props.configSpaceViewportRect);this.setConfigSpaceViewportRect(a)};this.onNodeHover=e=>{this.props.setNodeHover(e)};this.onNodeClick=e=>{this.props.setSelectedNode(e)};this.container=null;this.containerRef=e=>{this.container=e||null}}getStyle(){return ue(this.props.theme)}configSpaceSize(){return new m(this.props.flamechart.getTotalWeight(),this.props.flamechart.getLayers().length)}formatValue(e){let a=this.props.flamechart.getTotalWeight(),r=100*e/a,o=ce(r);return`${this.props.flamechart.formatValue(e)} (${o})`}renderTooltip(){if(!this.container)return null;let{hover:e}=this.props;if(!e)return null;let{width:a,height:r,left:o,top:i}=this.container.getBoundingClientRect(),s=new m(e.event.clientX-o,e.event.clientY-i),h=e.node.frame,c=this.getStyle();return p(mn,{containerSize:new m(a,r),offset:s},p("span",{className:y(c.hoverCount)},this.formatValue(e.node.getTotalWeight()))," ",h.name,h.file?p("div",null,h.file,":",h.line):void 0)}render(){let e=this.getStyle();return p("div",{className:y(e.fill,$.vbox),ref:this.containerRef},p(hn,{theme:this.props.theme,configSpaceViewportRect:this.props.configSpaceViewportRect,transformViewport:this.transformViewport,flamechart:this.props.flamechart,flamechartRenderer:this.props.flamechartRenderer,canvasContext:this.props.canvasContext,setConfigSpaceViewportRect:this.setConfigSpaceViewportRect}),p(Be.Consumer,null,a=>p(oe,null,p(Oe,{theme:this.props.theme,canvasContext:this.props.canvasContext,flamechart:this.props.flamechart,flamechartRenderer:this.props.flamechartRenderer,renderInverted:!1,onNodeHover:this.onNodeHover,onNodeSelect:this.onNodeClick,selectedNode:this.props.selectedNode,transformViewport:this.transformViewport,configSpaceViewportRect:this.props.configSpaceViewportRect,setConfigSpaceViewportRect:this.setConfigSpaceViewportRect,logicalSpaceViewportSize:this.props.logicalSpaceViewportSize,setLogicalSpaceViewportSize:this.setLogicalSpaceViewportSize,searchResults:a}),p(ai,null))),this.renderTooltip(),this.props.selectedNode&&p(ti,{flamechart:this.props.flamechart,getCSSColorForFrame:this.props.getCSSColorForFrame,selectedNode:this.props.selectedNode}))}};function Ke(n){return{setNodeHover:E(t=>{Y.setFlamechartHoveredNode(n,t)},[n]),setLogicalSpaceViewportSize:E(t=>{Y.setLogicalSpaceViewportSize(n,t)},[n]),setConfigSpaceViewportRect:E(t=>{Y.setConfigSpaceViewportRect(n,t)},[n]),setSelectedNode:E(t=>{Y.setSelectedNode(n,t)},[n])}}var f_=ae(({profile:n,getColorBucketForFrame:t})=>new xe({getTotalWeight:n.getTotalWeight.bind(n),forEachCall:n.forEachCall.bind(n),formatValue:n.formatValue.bind(n),getColorBucketForFrame:t})),Ue=n=>ae(({canvasContext:t,flamechart:e})=>new _n(t.gl,Ia(t),e,t.rectangleBatchRenderer,t.flamechartColorPassRenderer,n)),y_=Ue(),oi=K(n=>{let{activeProfileState:t,glCanvas:e}=n,{profile:a,chronoViewState:r}=t,o=I(),i=ge({theme:o,canvas:e}),s=je(a),h=Re(s),c=ye({theme:o,frameToColorBucket:s}),d=f_({profile:a,getColorBucketForFrame:h}),u=y_({canvasContext:i,flamechart:d}),g=Ke("CHRONO");return p(aa,{flamechart:d,selectedNode:r.selectedNode,setSelectedNode:g.setSelectedNode,configSpaceViewportRect:r.configSpaceViewportRect,setConfigSpaceViewportRect:g.setConfigSpaceViewportRect},p(lt,{theme:o,renderInverted:!1,flamechart:d,flamechartRenderer:u,canvasContext:i,getCSSColorForFrame:c,...r,...g}))}),g_=ae(({profile:n,getColorBucketForFrame:t})=>new xe({getTotalWeight:n.getTotalNonIdleWeight.bind(n),forEachCall:n.forEachCallGrouped.bind(n),formatValue:n.formatValue.bind(n),getColorBucketForFrame:t})),j_=Ue(),ii=K(n=>{let{activeProfileState:t,glCanvas:e}=n,{profile:a,leftHeavyViewState:r}=t,o=I(),i=ge({theme:o,canvas:e}),s=je(a),h=Re(s),c=ye({theme:o,frameToColorBucket:s}),d=g_({profile:a,getColorBucketForFrame:h}),u=j_({canvasContext:i,flamechart:d}),g=Ke("LEFT_HEAVY");return p(aa,{flamechart:d,selectedNode:r.selectedNode,setSelectedNode:g.setSelectedNode,configSpaceViewportRect:r.configSpaceViewportRect,setConfigSpaceViewportRect:g.setConfigSpaceViewportRect},p(lt,{theme:o,renderInverted:!1,flamechart:d,flamechartRenderer:u,canvasContext:i,getCSSColorForFrame:c,...r,...g}))});function si(n,t){return S_(n,t)}var ra=97,_i=122,ci=65,C_=90,b_=48,x_=57;function li(n){let t=n.charCodeAt(0);return ra<=t&&t<=_i?1:ci<=t&&t<=C_?2:b_<=t&&t<=x_?3:0}function oa(n,t){if(n===t)return!0;let e=t.charCodeAt(0);return ra<=e&&e<=_i?n.charCodeAt(0)===e-ra+ci:!1}function S_(n,t){if(t.length==0)return{matchedRanges:[],score:0};let e=0,a=-1,r=-1,o=n.length,i=t.length;for(let s=0;s<o;s++){let h=n[s],c=t[e];if(oa(h,c)&&(a<0&&(a=s),e++,e==i)){r=s+1;break}}if(r==-1)return null;e--;for(let s=r-1;s>=a;s--){let h=n[s],c=t[e];if(oa(h,c)&&(e--,e<0))return a=s,E_(n,t,a,r)}throw new Error("Implementation error. This must be a bug in fzfFuzzyMatchV1")}var ia=16,hi=-3,la=-1,sa=ia/2,w_=ia/2,R_=sa+la,k_=-(hi+la),N_=2;function A_(n,t){return n===0&&t!==0?sa:n===1&&t==2||n!==3&&t==3?R_:t===0?w_:0}function E_(n,t,e,a){let r=0,o=0,i=!1,s=0,h=0,c=new Array(t.length),d=0;e>0&&(d=li(n[e-1]));for(let g=e;g<a;g++){let j=n[g],C=li(j);if(oa(j,t[r])){c[r]=g,o+=ia;let _=A_(d,C);s==0?h=_:(_===sa&&(h=_),_=Math.max(_,h,k_)),r===0?o+=_*N_:o+=_,i=!1,s++,r++}else i?o+=la:o+=hi,i=!0,s=0,h=0;d=C}if(r!==t.length)throw new Error("fzfCalculateScore should only be called when pattern is found between sidx and eidx");let u=[[c[0],c[0]+1]];for(let g=1;g<c.length;g++){let j=c[g],C=u[u.length-1];C[1]===j?C[1]=j+1:u.push([j,j+1])}return{score:o,matchedRanges:u}}function T_(n,t,e){let a=[],r=0;for(let o of t)a.push(n.slice(r,o[0])),a.push(p("span",{className:e},n.slice(o[0],o[1]))),r=o[1];return a.push(n.slice(r)),p("span",null,a)}function _a({activeDirection:n}){let t=I(),e=ca(t),a=n==="ascending"?t.fgPrimaryColor:t.fgSecondaryColor,r=n==="descending"?t.fgPrimaryColor:t.fgSecondaryColor;return p("svg",{width:"8",height:"10",viewBox:"0 0 8 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:y(e.sortIcon)},p("path",{d:"M0 4L4 0L8 4H0Z",fill:a}),p("path",{d:"M0 4L4 0L8 4H0Z",transform:"translate(0 10) scale(1 -1)",fill:r}))}function H_({setProfileIndexToView:n,setHoveredProfileIndex:t,profile:e,selected:a,hovered:r,nodeRef:o,closeProfileSelect:i,indexInProfileGroup:s,matchedRanges:h,indexInFilteredListView:c}){let d=ca(I()),u=E(()=>{i(),n(s)},[i,n,s]),g=E(v=>{t(s)},[t,s]),j=e.getName(),C=e.getTotalNonIdleWeight(),_=y(d.highlighted),l=F(()=>T_(j,h,_),[j,h,_]);return p("tr",{ref:o,onMouseUp:u,onMouseEnter:g,title:j,className:y(d.profileRow,c%2===0&&d.profileRowEven,a&&d.profileRowSelected,r&&d.profileRowHovered)},p("td",{className:y(d.indexCell)},s+1),p("td",{className:y(d.nameCell)},l),p("td",{className:y(d.weightCell)},e.formatValue(C)))}function di(n){n.stopPropagation()}function L_(n,t,e){let a=[];for(let r=0;r<n.length;r++){let o=n[r],i=si(o.getName(),t);i&&a.push({indexInProfileGroup:r,profile:o,...i})}return e.field==="name"?a.sort((r,o)=>{let i=r.profile.getName().toLowerCase(),s=o.profile.getName().toLowerCase();return e.direction==="ascending"?i.localeCompare(s):s.localeCompare(i)}):e.field==="weight"?we(a,r=>e.direction==="ascending"?r.profile.getTotalNonIdleWeight():-r.profile.getTotalNonIdleWeight()):e.field==="index"?we(a,r=>e.direction==="ascending"?r.indexInProfileGroup:-r.indexInProfileGroup):we(a,r=>-r.score),a}function vi({profiles:n,closeProfileSelect:t,indexToView:e,visible:a,setProfileIndexToView:r}){let o=ca(I()),[i,s]=te(""),[h,c]=te({field:"index",direction:"ascending"}),d=E(R=>{let x=R.target.value;s(x)},[s]),u=E(R=>{R&&(a?R.select():R.blur())},[a]),g=E((R,x)=>{x.preventDefault(),x.stopPropagation(),h.field===R?c({field:R,direction:h.direction==="ascending"?"descending":"ascending"}):c({field:R,direction:R==="name"||R==="index"?"ascending":"descending"})},[h,c]),j=F(()=>L_(n,i,h),[n,i,h]),[C,_]=te(0),l=ke(null);re(()=>{a&&(_(null),l.current!==null&&l.current.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"}))},[a]);let v=E(R=>{R.stopPropagation();let x=null;switch(R.key){case"Enter":{C!=null&&(t(),r(C));break}case"Escape":{t();break}case"ArrowDown":{if(R.preventDefault(),x=0,C!=null){let P=j.findIndex(Q=>Q.indexInProfileGroup===C);P!==-1&&(x=P+1)}break}case"ArrowUp":{if(R.preventDefault(),x=j.length-1,C!=null){let P=j.findIndex(Q=>Q.indexInProfileGroup===C);P!==-1&&(x=P-1)}break}}if(x!=null&&x>=0&&x<j.length){let P=j[x].indexInProfileGroup;_(P),b(!0)}},[t,r,C,j]),[f,b]=te(!1);re(()=>{j.length>0&&(_(j[0].indexInProfileGroup),b(!0))},[_,j]);let S=E(R=>{f&&R&&(R.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"}),b(!1))},[f,b]),w=E(R=>{l.current=R,S(R)},[l,S]),T=E(R=>g("name",R),[g]),D=E(R=>g("weight",R),[g]),ne=E(R=>g("index",R),[g]);return p("div",{className:y(o.profileSelectOuter)},p("div",{className:y(o.caret)}),p("div",{className:y(o.profileSelectBox)},p("div",{className:y(o.filterInputContainer)},p("input",{type:"text",className:y(o.filterInput),ref:u,placeholder:"Filter...",value:i,onInput:d,onKeyDown:v,onKeyUp:di,onKeyPress:di})),p("div",{className:y(o.profileSelectScrolling)},p("table",{className:y(o.tableView)},p("thead",{className:y(o.tableHeader)},p("tr",null,p("th",{className:y(o.indexHeaderCell),onClick:ne},p(_a,{activeDirection:h.field==="index"?h.direction:null}),"#"),p("th",{className:y(o.nameHeaderCell),onClick:T},p(_a,{activeDirection:h.field==="name"?h.direction:null}),"Name"),p("th",{className:y(o.weightHeaderCell),onClick:D},p(_a,{activeDirection:h.field==="weight"?h.direction:null}),"Total Weight"))),p("tbody",null,j.map(({profile:R,matchedRanges:x,indexInProfileGroup:P},Q)=>{let Ge,_t=P===e,qe=P===C;return _t&&qe?Ge=w:_t?Ge=l:qe&&(Ge=S),p(H_,{key:Q,setHoveredProfileIndex:_,indexInProfileGroup:P,indexInFilteredListView:Q,hovered:P==C,selected:P===e,profile:R,nodeRef:Ge,matchedRanges:x,setProfileIndexToView:r,closeProfileSelect:t})}),j.length===0?p("tr",null,p("td",{colSpan:3,className:y(o.noResultsRow)},'No results match filter "',i,'"')):null)))))}var pi=10,ca=U(n=>V.create({filterInputContainer:{display:"flex",flexDirection:"column",padding:5,alignItems:"stretch"},filterInput:{color:n.altFgPrimaryColor,background:n.altBgSecondaryColor,borderRadius:5,padding:5,border:"none",":focus":{outline:"none"},"::selection":{color:n.altFgPrimaryColor,background:n.selectionPrimaryColor}},caret:{width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottom:"5px solid black"},highlighted:{background:n.selectionSecondaryColor},padding:{height:pi,background:n.altBgPrimaryColor},tableView:{width:"100%",fontSize:10,background:n.altBgPrimaryColor,borderCollapse:"collapse"},tableHeader:{borderBottom:`2px solid ${n.altBgSecondaryColor}`,textAlign:"left",color:n.altFgPrimaryColor,userSelect:"none"},indexHeaderCell:{cursor:"pointer",padding:"8px 10px",textAlign:"right",fontWeight:"bold",width:"20px"},nameHeaderCell:{cursor:"pointer",padding:"8px 10px",textAlign:"left",fontWeight:"bold"},weightHeaderCell:{cursor:"pointer",padding:"8px 10px",textAlign:"right",fontWeight:"bold",width:"150px"},sortIcon:{position:"relative",top:1,marginRight:4},profileRow:{height:18,background:n.altBgPrimaryColor,cursor:"pointer",":hover":{background:n.altBgSecondaryColor}},profileRowHovered:{background:n.altBgSecondaryColor},profileRowSelected:{background:n.selectionPrimaryColor,color:n.altFgPrimaryColor},profileRowEven:{background:n.altBgSecondaryColor},indexCell:{padding:"4px 10px",textAlign:"right",whiteSpace:"nowrap",width:"20px",fontFamily:"monospace",color:n.altFgSecondaryColor},nameCell:{padding:"4px 10px",textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"300px"},weightCell:{padding:"4px 10px",textAlign:"right",whiteSpace:"nowrap",width:"150px",fontFamily:"monospace"},noResultsRow:{padding:"20px",textAlign:"center",color:n.altFgSecondaryColor,fontStyle:"italic"},profileSelectScrolling:{maxHeight:`min(calc(100vh - ${20-2*pi}px), ${20*20}px)`,overflow:"auto","::-webkit-scrollbar":{background:n.altBgPrimaryColor},"::-webkit-scrollbar-thumb":{background:n.altFgSecondaryColor,borderRadius:20,border:`3px solid ${n.altBgPrimaryColor}`,":hover":{background:n.altBgPrimaryColor}}},profileSelectBox:{width:"100%",paddingBottom:10,background:n.altBgPrimaryColor,color:n.altFgPrimaryColor},profileSelectOuter:{width:"100%",maxWidth:600,margin:"0 auto",position:"relative",zIndex:1,alignItems:"center",display:"flex",flexDirection:"column"},profileIndex:{textAlign:"right",display:"inline-block",color:n.altFgSecondaryColor},profileIndexSelected:{color:n.altFgPrimaryColor}}));function ha(n,t){return E(()=>n(t),[n,t])}function I_(n){let t=un(I()),e=ha(Ne.set,0),a=ha(Ne.set,1),r=ha(Ne.set,2);return n.activeProfileState?p("div",{className:y(t.toolbarLeft)},p("div",{className:y(t.toolbarTab,n.viewMode===0&&t.toolbarTabActive),onClick:e},p("span",{className:y(t.emoji)},"\u{1F570}"),"Time Order"),p("div",{className:y(t.toolbarTab,n.viewMode===1&&t.toolbarTabActive),onClick:a},p("span",{className:y(t.emoji)},"\u2B05\uFE0F"),"Left Heavy"),p("div",{className:y(t.toolbarTab,n.viewMode===2&&t.toolbarTabActive),onClick:r},p("span",{className:y(t.emoji)},"\u{1F96A}"),"Sandwich")):null}var z_=(()=>{let n=null;return t=>{let e=t?.profiles.map(a=>a.profile)||null;return(n===null||e!=null&&!ht(n,e))&&(n=e),n}})();function F_(n){let t=un(I()),{activeProfileState:e,profileGroup:a}=n,r=z_(a),[o,i]=te(!1),s=E(()=>{i(!0)},[i]),h=E(()=>{i(!1)},[i]);return re(()=>{let c=d=>{d.key==="t"&&(d.preventDefault(),i(!0))};return window.addEventListener("keypress",c),()=>{window.removeEventListener("keypress",c)}},[i]),re(()=>{let c=d=>{d.key==="t"&&(d.preventDefault(),i(!0))};return window.addEventListener("keypress",c),()=>{window.removeEventListener("keypress",c)}},[i]),e&&a&&r?a.profiles.length===1?p(oe,null,e.profile.getName()):p("div",{className:y(t.toolbarCenter),onMouseLeave:h},p("span",{onMouseOver:s},e.profile.getName()," ",p("span",{className:y(t.toolbarProfileIndex)},"(",e.index+1,"/",a.profiles.length,")")),p("div",{style:{display:o?"block":"none"}},p(vi,{setProfileIndexToView:n.setProfileIndexToView,indexToView:a.indexToView,profiles:r,closeProfileSelect:h,visible:o}))):p(oe,null,"\u{1F52C}speedscope")}function D_(n){let t=un(I()),e=z(He),a=p("div",{className:y(t.toolbarTab),onClick:n.saveFile},p("span",{className:y(t.emoji)},"\u2934\uFE0F"),"Export"),r=p("div",{className:y(t.toolbarTab),onClick:n.browseForFile},p("span",{className:y(t.emoji)},"\u2935\uFE0F"),"Import"),o=p("div",{className:y(t.toolbarTab),onClick:He.cycleToNextColorScheme},p("span",{className:y(t.emoji)},"\u{1F3A8}"),p("span",{className:y(t.toolbarTabColorSchemeToggle)},vr(e))),i=p("div",{className:y(t.toolbarTab)},p("a",{href:"https://github.com/jlfwong/speedscope#usage",className:y(t.noLinkStyle),target:"_blank"},p("span",{className:y(t.emoji)},"\u2753"),"Help"));return p("div",{className:y(t.toolbarRight)},n.activeProfileState&&a,r,o,i)}function mi(n){let t=un(I());return p("div",{className:y(t.toolbar)},p(I_,{...n}),p(F_,{...n}),p(D_,{...n}))}var un=U(n=>V.create({toolbar:{height:20,flexShrink:0,background:n.altBgPrimaryColor,color:n.altFgPrimaryColor,textAlign:"center",fontFamily:'"Source Code Pro", Courier, monospace',fontSize:12,lineHeight:"18px",userSelect:"none"},toolbarLeft:{position:"absolute",height:20,overflow:"hidden",top:0,left:0,marginRight:2,textAlign:"left"},toolbarCenter:{paddingTop:1,height:20},toolbarRight:{height:20,overflow:"hidden",position:"absolute",top:0,right:0,marginRight:2,textAlign:"right"},toolbarProfileIndex:{color:n.altFgSecondaryColor},toolbarTab:{background:n.altBgSecondaryColor,marginTop:2,height:18,lineHeight:"18px",paddingLeft:2,paddingRight:8,display:"inline-block",marginLeft:2,transition:"all 0.07s ease-in",":hover":{background:n.selectionSecondaryColor}},toolbarTabActive:{background:n.selectionPrimaryColor,":hover":{background:n.selectionPrimaryColor}},toolbarTabColorSchemeToggle:{display:"inline-block",textAlign:"center",minWidth:"50px"},emoji:{display:"inline-block",verticalAlign:"middle",paddingTop:"0px",marginRight:"0.3em"},noLinkStyle:{textDecoration:"none",color:"inherit"}}));var P_=import("./source-map-5DQ363YZ.js"),M_=!1;async function ui(n,t){let e=await P_,a=null,r=null;try{r=JSON.parse(n),a=new e.default.SourceMapConsumer(r)}catch{return null}let o=[];a.eachMapping(function(s){o.push({...s,generatedColumn:s.generatedColumn+1,originalColumn:s.originalColumn+1})},{},e.default.SourceMapConsumer.GENERATED_ORDER);let i=t.replace(/\.[^/]*$/,"");return s=>{let h=!1;if((r?.file&&r?.file===s.file||("/"+s.file?.replace(/\.[^/]*$/,"")).endsWith("/"+i))&&(h=!0),!h||s.line==null||s.col==null)return null;let c=ba(o,g=>g.generatedLine>s.line?!0:g.generatedLine<s.line?!1:g.generatedColumn>=s.col);if(c===-1)c=o.length-1;else{if(c===0)return null;c--}let d=o[c],u={};if(d.name!=null)u.name=d.name;else if(d.source!=null){let g=a?.sourceContentFor(d.source,!0);if(g){let C=g.split(`
`)[d.originalLine-1];if(C){let _=/\w+/.exec(C.substr(d.originalColumn-1));_&&(u.name=_[0])}}}switch(u.name){case"constructor":{u.name=s.name+" constructor";break}case"function":{u.name=s.name;break}case"const":case"export":{u.name=s.name;break}}return u.name&&s.name.includes(u.name)&&(u.name=s.name),d.source!=null&&(u.file=d.source,u.line=d.originalLine,u.col=d.originalColumn),M_&&(console.groupCollapsed(`Remapping "${s.name}" -> "${u.name}"`),console.log("before",{...s}),console.log("item @ index",d),console.log("item @ index + 1",o[c+1]),console.log("after",u),console.groupEnd()),u}}var fi=({items:n,axis:t,renderItems:e,className:a,initialIndexInView:r})=>{let[o,i]=te(null),[s,h]=te(0),c=ke(null),d=t==="x"?"width":"height",u=t==="x"?"left":"top",g=t==="x"?"scrollLeft":"scrollTop",j=r?n.reduce((w,T,D)=>D<r?w+T.size:w,0):0,C=ke(j),_=E(w=>{w?requestAnimationFrame(()=>{i(w.getBoundingClientRect()[d]),C.current!=null&&(w.scrollTo({[u]:C.current}),C.current=null)}):i(null),c.current=w},[i,d,u]),l=F(()=>{if(c.current==null||o==null||s==null)return null;let w=s-o/4,T=s+o+o/4,D=0,ne=0,R=0;for(;R<n.length;R++){let Q=n[R];if(ne=D,D+=Q.size,D>=w)break}let x=R;for(;R<n.length;R++){let Q=n[R];if(D+=Q.size,D>=T)break}let P=Math.min(R,n.length-1);return{firstVisibleIndex:x,lastVisibleIndex:P,invisiblePrefixSize:ne}},[o,s,n]),v=F(()=>n.reduce((w,T)=>w+T.size,0),[n]),f=E(()=>{c.current!=null&&h(c.current[g])},[g]);re(()=>{let w=()=>{c.current!=null&&i(c.current.getBoundingClientRect()[d])};return window.addEventListener("resize",w),()=>{window.removeEventListener("resize",w)}},[d]);let b=F(()=>l?e(l.firstVisibleIndex,l.lastVisibleIndex):null,[e,l]),S=F(()=>p("div",{style:{height:v}},p("div",{style:{transform:`translateY(${l?.invisiblePrefixSize||0}px)`}},b)),[l,b,v]);return p("div",{className:a,ref:_,onScroll:f},S)};function yi(n){let t=fn(I());return p("div",{className:y(t.hBarDisplay)},p("div",{className:y(t.hBarDisplayFilled),style:{width:`${n.perc}%`}}))}function da(n){let t=I(),e=fn(t),{activeDirection:a}=n,r=a===0?t.fgPrimaryColor:t.fgSecondaryColor,o=a===1?t.fgPrimaryColor:t.fgSecondaryColor;return p("svg",{width:"8",height:"10",viewBox:"0 0 8 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:y(e.sortIcon)},p("path",{d:"M0 4L4 0L8 4H0Z",fill:r}),p("path",{d:"M0 4L4 0L8 4H0Z",transform:"translate(0 10) scale(1 -1)",fill:o}))}function O_(n,t,e){let a=[],r=0;for(let o of t)a.push(n.slice(r,o[0])),a.push(p("span",{className:e},n.slice(o[0],o[1]))),r=o[1];return a.push(n.slice(r)),p("span",null,a)}var K_=({frame:n,matchedRanges:t,profile:e,index:a,selectedFrame:r,setSelectedFrame:o,getCSSColorForFrame:i})=>{let s=fn(I()),h=n.getTotalWeight(),c=n.getSelfWeight(),d=100*h/e.getTotalNonIdleWeight(),u=100*c/e.getTotalNonIdleWeight(),g=n===r;return p("tr",{key:`${a}`,onClick:o.bind(null,n),className:y(s.tableRow,a%2==0&&s.tableRowEven,g&&s.tableRowSelected)},p("td",{className:y(s.numericCell)},e.formatValue(h)," (",ce(d),")",p(yi,{perc:d})),p("td",{className:y(s.numericCell)},e.formatValue(c)," (",ce(u),")",p(yi,{perc:u})),p("td",{title:n.file,className:y(s.textCell)},p(pn,{color:i(n)}),t?O_(n.name,t,y(s.matched,g&&s.matchedSelected)):n.name))},U_=K(({profile:n,sortMethod:t,setSortMethod:e,selectedFrame:a,setSelectedFrame:r,getCSSColorForFrame:o,searchQuery:i,searchIsActive:s})=>{let h=fn(I()),c=E((l,v)=>{if(v.preventDefault(),t.field==l)e({field:l,direction:t.direction===0?1:0});else switch(l){case 0:{e({field:l,direction:0});break}case 1:{e({field:l,direction:1});break}case 2:{e({field:l,direction:1});break}}},[t,e]),d=le(st),u=E((l,v)=>{if(!d)return null;let f=[];for(let b=l;b<=v;b++){let S=d.rowList[b],w=d.getSearchMatchForFrame(S);f.push(K_({frame:S,matchedRanges:w??null,index:b,profile:n,selectedFrame:a,setSelectedFrame:r,getCSSColorForFrame:o}))}return f.length===0&&(s?f.push(p("tr",null,p("td",{className:y(h.emptyState)},'No symbol names match query "',i,'".'))):f.push(p("tr",null,p("td",{className:y(h.emptyState)},"No symbols found.")))),p("table",{className:y(h.tableView)},f)},[d,n,a,r,o,s,i,h.emptyState,h.tableView]),g=F(()=>d==null?[]:d.rowList.map(l=>({size:20})),[d]),j=E(l=>c(2,l),[c]),C=E(l=>c(1,l),[c]),_=E(l=>c(0,l),[c]);return p("div",{className:y($.vbox,h.profileTableView)},p("table",{className:y(h.tableView)},p("thead",{className:y(h.tableHeader)},p("tr",null,p("th",{className:y(h.numericCell),onClick:j},p(da,{activeDirection:t.field===2?t.direction:null}),"Total"),p("th",{className:y(h.numericCell),onClick:C},p(da,{activeDirection:t.field===1?t.direction:null}),"Self"),p("th",{className:y(h.textCell),onClick:_},p(da,{activeDirection:t.field===0?t.direction:null}),"Symbol Name")))),p(fi,{axis:"y",items:g,className:y(h.scrollView),renderItems:u,initialIndexInView:a==null?null:d?.getIndexForFrame(a)}))}),fn=U(n=>V.create({profileTableView:{background:n.bgPrimaryColor,height:"100%"},scrollView:{overflowY:"auto",overflowX:"hidden",flexGrow:1,"::-webkit-scrollbar":{background:n.bgPrimaryColor},"::-webkit-scrollbar-thumb":{background:n.fgSecondaryColor,borderRadius:20,border:`3px solid ${n.bgPrimaryColor}`,":hover":{background:n.fgPrimaryColor}}},tableView:{width:"100%",fontSize:10,background:n.bgPrimaryColor},tableHeader:{borderBottom:`2px solid ${n.bgSecondaryColor}`,textAlign:"left",color:n.fgPrimaryColor,userSelect:"none"},sortIcon:{position:"relative",top:1,marginRight:20/4},tableRow:{background:n.bgPrimaryColor,height:20},tableRowEven:{background:n.bgSecondaryColor},tableRowSelected:{background:n.selectionPrimaryColor,color:n.altFgPrimaryColor},numericCell:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",position:"relative",textAlign:"right",paddingRight:20,width:6*20,minWidth:6*20},textCell:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",width:"100%",maxWidth:0},hBarDisplay:{position:"absolute",background:O.fromCSSHex(n.weightColor).withAlpha(.2).toCSS(),bottom:2,height:2,width:`calc(100% - ${2*20}px)`,right:20},hBarDisplayFilled:{height:"100%",position:"absolute",background:n.weightColor,right:0},matched:{borderBottom:`2px solid ${n.fgPrimaryColor}`},matchedSelected:{borderColor:n.altFgPrimaryColor},emptyState:{textAlign:"center",fontWeight:"bold"}})),gi=K(n=>{let{activeProfileState:t}=n,{profile:e,sandwichViewState:a}=t;if(!e)throw new Error("profile missing");let r=z(nt),o=I(),{callerCallee:i}=a,s=i?i.selectedFrame:null,h=je(e),c=ye({theme:o,frameToColorBucket:h}),d=E(j=>{Y.setSelectedFrame(j)},[]),u=z(Pe),g=z(Me);return p(U_,{profile:e,selectedFrame:s,getCSSColorForFrame:c,sortMethod:r,setSelectedFrame:d,setSortMethod:nt.set,searchIsActive:u,searchQuery:g})});var $e=class extends _e{constructor(){super(...arguments);this.setConfigSpaceViewportRect=e=>{this.props.setConfigSpaceViewportRect(this.clampViewportToFlamegraph(e))};this.setLogicalSpaceViewportSize=e=>{this.props.setLogicalSpaceViewportSize(e)};this.transformViewport=e=>{this.setConfigSpaceViewportRect(e.transformRect(this.props.configSpaceViewportRect))};this.container=null;this.containerRef=e=>{this.container=e||null};this.setNodeHover=e=>{this.props.setNodeHover(e)}}clampViewportToFlamegraph(e){let{flamechart:a,renderInverted:r}=this.props;return a.getClampedConfigSpaceViewportRect({configSpaceViewportRect:e,renderInverted:r})}formatValue(e){let a=this.props.flamechart.getTotalWeight(),r=100*e/a,o=ce(r);return`${this.props.flamechart.formatValue(e)} (${o})`}renderTooltip(){if(!this.container)return null;let{hover:e}=this.props;if(!e)return null;let{width:a,height:r,left:o,top:i}=this.container.getBoundingClientRect(),s=new m(e.event.clientX-o,e.event.clientY-i),h=$_(this.props.theme),c=e.node.frame;return p(mn,{containerSize:new m(a,r),offset:s},p("span",{className:y(h.hoverCount)},this.formatValue(e.node.getTotalWeight()))," ",c.name,c.file?p("div",null,c.file,":",c.line):void 0)}render(){return p("div",{className:y($.fillY,$.fillX,$.vbox),ref:this.containerRef},p(Oe,{theme:this.props.theme,selectedNode:null,onNodeHover:this.setNodeHover,onNodeSelect:ze,configSpaceViewportRect:this.props.configSpaceViewportRect,setConfigSpaceViewportRect:this.setConfigSpaceViewportRect,transformViewport:this.transformViewport,flamechart:this.props.flamechart,flamechartRenderer:this.props.flamechartRenderer,canvasContext:this.props.canvasContext,renderInverted:this.props.renderInverted,logicalSpaceViewportSize:this.props.logicalSpaceViewportSize,setLogicalSpaceViewportSize:this.setLogicalSpaceViewportSize,searchResults:null}),this.renderTooltip())}},$_=U(n=>V.create({hoverCount:{color:n.weightColor}}));var W_=ae(({profile:n,frame:t,flattenRecursion:e})=>{let a=n.getInvertedProfileForCallersOf(t);return e?a.getProfileWithRecursionFlattened():a}),G_=ae(({invertedCallerProfile:n,getColorBucketForFrame:t})=>new xe({getTotalWeight:n.getTotalNonIdleWeight.bind(n),forEachCall:n.forEachCallGrouped.bind(n),formatValue:n.formatValue.bind(n),getColorBucketForFrame:t})),q_=Ue({inverted:!0}),ji=K(n=>{let{activeProfileState:t}=n,{profile:e,sandwichViewState:a}=t,r=z(Ce),o=z(Te),i=I();if(!e)throw new Error("profile missing");if(!o)throw new Error("glCanvas missing");let{callerCallee:s}=a;if(!s)throw new Error("callerCallee missing");let{selectedFrame:h}=s,c=je(e),d=Re(c),u=ye({theme:i,frameToColorBucket:c}),g=ge({theme:i,canvas:o}),j=G_({invertedCallerProfile:W_({profile:e,frame:h,flattenRecursion:r}),getColorBucketForFrame:d}),C=q_({canvasContext:g,flamechart:j});return p($e,{theme:i,renderInverted:!0,flamechart:j,flamechartRenderer:C,canvasContext:g,getCSSColorForFrame:u,...Ke("SANDWICH_INVERTED_CALLERS"),...s.invertedCallerFlamegraph,setSelectedNode:ze})});var X_=ae(({profile:n,frame:t,flattenRecursion:e})=>{let a=n.getProfileForCalleesOf(t);return e?a.getProfileWithRecursionFlattened():a}),Y_=ae(({calleeProfile:n,getColorBucketForFrame:t})=>new xe({getTotalWeight:n.getTotalNonIdleWeight.bind(n),forEachCall:n.forEachCallGrouped.bind(n),formatValue:n.formatValue.bind(n),getColorBucketForFrame:t})),Z_=Ue(),Ci=K(n=>{let{activeProfileState:t}=n,{profile:e,sandwichViewState:a}=t,r=z(Ce),o=z(Te),i=I();if(!e)throw new Error("profile missing");if(!o)throw new Error("glCanvas missing");let{callerCallee:s}=a;if(!s)throw new Error("callerCallee missing");let{selectedFrame:h}=s,c=je(e),d=Re(c),u=ye({theme:i,frameToColorBucket:c}),g=ge({theme:i,canvas:o}),j=Y_({calleeProfile:X_({profile:e,frame:h,flattenRecursion:r}),getColorBucketForFrame:d}),C=Z_({canvasContext:g,flamechart:j});return p($e,{theme:i,renderInverted:!1,flamechart:j,flamechartRenderer:C,canvasContext:g,getCSSColorForFrame:u,...Ke("SANDWICH_CALLEES"),...s.calleeFlamegraph,setSelectedNode:ze})});var bi=K(()=>{let n=le(st),t=n!=null?n.rowList:null,e=n?.selectedFrame!=null?n.getIndexForFrame(n.selectedFrame):null,a=t!=null?t.length:null,{selectPrev:r,selectNext:o}=F(()=>t==null||a==null||a===0||n==null?{selectPrev:()=>{},selectNext:()=>{}}:{selectPrev:()=>{let i=e==null?a-1:e-1;i<0&&(i=a-1),n.setSelectedFrame(t[i])},selectNext:()=>{let i=e==null?0:e+1;i>=a&&(i=0),n.setSelectedFrame(t[i])}},[e,t,a,n]);return p(on,{resultIndex:e,numResults:a,selectPrev:r,selectNext:o})});var pa=class extends _e{constructor(){super(...arguments);this.setSelectedFrame=e=>{this.props.setSelectedFrame(e)};this.onWindowKeyPress=e=>{e.key==="Escape"&&this.setSelectedFrame(null)}}componentDidMount(){window.addEventListener("keydown",this.onWindowKeyPress)}componentWillUnmount(){window.removeEventListener("keydown",this.onWindowKeyPress)}render(){let e=Q_(this.props.theme),{selectedFrame:a}=this.props,r=null;return a&&(r=p("div",{className:y($.fillY,e.callersAndCallees,$.vbox)},p("div",{className:y($.hbox,e.panZoomViewWraper)},p("div",{className:y(e.flamechartLabelParent)},p("div",{className:y(e.flamechartLabel)},"Callers")),p(ji,{glCanvas:this.props.glCanvas,activeProfileState:this.props.activeProfileState})),p("div",{className:y(e.divider)}),p("div",{className:y($.hbox,e.panZoomViewWraper)},p("div",{className:y(e.flamechartLabelParent,e.flamechartLabelParentBottom)},p("div",{className:y(e.flamechartLabel,e.flamechartLabelBottom)},"Callees")),p(Ci,{glCanvas:this.props.glCanvas,activeProfileState:this.props.activeProfileState})))),p("div",{className:y($.hbox,$.fillY)},p("div",{className:y(e.tableView)},p(gi,{activeProfileState:this.props.activeProfileState}),p(bi,null)),r)}},Q_=U(n=>V.create({tableView:{position:"relative",flex:1},panZoomViewWraper:{flex:1},flamechartLabelParent:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",fontSize:12,width:12*1.2,borderRight:`1px solid ${n.fgSecondaryColor}`},flamechartLabelParentBottom:{justifyContent:"flex-start"},flamechartLabel:{transform:"rotate(-90deg)",transformOrigin:"50% 50% 0",width:12*1.2,flexShrink:1},flamechartLabelBottom:{transform:"rotate(-90deg)",display:"flex",justifyContent:"flex-end"},callersAndCallees:{flex:1,borderLeft:`2px solid ${n.fgSecondaryColor}`},divider:{height:2,background:n.fgSecondaryColor}})),st=he(null),xi=K(n=>{let{activeProfileState:t,glCanvas:e}=n,{sandwichViewState:a,index:r}=t,{callerCallee:o}=a,i=I(),s=E(l=>{Y.setSelectedFrame(l)},[]),h=t.profile,c=z(nt),d=le(Be),u=o?o.selectedFrame:null,g=F(()=>{let l=[];switch(h.forEachFrame(v=>{d&&!d.getMatchForFrame(v)||l.push(v)}),c.field){case 0:{we(l,v=>v.name.toLowerCase());break}case 1:{we(l,v=>v.getSelfWeight());break}case 2:{we(l,v=>v.getTotalWeight());break}}return c.direction===1&&l.reverse(),l},[h,d,c]),j=F(()=>{let l=new Map;for(let v=0;v<g.length;v++)l.set(g[v],v);return v=>{let f=l.get(v);return f??null}},[g]),C=F(()=>l=>d==null?null:d.getMatchForFrame(l),[d]),_={rowList:g,selectedFrame:u,setSelectedFrame:s,getIndexForFrame:j,getSearchMatchForFrame:C};return p(st.Provider,{value:_},p(pa,{theme:i,activeProfileState:t,glCanvas:e,setSelectedFrame:s,selectedFrame:u,profileIndex:r}))});var We=import("./import-OCA3S65K.js");We.then(()=>{});import("./demangle-B53S5JWH.js").then(()=>{});import("./source-map-5DQ363YZ.js").then(()=>{});async function wi(n,t){return(await We).importProfileGroupFromText(n,t)}async function tc(n,t){return(await We).importProfileGroupFromBase64(n,t)}async function nc(n,t){return(await We).importProfilesFromArrayBuffer(n,t)}async function ac(n){return(await We).importProfilesFromFile(n)}async function rc(n){return(await We).importFromFileSystemDirectoryEntry(n)}var oc=Si();function ic(n){return n!=null&&n.isDirectory}var va=class extends _e{constructor(){super(...arguments);this.canvas=null;this.ref=e=>{e instanceof HTMLCanvasElement?this.canvas=e:this.canvas=null,this.props.setGLCanvas(this.canvas)};this.container=null;this.containerRef=e=>{e instanceof HTMLElement?this.container=e:this.container=null};this.maybeResize=()=>{if(!this.container||!this.props.canvasContext)return;let{width:e,height:a}=this.container.getBoundingClientRect(),r=e,o=a,i=e*window.devicePixelRatio,s=a*window.devicePixelRatio;this.props.canvasContext.gl.resize(i,s,r,o)};this.onWindowResize=()=>{this.props.canvasContext&&this.props.canvasContext.requestFrame()}}componentWillReceiveProps(e){this.props.canvasContext!==e.canvasContext&&(this.props.canvasContext&&this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize),e.canvasContext&&(e.canvasContext.addBeforeFrameHandler(this.maybeResize),e.canvasContext.requestFrame()))}componentDidMount(){window.addEventListener("resize",this.onWindowResize)}componentWillUnmount(){this.props.canvasContext&&this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize),window.removeEventListener("resize",this.onWindowResize)}render(){let e=Ri(this.props.theme);return p("div",{ref:this.containerRef,className:y(e.glCanvasView)},p("canvas",{ref:this.ref,width:1,height:1}))}},yn=class extends _e{constructor(){super(...arguments);this.loadExample=()=>{this.loadProfile(async()=>{let e="perf-vertx-stacks-01-collapsed-all.txt",a=await fetch(oc).then(r=>r.text());return await wi(e,a)})};this.onDrop=e=>{if(this.props.setDragActive(!1),e.preventDefault(),!e.dataTransfer)return;let a=e.dataTransfer.items[0];if("webkitGetAsEntry"in a){let o=a.webkitGetAsEntry();if(o&&ic(o)&&o.name.endsWith(".trace")){console.log("Importing as Instruments.app .trace file");let i=o;this.loadProfile(async()=>await rc(i));return}}let r=e.dataTransfer.files.item(0);r&&this.loadFromFile(r)};this.onDragOver=e=>{this.props.setDragActive(!0),e.preventDefault()};this.onDragLeave=e=>{this.props.setDragActive(!1),e.preventDefault()};this.onWindowKeyPress=async e=>{if(e.key==="1")this.props.setViewMode(0);else if(e.key==="2")this.props.setViewMode(1);else if(e.key==="3")this.props.setViewMode(2);else if(e.key==="r"){let{flattenRecursion:a}=this.props;this.props.setFlattenRecursion(!a)}else if(e.key==="n"){let{activeProfileState:a}=this.props;a&&this.props.setProfileIndexToView(a.index+1)}else if(e.key==="p"){let{activeProfileState:a}=this.props;a&&this.props.setProfileIndexToView(a.index-1)}};this.saveFile=()=>{if(this.props.profileGroup){let{name:e,indexToView:a,profiles:r}=this.props.profileGroup,o={name:e,indexToView:a,profiles:r.map(i=>i.profile)};xa(o)}};this.browseForFile=()=>{let e=document.createElement("input");e.type="file",e.addEventListener("change",this.onFileSelect),e.click()};this.onWindowKeyDown=async e=>{e.key==="s"&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),this.saveFile()):e.key==="o"&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.browseForFile())};this.onDocumentPaste=e=>{if(document.activeElement!=null&&document.activeElement.nodeName==="INPUT")return;e.preventDefault(),e.stopPropagation();let a=e.clipboardData;if(!a)return;let r=a.getData("text");this.loadProfile(async()=>await wi("From Clipboard",r))};this.onFileSelect=e=>{let a=e.target.files.item(0);a&&this.loadFromFile(a)}}async loadProfile(e){if(this.props.setError(!1),this.props.setLoading(!0),await new Promise(r=>setTimeout(r,0)),!this.props.glCanvas)return;console.time("import");let a=null;try{a=await e()}catch(r){console.log("Failed to load format",r),this.props.setError(!0);return}if(a==null){alert("Unrecognized format! See documentation about supported formats."),this.props.setLoading(!1);return}else if(a.profiles.length===0){alert("Successfully imported profile, but it's empty!"),this.props.setLoading(!1);return}this.props.hashParams.title&&(a={...a,name:this.props.hashParams.title}),document.title=`${a.name} - speedscope`,this.props.hashParams.viewMode&&this.props.setViewMode(this.props.hashParams.viewMode);for(let r of a.profiles)await r.demangle();for(let r of a.profiles){let o=this.props.hashParams.title||r.getName();r.setName(o)}console.timeEnd("import"),this.props.setProfileGroup(a),this.props.setLoading(!1)}getStyle(){return Ri(this.props.theme)}loadFromFile(e){this.loadProfile(async()=>{let a=await ac(e);if(a){for(let r of a.profiles)r.getName()||r.setName(e.name);return a}if(this.props.profileGroup&&this.props.activeProfileState){let r=new FileReader,o=new Promise(d=>{r.addEventListener("loadend",()=>{if(typeof r.result!="string")throw new Error("Expected reader.result to be a string");d(r.result)})});r.readAsText(e);let i=await o,s=null,h=qo(i);h&&(console.log("Importing as emscripten symbol map"),s=h);let c=await ui(i,e.name);if(!s&&c&&(console.log("Importing as JavaScript source map"),s=c),s!=null)return{name:this.props.profileGroup.name||"profile",indexToView:this.props.profileGroup.indexToView,profiles:this.props.profileGroup.profiles.map(d=>{let u=d.profile.shallowClone();return u.remapSymbols(s),u})}}return null})}componentDidMount(){window.addEventListener("keydown",this.onWindowKeyDown),window.addEventListener("keypress",this.onWindowKeyPress),document.addEventListener("paste",this.onDocumentPaste),this.maybeLoadHashParamProfile()}componentWillUnmount(){window.removeEventListener("keydown",this.onWindowKeyDown),window.removeEventListener("keypress",this.onWindowKeyPress),document.removeEventListener("paste",this.onDocumentPaste)}async maybeLoadHashParamProfile(){let{profileURL:e}=this.props.hashParams;if(e){if(!Nt){alert(`Cannot load a profile URL when loading from "${window.location.protocol}" URL protocol`);return}this.loadProfile(async()=>{let a=await fetch(e),r=new URL(e,window.location.href).pathname;return r.includes("/")&&(r=r.slice(r.lastIndexOf("/")+1)),await nc(r,await a.arrayBuffer())})}else if(this.props.hashParams.localProfilePath){window.speedscope={loadFileFromBase64:(r,o)=>{this.loadProfile(()=>tc(r,o))}};let a=document.createElement("script");a.src=`file:///${this.props.hashParams.localProfilePath}`,document.head.appendChild(a)}}renderLanding(){let e=this.getStyle();return p("div",{className:y(e.landingContainer)},p("div",{className:y(e.landingMessage)},p("p",{className:y(e.landingP)},"\u{1F44B} Hi there! Welcome to \u{1F52C}speedscope, an interactive"," ",p("a",{className:y(e.link),href:"http://www.brendangregg.com/FlameGraphs/cpuflamegraphs.html"},"flamegraph")," ","visualizer. Use it to help you make your software faster."),Nt?p("p",{className:y(e.landingP)},"Drag and drop a profile file onto this window to get started, click the big blue button below to browse for a profile to explore, or"," ",p("a",{tabIndex:0,className:y(e.link),onClick:this.loadExample},"click here")," ","to load an example profile."):p("p",{className:y(e.landingP)},"Drag and drop a profile file onto this window to get started, or click the big blue button below to browse for a profile to explore."),p("div",{className:y(e.browseButtonContainer)},p("input",{type:"file",name:"file",id:"file",onChange:this.onFileSelect,className:y(e.hide)}),p("label",{for:"file",className:y(e.browseButton),tabIndex:0},"Browse")),p("p",{className:y(e.landingP)},"See the"," ",p("a",{className:y(e.link),href:"https://github.com/jlfwong/speedscope#usage",target:"_blank"},"documentation")," ","for information about supported file formats, keyboard shortcuts, and how to navigate around the profile."),p("p",{className:y(e.landingP)},"speedscope is open source. Please"," ",p("a",{className:y(e.link),target:"_blank",href:"https://github.com/jlfwong/speedscope/issues"},"report any issues on GitHub"),".")))}renderError(){let e=this.getStyle();return p("div",{className:y(e.error)},p("div",null,"\u{1F63F} Something went wrong."),p("div",null,"Check the JS console for more details."))}renderLoadingBar(){let e=this.getStyle();return p("div",{className:y(e.loading)})}renderContent(){let{viewMode:e,activeProfileState:a,error:r,loading:o,glCanvas:i}=this.props;if(r)return this.renderError();if(o)return this.renderLoadingBar();if(!a||!i)return this.renderLanding();switch(e){case 0:return p(oi,{activeProfileState:a,glCanvas:i});case 1:return p(ii,{activeProfileState:a,glCanvas:i});case 2:return p(xi,{activeProfileState:a,glCanvas:i})}}render(){let e=this.getStyle();return p("div",{onDrop:this.onDrop,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,className:y(e.root,this.props.dragActive&&e.dragTargetRoot)},p(va,{setGLCanvas:this.props.setGLCanvas,canvasContext:this.props.canvasContext,theme:this.props.theme}),p(mi,{saveFile:this.saveFile,browseForFile:this.browseForFile,...this.props}),p("div",{className:y(e.contentContainer)},this.renderContent()),this.props.dragActive&&p("div",{className:y(e.dragTarget)}))}},Ri=U(n=>V.create({glCanvasView:{position:"absolute",width:"100vw",height:"100vh",zIndex:-1,pointerEvents:"none"},error:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},loading:{height:3,marginBottom:-3,background:n.selectionPrimaryColor,transformOrigin:"0% 50%",animationName:[{from:{transform:"scaleX(0)"},to:{transform:"scaleX(1)"}}],animationTimingFunction:"cubic-bezier(0, 1, 0, 1)",animationDuration:"30s"},root:{width:"100vw",height:"100vh",overflow:"hidden",display:"flex",flexDirection:"column",position:"relative",fontFamily:'"Source Code Pro", Courier, monospace',lineHeight:"20px",color:n.fgPrimaryColor},dragTargetRoot:{cursor:"copy"},dragTarget:{boxSizing:"border-box",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:`5px dashed ${n.selectionPrimaryColor}`,pointerEvents:"none"},contentContainer:{position:"relative",display:"flex",overflow:"hidden",flexDirection:"column",flex:1},landingContainer:{display:"flex",alignItems:"center",justifyContent:"center",flex:1},landingMessage:{maxWidth:600},landingP:{marginBottom:16},hide:{display:"none"},browseButtonContainer:{display:"flex",alignItems:"center",justifyContent:"center"},browseButton:{marginBottom:16,height:72,flex:1,maxWidth:256,textAlign:"center",fontSize:36,lineHeight:"72px",background:n.selectionPrimaryColor,color:n.altFgPrimaryColor,transition:"all 0.07s ease-in",":hover":{background:n.selectionSecondaryColor}},link:{color:n.selectionPrimaryColor,cursor:"pointer",textDecoration:"none",transition:"all 0.07s ease-in",":hover":{color:n.selectionSecondaryColor}}}));var ki=K(()=>{let n=z(Te),t=I(),e=F(()=>n?ge({theme:t,canvas:n}):null,[t,n]);return p(Wo,null,p(yn,{activeProfileState:At(),canvasContext:e,setGLCanvas:Te.set,setLoading:Mn.set,setError:Jn.set,setProfileGroup:Y.setProfileGroup,setDragActive:Pn.set,setViewMode:Ne.set,setFlattenRecursion:Ce.set,setProfileIndexToView:Y.setProfileIndexToView,profileGroup:z(Y),theme:t,flattenRecursion:z(Ce),viewMode:z(Ne),hashParams:z(ar),glCanvas:n,dragActive:z(Pn),loading:z(Mn),error:z(Jn)}))});console.log(`speedscope v${Ni().version}`);wn(p(mr,null,p(ki,null)),document.body,document.body.lastElementChild||void 0);
//# sourceMappingURL=speedscope-ZJBYGUSB.js.map
