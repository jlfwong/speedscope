{
  "version": 3,
  "sources": ["../../node_modules/css-in-js-utils/lib/isPrefixedValue.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/calc.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/crossFade.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/cursor.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/filter.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flex.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flexboxIE.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/flexboxOld.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/gradient.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/imageSet.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/position.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/sizing.js", "../../node_modules/hyphenate-style-name/index.js", "../../node_modules/css-in-js-utils/lib/hyphenateProperty.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/capitalizeString.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/plugins/transition.js", "../../node_modules/string-hash/index.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/prefixProperty.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/prefixValue.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/addNewValuesOnly.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/utils/isObject.js", "../../node_modules/aphrodite/node_modules/inline-style-prefixer/static/createPrefixer.js", "../../node_modules/asap/browser-raw.js", "../../node_modules/asap/browser-asap.js", "../../node_modules/preact/src/constants.js", "../../node_modules/preact/src/options.js", "../../node_modules/preact/src/create-element.js", "../../node_modules/preact/src/component.js", "../../node_modules/preact/src/render.js", "../../node_modules/preact/src/create-context.js", "../../node_modules/preact/src/util.js", "../../node_modules/preact/src/diff/children.js", "../../node_modules/preact/src/diff/props.js", "../../node_modules/preact/src/diff/index.js", "../../node_modules/preact/src/clone-element.js", "../../node_modules/preact/src/diff/catch-error.js", "../../src/lib/lru-cache.ts", "../../src/lib/math.ts", "../../src/gl/graphics.ts", "../../src/gl/utils.ts", "../../src/gl/rectangle-batch-renderer.ts", "../../src/lib/color.ts", "../../src/gl/row-atlas.ts", "../../src/gl/texture-renderer.ts", "../../src/gl/overlay-rectangle-renderer.ts", "../../src/gl/flamechart-color-pass-renderer.ts", "../../src/gl/canvas-context.ts", "../../src/app-state/getters.ts", "../../node_modules/preact/hooks/src/index.js", "../../node_modules/preact/compat/src/util.js", "../../node_modules/preact/compat/src/PureComponent.js", "../../node_modules/preact/compat/src/memo.js", "../../node_modules/preact/compat/src/forwardRef.js", "../../node_modules/preact/compat/src/Children.js", "../../node_modules/preact/compat/src/suspense.js", "../../node_modules/preact/compat/src/suspense-list.js", "../../node_modules/preact/compat/src/portals.js", "../../node_modules/preact/compat/src/render.js", "../../node_modules/preact/compat/src/events.js", "../../node_modules/preact/compat/src/index.js", "../../src/lib/atom.ts", "../../src/lib/hash-params.ts", "../../src/app-state/profile-group.ts", "../../src/app-state/index.ts", "../../src/app-state/active-profile-state.ts", "../../src/app-state/color-scheme.ts", "../../src/views/themes/dark-theme.ts", "../../src/views/themes/light-theme.ts", "../../src/views/themes/theme.tsx", "../../node_modules/aphrodite/es/index.js", "../../src/views/style.ts", "../../src/lib/profile-search.ts", "../../src/views/search-view.tsx", "../../src/lib/emscripten.ts", "../../src/lib/flamechart.ts", "../../src/gl/flamechart-renderer.ts", "../../src/views/flamechart-style.ts", "../../src/lib/text-utils.ts", "../../src/views/flamechart-minimap-view.tsx", "../../src/views/color-chit.tsx", "../../src/views/flamechart-detail-view.tsx", "../../src/lib/canvas-2d-batch-renderers.ts", "../../src/views/flamechart-pan-zoom-view.tsx", "../../src/views/hovertip.tsx", "../../src/views/flamechart-search-view.tsx", "../../src/lib/preact-helpers.tsx", "../../src/views/flamechart-view.tsx", "../../src/views/flamechart-view-container.tsx", "../../src/lib/fuzzy-find.ts", "../../src/views/profile-select.tsx", "../../src/views/toolbar.tsx", "../../src/lib/js-source-map.ts", "../../src/views/scrollable-list-view.tsx", "../../src/views/profile-table-view.tsx", "../../src/views/flamechart-wrapper.tsx", "../../src/views/inverted-caller-flamegraph-view.tsx", "../../src/views/callee-flamegraph-view.tsx", "../../src/views/sandwich-search-view.tsx", "../../src/views/sandwich-view.tsx", "../../src/views/application.tsx", "../../src/views/application-container.tsx", "../../src/speedscope.tsx"],
  "sourcesContent": ["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isPrefixedValue;\nvar regex = /-webkit-|-moz-|-ms-/;\n\nfunction isPrefixedValue(value) {\n  return typeof value === 'string' && regex.test(value);\n}\nmodule.exports = exports['default'];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = calc;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\nfunction calc(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"calc(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/calc\\(/g, prefix + \"calc(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = crossFade;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#search=cross-fade\nvar prefixes = [\"-webkit-\", \"\"];\nfunction crossFade(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"cross-fade(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/cross-fade\\(/g, prefix + \"cross-fade(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = cursor;\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar values = {\n  \"zoom-in\": true,\n  \"zoom-out\": true,\n  grab: true,\n  grabbing: true\n};\n\nfunction cursor(property, value) {\n  if (property === \"cursor\" && values.hasOwnProperty(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = filter;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#feat=css-filter-function\nvar prefixes = [\"-webkit-\", \"\"];\nfunction filter(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"filter(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/filter\\(/g, prefix + \"filter(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flex;\nvar values = {\n  flex: [\"-webkit-box\", \"-moz-box\", \"-ms-flexbox\", \"-webkit-flex\", \"flex\"],\n  \"inline-flex\": [\"-webkit-inline-box\", \"-moz-inline-box\", \"-ms-inline-flexbox\", \"-webkit-inline-flex\", \"inline-flex\"]\n};\n\nfunction flex(property, value) {\n  if (property === \"display\" && values.hasOwnProperty(value)) {\n    return values[value];\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flexboxIE;\nvar alternativeValues = {\n  \"space-around\": \"distribute\",\n  \"space-between\": \"justify\",\n  \"flex-start\": \"start\",\n  \"flex-end\": \"end\"\n};\nvar alternativeProps = {\n  alignContent: \"msFlexLinePack\",\n  alignSelf: \"msFlexItemAlign\",\n  alignItems: \"msFlexAlign\",\n  justifyContent: \"msFlexPack\",\n  order: \"msFlexOrder\",\n  flexGrow: \"msFlexPositive\",\n  flexShrink: \"msFlexNegative\",\n  flexBasis: \"msFlexPreferredSize\"\n};\n\nfunction flexboxIE(property, value, style) {\n  if (alternativeProps.hasOwnProperty(property)) {\n    style[alternativeProps[property]] = alternativeValues[value] || value;\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = flexboxOld;\nvar alternativeValues = {\n  \"space-around\": \"justify\",\n  \"space-between\": \"justify\",\n  \"flex-start\": \"start\",\n  \"flex-end\": \"end\",\n  \"wrap-reverse\": \"multiple\",\n  wrap: \"multiple\"\n};\n\nvar alternativeProps = {\n  alignItems: \"WebkitBoxAlign\",\n  justifyContent: \"WebkitBoxPack\",\n  flexWrap: \"WebkitBoxLines\"\n};\n\nfunction flexboxOld(property, value, style) {\n  if (property === \"flexDirection\" && typeof value === \"string\") {\n    if (value.indexOf(\"column\") > -1) {\n      style.WebkitBoxOrient = \"vertical\";\n    } else {\n      style.WebkitBoxOrient = \"horizontal\";\n    }\n    if (value.indexOf(\"reverse\") > -1) {\n      style.WebkitBoxDirection = \"reverse\";\n    } else {\n      style.WebkitBoxDirection = \"normal\";\n    }\n  }\n  if (alternativeProps.hasOwnProperty(property)) {\n    style[alternativeProps[property]] = alternativeValues[value] || value;\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = gradient;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar values = /linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;\n\nfunction gradient(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && values.test(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = imageSet;\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// http://caniuse.com/#feat=css-image-set\nvar prefixes = [\"-webkit-\", \"\"];\nfunction imageSet(property, value) {\n  if (typeof value === \"string\" && !(0, _isPrefixedValue2.default)(value) && value.indexOf(\"image-set(\") > -1) {\n    return prefixes.map(function (prefix) {\n      return value.replace(/image-set\\(/g, prefix + \"image-set(\");\n    });\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = position;\nfunction position(property, value) {\n  if (property === \"position\" && value === \"sticky\") {\n    return [\"-webkit-sticky\", \"sticky\"];\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = sizing;\nvar prefixes = [\"-webkit-\", \"-moz-\", \"\"];\n\nvar properties = {\n  maxHeight: true,\n  maxWidth: true,\n  width: true,\n  height: true,\n  columnWidth: true,\n  minWidth: true,\n  minHeight: true\n};\nvar values = {\n  \"min-content\": true,\n  \"max-content\": true,\n  \"fill-available\": true,\n  \"fit-content\": true,\n  \"contain-floats\": true\n};\n\nfunction sizing(property, value) {\n  if (properties.hasOwnProperty(property) && values.hasOwnProperty(value)) {\n    return prefixes.map(function (prefix) {\n      return prefix + value;\n    });\n  }\n}\nmodule.exports = exports[\"default\"];", "'use strict';\n\nvar uppercasePattern = /[A-Z]/g;\nvar msPattern = /^ms-/;\nvar cache = {};\n\nfunction hyphenateStyleName(string) {\n    return string in cache\n    ? cache[string]\n    : cache[string] = string\n      .replace(uppercasePattern, '-$&')\n      .toLowerCase()\n      .replace(msPattern, '-ms-');\n}\n\nmodule.exports = hyphenateStyleName;\n", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = hyphenateProperty;\n\nvar _hyphenateStyleName = require('hyphenate-style-name');\n\nvar _hyphenateStyleName2 = _interopRequireDefault(_hyphenateStyleName);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction hyphenateProperty(property) {\n  return (0, _hyphenateStyleName2.default)(property);\n}\nmodule.exports = exports['default'];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = capitalizeString;\nfunction capitalizeString(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = transition;\n\nvar _hyphenateProperty = require(\"css-in-js-utils/lib/hyphenateProperty\");\n\nvar _hyphenateProperty2 = _interopRequireDefault(_hyphenateProperty);\n\nvar _isPrefixedValue = require(\"css-in-js-utils/lib/isPrefixedValue\");\n\nvar _isPrefixedValue2 = _interopRequireDefault(_isPrefixedValue);\n\nvar _capitalizeString = require(\"../../utils/capitalizeString\");\n\nvar _capitalizeString2 = _interopRequireDefault(_capitalizeString);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar properties = {\n  transition: true,\n  transitionProperty: true,\n  WebkitTransition: true,\n  WebkitTransitionProperty: true,\n  MozTransition: true,\n  MozTransitionProperty: true\n};\n\n\nvar prefixMapping = {\n  Webkit: \"-webkit-\",\n  Moz: \"-moz-\",\n  ms: \"-ms-\"\n};\n\nfunction prefixValue(value, propertyPrefixMap) {\n  if ((0, _isPrefixedValue2.default)(value)) {\n    return value;\n  }\n\n  // only split multi values, not cubic beziers\n  var multipleValues = value.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g);\n\n  for (var i = 0, len = multipleValues.length; i < len; ++i) {\n    var singleValue = multipleValues[i];\n    var values = [singleValue];\n    for (var property in propertyPrefixMap) {\n      var dashCaseProperty = (0, _hyphenateProperty2.default)(property);\n\n      if (singleValue.indexOf(dashCaseProperty) > -1 && dashCaseProperty !== \"order\") {\n        var prefixes = propertyPrefixMap[property];\n        for (var j = 0, pLen = prefixes.length; j < pLen; ++j) {\n          // join all prefixes and create a new value\n          values.unshift(singleValue.replace(dashCaseProperty, prefixMapping[prefixes[j]] + dashCaseProperty));\n        }\n      }\n    }\n\n    multipleValues[i] = values.join(\",\");\n  }\n\n  return multipleValues.join(\",\");\n}\n\nfunction transition(property, value, style, propertyPrefixMap) {\n  // also check for already prefixed transitions\n  if (typeof value === \"string\" && properties.hasOwnProperty(property)) {\n    var outputValue = prefixValue(value, propertyPrefixMap);\n    // if the property is already prefixed\n    var webkitOutput = outputValue.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g).filter(function (val) {\n      return !/-moz-|-ms-/.test(val);\n    }).join(\",\");\n\n    if (property.indexOf(\"Webkit\") > -1) {\n      return webkitOutput;\n    }\n\n    var mozOutput = outputValue.split(/,(?![^()]*(?:\\([^()]*\\))?\\))/g).filter(function (val) {\n      return !/-webkit-|-ms-/.test(val);\n    }).join(\",\");\n\n    if (property.indexOf(\"Moz\") > -1) {\n      return mozOutput;\n    }\n\n    style[\"Webkit\" + (0, _capitalizeString2.default)(property)] = webkitOutput;\n    style[\"Moz\" + (0, _capitalizeString2.default)(property)] = mozOutput;\n    return outputValue;\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nfunction hash(str) {\n  var hash = 5381,\n      i    = str.length;\n\n  while(i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */\n  return hash >>> 0;\n}\n\nmodule.exports = hash;\n", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = prefixProperty;\n\nvar _capitalizeString = require(\"./capitalizeString\");\n\nvar _capitalizeString2 = _interopRequireDefault(_capitalizeString);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction prefixProperty(prefixProperties, property, style) {\n  if (prefixProperties.hasOwnProperty(property)) {\n    var newStyle = {};\n    var requiredPrefixes = prefixProperties[property];\n    var capitalizedProperty = (0, _capitalizeString2.default)(property);\n    var keys = Object.keys(style);\n    for (var i = 0; i < keys.length; i++) {\n      var styleProperty = keys[i];\n      if (styleProperty === property) {\n        for (var j = 0; j < requiredPrefixes.length; j++) {\n          newStyle[requiredPrefixes[j] + capitalizedProperty] = style[property];\n        }\n      }\n      newStyle[styleProperty] = style[styleProperty];\n    }\n    return newStyle;\n  }\n  return style;\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = prefixValue;\nfunction prefixValue(plugins, property, value, style, metaData) {\n  for (var i = 0, len = plugins.length; i < len; ++i) {\n    var processedValue = plugins[i](property, value, style, metaData);\n\n    // we can stop processing if a value is returned\n    // as all plugin criteria are unique\n    if (processedValue) {\n      return processedValue;\n    }\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = addNewValuesOnly;\nfunction addIfNew(list, value) {\n  if (list.indexOf(value) === -1) {\n    list.push(value);\n  }\n}\n\nfunction addNewValuesOnly(list, values) {\n  if (Array.isArray(values)) {\n    for (var i = 0, len = values.length; i < len; ++i) {\n      addIfNew(list, values[i]);\n    }\n  } else {\n    addIfNew(list, values);\n  }\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = isObject;\nfunction isObject(value) {\n  return value instanceof Object && !Array.isArray(value);\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = createPrefixer;\n\nvar _prefixProperty = require(\"../utils/prefixProperty\");\n\nvar _prefixProperty2 = _interopRequireDefault(_prefixProperty);\n\nvar _prefixValue = require(\"../utils/prefixValue\");\n\nvar _prefixValue2 = _interopRequireDefault(_prefixValue);\n\nvar _addNewValuesOnly = require(\"../utils/addNewValuesOnly\");\n\nvar _addNewValuesOnly2 = _interopRequireDefault(_addNewValuesOnly);\n\nvar _isObject = require(\"../utils/isObject\");\n\nvar _isObject2 = _interopRequireDefault(_isObject);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction createPrefixer(_ref) {\n  var prefixMap = _ref.prefixMap,\n      plugins = _ref.plugins;\n\n  function prefixAll(style) {\n    for (var property in style) {\n      var value = style[property];\n\n      // handle nested objects\n      if ((0, _isObject2.default)(value)) {\n        style[property] = prefixAll(value);\n        // handle array values\n      } else if (Array.isArray(value)) {\n        var combinedValue = [];\n\n        for (var i = 0, len = value.length; i < len; ++i) {\n          var processedValue = (0, _prefixValue2.default)(plugins, property, value[i], style, prefixMap);\n          (0, _addNewValuesOnly2.default)(combinedValue, processedValue || value[i]);\n        }\n\n        // only modify the value if it was touched\n        // by any plugin to prevent unnecessary mutations\n        if (combinedValue.length > 0) {\n          style[property] = combinedValue;\n        }\n      } else {\n        var _processedValue = (0, _prefixValue2.default)(plugins, property, value, style, prefixMap);\n\n        // only modify the value if it was touched\n        // by any plugin to prevent unnecessary mutations\n        if (_processedValue) {\n          style[property] = _processedValue;\n        }\n\n        style = (0, _prefixProperty2.default)(prefixMap, property, style);\n      }\n    }\n\n    return style;\n  }\n\n  return prefixAll;\n}\nmodule.exports = exports[\"default\"];", "\"use strict\";\n\n// Use the fastest means possible to execute a task in its own turn, with\n// priority over other events including IO, animation, reflow, and redraw\n// events in browsers.\n//\n// An exception thrown by a task will permanently interrupt the processing of\n// subsequent tasks. The higher level `asap` function ensures that if an\n// exception is thrown by a task, that the task queue will continue flushing as\n// soon as possible, but if you use `rawAsap` directly, you are responsible to\n// either ensure that no exceptions are thrown from your task, or to manually\n// call `rawAsap.requestFlush` if an exception is thrown.\nmodule.exports = rawAsap;\nfunction rawAsap(task) {\n    if (!queue.length) {\n        requestFlush();\n        flushing = true;\n    }\n    // Equivalent to push, but avoids a function call.\n    queue[queue.length] = task;\n}\n\nvar queue = [];\n// Once a flush has been requested, no further calls to `requestFlush` are\n// necessary until the next `flush` completes.\nvar flushing = false;\n// `requestFlush` is an implementation-specific method that attempts to kick\n// off a `flush` event as quickly as possible. `flush` will attempt to exhaust\n// the event queue before yielding to the browser's own event loop.\nvar requestFlush;\n// The position of the next task to execute in the task queue. This is\n// preserved between calls to `flush` so that it can be resumed if\n// a task throws an exception.\nvar index = 0;\n// If a task schedules additional tasks recursively, the task queue can grow\n// unbounded. To prevent memory exhaustion, the task queue will periodically\n// truncate already-completed tasks.\nvar capacity = 1024;\n\n// The flush function processes all tasks that have been scheduled with\n// `rawAsap` unless and until one of those tasks throws an exception.\n// If a task throws an exception, `flush` ensures that its state will remain\n// consistent and will resume where it left off when called again.\n// However, `flush` does not make any arrangements to be called again if an\n// exception is thrown.\nfunction flush() {\n    while (index < queue.length) {\n        var currentIndex = index;\n        // Advance the index before calling the task. This ensures that we will\n        // begin flushing on the next task the task throws an error.\n        index = index + 1;\n        queue[currentIndex].call();\n        // Prevent leaking memory for long chains of recursive calls to `asap`.\n        // If we call `asap` within tasks scheduled by `asap`, the queue will\n        // grow, but to avoid an O(n) walk for every task we execute, we don't\n        // shift tasks off the queue after they have been executed.\n        // Instead, we periodically shift 1024 tasks off the queue.\n        if (index > capacity) {\n            // Manually shift all values starting at the index back to the\n            // beginning of the queue.\n            for (var scan = 0, newLength = queue.length - index; scan < newLength; scan++) {\n                queue[scan] = queue[scan + index];\n            }\n            queue.length -= index;\n            index = 0;\n        }\n    }\n    queue.length = 0;\n    index = 0;\n    flushing = false;\n}\n\n// `requestFlush` is implemented using a strategy based on data collected from\n// every available SauceLabs Selenium web driver worker at time of writing.\n// https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\n// Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n// have WebKitMutationObserver but not un-prefixed MutationObserver.\n// Must use `global` or `self` instead of `window` to work in both frames and web\n// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\n/* globals self */\nvar scope = typeof global !== \"undefined\" ? global : self;\nvar BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\n\n// MutationObservers are desirable because they have high priority and work\n// reliably everywhere they are implemented.\n// They are implemented in all modern browsers.\n//\n// - Android 4-4.3\n// - Chrome 26-34\n// - Firefox 14-29\n// - Internet Explorer 11\n// - iPad Safari 6-7.1\n// - iPhone Safari 7-7.1\n// - Safari 6-7\nif (typeof BrowserMutationObserver === \"function\") {\n    requestFlush = makeRequestCallFromMutationObserver(flush);\n\n// MessageChannels are desirable because they give direct access to the HTML\n// task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n// 11-12, and in web workers in many engines.\n// Although message channels yield to any queued rendering and IO tasks, they\n// would be better than imposing the 4ms delay of timers.\n// However, they do not work reliably in Internet Explorer or Safari.\n\n// Internet Explorer 10 is the only browser that has setImmediate but does\n// not have MutationObservers.\n// Although setImmediate yields to the browser's renderer, it would be\n// preferrable to falling back to setTimeout since it does not have\n// the minimum 4ms penalty.\n// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n// Desktop to a lesser extent) that renders both setImmediate and\n// MessageChannel useless for the purposes of ASAP.\n// https://github.com/kriskowal/q/issues/396\n\n// Timers are implemented universally.\n// We fall back to timers in workers in most engines, and in foreground\n// contexts in the following browsers.\n// However, note that even this simple case requires nuances to operate in a\n// broad spectrum of browsers.\n//\n// - Firefox 3-13\n// - Internet Explorer 6-9\n// - iPad Safari 4.3\n// - Lynx 2.8.7\n} else {\n    requestFlush = makeRequestCallFromTimer(flush);\n}\n\n// `requestFlush` requests that the high priority event queue be flushed as\n// soon as possible.\n// This is useful to prevent an error thrown in a task from stalling the event\n// queue if the exception handled by Node.js\u2019s\n// `process.on(\"uncaughtException\")` or by a domain.\nrawAsap.requestFlush = requestFlush;\n\n// To request a high priority event, we induce a mutation observer by toggling\n// the text of a text node between \"1\" and \"-1\".\nfunction makeRequestCallFromMutationObserver(callback) {\n    var toggle = 1;\n    var observer = new BrowserMutationObserver(callback);\n    var node = document.createTextNode(\"\");\n    observer.observe(node, {characterData: true});\n    return function requestCall() {\n        toggle = -toggle;\n        node.data = toggle;\n    };\n}\n\n// The message channel technique was discovered by Malte Ubl and was the\n// original foundation for this library.\n// http://www.nonblocking.io/2011/06/windownexttick.html\n\n// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n// page's first load. Thankfully, this version of Safari supports\n// MutationObservers, so we don't need to fall back in that case.\n\n// function makeRequestCallFromMessageChannel(callback) {\n//     var channel = new MessageChannel();\n//     channel.port1.onmessage = callback;\n//     return function requestCall() {\n//         channel.port2.postMessage(0);\n//     };\n// }\n\n// For reasons explained above, we are also unable to use `setImmediate`\n// under any circumstances.\n// Even if we were, there is another bug in Internet Explorer 10.\n// It is not sufficient to assign `setImmediate` to `requestFlush` because\n// `setImmediate` must be called *by name* and therefore must be wrapped in a\n// closure.\n// Never forget.\n\n// function makeRequestCallFromSetImmediate(callback) {\n//     return function requestCall() {\n//         setImmediate(callback);\n//     };\n// }\n\n// Safari 6.0 has a problem where timers will get lost while the user is\n// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n// mutation observers, so that implementation is used instead.\n// However, if we ever elect to use timers in Safari, the prevalent work-around\n// is to add a scroll event listener that calls for a flush.\n\n// `setTimeout` does not call the passed callback if the delay is less than\n// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n// even then.\n\nfunction makeRequestCallFromTimer(callback) {\n    return function requestCall() {\n        // We dispatch a timeout with a specified delay of 0 for engines that\n        // can reliably accommodate that request. This will usually be snapped\n        // to a 4 milisecond delay, but once we're flushing, there's no delay\n        // between events.\n        var timeoutHandle = setTimeout(handleTimer, 0);\n        // However, since this timer gets frequently dropped in Firefox\n        // workers, we enlist an interval handle that will try to fire\n        // an event 20 times per second until it succeeds.\n        var intervalHandle = setInterval(handleTimer, 50);\n\n        function handleTimer() {\n            // Whichever timer succeeds will cancel both timers and\n            // execute the callback.\n            clearTimeout(timeoutHandle);\n            clearInterval(intervalHandle);\n            callback();\n        }\n    };\n}\n\n// This is for `asap.js` only.\n// Its name will be periodically randomized to break any code that depends on\n// its existence.\nrawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer;\n\n// ASAP was originally a nextTick shim included in Q. This was factored out\n// into this ASAP package. It was later adapted to RSVP which made further\n// amendments. These decisions, particularly to marginalize MessageChannel and\n// to capture the MutationObserver implementation in a closure, were integrated\n// back into ASAP proper.\n// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n", "\"use strict\";\n\n// rawAsap provides everything we need except exception management.\nvar rawAsap = require(\"./raw\");\n// RawTasks are recycled to reduce GC churn.\nvar freeTasks = [];\n// We queue errors to ensure they are thrown in right order (FIFO).\n// Array-as-queue is good enough here, since we are just dealing with exceptions.\nvar pendingErrors = [];\nvar requestErrorThrow = rawAsap.makeRequestCallFromTimer(throwFirstError);\n\nfunction throwFirstError() {\n    if (pendingErrors.length) {\n        throw pendingErrors.shift();\n    }\n}\n\n/**\n * Calls a task as soon as possible after returning, in its own event, with priority\n * over other events like animation, reflow, and repaint. An error thrown from an\n * event will not interrupt, nor even substantially slow down the processing of\n * other events, but will be rather postponed to a lower priority event.\n * @param {{call}} task A callable object, typically a function that takes no\n * arguments.\n */\nmodule.exports = asap;\nfunction asap(task) {\n    var rawTask;\n    if (freeTasks.length) {\n        rawTask = freeTasks.pop();\n    } else {\n        rawTask = new RawTask();\n    }\n    rawTask.task = task;\n    rawAsap(rawTask);\n}\n\n// We wrap tasks with recyclable task objects.  A task object implements\n// `call`, just like a function.\nfunction RawTask() {\n    this.task = null;\n}\n\n// The sole purpose of wrapping the task is to catch the exception and recycle\n// the task object after its single use.\nRawTask.prototype.call = function () {\n    try {\n        this.task.call();\n    } catch (error) {\n        if (asap.onerror) {\n            // This hook exists purely for testing purposes.\n            // Its name will be periodically randomized to break any code that\n            // depends on its existence.\n            asap.onerror(error);\n        } else {\n            // In a web browser, exceptions are not fatal. However, to avoid\n            // slowing down the queue of pending tasks, we rethrow the error in a\n            // lower priority turn.\n            pendingErrors.push(error);\n            requestErrorThrow();\n        }\n    } finally {\n        this.task = null;\n        freeTasks[freeTasks.length] = this;\n    }\n};\n", "export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;\n", "import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError\n};\n\nexport default options;\n", "import options from './options';\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\ti;\n\tfor (i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\t// https://github.com/preactjs/preact/issues/1916\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(\n\t\ttype,\n\t\tnormalizedProps,\n\t\tprops && props.key,\n\t\tprops && props.ref,\n\t\tnull\n\t);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\tconstructor: undefined,\n\t\t_original: original\n\t};\n\n\tif (original == null) vnode._original = vnode;\n\tif (options.vnode) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn {};\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n", "import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\tupdate = update(s, this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = oldVNode;\n\n\t\tlet newDom = diff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tnull,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (newDom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\nlet rerenderCount = 0;\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\n", "import { EMPTY_OBJ, EMPTY_ARR } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\n\nconst IS_HYDRATE = EMPTY_OBJ;\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {Element | Text} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we\n\t// are in hydration mode or not by passing `IS_HYDRATE` instead of a\n\t// DOM element.\n\tlet isHydrating = replaceNode === IS_HYDRATE;\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\tvnode = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\t((isHydrating ? parentDom : replaceNode || parentDom)._children = vnode),\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\treplaceNode && !isHydrating\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: EMPTY_ARR.slice.call(parentDom.childNodes),\n\t\tcommitQueue,\n\t\treplaceNode || EMPTY_OBJ,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./index').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, IS_HYDRATE);\n}\n", "import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue) {\n\tconst ctx = {};\n\n\tconst context = {\n\t\t_id: '__cC' + i++,\n\t\t_defaultValue: defaultValue,\n\t\tConsumer(props, context) {\n\t\t\treturn props.children(context);\n\t\t},\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tconst subs = [];\n\t\t\t\tthis.getChildContext = () => {\n\t\t\t\t\tctx[context._id] = this;\n\t\t\t\t\treturn ctx;\n\t\t\t\t};\n\n\t\t\t\tthis.shouldComponentUpdate = _props => {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\tsubs.some(c => {\n\t\t\t\t\t\t\tc.context = _props.value;\n\t\t\t\t\t\t\tenqueueRender(c);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\told && old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\tcontext.Consumer.contextType = context;\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\tcontext.Provider._contextRef = context;\n\n\treturn context;\n}\n", "/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n", "import { diff, unmount, applyRef } from './index';\nimport { createVNode } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { removeNode } from '../util';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Node | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, newDom, sibDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\t// Only in very specific places should this logic be invoked (top level `render` and `diffElementNodes`).\n\t// I'm using `EMPTY_OBJ` to signal when `diffChildren` is invoked in these situations. I can't use `null`\n\t// for this purpose, because `null` is a valid value for `oldDom` which can mean to skip to this logic\n\t// (e.g. if mounting a new tree in which the old DOM should be ignored (usually for Fragments).\n\tif (oldDom == EMPTY_OBJ) {\n\t\tif (excessDomChildren != null) {\n\t\t\toldDom = excessDomChildren[0];\n\t\t} else if (oldChildrenLength) {\n\t\t\toldDom = getDomSibling(oldParentVNode, 0);\n\t\t} else {\n\t\t\toldDom = null;\n\t\t}\n\t}\n\n\ti = 0;\n\tnewParentVNode._children = toChildArray(\n\t\tnewParentVNode._children,\n\t\tchildVNode => {\n\t\t\tif (childVNode != null) {\n\t\t\t\tchildVNode._parent = newParentVNode;\n\t\t\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t\t\t// Check if we find a corresponding element in oldChildren.\n\t\t\t\t// If found, delete the array item by setting to `undefined`.\n\t\t\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t\t\t// (holes).\n\t\t\t\toldVNode = oldChildren[i];\n\n\t\t\t\tif (\n\t\t\t\t\toldVNode === null ||\n\t\t\t\t\t(oldVNode &&\n\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t\t\t) {\n\t\t\t\t\toldChildren[i] = undefined;\n\t\t\t\t} else {\n\t\t\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t\t\t// We always match by type (in either case).\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\toldVNode &&\n\t\t\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toldVNode = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\t\t\tnewDom = diff(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\tglobalContext,\n\t\t\t\t\tisSvg,\n\t\t\t\t\texcessDomChildren,\n\t\t\t\t\tcommitQueue,\n\t\t\t\t\toldDom,\n\t\t\t\t\tisHydrating\n\t\t\t\t);\n\n\t\t\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\t\t\tif (!refs) refs = [];\n\t\t\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t\t\t}\n\n\t\t\t\t// Only proceed if the vnode has not been unmounted by `diff()` above.\n\t\t\t\tif (newDom != null) {\n\t\t\t\t\tif (firstChildDom == null) {\n\t\t\t\t\t\tfirstChildDom = newDom;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet nextDom;\n\t\t\t\t\tif (childVNode._nextDom !== undefined) {\n\t\t\t\t\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t\t\t\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t\t\t\t\t// of last DOM child of this child VNode\n\t\t\t\t\t\tnextDom = childVNode._nextDom;\n\n\t\t\t\t\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t\t\t\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t\t\t\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t\t\t\t\t// can clean up the property\n\t\t\t\t\t\tchildVNode._nextDom = undefined;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\texcessDomChildren == oldVNode ||\n\t\t\t\t\t\tnewDom != oldDom ||\n\t\t\t\t\t\tnewDom.parentNode == null\n\t\t\t\t\t) {\n\t\t\t\t\t\t// NOTE: excessDomChildren==oldVNode above:\n\t\t\t\t\t\t// This is a compression of excessDomChildren==null && oldVNode==null!\n\t\t\t\t\t\t// The values only have the same type when `null`.\n\n\t\t\t\t\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\t\t\t\t\tparentDom.appendChild(newDom);\n\t\t\t\t\t\t\tnextDom = null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\t\t\t\t\tfor (\n\t\t\t\t\t\t\t\tsibDom = oldDom, j = 0;\n\t\t\t\t\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildrenLength;\n\t\t\t\t\t\t\t\tj += 2\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\t\t\t\t\tbreak outer;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\t\t\t\t\tnextDom = oldDom;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Browsers will infer an option's `value` from `textContent` when\n\t\t\t\t\t\t// no value is present. This essentially bypasses our code to set it\n\t\t\t\t\t\t// later in `diff()`. It works fine in all browsers except for IE11\n\t\t\t\t\t\t// where it breaks setting `select.value`. There it will be always set\n\t\t\t\t\t\t// to an empty string. Re-applying an options value will fix that, so\n\t\t\t\t\t\t// there are probably some internal data structures that aren't\n\t\t\t\t\t\t// updated properly.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// To fix it we make sure to reset the inferred value, so that our own\n\t\t\t\t\t\t// value check in `diff()` won't be skipped.\n\t\t\t\t\t\tif (newParentVNode.type == 'option') {\n\t\t\t\t\t\t\tparentDom.value = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t\t\t\t\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t\t\t\t\t// See more detail in create-element.js:createVNode\n\t\t\t\t\tif (nextDom !== undefined) {\n\t\t\t\t\t\toldDom = nextDom;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toldDom = newDom.nextSibling;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof newParentVNode.type == 'function') {\n\t\t\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t\t\t// node's nextSibling.\n\n\t\t\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t\t\t}\n\t\t\t\t} else if (\n\t\t\t\t\toldDom &&\n\t\t\t\t\toldVNode._dom == oldDom &&\n\t\t\t\t\toldDom.parentNode != parentDom\n\t\t\t\t) {\n\t\t\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\t\t\toldDom = getDomSibling(oldVNode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti++;\n\t\t\treturn childVNode;\n\t\t}\n\t);\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove children that are not part of any vnode.\n\tif (excessDomChildren != null && typeof newParentVNode.type != 'function') {\n\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t}\n\t}\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) unmount(oldChildren[i], oldChildren[i]);\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @param {(vnode: import('../internal').VNode) => import('../internal').VNode} [callback]\n * A function to invoke for each child before it is added to the flattened list.\n * @param {Array<import('../internal').VNode | string | number>} [flattened] An flat array of children to modify\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, callback, flattened) {\n\tif (flattened == null) flattened = [];\n\n\tif (children == null || typeof children == 'boolean') {\n\t\tif (callback) flattened.push(callback(null));\n\t} else if (Array.isArray(children)) {\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\ttoChildArray(children[i], callback, flattened);\n\t\t}\n\t} else if (!callback) {\n\t\tflattened.push(children);\n\t} else if (typeof children == 'string' || typeof children == 'number') {\n\t\tflattened.push(callback(createVNode(null, children, null, null, children)));\n\t} else if (children._dom != null || children._component != null) {\n\t\tflattened.push(\n\t\t\tcallback(\n\t\t\t\tcreateVNode(\n\t\t\t\t\tchildren.type,\n\t\t\t\t\tchildren.props,\n\t\t\t\t\tchildren.key,\n\t\t\t\t\tnull,\n\t\t\t\t\tchildren._original\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t} else {\n\t\tflattened.push(callback(children));\n\t}\n\n\treturn flattened;\n}\n", "import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (\n\t\ttypeof value == 'number' &&\n\t\tIS_NON_DIMENSIONAL.test(key) === false\n\t) {\n\t\tstyle[key] = value + 'px';\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else {\n\t\tstyle[key] = value;\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet s, useCapture, nameLower;\n\n\tif (isSvg) {\n\t\tif (name === 'className') {\n\t\t\tname = 'class';\n\t\t}\n\t} else if (name === 'class') {\n\t\tname = 'className';\n\t}\n\n\tif (name === 'style') {\n\t\ts = dom.style;\n\n\t\tif (typeof value == 'string') {\n\t\t\ts.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\ts.cssText = '';\n\t\t\t\toldValue = null;\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (let i in oldValue) {\n\t\t\t\t\tif (!(value && i in value)) {\n\t\t\t\t\t\tsetStyle(s, i, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (let i in value) {\n\t\t\t\t\tif (!oldValue || value[i] !== oldValue[i]) {\n\t\t\t\t\t\tsetStyle(s, i, value[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\t\tnameLower = name.toLowerCase();\n\t\tname = (nameLower in dom ? nameLower : name).slice(2);\n\n\t\tif (value) {\n\t\t\tif (!oldValue) dom.addEventListener(name, eventProxy, useCapture);\n\t\t\t(dom._listeners || (dom._listeners = {}))[name] = value;\n\t\t} else {\n\t\t\tdom.removeEventListener(name, eventProxy, useCapture);\n\t\t}\n\t} else if (\n\t\tname !== 'list' &&\n\t\tname !== 'tagName' &&\n\t\t// HTMLButtonElement.form and HTMLInputElement.form are read-only but can be set using\n\t\t// setAttribute\n\t\tname !== 'form' &&\n\t\tname !== 'type' &&\n\t\tname !== 'size' &&\n\t\t!isSvg &&\n\t\tname in dom\n\t) {\n\t\tdom[name] = value == null ? '' : value;\n\t} else if (typeof value != 'function' && name !== 'dangerouslySetInnerHTML') {\n\t\tif (name !== (name = name.replace(/^xlink:?/, ''))) {\n\t\t\tif (value == null || value === false) {\n\t\t\t\tdom.removeAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase()\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tdom.setAttributeNS(\n\t\t\t\t\t'http://www.w3.org/1999/xlink',\n\t\t\t\t\tname.toLowerCase(),\n\t\t\t\t\tvalue\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (\n\t\t\tvalue == null ||\n\t\t\t(value === false &&\n\t\t\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t\t\t// The value `false` is different from the attribute not\n\t\t\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t\t\t// that other VDOM frameworks also always stringify `false`.\n\t\t\t\t!/^ar/.test(name))\n\t\t) {\n\t\t\tdom.removeAttribute(name);\n\t\t} else {\n\t\t\tdom.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type](options.event ? options.event(e) : e);\n}\n", "import { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { Component } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {Element | Text} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\t(newVNode._original === oldVNode._original && !c._processingException)\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (tmp = 0; tmp < newVNode._children.length; tmp++) {\n\t\t\t\t\t\tif (newVNode._children[tmp]) {\n\t\t\t\t\t\t\tnewVNode._children[tmp]._parent = newVNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type == Fragment && tmp.key == null;\n\t\t\tnewVNode._children = isTopLevelFragment\n\t\t\t\t? tmp.props.children\n\t\t\t\t: Array.isArray(tmp)\n\t\t\t\t? tmp\n\t\t\t\t: [tmp];\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n\n\treturn newVNode._dom;\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet i;\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tisSvg = newVNode.type === 'svg' || isSvg;\n\n\tif (excessDomChildren != null) {\n\t\tfor (i = 0; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild != null &&\n\t\t\t\t((newVNode.type === null\n\t\t\t\t\t? child.nodeType === 3\n\t\t\t\t\t: child.localName === newVNode.type) ||\n\t\t\t\t\tdom == child)\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (newVNode.type === null) {\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tdom = isSvg\n\t\t\t? document.createElementNS('http://www.w3.org/2000/svg', newVNode.type)\n\t\t\t: document.createElement(\n\t\t\t\t\tnewVNode.type,\n\t\t\t\t\tnewProps.is && { is: newProps.is }\n\t\t\t  );\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (newVNode.type === null) {\n\t\tif (oldProps !== newProps && dom.data != newProps) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\tif (excessDomChildren != null) {\n\t\t\texcessDomChildren = EMPTY_ARR.slice.call(dom.childNodes);\n\t\t}\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\tif (oldProps === EMPTY_OBJ) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (let i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (!newHtml || !oldHtml || newHtml.__html != oldHtml.__html) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\tnewVNode._children = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tnewVNode.type === 'foreignObject' ? false : isSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tEMPTY_OBJ,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\ti !== dom.value\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tlet dom;\n\tif (!skipRemove && typeof vnode.type != 'function') {\n\t\tskipRemove = (dom = vnode._dom) != null;\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) unmount(r[i], parentVNode, skipRemove);\n\t\t}\n\t}\n\n\tif (dom != null) removeNode(dom);\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n", "import { assign } from './util';\nimport { EMPTY_ARR } from './constants';\nimport { createVNode } from './create-element';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {import('./internal').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./index').ComponentChildren>} rest Any additional arguments will be used as replacement children.\n * @returns {import('./internal').VNode}\n */\nexport function cloneElement(vnode, props) {\n\tprops = assign(assign({}, vnode.props), props);\n\tif (arguments.length > 2) props.children = EMPTY_ARR.slice.call(arguments, 2);\n\tlet normalizedProps = {};\n\tfor (const i in props) {\n\t\tif (i !== 'key' && i !== 'ref') normalizedProps[i] = props[i];\n\t}\n\n\treturn createVNode(\n\t\tvnode.type,\n\t\tnormalizedProps,\n\t\tprops.key || vnode.key,\n\t\tprops.ref || vnode.ref,\n\t\tnull\n\t);\n}\n", "import { enqueueRender } from '../component';\n\n/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, hasCaught;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tif (\n\t\t\t\t\tcomponent.constructor &&\n\t\t\t\t\tcomponent.constructor.getDerivedStateFromError != null\n\t\t\t\t) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.setState(\n\t\t\t\t\t\tcomponent.constructor.getDerivedStateFromError(error)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\thasCaught = true;\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t}\n\n\t\t\t\tif (hasCaught)\n\t\t\t\t\treturn enqueueRender((component._pendingError = component));\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n", "class ListNode<V> {\n  prev: ListNode<V> | null = null\n  next: ListNode<V> | null = null\n  constructor(readonly data: V) {}\n}\n\nexport class List<V> {\n  private head: ListNode<V> | null = null\n  private tail: ListNode<V> | null = null\n  private size: number = 0\n  constructor() {}\n\n  getHead(): ListNode<V> | null {\n    return this.head\n  }\n  getTail(): ListNode<V> | null {\n    return this.tail\n  }\n  getSize(): number {\n    return this.size\n  }\n\n  append(node: ListNode<V>): void {\n    if (!this.tail) {\n      this.head = this.tail = node\n    } else {\n      this.tail.next = node\n      node.prev = this.tail\n      this.tail = node\n    }\n    this.size++\n  }\n\n  prepend(node: ListNode<V>): ListNode<V> {\n    if (!this.head) {\n      this.head = this.tail = node\n    } else {\n      this.head.prev = node\n      node.next = this.head\n      this.head = node\n    }\n    this.size++\n    return node\n  }\n\n  pop(): ListNode<V> | null {\n    if (!this.tail) {\n      return null\n    } else {\n      const ret = this.tail\n      if (ret.prev) {\n        this.tail = ret.prev\n        this.tail.next = null\n      } else {\n        this.head = this.tail = null\n      }\n      this.size--\n      ret.prev = null\n      return ret\n    }\n  }\n\n  dequeue(): ListNode<V> | null {\n    if (!this.head) {\n      return null\n    } else {\n      const ret = this.head\n      if (ret.next) {\n        this.head = ret.next\n        this.head.prev = null\n      } else {\n        this.head = this.tail = null\n      }\n      this.size--\n      ret.next = null\n      return ret\n    }\n  }\n\n  remove(node: ListNode<V>): void {\n    if (node.prev == null) {\n      this.dequeue()\n    } else if (node.next == null) {\n      this.pop()\n    } else {\n      // Neither first nor last, should be safe to just link\n      // neighbours.\n      node.next.prev = node.prev\n      node.prev.next = node.next\n      node.next = null\n      node.prev = null\n      this.size--\n    }\n  }\n}\n\ninterface LRUCacheNode<K, V> {\n  value: V\n  listNode: ListNode<K>\n}\n\nexport class LRUCache<K, V> {\n  private list = new List<K>()\n  private map = new Map<K, LRUCacheNode<K, V>>()\n\n  constructor(private capacity: number) {}\n\n  has(key: K): boolean {\n    return this.map.has(key)\n  }\n\n  get(key: K): V | null {\n    const node = this.map.get(key)\n    if (!node) {\n      return null\n    }\n    // Bring node to the front of the list\n    this.list.remove(node.listNode)\n    this.list.prepend(node.listNode)\n\n    return node ? node.value : null\n  }\n\n  getSize() {\n    return this.list.getSize()\n  }\n\n  getCapacity() {\n    return this.capacity\n  }\n\n  insert(key: K, value: V) {\n    const node = this.map.get(key)\n    if (node) {\n      this.list.remove(node.listNode)\n    }\n    // Evict old entries when out of capacity\n    while (this.list.getSize() >= this.capacity) {\n      this.map.delete(this.list.pop()!.data)\n    }\n    const listNode = this.list.prepend(new ListNode(key))\n    this.map.set(key, {value, listNode})\n  }\n\n  getOrInsert(key: K, f: (key: K) => V): V {\n    let value = this.get(key)\n    if (value == null) {\n      value = f(key)\n      this.insert(key, value)\n    }\n    return value\n  }\n\n  removeLRU(): [K, V] | null {\n    const oldest = this.list.pop()\n    if (!oldest) return null\n    const key = oldest.data\n    const value = this.map.get(key)!.value\n    this.map.delete(key)\n    return [key, value]\n  }\n\n  clear() {\n    this.list = new List<K>()\n    this.map = new Map<K, LRUCacheNode<K, V>>()\n  }\n}\n", "export function clamp(x: number, minVal: number, maxVal: number) {\n  if (x < minVal) return minVal\n  if (x > maxVal) return maxVal\n  return x\n}\n\nexport class Vec2 {\n  constructor(\n    readonly x: number,\n    readonly y: number,\n  ) {}\n  withX(x: number) {\n    return new Vec2(x, this.y)\n  }\n  withY(y: number) {\n    return new Vec2(this.x, y)\n  }\n\n  plus(other: Vec2) {\n    return new Vec2(this.x + other.x, this.y + other.y)\n  }\n  minus(other: Vec2) {\n    return new Vec2(this.x - other.x, this.y - other.y)\n  }\n  times(scalar: number) {\n    return new Vec2(this.x * scalar, this.y * scalar)\n  }\n  timesPointwise(other: Vec2) {\n    return new Vec2(this.x * other.x, this.y * other.y)\n  }\n  dividedByPointwise(other: Vec2) {\n    return new Vec2(this.x / other.x, this.y / other.y)\n  }\n  dot(other: Vec2) {\n    return this.x * other.x + this.y * other.y\n  }\n  equals(other: Vec2) {\n    return this.x === other.x && this.y === other.y\n  }\n  approxEquals(other: Vec2, epsilon = 1e-9) {\n    return Math.abs(this.x - other.x) < epsilon && Math.abs(this.y - other.y) < epsilon\n  }\n\n  length2() {\n    return this.dot(this)\n  }\n  length() {\n    return Math.sqrt(this.length2())\n  }\n  abs() {\n    return new Vec2(Math.abs(this.x), Math.abs(this.y))\n  }\n\n  static min(a: Vec2, b: Vec2) {\n    return new Vec2(Math.min(a.x, b.x), Math.min(a.y, b.y))\n  }\n\n  static max(a: Vec2, b: Vec2) {\n    return new Vec2(Math.max(a.x, b.x), Math.max(a.y, b.y))\n  }\n\n  static clamp(v: Vec2, min: Vec2, max: Vec2) {\n    return new Vec2(clamp(v.x, min.x, max.x), clamp(v.y, min.y, max.y))\n  }\n\n  static zero = new Vec2(0, 0)\n  static unit = new Vec2(1, 1)\n\n  flatten(): [number, number] {\n    return [this.x, this.y]\n  }\n}\n\nexport class AffineTransform {\n  constructor(\n    readonly m00 = 1,\n    readonly m01 = 0,\n    readonly m02 = 0,\n    readonly m10 = 0,\n    readonly m11 = 1,\n    readonly m12 = 0,\n  ) {}\n\n  withScale(s: Vec2) {\n    let {m00, m01, m02, m10, m11, m12} = this\n    m00 = s.x\n    m11 = s.y\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n  static withScale(s: Vec2) {\n    return new AffineTransform().withScale(s)\n  }\n  scaledBy(s: Vec2) {\n    return AffineTransform.withScale(s).times(this)\n  }\n  getScale() {\n    return new Vec2(this.m00, this.m11)\n  }\n\n  withTranslation(t: Vec2) {\n    let {m00, m01, m02, m10, m11, m12} = this\n    m02 = t.x\n    m12 = t.y\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n  static withTranslation(t: Vec2) {\n    return new AffineTransform().withTranslation(t)\n  }\n  getTranslation() {\n    return new Vec2(this.m02, this.m12)\n  }\n  translatedBy(t: Vec2) {\n    return AffineTransform.withTranslation(t).times(this)\n  }\n\n  static betweenRects(from: Rect, to: Rect) {\n    return AffineTransform.withTranslation(from.origin.times(-1))\n      .scaledBy(new Vec2(to.size.x / from.size.x, to.size.y / from.size.y))\n      .translatedBy(to.origin)\n  }\n\n  times(other: AffineTransform) {\n    const m00 = this.m00 * other.m00 + this.m01 * other.m10\n    const m01 = this.m00 * other.m01 + this.m01 * other.m11\n    const m02 = this.m00 * other.m02 + this.m01 * other.m12 + this.m02\n\n    const m10 = this.m10 * other.m00 + this.m11 * other.m10\n    const m11 = this.m10 * other.m01 + this.m11 * other.m11\n    const m12 = this.m10 * other.m02 + this.m11 * other.m12 + this.m12\n    return new AffineTransform(m00, m01, m02, m10, m11, m12)\n  }\n\n  equals(other: AffineTransform) {\n    return (\n      this.m00 == other.m00 &&\n      this.m01 == other.m01 &&\n      this.m02 == other.m02 &&\n      this.m10 == other.m10 &&\n      this.m11 == other.m11 &&\n      this.m12 == other.m12\n    )\n  }\n\n  approxEquals(other: AffineTransform, epsilon = 1e-9) {\n    return (\n      Math.abs(this.m00 - other.m00) < epsilon &&\n      Math.abs(this.m01 - other.m01) < epsilon &&\n      Math.abs(this.m02 - other.m02) < epsilon &&\n      Math.abs(this.m10 - other.m10) < epsilon &&\n      Math.abs(this.m11 - other.m11) < epsilon &&\n      Math.abs(this.m12 - other.m12) < epsilon\n    )\n  }\n\n  timesScalar(s: number) {\n    const {m00, m01, m02, m10, m11, m12} = this\n    return new AffineTransform(s * m00, s * m01, s * m02, s * m10, s * m11, s * m12)\n  }\n\n  det() {\n    const {m00, m01, m02, m10, m11, m12} = this\n    const m20 = 0\n    const m21 = 0\n    const m22 = 1\n\n    return (\n      m00 * (m11 * m22 - m12 * m21) - m01 * (m10 * m22 - m12 * m20) + m02 * (m10 * m21 - m11 * m20)\n    )\n  }\n\n  adj() {\n    const {m00, m01, m02, m10, m11, m12} = this\n    const m20 = 0\n    const m21 = 0\n    const m22 = 1\n\n    // Adjugate matrix (a) is the transpose of the\n    // cofactor matrix (c).\n    //\n    // 00 01 02\n    // 10 11 12\n    // 20 21 22\n\n    const a00 = /* c00 = */ +(m11 * m22 - m12 * m21)\n    const a01 = /* c10 = */ -(m01 * m22 - m02 * m21)\n    const a02 = /* c20 = */ +(m01 * m12 - m02 * m11)\n    const a10 = /* c01 = */ -(m10 * m22 - m12 * m20)\n    const a11 = /* c11 = */ +(m00 * m22 - m02 * m20)\n    const a12 = /* c21 = */ -(m00 * m12 - m02 * m10)\n\n    return new AffineTransform(a00, a01, a02, a10, a11, a12)\n  }\n\n  inverted(): AffineTransform | null {\n    const det = this.det()\n    if (det === 0) return null\n    const adj = this.adj()\n    return adj.timesScalar(1 / det)\n  }\n\n  transformVector(v: Vec2) {\n    return new Vec2(v.x * this.m00 + v.y * this.m01, v.x * this.m10 + v.y * this.m11)\n  }\n\n  inverseTransformVector(v: Vec2): Vec2 | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformVector(v)\n  }\n\n  transformPosition(v: Vec2) {\n    return new Vec2(\n      v.x * this.m00 + v.y * this.m01 + this.m02,\n      v.x * this.m10 + v.y * this.m11 + this.m12,\n    )\n  }\n\n  inverseTransformPosition(v: Vec2): Vec2 | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformPosition(v)\n  }\n\n  transformRect(r: Rect) {\n    const size = this.transformVector(r.size)\n    const origin = this.transformPosition(r.origin)\n\n    if (size.x < 0 && size.y < 0) {\n      return new Rect(origin.plus(size), size.abs())\n    } else if (size.x < 0) {\n      return new Rect(origin.withX(origin.x + size.x), size.abs())\n    } else if (size.y < 0) {\n      return new Rect(origin.withY(origin.y + size.y), size.abs())\n    }\n\n    return new Rect(origin, size)\n  }\n\n  inverseTransformRect(r: Rect): Rect | null {\n    const inv = this.inverted()\n    if (!inv) return null\n    return inv.transformRect(r)\n  }\n\n  flatten(): [number, number, number, number, number, number, number, number, number] {\n    // Flatten into GLSL format\n    // prettier-ignore\n    return [\n      this.m00, this.m10, 0,\n      this.m01, this.m11, 0,\n      this.m02, this.m12, 1,\n    ]\n  }\n}\n\nexport class Rect {\n  constructor(\n    readonly origin: Vec2,\n    readonly size: Vec2,\n  ) {}\n\n  isEmpty() {\n    return this.width() == 0 || this.height() == 0\n  }\n\n  width() {\n    return this.size.x\n  }\n  height() {\n    return this.size.y\n  }\n\n  left() {\n    return this.origin.x\n  }\n  right() {\n    return this.left() + this.width()\n  }\n  top() {\n    return this.origin.y\n  }\n  bottom() {\n    return this.top() + this.height()\n  }\n\n  topLeft() {\n    return this.origin\n  }\n  topRight() {\n    return this.origin.plus(new Vec2(this.width(), 0))\n  }\n\n  bottomRight() {\n    return this.origin.plus(this.size)\n  }\n  bottomLeft() {\n    return this.origin.plus(new Vec2(0, this.height()))\n  }\n\n  withOrigin(origin: Vec2) {\n    return new Rect(origin, this.size)\n  }\n  withSize(size: Vec2) {\n    return new Rect(this.origin, size)\n  }\n\n  closestPointTo(p: Vec2) {\n    return new Vec2(clamp(p.x, this.left(), this.right()), clamp(p.y, this.top(), this.bottom()))\n  }\n\n  distanceFrom(p: Vec2) {\n    return p.minus(this.closestPointTo(p)).length()\n  }\n\n  contains(p: Vec2) {\n    return this.distanceFrom(p) === 0\n  }\n\n  hasIntersectionWith(other: Rect) {\n    const top = Math.max(this.top(), other.top())\n    const bottom = Math.max(top, Math.min(this.bottom(), other.bottom()))\n    if (bottom - top === 0) return false\n\n    const left = Math.max(this.left(), other.left())\n    const right = Math.max(left, Math.min(this.right(), other.right()))\n    if (right - left === 0) return false\n    return true\n  }\n\n  intersectWith(other: Rect): Rect {\n    const topLeft = Vec2.max(this.topLeft(), other.topLeft())\n    const bottomRight = Vec2.max(topLeft, Vec2.min(this.bottomRight(), other.bottomRight()))\n\n    return new Rect(topLeft, bottomRight.minus(topLeft))\n  }\n\n  equals(other: Rect) {\n    return this.origin.equals(other.origin) && this.size.equals(other.size)\n  }\n\n  approxEquals(other: Rect) {\n    return this.origin.approxEquals(other.origin) && this.size.approxEquals(other.size)\n  }\n\n  area() {\n    return this.size.x * this.size.y\n  }\n\n  static empty = new Rect(Vec2.zero, Vec2.zero)\n  static unit = new Rect(Vec2.zero, Vec2.unit)\n  static NDC = new Rect(new Vec2(-1, -1), new Vec2(2, 2))\n}\n", "// This is a port of the GPU APIs from https://github.com/evanw/sky from Skew to\n// TypeScript.\n//\n// The MIT License (MIT)\n// Original work Copyright (c) 2016 Evan Wallace\n// Modified work Copyright (c) 2018 Jamie Wong\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\n// NOTE: This file intentionally has no dependencies.\n\n// Dependencies & polyfills for import from skew\nconst RELEASE =\n  typeof process !== 'undefined' && process.env && process.env.NODE_ENV === 'production'\n\nfunction assert(condition: boolean) {\n  if (!RELEASE) {\n    if (!condition) throw new Error('Assertion failed.')\n  }\n}\n\nfunction appendOne<T>(ts: T[], t: T): void {\n  if (ts.indexOf(t) === -1) ts.push(t)\n}\n\nfunction removeOne<T>(ts: T[], t: T): void {\n  const index = ts.indexOf(t)\n  if (index !== -1) ts.splice(index, 1)\n}\n\nfunction TEXTURE_N(gl: WebGLRenderingContext, index: number) {\n  assert(index >= 0 && index <= 31)\n  return (gl.TEXTURE0 + index) as GLenum\n}\n\nexport namespace Graphics {\n  export class Rect {\n    constructor(\n      public x: number = 0,\n      public y: number = 0,\n      public width: number = 0,\n      public height: number = 0,\n    ) {}\n\n    set(x: number, y: number, width: number, height: number) {\n      this.x = x\n      this.y = y\n      this.width = width\n      this.height = height\n    }\n\n    equals(other: Rect) {\n      return (\n        this.x === other.x &&\n        this.y === other.y &&\n        this.width === other.width &&\n        this.height === other.height\n      )\n    }\n  }\n\n  export class Color {\n    constructor(\n      public redF: number,\n      public greenF: number,\n      public blueF: number,\n      public alphaF: number,\n    ) {}\n\n    equals(other: Color): boolean {\n      return (\n        this.redF === other.redF &&\n        this.greenF === other.greenF &&\n        this.blueF === other.blueF &&\n        this.alphaF === other.alphaF\n      )\n    }\n\n    static TRANSPARENT = new Color(0, 0, 0, 0)\n  }\n\n  // Converted from https://github.com/evanw/sky/blob/c72de77/src/graphics/context.sk\n  export enum BlendOperation {\n    ZERO = 0,\n    ONE = 1,\n\n    SOURCE_COLOR = 2,\n    TARGET_COLOR = 3,\n    INVERSE_SOURCE_COLOR = 4,\n    INVERSE_TARGET_COLOR = 5,\n\n    SOURCE_ALPHA = 6,\n    TARGET_ALPHA = 7,\n    INVERSE_SOURCE_ALPHA = 8,\n    INVERSE_TARGET_ALPHA = 9,\n\n    CONSTANT = 10,\n    INVERSE_CONSTANT = 11,\n  }\n\n  export enum Primitive {\n    TRIANGLES,\n    TRIANGLE_STRIP,\n  }\n\n  export abstract class Context {\n    abstract addContextResetHandler(callback: () => void): void\n    abstract beginFrame(): void\n    abstract clear(color: Color): void\n\n    abstract createMaterial(\n      format: VertexFormat,\n      vertexSource: string,\n      fragmentSource: string,\n    ): Material\n    abstract createTexture(\n      format: TextureFormat,\n      width: number,\n      height: number,\n      pixels?: Uint8Array,\n    ): Texture\n    abstract createRenderTarget(texture: Texture): RenderTarget\n    abstract createVertexBuffer(byteCount: number): VertexBuffer\n    abstract currentRenderTarget: RenderTarget | null\n    abstract draw(primitive: Primitive, material: Material, vertices: VertexBuffer): void\n    abstract endFrame(): void\n    abstract removeContextResetHandler(callback: () => void): void\n    abstract resize(\n      widthInPixels: number,\n      heightInPixels: number,\n      widthInAppUnits: number,\n      heightInAppUnits: number,\n    ): void\n    abstract setRenderTarget(renderTarget: RenderTarget | null): void\n    abstract setViewport(x: number, y: number, width: number, height: number): void\n    abstract viewport: Rect\n    abstract widthInPixels: number\n    abstract heightInPixels: number\n\n    abstract renderTargetHeightInPixels: number\n    abstract renderTargetWidthInPixels: number\n\n    abstract setBlendState(source: BlendOperation, target: BlendOperation): void\n    setCopyBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.ZERO)\n    }\n    setAddBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.ONE)\n    }\n    setPremultipliedBlendState() {\n      this.setBlendState(BlendOperation.ONE, BlendOperation.INVERSE_SOURCE_ALPHA)\n    }\n    setUnpremultipliedBlendState() {\n      this.setBlendState(BlendOperation.SOURCE_ALPHA, BlendOperation.INVERSE_SOURCE_ALPHA)\n    }\n\n    protected resizeEventHandlers = new Set<() => void>()\n    addAfterResizeEventHandler(callback: () => void): void {\n      this.resizeEventHandlers.add(callback)\n    }\n    removeAfterResizeEventHandler(callback: () => void): void {\n      this.resizeEventHandlers.delete(callback)\n    }\n  }\n\n  export interface Material {\n    context: Context\n    format: VertexFormat\n    fragmentSource: string\n    vertexSource: string\n    setUniformFloat(name: string, x: number): void\n    setUniformInt(name: string, x: number): void\n    setUniformVec2(name: string, x: number, y: number): void\n    setUniformVec3(name: string, x: number, y: number, z: number): void\n    setUniformVec4(name: string, x: number, y: number, z: number, w: number): void\n    setUniformMat3(\n      name: string,\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ): void\n    setUniformSampler(name: string, texture: Texture, index: number): void\n  }\n\n  export enum AttributeType {\n    FLOAT,\n    BYTE,\n  }\n\n  export function attributeByteLength(type: AttributeType) {\n    return type == AttributeType.FLOAT ? 4 : 1\n  }\n\n  export class Attribute {\n    constructor(\n      readonly name: string,\n      readonly type: AttributeType,\n      readonly count: number,\n      readonly byteOffset: number,\n    ) {}\n  }\n\n  export class VertexFormat {\n    private _attributes: Attribute[] = []\n    private _stride = 0\n\n    get attributes() {\n      return this._attributes\n    }\n    get stride() {\n      return this._stride\n    }\n\n    add(name: string, type: AttributeType, count: number): VertexFormat {\n      this.attributes.push(new Attribute(name, type, count, this.stride))\n      this._stride += count * attributeByteLength(type)\n      return this\n    }\n  }\n\n  export abstract class VertexBuffer {\n    abstract byteCount: number\n    abstract context: Context\n    abstract move(sourceByteOffset: number, targetByteOffset: number, byteCount: number): void\n    abstract upload(bytes: Uint8Array, byteOffset?: number): void\n    uploadFloat32Array(floats: Float32Array) {\n      this.upload(new Uint8Array(floats.buffer), 0)\n    }\n    uploadFloats(floats: number[]) {\n      this.uploadFloat32Array(new Float32Array(floats))\n    }\n    abstract free(): void\n  }\n\n  export enum PixelFilter {\n    NEAREST,\n    LINEAR,\n  }\n\n  export enum PixelWrap {\n    REPEAT,\n    CLAMP,\n  }\n\n  export class TextureFormat {\n    constructor(\n      readonly minFilter: PixelFilter,\n      readonly magFilter: PixelFilter,\n      readonly wrap: PixelWrap,\n    ) {}\n\n    static LINEAR_CLAMP = new TextureFormat(PixelFilter.LINEAR, PixelFilter.LINEAR, PixelWrap.CLAMP)\n    static LINEAR_MIN_NEAREST_MAG_CLAMP = new TextureFormat(\n      PixelFilter.LINEAR,\n      PixelFilter.NEAREST,\n      PixelWrap.CLAMP,\n    )\n    static NEAREST_CLAMP = new TextureFormat(\n      PixelFilter.NEAREST,\n      PixelFilter.NEAREST,\n      PixelWrap.CLAMP,\n    )\n  }\n\n  export interface Texture {\n    context: Context\n    format: TextureFormat\n    width: number\n    height: number\n    resize(width: number, height: number, pixels?: Uint8Array): void\n    setFormat(format: TextureFormat): void\n    free(): void\n  }\n\n  export interface RenderTarget {\n    context: Context\n    texture: Texture\n    setColor(texture: Texture): void\n    free(): void\n  }\n}\n\n// Converted from https://github.com/evanw/sky/blob/c72de77/src/browser/context.sk\nexport namespace WebGL {\n  export class Context extends Graphics.Context {\n    private _attributeCount = 0\n    private _blendOperationMap: {[key: number]: GLenum}\n    private _blendOperations = 0\n    private _contextResetHandlers: (() => void)[] = []\n    private _currentClearColor = Graphics.Color.TRANSPARENT\n    private _currentRenderTarget: RenderTarget | null = null\n    private _defaultViewport = new Graphics.Rect()\n    private _forceStateUpdate = true\n    private _generation = 1\n    private _gl: WebGLRenderingContext\n    private _height = 0\n    private _oldBlendOperations = 0\n    private _oldRenderTarget: RenderTarget | null = null\n    private _oldViewport = new Graphics.Rect()\n    private _width = 0\n\n    get widthInPixels() {\n      return this._width\n    }\n    get heightInPixels() {\n      return this._height\n    }\n\n    constructor(canvas: HTMLCanvasElement = document.createElement('canvas')) {\n      super()\n      let gl = canvas.getContext('webgl', {\n        alpha: false,\n        antialias: false,\n        depth: false,\n        preserveDrawingBuffer: false,\n        stencil: false,\n      })\n\n      if (gl == null) {\n        throw new Error('Setup failure')\n      }\n\n      this._gl = gl\n      let style = canvas.style\n      canvas.width = 0\n      canvas.height = 0\n      style.width = style.height = '0'\n\n      canvas.addEventListener('webglcontextlost', (e: Event) => {\n        e.preventDefault()\n      })\n\n      canvas.addEventListener('webglcontextrestored', this.handleWebglContextRestored)\n\n      // Using maps makes these compact in release\n      this._blendOperationMap = {\n        [Graphics.BlendOperation.ZERO]: this._gl.ZERO,\n        [Graphics.BlendOperation.ONE]: this._gl.ONE,\n\n        [Graphics.BlendOperation.SOURCE_COLOR]: this._gl.SRC_COLOR,\n        [Graphics.BlendOperation.TARGET_COLOR]: this._gl.DST_COLOR,\n        [Graphics.BlendOperation.INVERSE_SOURCE_COLOR]: this._gl.ONE_MINUS_SRC_COLOR,\n        [Graphics.BlendOperation.INVERSE_TARGET_COLOR]: this._gl.ONE_MINUS_DST_COLOR,\n\n        [Graphics.BlendOperation.SOURCE_ALPHA]: this._gl.SRC_ALPHA,\n        [Graphics.BlendOperation.TARGET_ALPHA]: this._gl.DST_ALPHA,\n        [Graphics.BlendOperation.INVERSE_SOURCE_ALPHA]: this._gl.ONE_MINUS_SRC_ALPHA,\n        [Graphics.BlendOperation.INVERSE_TARGET_ALPHA]: this._gl.ONE_MINUS_DST_ALPHA,\n\n        [Graphics.BlendOperation.CONSTANT]: this._gl.CONSTANT_COLOR,\n        [Graphics.BlendOperation.INVERSE_CONSTANT]: this._gl.ONE_MINUS_CONSTANT_COLOR,\n      }\n    }\n\n    private handleWebglContextRestored = () => {\n      this._attributeCount = 0\n      this._currentClearColor = Graphics.Color.TRANSPARENT\n      this._forceStateUpdate = true\n      this._generation++\n      for (let handler of this._contextResetHandlers) {\n        handler()\n      }\n    }\n\n    public testContextLoss() {\n      this.handleWebglContextRestored()\n    }\n\n    get gl() {\n      return this._gl\n    }\n    get generation() {\n      return this._generation\n    }\n    addContextResetHandler(callback: () => void) {\n      appendOne(this._contextResetHandlers, callback)\n    }\n    removeContextResetHandler(callback: () => void) {\n      removeOne(this._contextResetHandlers, callback)\n    }\n\n    get currentRenderTarget() {\n      return this._currentRenderTarget\n    }\n\n    beginFrame() {\n      this.setRenderTarget(null)\n    }\n\n    endFrame() {}\n\n    setBlendState(source: Graphics.BlendOperation, target: Graphics.BlendOperation) {\n      this._blendOperations = Context._packBlendModes(source, target)\n    }\n\n    setViewport(x: number, y: number, width: number, height: number) {\n      ;(this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport\n        : this._defaultViewport\n      ).set(x, y, width, height)\n    }\n\n    get viewport() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport\n        : this._defaultViewport\n    }\n\n    get renderTargetWidthInPixels() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport.width\n        : this._width\n    }\n\n    get renderTargetHeightInPixels() {\n      return this._currentRenderTarget != null\n        ? this._currentRenderTarget.viewport.height\n        : this._height\n    }\n\n    draw(\n      primitive: Graphics.Primitive,\n      material: Graphics.Material,\n      vertices: Graphics.VertexBuffer,\n    ) {\n      // Update the texture set before preparing the material so uniform samplers can check for that they use different textures\n      this._updateRenderTargetAndViewport()\n      Material.from(material).prepare()\n\n      // Update the vertex buffer before updating the format so attributes can bind correctly\n      VertexBuffer.from(vertices).prepare()\n      this._updateFormat(material.format)\n\n      // Draw now that everything is ready\n      this._updateBlendState()\n\n      this._gl.drawArrays(\n        primitive == Graphics.Primitive.TRIANGLES ? this._gl.TRIANGLES : this._gl.TRIANGLE_STRIP,\n        0,\n        Math.floor(vertices.byteCount / material.format.stride),\n      )\n\n      // Forced state updates are done once after a context loss\n      this._forceStateUpdate = false\n    }\n\n    resize(\n      widthInPixels: number,\n      heightInPixels: number,\n      widthInAppUnits: number,\n      heightInAppUnits: number,\n    ) {\n      let canvas = this._gl.canvas as HTMLCanvasElement\n      const bounds = canvas.getBoundingClientRect()\n\n      if (\n        this._width === widthInPixels &&\n        this._height === heightInPixels &&\n        bounds.width === widthInAppUnits &&\n        bounds.height === heightInAppUnits\n      ) {\n        // Nothing to do here!\n        return\n      }\n\n      let style = canvas.style\n      canvas.width = widthInPixels\n      canvas.height = heightInPixels\n      style.width = `${widthInAppUnits}px`\n      style.height = `${heightInAppUnits}px`\n      this.setViewport(0, 0, widthInPixels, heightInPixels)\n      this._width = widthInPixels\n      this._height = heightInPixels\n\n      this.resizeEventHandlers.forEach(cb => cb())\n    }\n\n    clear(color: Graphics.Color) {\n      this._updateRenderTargetAndViewport()\n      this._updateBlendState()\n\n      if (!color.equals(this._currentClearColor)) {\n        this._gl.clearColor(color.redF, color.greenF, color.blueF, color.alphaF)\n        this._currentClearColor = color\n      }\n\n      this._gl.clear(this._gl.COLOR_BUFFER_BIT)\n    }\n\n    setRenderTarget(renderTarget: Graphics.RenderTarget | null) {\n      this._currentRenderTarget = RenderTarget.from(renderTarget)\n    }\n\n    createMaterial(\n      format: Graphics.VertexFormat,\n      vertexSource: string,\n      fragmentSource: string,\n    ): Graphics.Material {\n      let material = new Material(this, format, vertexSource, fragmentSource)\n\n      // Compiling shaders is really expensive so we want to get that started\n      // as early as possible. In Chrome and possibly other browsers, shader\n      // compilation can happen asynchronously as long as you don't call\n      // useProgram().\n      //\n      //   https://plus.google.com/+BrandonJonesToji/posts/4ERHkicC5Ny\n      //\n      material.program\n\n      return material\n    }\n\n    createVertexBuffer(byteCount: number): Graphics.VertexBuffer {\n      assert(byteCount > 0 && byteCount % 4 == 0)\n      return new VertexBuffer(this, byteCount)\n    }\n\n    createTexture(\n      format: Graphics.TextureFormat,\n      width: number,\n      height: number,\n      pixels?: Uint8Array,\n    ): Graphics.Texture {\n      return new Texture(this, format, width, height, pixels)\n    }\n\n    createRenderTarget(texture: Graphics.Texture): Graphics.RenderTarget {\n      return new RenderTarget(this, Texture.from(texture))\n    }\n\n    private ANGLE_instanced_arrays: ANGLE_instanced_arrays | null = null\n    private ANGLE_instanced_arrays_generation: number = -1\n    getANGLE_instanced_arrays(): ANGLE_instanced_arrays {\n      if (this.ANGLE_instanced_arrays_generation !== this._generation) {\n        this.ANGLE_instanced_arrays = null\n      }\n      if (!this.ANGLE_instanced_arrays) {\n        this.ANGLE_instanced_arrays = this.gl.getExtension('ANGLE_instanced_arrays')\n        if (!this.ANGLE_instanced_arrays) {\n          throw new Error('Failed to get extension ANGLE_instanced_arrays')\n        }\n      }\n      return this.ANGLE_instanced_arrays!\n    }\n\n    _updateRenderTargetAndViewport() {\n      let renderTarget = this._currentRenderTarget\n      let viewport = renderTarget != null ? renderTarget.viewport : this._defaultViewport\n      let gl = this._gl\n\n      if (this._forceStateUpdate || this._oldRenderTarget != renderTarget) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, renderTarget ? renderTarget.framebuffer : null)\n        this._oldRenderTarget = renderTarget\n      }\n\n      if (this._forceStateUpdate || !this._oldViewport.equals(viewport)) {\n        gl.viewport(\n          viewport.x,\n          this.renderTargetHeightInPixels - viewport.y - viewport.height,\n          viewport.width,\n          viewport.height,\n        )\n        this._oldViewport.set(viewport.x, viewport.y, viewport.width, viewport.height)\n      }\n    }\n\n    _updateBlendState() {\n      if (this._forceStateUpdate || this._oldBlendOperations != this._blendOperations) {\n        let gl = this._gl\n        let operations = this._blendOperations\n        let oldOperations = this._oldBlendOperations\n        let source = (operations & 0xf) as Graphics.BlendOperation\n        let target = (operations >> 4) as Graphics.BlendOperation\n\n        assert(source in this._blendOperationMap)\n        assert(target in this._blendOperationMap)\n\n        // Special-case the blend mode that just writes over the target buffer\n        if (operations == Context.COPY_BLEND_OPERATIONS) {\n          gl.disable(gl.BLEND)\n        } else {\n          if (this._forceStateUpdate || oldOperations == Context.COPY_BLEND_OPERATIONS) {\n            gl.enable(gl.BLEND)\n          }\n\n          // Otherwise, use actual blending\n          gl.blendFunc(this._blendOperationMap[source], this._blendOperationMap[target])\n        }\n\n        this._oldBlendOperations = operations\n      }\n    }\n\n    _updateFormat(format: Graphics.VertexFormat) {\n      // Update the attributes\n      let gl = this._gl\n      let attributes = format.attributes\n      let count = attributes.length\n      for (let i = 0; i < count; i++) {\n        let attribute = attributes[i]\n        let isByte = attribute.type == Graphics.AttributeType.BYTE\n        gl.vertexAttribPointer(\n          i,\n          attribute.count,\n          isByte ? gl.UNSIGNED_BYTE : gl.FLOAT,\n          isByte,\n          format.stride,\n          attribute.byteOffset,\n        )\n      }\n\n      // Update the attribute count\n      while (this._attributeCount < count) {\n        gl.enableVertexAttribArray(this._attributeCount)\n        this._attributeCount++\n      }\n      while (this._attributeCount > count) {\n        this._attributeCount--\n        gl.disableVertexAttribArray(this._attributeCount)\n      }\n      this._attributeCount = count\n    }\n\n    getWebGLInfo(): {renderer: string | null; vendor: string | null; version: string | null} {\n      const ext = this.gl.getExtension('WEBGL_debug_renderer_info')\n      const renderer = ext ? this.gl.getParameter(ext.UNMASKED_RENDERER_WEBGL) : null\n      const vendor = ext ? this.gl.getParameter(ext.UNMASKED_VENDOR_WEBGL) : null\n      const version = this.gl.getParameter(this.gl.VERSION)\n      return {renderer, vendor, version}\n    }\n\n    static from(context: Graphics.Context): Context {\n      assert(context == null || context instanceof Context)\n      return context as Context\n    }\n\n    static _packBlendModes(\n      source: Graphics.BlendOperation,\n      target: Graphics.BlendOperation,\n    ): number {\n      return source | (target << 4)\n    }\n\n    static COPY_BLEND_OPERATIONS = Context._packBlendModes(\n      Graphics.BlendOperation.ONE,\n      Graphics.BlendOperation.ZERO,\n    )\n  }\n\n  abstract class Uniform {\n    constructor(\n      protected readonly _material: Material,\n      protected readonly _name: string,\n      protected _generation = 0,\n      protected _location: WebGLUniformLocation | null = null,\n      protected _isDirty = true,\n    ) {}\n\n    // Upload this uniform if it's dirty\n    abstract prepare(): void\n\n    get location(): WebGLUniformLocation {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation) {\n        this._location = context.gl.getUniformLocation(this._material.program, this._name)\n        this._generation = context.generation\n\n        // Validate the shader against this uniform\n        if (!RELEASE) {\n          let program = this._material.program\n          let gl = context.gl\n          for (let i = 0, ii = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS); i < ii; i++) {\n            let info = gl.getActiveUniform(program, i)\n            if (info && info.name == this._name) {\n              assert(info.size == 1)\n              switch (info.type) {\n                case gl.FLOAT: {\n                  assert(this instanceof UniformFloat)\n                  break\n                }\n                case gl.FLOAT_MAT3: {\n                  assert(this instanceof UniformMat3)\n                  break\n                }\n                case gl.FLOAT_VEC2: {\n                  assert(this instanceof UniformVec2)\n                  break\n                }\n                case gl.FLOAT_VEC3: {\n                  assert(this instanceof UniformVec3)\n                  break\n                }\n                case gl.FLOAT_VEC4: {\n                  assert(this instanceof UniformVec4)\n                  break\n                }\n                case gl.INT: {\n                  assert(this instanceof UniformInt)\n                  break\n                }\n                case gl.SAMPLER_2D: {\n                  assert(this instanceof UniformSampler)\n                  break\n                }\n                default:\n                  assert(false)\n              }\n            }\n          }\n        }\n      }\n      if (!this._location) {\n        throw new Error('Failed to get uniform location')\n      }\n      return this._location\n    }\n  }\n\n  class UniformFloat extends Uniform {\n    private _x = 0.0\n\n    set(x: number) {\n      if (x != this._x) {\n        this._x = x\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform1f(this.location, this._x)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformInt extends Uniform {\n    private _x = 0\n\n    set(x: number) {\n      if (x != this._x) {\n        this._x = x\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform1i(this.location, this._x)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec2 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n\n    set(x: number, y: number) {\n      if (x != this._x || y != this._y) {\n        this._x = x\n        this._y = y\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform2f(this.location, this._x, this._y)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec3 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n    private _z = 0.0\n\n    set(x: number, y: number, z: number) {\n      if (x != this._x || y != this._y || z != this._z) {\n        this._x = x\n        this._y = y\n        this._z = z\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform3f(this.location, this._x, this._y, this._z)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformVec4 extends Uniform {\n    private _x = 0.0\n    private _y = 0.0\n    private _z = 0.0\n    private _w = 0.0\n\n    set(x: number, y: number, z: number, w: number) {\n      if (x != this._x || y != this._y || z != this._z || w != this._w) {\n        this._x = x\n        this._y = y\n        this._z = z\n        this._w = w\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniform4f(this.location, this._x, this._y, this._z, this._w)\n        this._isDirty = false\n      }\n    }\n  }\n\n  class UniformMat3 extends Uniform {\n    private _values = [1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0]\n\n    set(\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ) {\n      // These values are deliberately transposed because WebGL requires the \"transpose\" argument of uniformMatrix() to be false\n      UniformMat3._cachedValues[0] = m00\n      UniformMat3._cachedValues[1] = m10\n      UniformMat3._cachedValues[2] = m20\n      UniformMat3._cachedValues[3] = m01\n      UniformMat3._cachedValues[4] = m11\n      UniformMat3._cachedValues[5] = m21\n      UniformMat3._cachedValues[6] = m02\n      UniformMat3._cachedValues[7] = m12\n      UniformMat3._cachedValues[8] = m22\n\n      for (let i = 0; i < 9; i++) {\n        if (UniformMat3._cachedValues[i] != this._values[i]) {\n          let swap = this._values\n          this._values = UniformMat3._cachedValues\n          UniformMat3._cachedValues = swap\n          this._isDirty = true\n          break\n        }\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      if (this._generation != context.generation || this._isDirty) {\n        context.gl.uniformMatrix3fv(this.location, false, this._values)\n        this._isDirty = false\n      }\n    }\n\n    // Statically allocate this to avoid allocations\n    static _cachedValues = [1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0]\n  }\n\n  class UniformSampler extends Uniform {\n    private _texture: Texture | null = null\n    private _index = -1\n\n    set(texture: Graphics.Texture, index: number) {\n      if (this._texture != texture || this._index != index) {\n        this._texture = Texture.from(texture)\n        this._index = index\n        this._isDirty = true\n      }\n    }\n\n    prepare() {\n      let context = Context.from(this._material.context)\n      let gl = context.gl\n      assert(\n        this._texture == null ||\n          context.currentRenderTarget == null ||\n          this._texture != context.currentRenderTarget.texture,\n      )\n      if (this._generation != context.generation || this._isDirty) {\n        gl.uniform1i(this.location, this._index)\n        this._isDirty = false\n      }\n      gl.activeTexture(TEXTURE_N(gl, this._index))\n      gl.bindTexture(\n        gl.TEXTURE_2D,\n        this._texture != null && this._texture.width > 0 && this._texture.height > 0\n          ? this._texture.texture\n          : null,\n      )\n    }\n  }\n\n  class Material implements Graphics.Material {\n    constructor(\n      private readonly _context: Context,\n      private readonly _format: Graphics.VertexFormat,\n      private readonly _vertexSource: string,\n      private readonly _fragmentSource: string,\n      private readonly _uniformsMap: {[key: string]: Uniform} = {},\n      private readonly _uniformsList: Uniform[] = [],\n      private _generation = 0,\n      private _program: WebGLProgram | null = null,\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get format() {\n      return this._format\n    }\n    get vertexSource() {\n      return this._vertexSource\n    }\n    get fragmentSource() {\n      return this._fragmentSource\n    }\n\n    setUniformFloat(name: string, x: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformFloat(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformFloat)\n      ;(uniform as UniformFloat).set(x)\n    }\n\n    setUniformInt(name: string, x: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformInt(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformInt)\n      ;(uniform as UniformInt).set(x)\n    }\n\n    setUniformVec2(name: string, x: number, y: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec2(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec2)\n      ;(uniform as UniformVec2).set(x, y)\n    }\n\n    setUniformVec3(name: string, x: number, y: number, z: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec3(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec3)\n      ;(uniform as UniformVec3).set(x, y, z)\n    }\n\n    setUniformVec4(name: string, x: number, y: number, z: number, w: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformVec4(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformVec4)\n      ;(uniform as UniformVec4).set(x, y, z, w)\n    }\n\n    setUniformMat3(\n      name: string,\n      m00: number,\n      m01: number,\n      m02: number,\n      m10: number,\n      m11: number,\n      m12: number,\n      m20: number,\n      m21: number,\n      m22: number,\n    ) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformMat3(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformMat3)\n      ;(uniform as UniformMat3).set(m00, m01, m02, m10, m11, m12, m20, m21, m22)\n    }\n\n    setUniformSampler(name: string, texture: Graphics.Texture, index: number) {\n      let uniform = this._uniformsMap[name] || null\n      if (uniform == null) {\n        uniform = new UniformSampler(this, name)\n        this._uniformsMap[name] = uniform\n        this._uniformsList.push(uniform)\n      }\n      assert(uniform instanceof UniformSampler)\n      ;(uniform as UniformSampler).set(texture, index)\n    }\n\n    get program(): WebGLProgram {\n      let gl = this._context.gl\n      if (this._generation != this._context.generation) {\n        this._program = gl.createProgram()!\n        this._compileShader(gl, gl.VERTEX_SHADER, this.vertexSource)\n        this._compileShader(gl, gl.FRAGMENT_SHADER, this.fragmentSource)\n        let attributes = this.format.attributes\n        for (let i = 0; i < attributes.length; i++) {\n          gl.bindAttribLocation(this._program, i, attributes[i].name)\n        }\n        gl.linkProgram(this._program)\n        if (!gl.getProgramParameter(this._program, gl.LINK_STATUS)) {\n          throw new Error(`${gl.getProgramInfoLog(this._program)}`)\n        }\n        this._generation = this._context.generation\n\n        // Validate this shader against the format\n        if (!RELEASE) {\n          for (let attribute of attributes) {\n            for (\n              let i = 0, ii = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\n              i < ii;\n              i++\n            ) {\n              let info = gl.getActiveAttrib(this.program, i)\n              if (info && info.name == attribute.name) {\n                assert(info.size == 1)\n                switch (attribute.count) {\n                  case 1: {\n                    assert(info.type == gl.FLOAT)\n                    break\n                  }\n                  case 2: {\n                    assert(info.type == gl.FLOAT_VEC2)\n                    break\n                  }\n                  case 3: {\n                    assert(info.type == gl.FLOAT_VEC3)\n                    break\n                  }\n                  case 4: {\n                    assert(info.type == gl.FLOAT_VEC4)\n                    break\n                  }\n                  default: {\n                    assert(false)\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      return this._program!\n    }\n\n    prepare(): void {\n      this._context.gl.useProgram(this.program)\n      for (let uniform of this._uniformsList) {\n        uniform.prepare()\n      }\n    }\n\n    _compileShader(gl: WebGLRenderingContext, type: GLenum, source: string) {\n      let shader = gl.createShader(type)\n      if (!shader) {\n        throw new Error('Failed to create shader')\n      }\n      gl.shaderSource(shader, source)\n      gl.compileShader(shader)\n      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        throw new Error(`${gl.getShaderInfoLog(shader)}`)\n      }\n      if (!this._program) {\n        throw new Error('Tried to attach shader before program was created')\n      }\n      gl.attachShader(this._program, shader)\n    }\n\n    static from(material: Graphics.Material): Material {\n      assert(material == null || material instanceof Material)\n      return material as Material\n    }\n  }\n\n  class VertexBuffer extends Graphics.VertexBuffer {\n    private readonly _context: Context\n    private _generation = 0\n    private _buffer: WebGLBuffer | null = null\n    private _bytes: Uint8Array | null = null\n    private _isDirty = true\n    private _dirtyMin = VertexBuffer.INT_MAX\n    private _dirtyMax = 0\n    private _totalMin = VertexBuffer.INT_MAX\n    private _totalMax = 0\n    private _byteCount = 0\n\n    constructor(context: Context, byteCount: number) {\n      super()\n      this._context = context\n      this._byteCount = byteCount\n      this._bytes = new Uint8Array(byteCount)\n    }\n\n    get context() {\n      return this._context\n    }\n    get byteCount() {\n      return this._byteCount\n    }\n\n    move(sourceByteOffset: number, targetByteOffset: number, byteCount: number) {\n      assert(byteCount >= 0)\n      assert(0 <= sourceByteOffset && sourceByteOffset + byteCount <= this._byteCount)\n      assert(0 <= targetByteOffset && targetByteOffset + byteCount <= this._byteCount)\n\n      if (this._bytes && sourceByteOffset != targetByteOffset && byteCount != 0) {\n        this._bytes.set(this._bytes.subarray(sourceByteOffset, this._byteCount), targetByteOffset)\n        this._growDirtyRegion(\n          Math.min(sourceByteOffset, targetByteOffset),\n          Math.max(sourceByteOffset, targetByteOffset) + byteCount,\n        )\n      }\n    }\n\n    upload(bytes: Uint8Array, byteOffset: number = 0) {\n      assert(0 <= byteOffset && byteOffset + bytes.length <= this._byteCount)\n      assert(this._bytes != null)\n      this._bytes!.set(bytes, byteOffset)\n      this._growDirtyRegion(byteOffset, byteOffset + bytes.length)\n    }\n\n    free() {\n      if (this._buffer) {\n        this._context.gl.deleteBuffer(this._buffer)\n      }\n\n      // Reset the generation to force this to be re-uploaded if it's used again\n      // in the future.\n      this._generation = 0\n    }\n\n    prepare(): void {\n      let gl = this._context.gl\n\n      if (this._generation !== this._context.generation) {\n        this._buffer = gl.createBuffer()\n        this._generation = this._context.generation\n        this._isDirty = true\n      }\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, this._buffer)\n\n      if (this._isDirty) {\n        gl.bufferData(gl.ARRAY_BUFFER, this._byteCount, gl.DYNAMIC_DRAW)\n        this._dirtyMin = this._totalMin\n        this._dirtyMax = this._totalMax\n        this._isDirty = false\n      }\n\n      if (this._dirtyMin < this._dirtyMax) {\n        gl.bufferSubData(\n          gl.ARRAY_BUFFER,\n          this._dirtyMin,\n          this._bytes!.subarray(this._dirtyMin, this._dirtyMax),\n        )\n        this._dirtyMin = VertexBuffer.INT_MAX\n        this._dirtyMax = 0\n      }\n    }\n\n    _growDirtyRegion(min: number, max: number) {\n      this._dirtyMin = Math.min(this._dirtyMin, min)\n      this._dirtyMax = Math.max(this._dirtyMax, max)\n      this._totalMin = Math.min(this._totalMin, min)\n      this._totalMax = Math.max(this._totalMax, max)\n    }\n\n    static INT_MAX = 0x7fffffff\n\n    static from(buffer: Graphics.VertexBuffer): VertexBuffer {\n      assert(buffer == null || buffer instanceof VertexBuffer)\n      return buffer as VertexBuffer\n    }\n  }\n\n  class Texture implements Graphics.Texture {\n    constructor(\n      private readonly _context: Context,\n      private _format: Graphics.TextureFormat,\n      private _width: number,\n      private _height: number,\n      private _pixels: Uint8Array | null = null,\n      private _texture: WebGLTexture | null = null,\n      private _generation = 0,\n      private _isFormatDirty = true,\n      private _isContentDirty = true,\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get format() {\n      return this._format\n    }\n    get width() {\n      return this._width\n    }\n    get height() {\n      return this._height\n    }\n\n    resize(width: number, height: number, pixels: Uint8Array | null = null) {\n      this._width = width\n      this._height = height\n      this._pixels = pixels\n      this._isContentDirty = true\n    }\n\n    setFormat(format: Graphics.TextureFormat) {\n      if (this._format != format) {\n        this._format = format\n        this._isFormatDirty = true\n      }\n    }\n\n    get texture(): WebGLTexture {\n      let gl = this._context.gl\n\n      // Create\n      if (this._generation != this._context.generation) {\n        this._texture = gl.createTexture()\n        this._generation = this._context.generation\n        this._isFormatDirty = true\n        this._isContentDirty = true\n      }\n\n      // Format\n      if (this._isFormatDirty) {\n        gl.bindTexture(gl.TEXTURE_2D, this._texture)\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_MAG_FILTER,\n          this.format.magFilter == Graphics.PixelFilter.NEAREST ? gl.NEAREST : gl.LINEAR,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_MIN_FILTER,\n          this.format.minFilter == Graphics.PixelFilter.NEAREST ? gl.NEAREST : gl.LINEAR,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_WRAP_S,\n          this.format.wrap == Graphics.PixelWrap.REPEAT ? gl.REPEAT : gl.CLAMP_TO_EDGE,\n        )\n        gl.texParameteri(\n          gl.TEXTURE_2D,\n          gl.TEXTURE_WRAP_T,\n          this.format.wrap == Graphics.PixelWrap.REPEAT ? gl.REPEAT : gl.CLAMP_TO_EDGE,\n        )\n        this._isFormatDirty = false\n      }\n\n      if (this._isContentDirty) {\n        gl.bindTexture(gl.TEXTURE_2D, this._texture)\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          this._width,\n          this._height,\n          0,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          this._pixels,\n        )\n        this._isContentDirty = false\n      }\n\n      return this._texture!\n    }\n\n    free() {\n      if (this.texture) {\n        this._context.gl.deleteTexture(this.texture)\n        this._generation = 0\n      }\n    }\n\n    static from(texture: Graphics.Texture): Texture {\n      assert(texture == null || texture instanceof Texture)\n      return texture as Texture\n    }\n  }\n\n  class RenderTarget implements Graphics.RenderTarget {\n    constructor(\n      private _context: Context,\n      private _texture: Texture,\n      private _framebuffer: WebGLFramebuffer | null = null,\n      private _generation = 0,\n      private _isDirty = true,\n      private _viewport = new Graphics.Rect(),\n    ) {}\n\n    get context() {\n      return this._context\n    }\n    get texture() {\n      return this._texture\n    }\n    get viewport() {\n      return this._viewport\n    }\n    setColor(texture: Graphics.Texture) {\n      if (this._texture != texture) {\n        this._texture = Texture.from(texture)\n        this._isDirty = true\n      }\n    }\n\n    get framebuffer(): WebGLFramebuffer {\n      let gl = this._context.gl\n      let texture = this._texture.texture\n\n      // Create\n      if (this._generation != this._context.generation) {\n        this._framebuffer = gl.createFramebuffer()\n        this._generation = this._context.generation\n        this._isDirty = true\n      }\n\n      // Update\n      if (this._isDirty) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebuffer)\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0)\n        assert(gl.checkFramebufferStatus(gl.FRAMEBUFFER) == gl.FRAMEBUFFER_COMPLETE)\n        this._isDirty = false\n      }\n\n      return this._framebuffer!\n    }\n\n    free() {\n      if (this._framebuffer) {\n        this._context.gl.deleteFramebuffer(this._framebuffer)\n        this._generation = 0\n      }\n    }\n\n    static from(renderTarget: Graphics.RenderTarget | null): RenderTarget | null {\n      assert(renderTarget == null || renderTarget instanceof RenderTarget)\n      return renderTarget as RenderTarget | null\n    }\n  }\n}\n", "import {Graphics} from './graphics'\nimport {AffineTransform, Vec2} from '../lib/math'\n\nexport function setUniformAffineTransform(\n  material: Graphics.Material,\n  name: string,\n  transform: AffineTransform,\n) {\n  let {m00, m01, m02, m10, m11, m12} = transform\n  material.setUniformMat3(name, m00, m01, m02, m10, m11, m12, 0, 0, 1)\n}\nexport function setUniformVec2(material: Graphics.Material, name: string, vec: Vec2) {\n  material.setUniformVec2(name, vec.x, vec.y)\n}\n\nexport function renderInto(gl: Graphics.Context, target: Graphics.RenderTarget, cb: () => void) {\n  gl.setRenderTarget(target)\n  gl.setViewport(0, 0, target.texture.width, target.texture.height)\n  cb()\n  gl.setRenderTarget(null)\n}\n", "import {Rect, Vec2, AffineTransform} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('configSpacePos', Graphics.AttributeType.FLOAT, 2)\nvertexFormat.add('color', Graphics.AttributeType.FLOAT, 3)\n\nconst vert = `\n  uniform mat3 configSpaceToNDC;\n\n  attribute vec2 configSpacePos;\n  attribute vec3 color;\n  varying vec3 vColor;\n\n  void main() {\n    vColor = color;\n    vec2 position = (configSpaceToNDC * vec3(configSpacePos, 1)).xy;\n    gl_Position = vec4(position, 1, 1);\n  }\n`\n\nconst frag = `\n  precision mediump float;\n  varying vec3 vColor;\n\n  void main() {\n    gl_FragColor = vec4(vColor.rgb, 1);\n  }\n`\n\nexport class RectangleBatch {\n  private rects: Rect[] = []\n  private colors: Color[] = []\n  constructor(private gl: Graphics.Context) {}\n\n  getRectCount() {\n    return this.rects.length\n  }\n\n  private buffer: Graphics.VertexBuffer | null = null\n  getBuffer(): Graphics.VertexBuffer {\n    if (this.buffer) {\n      return this.buffer\n    }\n\n    const corners = [\n      [0, 0],\n      [1, 0],\n      [0, 1],\n      [1, 0],\n      [0, 1],\n      [1, 1],\n    ]\n\n    const bytes = new Uint8Array(vertexFormat.stride * corners.length * this.rects.length)\n    const floats = new Float32Array(bytes.buffer)\n    let idx = 0\n\n    for (let i = 0; i < this.rects.length; i++) {\n      const rect = this.rects[i]\n      const color = this.colors[i]\n\n      // TODO(jlfwong): In the conversion from regl to graphics.ts, I lost the\n      // ability to do instanced drawing. This is a pretty significant hit to\n      // the performance here since I need 6x the memory to allocate these\n      // things. Adding instanced drawing to graphics.ts is non-trivial, so I'm\n      // just going to try this for now.\n      for (let corner of corners) {\n        floats[idx++] = rect.origin.x + corner[0] * rect.size.x\n        floats[idx++] = rect.origin.y + corner[1] * rect.size.y\n\n        floats[idx++] = color.r\n        floats[idx++] = color.g\n        floats[idx++] = color.b\n      }\n    }\n\n    if (idx !== floats.length) {\n      throw new Error(\"Buffer expected to be full but wasn't\")\n    }\n\n    this.buffer = this.gl.createVertexBuffer(bytes.length)\n    this.buffer.upload(bytes)\n    return this.buffer\n  }\n\n  addRect(rect: Rect, color: Color) {\n    this.rects.push(rect)\n    this.colors.push(color)\n\n    if (this.buffer) {\n      this.buffer.free()\n      this.buffer = null\n    }\n  }\n\n  free() {\n    if (this.buffer) {\n      this.buffer.free()\n      this.buffer = null\n    }\n  }\n}\n\nexport interface RectangleBatchRendererProps {\n  batch: RectangleBatch\n  configSpaceSrcRect: Rect\n  physicalSpaceDstRect: Rect\n}\n\nexport class RectangleBatchRenderer {\n  material: Graphics.Material\n  constructor(private gl: Graphics.Context) {\n    this.material = gl.createMaterial(vertexFormat, vert, frag)\n  }\n\n  render(props: RectangleBatchRendererProps) {\n    setUniformAffineTransform(\n      this.material,\n      'configSpaceToNDC',\n      (() => {\n        const configToPhysical = AffineTransform.betweenRects(\n          props.configSpaceSrcRect,\n          props.physicalSpaceDstRect,\n        )\n\n        const viewportSize = new Vec2(this.gl.viewport.width, this.gl.viewport.height)\n\n        const physicalToNDC = AffineTransform.withTranslation(new Vec2(-1, 1)).times(\n          AffineTransform.withScale(new Vec2(2, -2).dividedByPointwise(viewportSize)),\n        )\n\n        return physicalToNDC.times(configToPhysical)\n      })(),\n    )\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLES, this.material, props.batch.getBuffer())\n  }\n}\n", "import {clamp} from './math'\n\nexport class Color {\n  constructor(\n    readonly r: number = 0,\n    readonly g: number = 0,\n    readonly b: number = 0,\n    readonly a: number = 1,\n  ) {}\n\n  static fromLumaChromaHue(L: number, C: number, H: number) {\n    // 0 <= L <= 1\n    // 0 <= C <= 1\n    // 0 <= H <= 360\n    // https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue\n\n    const hPrime = H / 60\n    const X = C * (1 - Math.abs((hPrime % 2) - 1))\n    const [R1, G1, B1] =\n      hPrime < 1\n        ? [C, X, 0]\n        : hPrime < 2\n          ? [X, C, 0]\n          : hPrime < 3\n            ? [0, C, X]\n            : hPrime < 4\n              ? [0, X, C]\n              : hPrime < 5\n                ? [X, 0, C]\n                : [C, 0, X]\n\n    const m = L - (0.3 * R1 + 0.59 * G1 + 0.11 * B1)\n\n    return new Color(clamp(R1 + m, 0, 1), clamp(G1 + m, 0, 1), clamp(B1 + m, 0, 1), 1.0)\n  }\n\n  static fromCSSHex(hex: string) {\n    if (hex.length !== 7 || hex[0] !== '#') {\n      throw new Error(`Invalid color input ${hex}`)\n    }\n    const r = parseInt(hex.substr(1, 2), 16) / 255\n    const g = parseInt(hex.substr(3, 2), 16) / 255\n    const b = parseInt(hex.substr(5, 2), 16) / 255\n    if (r < 0 || r > 1 || g < 0 || g > 1 || b < 0 || b > 1) {\n      throw new Error(`Invalid color input ${hex}`)\n    }\n    return new Color(r, g, b)\n  }\n\n  withAlpha(a: number): Color {\n    return new Color(this.r, this.g, this.b, a)\n  }\n\n  toCSS(): string {\n    return `rgba(${(255 * this.r).toFixed()}, ${(255 * this.g).toFixed()}, ${(\n      255 * this.b\n    ).toFixed()}, ${this.a.toFixed(2)})`\n  }\n}\n", "import {LRUCache} from '../lib/lru-cache'\nimport {RectangleBatch, RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {Rect, Vec2} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {Graphics} from './graphics'\nimport {TextureRenderer} from './texture-renderer'\nimport {renderInto} from './utils'\n\nexport class RowAtlas<K> {\n  private texture: Graphics.Texture\n  private renderTarget: Graphics.RenderTarget\n  private rowCache: LRUCache<K, number>\n  private clearLineBatch: RectangleBatch\n\n  constructor(\n    private gl: Graphics.Context,\n    private rectangleBatchRenderer: RectangleBatchRenderer,\n    private textureRenderer: TextureRenderer,\n  ) {\n    this.texture = gl.createTexture(Graphics.TextureFormat.NEAREST_CLAMP, 4096, 4096)\n    this.renderTarget = gl.createRenderTarget(this.texture)\n    this.rowCache = new LRUCache(this.texture.height)\n    this.clearLineBatch = new RectangleBatch(gl)\n    this.clearLineBatch.addRect(Rect.unit, new Color(0, 0, 0, 0))\n\n    // All of the cached data is stored GPU-side, and we don't retain a copy of\n    // it client-side. This means when we get a context loss event, the data is\n    // totally gone. So let's clear our CPU-side cache to reflect that fact.\n    gl.addContextResetHandler(() => {\n      this.rowCache.clear()\n    })\n  }\n\n  has(key: K) {\n    return this.rowCache.has(key)\n  }\n  getResolution() {\n    return this.texture.width\n  }\n  getCapacity() {\n    return this.texture.height\n  }\n\n  private allocateLine(key: K): number {\n    if (this.rowCache.getSize() < this.rowCache.getCapacity()) {\n      // Not in cache, but cache isn't full\n      const row = this.rowCache.getSize()\n      this.rowCache.insert(key, row)\n      return row\n    } else {\n      // Not in cache, and cache is full. Evict something.\n      const [, row] = this.rowCache.removeLRU()!\n      this.rowCache.insert(key, row)\n      return row\n    }\n  }\n\n  writeToAtlasIfNeeded(keys: K[], render: (textureDstRect: Rect, key: K) => void) {\n    renderInto(this.gl, this.renderTarget, () => {\n      for (let key of keys) {\n        let row = this.rowCache.get(key)\n        if (row != null) {\n          // Already cached!\n          continue\n        }\n        // Not cached -- we'll have to actually render\n        row = this.allocateLine(key)\n\n        const textureRect = new Rect(new Vec2(0, row), new Vec2(this.texture.width, 1))\n        this.rectangleBatchRenderer.render({\n          batch: this.clearLineBatch,\n          configSpaceSrcRect: Rect.unit,\n          physicalSpaceDstRect: textureRect,\n        })\n        render(textureRect, key)\n      }\n    })\n  }\n\n  renderViaAtlas(key: K, dstRect: Rect): boolean {\n    let row = this.rowCache.get(key)\n    if (row == null) {\n      return false\n    }\n\n    const textureRect = new Rect(new Vec2(0, row), new Vec2(this.texture.width, 1))\n\n    // At this point, we have the row in cache, and we can\n    // paint directly from it into the framebuffer.\n    this.textureRenderer.render({\n      texture: this.texture,\n      srcRect: textureRect,\n      dstRect: dstRect,\n    })\n    return true\n  }\n}\n", "import {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nexport interface TextureRendererProps {\n  texture: Graphics.Texture\n  srcRect: Rect\n  dstRect: Rect\n}\n\nconst vert = `\n  uniform mat3 uvTransform;\n  uniform mat3 positionTransform;\n\n  attribute vec2 position;\n  attribute vec2 uv;\n  varying vec2 vUv;\n\n  void main() {\n    vUv = (uvTransform * vec3(uv, 1)).xy;\n    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);\n  }\n`\n\nconst frag = `\n  precision mediump float;\n\n  varying vec2 vUv;\n  uniform sampler2D texture;\n\n  void main() {\n   gl_FragColor = texture2D(texture, vUv);\n  }\n`\n\nexport interface TextureRendererProps {\n  texture: Graphics.Texture\n  srcRect: Rect\n  dstRect: Rect\n}\n\nexport class TextureRenderer {\n  private buffer: Graphics.VertexBuffer\n  private material: Graphics.Material\n\n  constructor(private gl: Graphics.Context) {\n    const vertexFormat = new Graphics.VertexFormat()\n    vertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\n    vertexFormat.add('uv', Graphics.AttributeType.FLOAT, 2)\n\n    const vertices = [\n      {pos: [-1, 1], uv: [0, 1]},\n      {pos: [1, 1], uv: [1, 1]},\n      {pos: [-1, -1], uv: [0, 0]},\n      {pos: [1, -1], uv: [1, 0]},\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v.pos[0])\n      floats.push(v.pos[1])\n      floats.push(v.uv[0])\n      floats.push(v.uv[1])\n    }\n\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.upload(new Uint8Array(new Float32Array(floats).buffer))\n    this.material = gl.createMaterial(vertexFormat, vert, frag)\n  }\n\n  render(props: TextureRendererProps) {\n    this.material.setUniformSampler('texture', props.texture, 0)\n    setUniformAffineTransform(\n      this.material,\n      'uvTransform',\n      (() => {\n        const {srcRect, texture} = props\n        const physicalToUV = AffineTransform.withTranslation(new Vec2(0, 1))\n          .times(AffineTransform.withScale(new Vec2(1, -1)))\n          .times(\n            AffineTransform.betweenRects(\n              new Rect(Vec2.zero, new Vec2(texture.width, texture.height)),\n              Rect.unit,\n            ),\n          )\n        const uvRect = physicalToUV.transformRect(srcRect)\n        return AffineTransform.betweenRects(Rect.unit, uvRect)\n      })(),\n    )\n    setUniformAffineTransform(\n      this.material,\n      'positionTransform',\n      (() => {\n        const {dstRect} = props\n\n        const {viewport} = this.gl\n        const viewportSize = new Vec2(viewport.width, viewport.height)\n\n        const physicalToNDC = AffineTransform.withScale(new Vec2(1, -1)).times(\n          AffineTransform.betweenRects(new Rect(Vec2.zero, viewportSize), Rect.NDC),\n        )\n        const ndcRect = physicalToNDC.transformRect(dstRect)\n        return AffineTransform.betweenRects(Rect.NDC, ndcRect)\n      })(),\n    )\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n", "import {Color} from '../lib/color'\nimport {AffineTransform, Rect} from '../lib/math'\nimport {Theme} from '../views/themes/theme'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform, setUniformVec2} from './utils'\n\nexport interface ViewportRectangleRendererProps {\n  configSpaceToPhysicalViewSpace: AffineTransform\n  configSpaceViewportRect: Rect\n}\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\n\nconst vert = `\n  attribute vec2 position;\n\n  void main() {\n    gl_Position = vec4(position, 0, 1);\n  }\n`\n\nconst frag = (theme: Theme) => {\n  const {r, g, b} = Color.fromCSSHex(theme.fgSecondaryColor)\n  const rgb = `${r.toFixed(1)}, ${g.toFixed(1)}, ${b.toFixed(1)}`\n  return `\n    precision mediump float;\n\n    uniform mat3 configSpaceToPhysicalViewSpace;\n    uniform vec2 physicalSize;\n    uniform vec2 physicalOrigin;\n    uniform vec2 configSpaceViewportOrigin;\n    uniform vec2 configSpaceViewportSize;\n    uniform float framebufferHeight;\n\n    void main() {\n      vec2 origin = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportOrigin, 1.0)).xy;\n      vec2 size = (configSpaceToPhysicalViewSpace * vec3(configSpaceViewportSize, 0.0)).xy;\n\n      vec2 halfSize = physicalSize / 2.0;\n\n      float borderWidth = 2.0;\n\n      origin = floor(origin * halfSize) / halfSize + borderWidth * vec2(1.0, 1.0);\n      size = floor(size * halfSize) / halfSize - 2.0 * borderWidth * vec2(1.0, 1.0);\n\n      vec2 coord = gl_FragCoord.xy;\n      coord.x = coord.x - physicalOrigin.x;\n      coord.y = framebufferHeight - coord.y - physicalOrigin.y;\n      vec2 clamped = clamp(coord, origin, origin + size);\n      vec2 gap = clamped - coord;\n      float maxdist = max(abs(gap.x), abs(gap.y));\n\n      // TOOD(jlfwong): Could probably optimize this to use mix somehow.\n      if (maxdist == 0.0) {\n        // Inside viewport rectangle\n        gl_FragColor = vec4(0, 0, 0, 0);\n      } else if (maxdist < borderWidth) {\n        // Inside viewport rectangle at border\n        gl_FragColor = vec4(${rgb}, 0.8);\n      } else {\n        // Outside viewport rectangle\n        gl_FragColor = vec4(${rgb}, 0.5);\n      }\n    }\n  `\n}\n\nexport class ViewportRectangleRenderer {\n  private material: Graphics.Material\n  private buffer: Graphics.VertexBuffer\n\n  constructor(\n    private gl: Graphics.Context,\n    theme: Theme,\n  ) {\n    const vertices = [\n      [-1, 1],\n      [1, 1],\n      [-1, -1],\n      [1, -1],\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v[0])\n      floats.push(v[1])\n    }\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.upload(new Uint8Array(new Float32Array(floats).buffer))\n    this.material = gl.createMaterial(vertexFormat, vert, frag(theme))\n  }\n\n  render(props: ViewportRectangleRendererProps) {\n    setUniformAffineTransform(\n      this.material,\n      'configSpaceToPhysicalViewSpace',\n      props.configSpaceToPhysicalViewSpace,\n    )\n\n    // TODO(jlfwong): Pack these into a Vec4 instead\n    setUniformVec2(this.material, 'configSpaceViewportOrigin', props.configSpaceViewportRect.origin)\n    setUniformVec2(this.material, 'configSpaceViewportSize', props.configSpaceViewportRect.size)\n    // TODO(jlfwong): Pack these into a Vec4 instead\n\n    const viewport = this.gl.viewport\n    this.material.setUniformVec2('physicalOrigin', viewport.x, viewport.y)\n    this.material.setUniformVec2('physicalSize', viewport.width, viewport.height)\n\n    this.material.setUniformFloat('framebufferHeight', this.gl.renderTargetHeightInPixels)\n\n    this.gl.setBlendState(\n      Graphics.BlendOperation.SOURCE_ALPHA,\n      Graphics.BlendOperation.INVERSE_SOURCE_ALPHA,\n    )\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n", "import {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Theme} from '../views/themes/theme'\nimport {Graphics} from './graphics'\nimport {setUniformAffineTransform} from './utils'\n\nconst vertexFormat = new Graphics.VertexFormat()\nvertexFormat.add('position', Graphics.AttributeType.FLOAT, 2)\nvertexFormat.add('uv', Graphics.AttributeType.FLOAT, 2)\n\nconst vert = `\n  uniform mat3 uvTransform;\n  uniform mat3 positionTransform;\n\n  attribute vec2 position;\n  attribute vec2 uv;\n  varying vec2 vUv;\n\n  void main() {\n    vUv = (uvTransform * vec3(uv, 1)).xy;\n    gl_Position = vec4((positionTransform * vec3(position, 1)).xy, 0, 1);\n  }\n`\n\nconst frag = (colorForBucket: string) => `\n  precision mediump float;\n\n  uniform vec2 uvSpacePixelSize;\n  uniform float renderOutlines;\n\n  varying vec2 vUv;\n  uniform sampler2D colorTexture;\n\n  // https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue\n  vec3 hcl2rgb(float H, float C, float L) {\n    float hPrime = H / 60.0;\n    float X = C * (1.0 - abs(mod(hPrime, 2.0) - 1.0));\n    vec3 RGB =\n      hPrime < 1.0 ? vec3(C, X, 0) :\n      hPrime < 2.0 ? vec3(X, C, 0) :\n      hPrime < 3.0 ? vec3(0, C, X) :\n      hPrime < 4.0 ? vec3(0, X, C) :\n      hPrime < 5.0 ? vec3(X, 0, C) :\n      vec3(C, 0, X);\n\n    float m = L - dot(RGB, vec3(0.30, 0.59, 0.11));\n    return RGB + vec3(m, m, m);\n  }\n\n  float triangle(float x) {\n    return 2.0 * abs(fract(x) - 0.5) - 1.0;\n  }\n\n  ${colorForBucket}\n\n  void main() {\n    vec4 here = texture2D(colorTexture, vUv);\n\n    if (here.z == 0.0) {\n      // Background color\n      gl_FragColor = vec4(0, 0, 0, 0);\n      return;\n    }\n\n    // Sample the 4 surrounding pixels in the depth texture to determine\n    // if we should draw a boundary here or not.\n    vec4 N = texture2D(colorTexture, vUv + vec2(0, uvSpacePixelSize.y));\n    vec4 E = texture2D(colorTexture, vUv + vec2(uvSpacePixelSize.x, 0));\n    vec4 S = texture2D(colorTexture, vUv + vec2(0, -uvSpacePixelSize.y));\n    vec4 W = texture2D(colorTexture, vUv + vec2(-uvSpacePixelSize.x, 0));\n\n    // NOTE: For outline checks, we intentionally check both the right\n    // and the left to determine if we're an edge. If a rectangle is a single\n    // pixel wide, we don't want to render it as an outline, so this method\n    // of checking ensures that we don't outline single physical-space\n    // pixel width rectangles.\n    if (\n      renderOutlines > 0.0 &&\n      (\n        here.y == N.y && here.y != S.y || // Top edge\n        here.y == S.y && here.y != N.y || // Bottom edge\n        here.x == E.x && here.x != W.x || // Left edge\n        here.x == W.x && here.x != E.x\n      )\n    ) {\n      // We're on an edge! Draw transparent.\n      gl_FragColor = vec4(0, 0, 0, 0);\n    } else {\n      // Not on an edge. Draw the appropriate color.\n      gl_FragColor = vec4(colorForBucket(here.z), here.a);\n    }\n  }\n`\n\nexport interface FlamechartColorPassRenderProps {\n  rectInfoTexture: Graphics.Texture\n  renderOutlines: boolean\n  srcRect: Rect\n  dstRect: Rect\n}\n\nexport class FlamechartColorPassRenderer {\n  private material: Graphics.Material\n  private buffer: Graphics.VertexBuffer\n\n  constructor(\n    private gl: Graphics.Context,\n    theme: Theme,\n  ) {\n    const vertices = [\n      {pos: [-1, 1], uv: [0, 1]},\n      {pos: [1, 1], uv: [1, 1]},\n      {pos: [-1, -1], uv: [0, 0]},\n      {pos: [1, -1], uv: [1, 0]},\n    ]\n    const floats: number[] = []\n    for (let v of vertices) {\n      floats.push(v.pos[0])\n      floats.push(v.pos[1])\n      floats.push(v.uv[0])\n      floats.push(v.uv[1])\n    }\n\n    this.buffer = gl.createVertexBuffer(vertexFormat.stride * vertices.length)\n    this.buffer.uploadFloats(floats)\n    this.material = gl.createMaterial(vertexFormat, vert, frag(theme.colorForBucketGLSL))\n  }\n\n  render(props: FlamechartColorPassRenderProps) {\n    const {srcRect, rectInfoTexture} = props\n    const physicalToUV = AffineTransform.withTranslation(new Vec2(0, 1))\n      .times(AffineTransform.withScale(new Vec2(1, -1)))\n      .times(\n        AffineTransform.betweenRects(\n          new Rect(Vec2.zero, new Vec2(rectInfoTexture.width, rectInfoTexture.height)),\n          Rect.unit,\n        ),\n      )\n    const uvRect = physicalToUV.transformRect(srcRect)\n    const uvTransform = AffineTransform.betweenRects(Rect.unit, uvRect)\n\n    const {dstRect} = props\n    const viewportSize = new Vec2(this.gl.viewport.width, this.gl.viewport.height)\n\n    const physicalToNDC = AffineTransform.withScale(new Vec2(1, -1)).times(\n      AffineTransform.betweenRects(new Rect(Vec2.zero, viewportSize), Rect.NDC),\n    )\n    const ndcRect = physicalToNDC.transformRect(dstRect)\n    const positionTransform = AffineTransform.betweenRects(Rect.NDC, ndcRect)\n\n    const uvSpacePixelSize = Vec2.unit.dividedByPointwise(\n      new Vec2(props.rectInfoTexture.width, props.rectInfoTexture.height),\n    )\n\n    this.material.setUniformSampler('colorTexture', props.rectInfoTexture, 0)\n    setUniformAffineTransform(this.material, 'uvTransform', uvTransform)\n    this.material.setUniformFloat('renderOutlines', props.renderOutlines ? 1.0 : 0.0)\n    this.material.setUniformVec2('uvSpacePixelSize', uvSpacePixelSize.x, uvSpacePixelSize.y)\n    setUniformAffineTransform(this.material, 'positionTransform', positionTransform)\n\n    this.gl.setUnpremultipliedBlendState()\n    this.gl.draw(Graphics.Primitive.TRIANGLE_STRIP, this.material, this.buffer)\n  }\n}\n", "import {Graphics, WebGL} from './graphics'\nimport {RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {TextureRenderer} from './texture-renderer'\nimport {Rect, Vec2} from '../lib/math'\nimport {ViewportRectangleRenderer} from './overlay-rectangle-renderer'\nimport {FlamechartColorPassRenderer} from './flamechart-color-pass-renderer'\nimport {Color} from '../lib/color'\nimport {Theme} from '../views/themes/theme'\n\ntype FrameCallback = () => void\n\nexport class CanvasContext {\n  public readonly gl: WebGL.Context\n  public readonly rectangleBatchRenderer: RectangleBatchRenderer\n  public readonly textureRenderer: TextureRenderer\n  public readonly viewportRectangleRenderer: ViewportRectangleRenderer\n  public readonly flamechartColorPassRenderer: FlamechartColorPassRenderer\n  public readonly theme: Theme\n\n  constructor(canvas: HTMLCanvasElement, theme: Theme) {\n    this.gl = new WebGL.Context(canvas)\n    this.rectangleBatchRenderer = new RectangleBatchRenderer(this.gl)\n    this.textureRenderer = new TextureRenderer(this.gl)\n    this.viewportRectangleRenderer = new ViewportRectangleRenderer(this.gl, theme)\n    this.flamechartColorPassRenderer = new FlamechartColorPassRenderer(this.gl, theme)\n    this.theme = theme\n\n    // Whenever the canvas is resized, draw immediately. This prevents\n    // flickering during resizing.\n    this.gl.addAfterResizeEventHandler(this.onBeforeFrame)\n\n    const webGLInfo = this.gl.getWebGLInfo()\n    if (webGLInfo) {\n      console.log(\n        `WebGL initialized. renderer: ${webGLInfo.renderer}, vendor: ${webGLInfo.vendor}, version: ${webGLInfo.version}`,\n      )\n    }\n    ;(window as any)['testContextLoss'] = () => {\n      this.gl.testContextLoss()\n    }\n  }\n\n  private animationFrameRequest: number | null = null\n  private beforeFrameHandlers = new Set<FrameCallback>()\n  addBeforeFrameHandler(callback: FrameCallback) {\n    this.beforeFrameHandlers.add(callback)\n  }\n  removeBeforeFrameHandler(callback: FrameCallback) {\n    this.beforeFrameHandlers.delete(callback)\n  }\n  requestFrame() {\n    if (!this.animationFrameRequest) {\n      this.animationFrameRequest = requestAnimationFrame(this.onBeforeFrame)\n    }\n  }\n  private onBeforeFrame = () => {\n    this.animationFrameRequest = null\n    this.gl.setViewport(0, 0, this.gl.renderTargetWidthInPixels, this.gl.renderTargetHeightInPixels)\n    const color = Color.fromCSSHex(this.theme.bgPrimaryColor)\n    this.gl.clear(new Graphics.Color(color.r, color.g, color.b, color.a))\n\n    for (const handler of this.beforeFrameHandlers) {\n      handler()\n    }\n  }\n\n  setViewport(physicalBounds: Rect, cb: () => void): void {\n    const {origin, size} = physicalBounds\n    let viewportBefore = this.gl.viewport\n    this.gl.setViewport(origin.x, origin.y, size.x, size.y)\n\n    cb()\n\n    let {x, y, width, height} = viewportBefore\n    this.gl.setViewport(x, y, width, height)\n  }\n\n  renderBehind(el: Element, cb: () => void) {\n    const bounds = el.getBoundingClientRect()\n    const physicalBounds = new Rect(\n      new Vec2(bounds.left * window.devicePixelRatio, bounds.top * window.devicePixelRatio),\n      new Vec2(bounds.width * window.devicePixelRatio, bounds.height * window.devicePixelRatio),\n    )\n\n    this.setViewport(physicalBounds, cb)\n  }\n}\n", "import {Frame, Profile} from '../lib/profile'\nimport {memoizeByReference, memoizeByShallowEquality} from '../lib/utils'\nimport {RowAtlas} from '../gl/row-atlas'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {FlamechartRowAtlasKey} from '../gl/flamechart-renderer'\nimport {Theme} from '../views/themes/theme'\n\nexport const createGetColorBucketForFrame = memoizeByReference(\n  (frameToColorBucket: Map<number | string, number>) => {\n    return (frame: Frame): number => {\n      return frameToColorBucket.get(frame.key) || 0\n    }\n  },\n)\n\nexport const createGetCSSColorForFrame = memoizeByShallowEquality(\n  ({\n    theme,\n    frameToColorBucket,\n  }: {\n    theme: Theme\n    frameToColorBucket: Map<number | string, number>\n  }) => {\n    const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n    return (frame: Frame): string => {\n      const t = getColorBucketForFrame(frame) / 255\n      return theme.colorForBucket(t).toCSS()\n    }\n  },\n)\n\nexport const getCanvasContext = memoizeByShallowEquality(\n  ({theme, canvas}: {theme: Theme; canvas: HTMLCanvasElement}) => {\n    return new CanvasContext(canvas, theme)\n  },\n)\n\nexport const getRowAtlas = memoizeByReference((canvasContext: CanvasContext) => {\n  return new RowAtlas<FlamechartRowAtlasKey>(\n    canvasContext.gl,\n    canvasContext.rectangleBatchRenderer,\n    canvasContext.textureRenderer,\n  )\n})\n\nexport const getProfileToView = memoizeByShallowEquality(\n  ({profile, flattenRecursion}: {profile: Profile; flattenRecursion: boolean}): Profile => {\n    return flattenRecursion ? profile.getProfileWithRecursionFlattened() : profile\n  },\n)\nexport const getFrameToColorBucket = memoizeByReference(\n  (profile: Profile): Map<string | number, number> => {\n    const frames: Frame[] = []\n    profile.forEachFrame(f => frames.push(f))\n    function key(f: Frame) {\n      return (f.file || '') + f.name\n    }\n    function compare(a: Frame, b: Frame) {\n      return key(a) > key(b) ? 1 : -1\n    }\n    frames.sort(compare)\n    const frameToColorBucket = new Map<string | number, number>()\n    for (let i = 0; i < frames.length; i++) {\n      frameToColorBucket.set(frames[i].key, Math.floor((255 * i) / frames.length))\n    }\n\n    return frameToColorBucket\n  },\n)\n", "import { options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tif (currentComponent.__hooks) {\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\tcurrentComponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\tcurrentComponent.__hooks._pendingEffects = [];\n\t}\n};\n\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\tif (hooks._pendingEffects.length) {\n\t\t\tafterPaint(afterPaintEffects.push(c));\n\t\t}\n\t}\n};\n\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (!c) return;\n\n\tconst hooks = c.__hooks;\n\tif (hooks) {\n\t\ttry {\n\t\t\thooks._list.forEach(hook => hook._cleanup && hook._cleanup());\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {import('./internal').HookState}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({});\n\t}\n\treturn hooks._list[index];\n}\n\n/**\n * @param {import('./index').StateUpdater<any>} initialState\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @param {import('./index').Reducer<any, any>} reducer\n * @param {import('./index').StateUpdater<any>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ any, (state: any) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\tif (!hookState._component) {\n\t\thookState._component = currentComponent;\n\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst nextValue = reducer(hookState._value[0], action);\n\t\t\t\tif (hookState._value[0] !== nextValue) {\n\t\t\t\t\thookState._value[0] = nextValue;\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\treturn hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {any[]} args\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._args = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {any[]} args\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') ref(createHandle());\n\t\t\telse if (ref) ref.current = createHandle();\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @param {() => any} factory\n * @param {any[]} args\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._args = args;\n\t\tstate._factory = factory;\n\t\treturn (state._value = factory());\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {any[]} args\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\n\t}\n}\n\nexport function useErrorBoundary(cb) {\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = err => {\n\t\t\tif (state._value) state._value(err);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tafterPaintEffects.some(component => {\n\t\tif (component._parentDom) {\n\t\t\ttry {\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t} catch (e) {\n\t\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\t\toptions._catchError(e, component._vnode);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t});\n\tafterPaintEffects = [];\n}\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tcancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (typeof window != 'undefined') {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeCleanup(hook) {\n\tif (hook._cleanup) hook._cleanup();\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n */\nfunction invokeEffect(hook) {\n\tconst result = hook._value();\n\tif (typeof result == 'function') hook._cleanup = result;\n}\n\n/**\n * @param {any[]} oldArgs\n * @param {any[]} newArgs\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn !oldArgs || newArgs.some((arg, index) => arg !== oldArgs[index]);\n}\n\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n", "/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Check if two objects have a different shape\n * @param {object} a\n * @param {object} b\n * @returns {boolean}\n */\nexport function shallowDiffers(a, b) {\n\tfor (let i in a) if (i !== '__source' && !(i in b)) return true;\n\tfor (let i in b) if (i !== '__source' && a[i] !== b[i]) return true;\n\treturn false;\n}\n", "import { Component } from 'preact';\nimport { shallowDiffers } from './util';\n\n/**\n * Component class with a predefined `shouldComponentUpdate` implementation\n */\nexport class PureComponent extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t// Some third-party libraries check if this property is present\n\t\tthis.isPureReactComponent = true;\n\t}\n\n\tshouldComponentUpdate(props, state) {\n\t\treturn (\n\t\t\tshallowDiffers(this.props, props) || shallowDiffers(this.state, state)\n\t\t);\n\t}\n}\n", "import { createElement } from 'preact';\nimport { shallowDiffers, assign } from './util';\n\n/**\n * Memoize a component, so that it only updates when the props actually have\n * changed. This was previously known as `React.pure`.\n * @param {import('./internal').FunctionalComponent} c functional component\n * @param {(prev: object, next: object) => boolean} [comparer] Custom equality function\n * @returns {import('./internal').FunctionalComponent}\n */\nexport function memo(c, comparer) {\n\tfunction shouldUpdate(nextProps) {\n\t\tlet ref = this.props.ref;\n\t\tlet updateRef = ref == nextProps.ref;\n\t\tif (!updateRef && ref) {\n\t\t\tref.call ? ref(null) : (ref.current = null);\n\t\t}\n\n\t\tif (!comparer) {\n\t\t\treturn shallowDiffers(this.props, nextProps);\n\t\t}\n\n\t\treturn !comparer(this.props, nextProps) || !updateRef;\n\t}\n\n\tfunction Memoed(props) {\n\t\tthis.shouldComponentUpdate = shouldUpdate;\n\t\treturn createElement(c, assign({}, props));\n\t}\n\tMemoed.prototype.isReactComponent = true;\n\tMemoed.displayName = 'Memo(' + (c.displayName || c.name) + ')';\n\tMemoed._forwarded = true;\n\treturn Memoed;\n}\n", "import { options } from 'preact';\nimport { assign } from './util';\n\nlet oldDiffHook = options._diff;\noptions._diff = vnode => {\n\tif (vnode.type && vnode.type._forwarded && vnode.ref) {\n\t\tvnode.props.ref = vnode.ref;\n\t\tvnode.ref = null;\n\t}\n\tif (oldDiffHook) oldDiffHook(vnode);\n};\n\n/**\n * Pass ref down to a child. This is mainly used in libraries with HOCs that\n * wrap components. Using `forwardRef` there is an easy way to get a reference\n * of the wrapped component instead of one of the wrapper itself.\n * @param {import('./index').ForwardFn} fn\n * @returns {import('./internal').FunctionalComponent}\n */\nexport function forwardRef(fn) {\n\tfunction Forwarded(props) {\n\t\tlet clone = assign({}, props);\n\t\tdelete clone.ref;\n\t\treturn fn(clone, props.ref);\n\t}\n\tForwarded.prototype.isReactComponent = Forwarded._forwarded = true;\n\tForwarded.displayName = 'ForwardRef(' + (fn.displayName || fn.name) + ')';\n\treturn Forwarded;\n}\n", "import { toChildArray } from 'preact';\n\nconst mapFn = (children, fn) => {\n\tif (!children) return null;\n\treturn toChildArray(children).reduce(\n\t\t(acc, value, index) => acc.concat(fn(value, index)),\n\t\t[]\n\t);\n};\n\n// This API is completely unnecessary for Preact, so it's basically passthrough.\nexport const Children = {\n\tmap: mapFn,\n\tforEach: mapFn,\n\tcount(children) {\n\t\treturn children ? toChildArray(children).length : 0;\n\t},\n\tonly(children) {\n\t\tchildren = toChildArray(children);\n\t\tif (children.length !== 1) {\n\t\t\tthrow new Error('Children.only() expects only one child.');\n\t\t}\n\t\treturn children[0];\n\t},\n\ttoArray: toChildArray\n};\n", "import { Component, createElement, options } from 'preact';\nimport { assign } from './util';\n\nconst oldCatchError = options._catchError;\noptions._catchError = function(error, newVNode, oldVNode) {\n\tif (error.then) {\n\t\t/** @type {import('./internal').Component} */\n\t\tlet component;\n\t\tlet vnode = newVNode;\n\n\t\tfor (; (vnode = vnode._parent); ) {\n\t\t\tif ((component = vnode._component) && component._childDidSuspend) {\n\t\t\t\t// Don't call oldCatchError if we found a Suspense\n\t\t\t\treturn component._childDidSuspend(error, newVNode._component);\n\t\t\t}\n\t\t}\n\t}\n\toldCatchError(error, newVNode, oldVNode);\n};\n\nfunction detachedClone(vnode) {\n\tif (vnode) {\n\t\tvnode = assign({}, vnode);\n\t\tvnode._component = null;\n\t\tvnode._children = vnode._children && vnode._children.map(detachedClone);\n\t}\n\treturn vnode;\n}\n\n// having custom inheritance instead of a class here saves a lot of bytes\nexport function Suspense() {\n\t// we do not call super here to golf some bytes...\n\tthis._pendingSuspensionCount = 0;\n\tthis._suspenders = null;\n\tthis._detachOnNextRender = null;\n}\n\n// Things we do here to save some bytes but are not proper JS inheritance:\n// - call `new Component()` as the prototype\n// - do not set `Suspense.prototype.constructor` to `Suspense`\nSuspense.prototype = new Component();\n\n/**\n * @param {Promise} promise The thrown promise\n * @param {Component<any, any>} suspendingComponent The suspending component\n */\nSuspense.prototype._childDidSuspend = function(promise, suspendingComponent) {\n\t/** @type {import('./internal').SuspenseComponent} */\n\tconst c = this;\n\n\tif (c._suspenders == null) {\n\t\tc._suspenders = [];\n\t}\n\tc._suspenders.push(suspendingComponent);\n\n\tconst resolve = suspended(c._vnode);\n\n\tlet resolved = false;\n\tconst onResolved = () => {\n\t\tif (resolved) return;\n\n\t\tresolved = true;\n\n\t\tif (resolve) {\n\t\t\tresolve(onSuspensionComplete);\n\t\t} else {\n\t\t\tonSuspensionComplete();\n\t\t}\n\t};\n\n\tsuspendingComponent._suspendedComponentWillUnmount =\n\t\tsuspendingComponent.componentWillUnmount;\n\tsuspendingComponent.componentWillUnmount = () => {\n\t\tonResolved();\n\n\t\tif (suspendingComponent._suspendedComponentWillUnmount) {\n\t\t\tsuspendingComponent._suspendedComponentWillUnmount();\n\t\t}\n\t};\n\n\tconst onSuspensionComplete = () => {\n\t\tif (!--c._pendingSuspensionCount) {\n\t\t\tc._vnode._children[0] = c.state._suspended;\n\t\t\tc.setState({ _suspended: (c._detachOnNextRender = null) });\n\n\t\t\tlet suspended;\n\t\t\twhile ((suspended = c._suspenders.pop())) {\n\t\t\t\tsuspended.forceUpdate();\n\t\t\t}\n\t\t}\n\t};\n\n\tif (!c._pendingSuspensionCount++) {\n\t\tc.setState({ _suspended: (c._detachOnNextRender = c._vnode._children[0]) });\n\t}\n\tpromise.then(onResolved, onResolved);\n};\n\nSuspense.prototype.render = function(props, state) {\n\tif (this._detachOnNextRender) {\n\t\tthis._vnode._children[0] = detachedClone(this._detachOnNextRender);\n\t\tthis._detachOnNextRender = null;\n\t}\n\n\treturn [\n\t\tcreateElement(Component, null, state._suspended ? null : props.children),\n\t\tstate._suspended && props.fallback\n\t];\n};\n\n/**\n * Checks and calls the parent component's _suspended method, passing in the\n * suspended vnode. This is a way for a parent (e.g. SuspenseList) to get notified\n * that one of its children/descendants suspended.\n *\n * The parent MAY return a callback. The callback will get called when the\n * suspension resolves, notifying the parent of the fact.\n * Moreover, the callback gets function `unsuspend` as a parameter. The resolved\n * child descendant will not actually get unsuspended until `unsuspend` gets called.\n * This is a way for the parent to delay unsuspending.\n *\n * If the parent does not return a callback then the resolved vnode\n * gets unsuspended immediately when it resolves.\n *\n * @param {import('../src/internal').VNode} vnode\n * @returns {((unsuspend: () => void) => void)?}\n */\nexport function suspended(vnode) {\n\tlet component = vnode._parent._component;\n\treturn component && component._suspended && component._suspended(vnode);\n}\n\nexport function lazy(loader) {\n\tlet prom;\n\tlet component;\n\tlet error;\n\n\tfunction Lazy(props) {\n\t\tif (!prom) {\n\t\t\tprom = loader();\n\t\t\tprom.then(\n\t\t\t\texports => {\n\t\t\t\t\tcomponent = exports.default || exports;\n\t\t\t\t},\n\t\t\t\te => {\n\t\t\t\t\terror = e;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\n\t\tif (!component) {\n\t\t\tthrow prom;\n\t\t}\n\n\t\treturn createElement(component, props);\n\t}\n\n\tLazy.displayName = 'Lazy';\n\tLazy._forwarded = true;\n\treturn Lazy;\n}\n", "import { Component, toChildArray } from 'preact';\nimport { suspended } from './suspense.js';\n\n// Indexes to linked list nodes (nodes are stored as arrays to save bytes).\nconst SUSPENDED_COUNT = 0;\nconst RESOLVED_COUNT = 1;\nconst NEXT_NODE = 2;\n\n// Having custom inheritance instead of a class here saves a lot of bytes.\nexport function SuspenseList() {\n\tthis._next = null;\n\tthis._map = null;\n}\n\n// Mark one of child's earlier suspensions as resolved.\n// Some pending callbacks may become callable due to this\n// (e.g. the last suspended descendant gets resolved when\n// revealOrder === 'together'). Process those callbacks as well.\nconst resolve = (list, child, node) => {\n\tif (++node[RESOLVED_COUNT] === node[SUSPENDED_COUNT]) {\n\t\t// The number a child (or any of its descendants) has been suspended\n\t\t// matches the number of times it's been resolved. Therefore we\n\t\t// mark the child as completely resolved by deleting it from ._map.\n\t\t// This is used to figure out when *all* children have been completely\n\t\t// resolved when revealOrder is 'together'.\n\t\tlist._map.delete(child);\n\t}\n\n\t// If revealOrder is falsy then we can do an early exit, as the\n\t// callbacks won't get queued in the node anyway.\n\t// If revealOrder is 'together' then also do an early exit\n\t// if all suspended descendants have not yet been resolved.\n\tif (\n\t\t!list.props.revealOrder ||\n\t\t(list.props.revealOrder[0] === 't' && list._map.size)\n\t) {\n\t\treturn;\n\t}\n\n\t// Walk the currently suspended children in order, calling their\n\t// stored callbacks on the way. Stop if we encounter a child that\n\t// has not been completely resolved yet.\n\tnode = list._next;\n\twhile (node) {\n\t\twhile (node.length > 3) {\n\t\t\tnode.pop()();\n\t\t}\n\t\tif (node[RESOLVED_COUNT] < node[SUSPENDED_COUNT]) {\n\t\t\tbreak;\n\t\t}\n\t\tlist._next = node = node[NEXT_NODE];\n\t}\n};\n\n// Things we do here to save some bytes but are not proper JS inheritance:\n// - call `new Component()` as the prototype\n// - do not set `Suspense.prototype.constructor` to `Suspense`\nSuspenseList.prototype = new Component();\n\nSuspenseList.prototype._suspended = function(child) {\n\tconst list = this;\n\tconst delegated = suspended(list._vnode);\n\n\tlet node = list._map.get(child);\n\tnode[SUSPENDED_COUNT]++;\n\n\treturn unsuspend => {\n\t\tconst wrappedUnsuspend = () => {\n\t\t\tif (!list.props.revealOrder) {\n\t\t\t\t// Special case the undefined (falsy) revealOrder, as there\n\t\t\t\t// is no need to coordinate a specific order or unsuspends.\n\t\t\t\tunsuspend();\n\t\t\t} else {\n\t\t\t\tnode.push(unsuspend);\n\t\t\t\tresolve(list, child, node);\n\t\t\t}\n\t\t};\n\t\tif (delegated) {\n\t\t\tdelegated(wrappedUnsuspend);\n\t\t} else {\n\t\t\twrappedUnsuspend();\n\t\t}\n\t};\n};\n\nSuspenseList.prototype.render = function(props) {\n\tthis._next = null;\n\tthis._map = new Map();\n\n\tconst children = toChildArray(props.children);\n\tif (props.revealOrder && props.revealOrder[0] === 'b') {\n\t\t// If order === 'backwards' (or, well, anything starting with a 'b')\n\t\t// then flip the child list around so that the last child will be\n\t\t// the first in the linked list.\n\t\tchildren.reverse();\n\t}\n\t// Build the linked list. Iterate through the children in reverse order\n\t// so that `_next` points to the first linked list node to be resolved.\n\tfor (let i = children.length; i--; ) {\n\t\t// Create a new linked list node as an array of form:\n\t\t// \t[suspended_count, resolved_count, next_node]\n\t\t// where suspended_count and resolved_count are numeric counters for\n\t\t// keeping track how many times a node has been suspended and resolved.\n\t\t//\n\t\t// Note that suspended_count starts from 1 instead of 0, so we can block\n\t\t// processing callbacks until componentDidMount has been called. In a sense\n\t\t// node is suspended at least until componentDidMount gets called!\n\t\t//\n\t\t// Pending callbacks are added to the end of the node:\n\t\t// \t[suspended_count, resolved_count, next_node, callback_0, callback_1, ...]\n\t\tthis._map.set(children[i], (this._next = [1, 0, this._next]));\n\t}\n\treturn props.children;\n};\n\nSuspenseList.prototype.componentDidUpdate = SuspenseList.prototype.componentDidMount = function() {\n\t// Iterate through all children after mounting for two reasons:\n\t// 1. As each node[SUSPENDED_COUNT] starts from 1, this iteration increases\n\t//    each node[RELEASED_COUNT] by 1, therefore balancing the counters.\n\t//    The nodes can now be completely consumed from the linked list.\n\t// 2. Handle nodes that might have gotten resolved between render and\n\t//    componentDidMount.\n\tconst list = this;\n\tlist._map.forEach((node, child) => {\n\t\tresolve(list, child, node);\n\t});\n};\n", "import { createElement, hydrate, render, _unmount } from 'preact';\n\nclass ContextProvider {\n\tgetChildContext() {\n\t\treturn this.props.context;\n\t}\n\trender(props) {\n\t\treturn props.children;\n\t}\n}\n\n/**\n * Portal component\n * @param {object | null | undefined} props\n */\nfunction Portal(props) {\n\tlet _this = this;\n\tlet container = props.container;\n\tlet wrap = createElement(\n\t\tContextProvider,\n\t\t{ context: _this.context },\n\t\tprops.vnode\n\t);\n\n\t// When we change container we should clear our old container and\n\t// indicate a new mount.\n\tif (_this._container && _this._container !== container) {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t\t_this._hasMounted = false;\n\t}\n\n\t// When props.vnode is undefined/false/null we are dealing with some kind of\n\t// conditional vnode. This should not trigger a render.\n\tif (props.vnode) {\n\t\tif (!_this._hasMounted) {\n\t\t\t// Create a placeholder that we can use to insert into.\n\t\t\t_this._temp = document.createTextNode('');\n\t\t\t// Hydrate existing nodes to keep the dom intact, when rendering\n\t\t\t// wrap into the container.\n\t\t\thydrate('', container);\n\t\t\t// Append to the container (this matches React's behavior)\n\t\t\tcontainer.appendChild(_this._temp);\n\t\t\t// At this point we have mounted and should set our container.\n\t\t\t_this._hasMounted = true;\n\t\t\t_this._container = container;\n\t\t\t// Render our wrapping element into temp.\n\t\t\trender(wrap, container, _this._temp);\n\t\t\t_this._children = _this._temp._children;\n\t\t} else {\n\t\t\t// When we have mounted and the vnode is present it means the\n\t\t\t// props have changed or a parent is triggering a rerender.\n\t\t\t// This implies we only need to call render. But we need to keep\n\t\t\t// the old tree around, otherwise will treat the vnodes as new and\n\t\t\t// will wrongly call `componentDidMount` on them\n\t\t\tcontainer._children = _this._children;\n\t\t\trender(wrap, container);\n\t\t\t_this._children = container._children;\n\t\t}\n\t}\n\t// When we come from a conditional render, on a mounted\n\t// portal we should clear the DOM.\n\telse if (_this._hasMounted) {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t}\n\t// Set the wrapping element for future unmounting.\n\t_this._wrap = wrap;\n\n\t_this.componentWillUnmount = () => {\n\t\tif (_this._temp.parentNode) _this._container.removeChild(_this._temp);\n\t\t_unmount(_this._wrap);\n\t};\n\n\treturn null;\n}\n\n/**\n * Create a `Portal` to continue rendering the vnode tree at a different DOM node\n * @param {import('./internal').VNode} vnode The vnode to render\n * @param {import('./internal').PreactElement} container The DOM node to continue rendering in to.\n */\nexport function createPortal(vnode, container) {\n\treturn createElement(Portal, { vnode, container });\n}\n", "import {\n\trender as preactRender,\n\thydrate as preactHydrate,\n\toptions,\n\ttoChildArray,\n\tComponent\n} from 'preact';\nimport { applyEventNormalization } from './events';\n\nconst CAMEL_PROPS = /^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;\n\n// Some libraries like `react-virtualized` explicitly check for this.\nComponent.prototype.isReactComponent = {};\n\nexport const REACT_ELEMENT_TYPE =\n\t(typeof Symbol != 'undefined' && Symbol.for && Symbol.for('react.element')) ||\n\t0xeac7;\n\n/**\n * Proxy render() since React returns a Component reference.\n * @param {import('./internal').VNode} vnode VNode tree to render\n * @param {import('./internal').PreactElement} parent DOM node to render vnode tree into\n * @param {() => void} [callback] Optional callback that will be called after rendering\n * @returns {import('./internal').Component | null} The root component reference or null\n */\nexport function render(vnode, parent, callback) {\n\t// React destroys any existing DOM nodes, see #1727\n\t// ...but only on the first render, see #1828\n\tif (parent._children == null) {\n\t\twhile (parent.firstChild) {\n\t\t\tparent.removeChild(parent.firstChild);\n\t\t}\n\t}\n\n\tpreactRender(vnode, parent);\n\tif (typeof callback == 'function') callback();\n\n\treturn vnode ? vnode._component : null;\n}\n\nexport function hydrate(vnode, parent, callback) {\n\tpreactHydrate(vnode, parent);\n\tif (typeof callback == 'function') callback();\n\n\treturn vnode ? vnode._component : null;\n}\n\nlet oldEventHook = options.event;\noptions.event = e => {\n\tif (oldEventHook) e = oldEventHook(e);\n\te.persist = () => {};\n\tlet stoppedPropagating = false,\n\t\tdefaultPrevented = false;\n\n\tconst origStopPropagation = e.stopPropagation;\n\te.stopPropagation = () => {\n\t\torigStopPropagation.call(e);\n\t\tstoppedPropagating = true;\n\t};\n\n\tconst origPreventDefault = e.preventDefault;\n\te.preventDefault = () => {\n\t\torigPreventDefault.call(e);\n\t\tdefaultPrevented = true;\n\t};\n\n\te.isPropagationStopped = () => stoppedPropagating;\n\te.isDefaultPrevented = () => defaultPrevented;\n\treturn (e.nativeEvent = e);\n};\n\n// Patch in `UNSAFE_*` lifecycle hooks\nfunction setSafeDescriptor(proto, key) {\n\tif (proto['UNSAFE_' + key] && !proto[key]) {\n\t\tObject.defineProperty(proto, key, {\n\t\t\tconfigurable: false,\n\t\t\tget() {\n\t\t\t\treturn this['UNSAFE_' + key];\n\t\t\t},\n\t\t\t// This `set` is only used if a user sets a lifecycle like cWU\n\t\t\t// after setting a lifecycle like UNSAFE_cWU. I doubt anyone\n\t\t\t// actually does this in practice so not testing it\n\t\t\t/* istanbul ignore next */\n\t\t\tset(v) {\n\t\t\t\tthis['UNSAFE_' + key] = v;\n\t\t\t}\n\t\t});\n\t}\n}\n\nlet classNameDescriptor = {\n\tconfigurable: true,\n\tget() {\n\t\treturn this.class;\n\t}\n};\n\nlet oldVNodeHook = options.vnode;\noptions.vnode = vnode => {\n\tvnode.$$typeof = REACT_ELEMENT_TYPE;\n\n\tlet type = vnode.type;\n\tlet props = vnode.props;\n\n\tif (type) {\n\t\t// Alias `class` prop to `className` if available\n\t\tif (props.class != props.className) {\n\t\t\tclassNameDescriptor.enumerable = 'className' in props;\n\t\t\tif (props.className != null) props.class = props.className;\n\t\t\tObject.defineProperty(props, 'className', classNameDescriptor);\n\t\t}\n\n\t\t// Apply DOM VNode compat\n\t\tif (typeof type != 'function') {\n\t\t\t// Apply defaultValue to value\n\t\t\tif (props.defaultValue && props.value !== undefined) {\n\t\t\t\tif (!props.value && props.value !== 0) {\n\t\t\t\t\tprops.value = props.defaultValue;\n\t\t\t\t}\n\t\t\t\tdelete props.defaultValue;\n\t\t\t}\n\n\t\t\t// Add support for array select values: <select value={[]} />\n\t\t\tif (Array.isArray(props.value) && props.multiple && type === 'select') {\n\t\t\t\ttoChildArray(props.children).forEach(child => {\n\t\t\t\t\tif (props.value.indexOf(child.props.value) != -1) {\n\t\t\t\t\t\tchild.props.selected = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdelete props.value;\n\t\t\t}\n\n\t\t\t// Normalize DOM vnode properties.\n\t\t\tlet shouldSanitize, attrs, i;\n\t\t\tfor (i in props) if ((shouldSanitize = CAMEL_PROPS.test(i))) break;\n\t\t\tif (shouldSanitize) {\n\t\t\t\tattrs = vnode.props = {};\n\t\t\t\tfor (i in props) {\n\t\t\t\t\tattrs[\n\t\t\t\t\t\tCAMEL_PROPS.test(i) ? i.replace(/[A-Z0-9]/, '-$&').toLowerCase() : i\n\t\t\t\t\t] = props[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Events\n\t\tapplyEventNormalization(vnode);\n\n\t\t// Component base class compat\n\t\t// We can't just patch the base component class, because components that use\n\t\t// inheritance and are transpiled down to ES5 will overwrite our patched\n\t\t// getters and setters. See #1941\n\t\tif (\n\t\t\ttypeof type == 'function' &&\n\t\t\t!type._patchedLifecycles &&\n\t\t\ttype.prototype\n\t\t) {\n\t\t\tsetSafeDescriptor(type.prototype, 'componentWillMount');\n\t\t\tsetSafeDescriptor(type.prototype, 'componentWillReceiveProps');\n\t\t\tsetSafeDescriptor(type.prototype, 'componentWillUpdate');\n\t\t\ttype._patchedLifecycles = true;\n\t\t}\n\t}\n\n\tif (oldVNodeHook) oldVNodeHook(vnode);\n};\n", "/**\n * Normalize event handlers like react does. Most famously it uses `onChange` for any input element.\n * @param {import('./internal').VNode} vnode The vnode to normalize events on\n */\nexport function applyEventNormalization({ type, props }) {\n\tif (!props || typeof type != 'string') return;\n\tlet newProps = {};\n\n\tfor (let i in props) {\n\t\tif (/^on(Ani|Tra|Tou)/.test(i)) {\n\t\t\tprops[i.toLowerCase()] = props[i];\n\t\t\tdelete props[i];\n\t\t}\n\t\tnewProps[i.toLowerCase()] = i;\n\t}\n\tif (newProps.ondoubleclick) {\n\t\tprops.ondblclick = props[newProps.ondoubleclick];\n\t\tdelete props[newProps.ondoubleclick];\n\t}\n\tif (newProps.onbeforeinput) {\n\t\tprops.onbeforeinput = props[newProps.onbeforeinput];\n\t\tdelete props[newProps.onbeforeinput];\n\t}\n\t// for *textual inputs* (incl textarea), normalize `onChange` -> `onInput`:\n\tif (\n\t\tnewProps.onchange &&\n\t\t(type === 'textarea' ||\n\t\t\t(type.toLowerCase() === 'input' && !/^fil|che|ra/i.test(props.type)))\n\t) {\n\t\tlet normalized = newProps.oninput || 'oninput';\n\t\tif (!props[normalized]) {\n\t\t\tprops[normalized] = props[newProps.onchange];\n\t\t\tdelete props[newProps.onchange];\n\t\t}\n\t}\n}\n", "import {\n\tcreateElement,\n\trender as preactRender,\n\tcloneElement as preactCloneElement,\n\tcreateRef,\n\tComponent,\n\tcreateContext,\n\tFragment\n} from 'preact';\nimport {\n\tuseState,\n\tuseReducer,\n\tuseEffect,\n\tuseLayoutEffect,\n\tuseRef,\n\tuseImperativeHandle,\n\tuseMemo,\n\tuseCallback,\n\tuseContext,\n\tuseDebugValue\n} from 'preact/hooks';\nimport { PureComponent } from './PureComponent';\nimport { memo } from './memo';\nimport { forwardRef } from './forwardRef';\nimport { Children } from './Children';\nimport { Suspense, lazy } from './suspense';\nimport { SuspenseList } from './suspense-list';\nimport { createPortal } from './portals';\nimport { hydrate, render, REACT_ELEMENT_TYPE } from './render';\n\nconst version = '16.8.0'; // trick libraries to think we are react\n\n/**\n * Legacy version of createElement.\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component constructor\n */\nfunction createFactory(type) {\n\treturn createElement.bind(null, type);\n}\n\n/**\n * Check if the passed element is a valid (p)react node.\n * @param {*} element The element to check\n * @returns {boolean}\n */\nfunction isValidElement(element) {\n\treturn !!element && element.$$typeof === REACT_ELEMENT_TYPE;\n}\n\n/**\n * Wrap `cloneElement` to abort if the passed element is not a valid element and apply\n * all vnode normalizations.\n * @param {import('./internal').VNode} element The vnode to clone\n * @param {object} props Props to add when cloning\n * @param {Array<import('./internal').ComponentChildren>} rest Optional component children\n */\nfunction cloneElement(element) {\n\tif (!isValidElement(element)) return element;\n\treturn preactCloneElement.apply(null, arguments);\n}\n\n/**\n * Remove a component tree from the DOM, including state and event handlers.\n * @param {import('./internal').PreactElement} container\n * @returns {boolean}\n */\nfunction unmountComponentAtNode(container) {\n\tif (container._children) {\n\t\tpreactRender(null, container);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n/**\n * Get the matching DOM node for a component\n * @param {import('./internal').Component} component\n * @returns {import('./internal').PreactElement | null}\n */\nfunction findDOMNode(component) {\n\treturn (\n\t\t(component &&\n\t\t\t(component.base || (component.nodeType === 1 && component))) ||\n\t\tnull\n\t);\n}\n\n/**\n * Deprecated way to control batched rendering inside the reconciler, but we\n * already schedule in batches inside our rendering code\n * @template Arg\n * @param {(arg: Arg) => void} callback function that triggers the updated\n * @param {Arg} [arg] Optional argument that can be passed to the callback\n */\n// eslint-disable-next-line camelcase\nconst unstable_batchedUpdates = (callback, arg) => callback(arg);\n\nexport * from 'preact/hooks';\nexport {\n\tversion,\n\tChildren,\n\trender,\n\thydrate,\n\tunmountComponentAtNode,\n\tcreatePortal,\n\tcreateElement,\n\tcreateContext,\n\tcreateFactory,\n\tcloneElement,\n\tcreateRef,\n\tFragment,\n\tisValidElement,\n\tfindDOMNode,\n\tComponent,\n\tPureComponent,\n\tmemo,\n\tforwardRef,\n\t// eslint-disable-next-line camelcase\n\tunstable_batchedUpdates,\n\tSuspense,\n\tSuspenseList,\n\tlazy\n};\n\n// React copies the named exports to the default one.\nexport default {\n\tuseState,\n\tuseReducer,\n\tuseEffect,\n\tuseLayoutEffect,\n\tuseRef,\n\tuseImperativeHandle,\n\tuseMemo,\n\tuseCallback,\n\tuseContext,\n\tuseDebugValue,\n\tversion,\n\tChildren,\n\trender,\n\thydrate: render,\n\tunmountComponentAtNode,\n\tcreatePortal,\n\tcreateElement,\n\tcreateContext,\n\tcreateFactory,\n\tcloneElement,\n\tcreateRef,\n\tFragment,\n\tisValidElement,\n\tfindDOMNode,\n\tComponent,\n\tPureComponent,\n\tmemo,\n\tforwardRef,\n\tunstable_batchedUpdates,\n\tSuspense,\n\tSuspenseList,\n\tlazy\n};\n", "// This is a very small application state management library.\n//\n// All it provides is a way of specifying state \"atoms\" (basically a value with\n// a setter and a way to be notified when the value updates), and a single\n// preact hook to manage the subscribe/unsubscribe process for you.\n//\n// At the moment, atoms are intended to be globally defined, but the system\n// could easily be adapted to pass down the atoms via context rather than being\n// globally available.\n//\n// To support complex data-types, you can either have simple functions that call\n// the public setter, or subclass Atom. So, for example, here are a few\n// different ways of making a list atom with convenient helpers:\n//\n// # Simple functions being passed atom\n//\n//     const myListAtom = new Atom<number[]>([], \"myList\")\n//     function push<T>(atom: Atom<T[]>, t: T) {\n//       const next = [...atom.get(), t]\n//       atom.set(next)\n//     }\n//     function removeLast<T>(atom: Atom<T[]>, t: T) {\n//       const next = [...atom.get()]\n//       next.pop()\n//       atom.set(next)\n//     }\n//\n//\n// # Simple functions operating on global atoms\n//\n//     const myListAtom = new Atom<number[]>([], \"myLisT\")\n//     function push(t: number) {\n//       myListAtom.set([...myListAtom.get(), t])\n//     }\n//     function removeLast() {\n//       const next = [...myListAtom.get()]\n//       myListAtom.set(next)\n//     }\n//\n//\n// # Subclassing\n//\n//     class ListAtom<T> extends Atom<T[]> {\n//        push(t: T) {\n//          const next = [...this.state, t]\n//          this.set(next)\n//        }\n//        removeLast() {\n//          const next = [...this.state]\n//          next.pop()\n//          this.set(next)\n//        }\n//     }\n//     const myListAtom = new ListAtom<number>([], \"myList\")\n//\n// This library is inspired by https://recoiljs.org/\n\nimport {useLayoutEffect, useState} from 'preact/hooks'\n\ntype AtomListener = () => void\n\nlet AtomDev: {[key: string]: Atom<any>} | null = null\nlet hotReloadStash: Map<string, any> | null = null\n\ndeclare const module: any\nif (process.env.NODE_ENV === 'development') {\n  ;(window as any)['Atom'] = AtomDev = {}\n\n  /*\n  TODO(jlfwong): Fix this\n  module.hot.dispose(() => {\n    if (AtomDev) {\n      hotReloadStash = new Map()\n      for (let key in AtomDev) {\n        hotReloadStash.set(key, AtomDev[key].get())\n      }\n    }\n\n    ;(window as any)['Atom_hotReloadStash'] = hotReloadStash\n  })\n  */\n\n  hotReloadStash = (window as any)['Atom_hotReloadStash'] || null\n}\n\nexport class Atom<T> {\n  private observers: AtomListener[] = []\n  constructor(\n    protected state: T,\n    debugKey: string,\n  ) {\n    if (process.env.NODE_ENV === 'development') {\n      if (hotReloadStash?.has(debugKey)) {\n        // If we have a stored value from a previous hot reload, use that\n        // instead of whatever was passed to the constructor.\n        this.state = hotReloadStash.get(debugKey)\n      }\n\n      if (AtomDev) {\n        if (debugKey in AtomDev) {\n          console.warn(`[Atom] Multiple atoms tried to register with the key ${debugKey}`)\n        }\n        AtomDev[debugKey] = this\n      }\n    }\n\n    // We do the bind here rather than in the definition to facilitate\n    // inheritance (we want the value defined on both the prototype and the\n    // instance).\n    this.set = this.set.bind(this)\n    this.get = this.get.bind(this)\n  }\n\n  set(t: T) {\n    if (this.state === t) {\n      // No-op if the value didn't actually change\n      return\n    }\n    this.state = t\n    this.observers.forEach(fn => fn())\n  }\n\n  get(): T {\n    return this.state\n  }\n\n  subscribe(listener: AtomListener) {\n    this.observers.push(listener)\n  }\n\n  unsubscribe(listener: AtomListener) {\n    const index = this.observers.indexOf(listener)\n    if (index !== -1) {\n      this.observers.splice(index, 1)\n    }\n  }\n}\n\nexport function useAtom<T>(atom: Atom<T>): T {\n  const [value, setValue] = useState(atom.get())\n\n  useLayoutEffect(() => {\n    // We need to setValue here because it's possible something has changed the\n    // value in the store between the atom.get() call above and layout. In most\n    // cases this should no-op.\n    setValue(atom.get())\n\n    function listener() {\n      setValue(atom.get())\n    }\n\n    atom.subscribe(listener)\n    return () => {\n      atom.unsubscribe(listener)\n    }\n  }, [atom])\n\n  return value\n}\n", "import {ViewMode} from '../lib/view-mode'\n\nexport interface HashParams {\n  profileURL?: string\n  title?: string\n  localProfilePath?: string\n  viewMode?: ViewMode\n}\n\nfunction getViewMode(value: string): ViewMode | null {\n  switch (value) {\n    case 'time-ordered':\n      return ViewMode.CHRONO_FLAME_CHART\n    case 'left-heavy':\n      return ViewMode.LEFT_HEAVY_FLAME_GRAPH\n    case 'sandwich':\n      return ViewMode.SANDWICH_VIEW\n    default:\n      return null\n  }\n}\n\nexport function getHashParams(hashContents = window.location.hash): HashParams {\n  try {\n    if (!hashContents.startsWith('#')) {\n      return {}\n    }\n    const components = hashContents.substr(1).split('&')\n    const result: HashParams = {}\n    for (const component of components) {\n      let [key, value] = component.split('=')\n      value = decodeURIComponent(value)\n      if (key === 'profileURL') {\n        result.profileURL = value\n      } else if (key === 'title') {\n        result.title = value\n      } else if (key === 'localProfilePath') {\n        result.localProfilePath = value\n      } else if (key === 'view') {\n        const mode = getViewMode(value)\n        if (mode !== null) {\n          result.viewMode = mode\n        } else {\n          console.error(`Ignoring invalid view specifier: ${value}`)\n        }\n      }\n    }\n    return result\n  } catch (e) {\n    console.error(`Error when loading hash fragment.`)\n    console.error(e)\n    return {}\n  }\n}\n", "import {Atom} from '../lib/atom'\nimport {clamp, Rect, Vec2} from '../lib/math'\nimport {CallTreeNode, Frame, Profile, ProfileGroup} from '../lib/profile'\nimport {objectsHaveShallowEquality} from '../lib/utils'\n\nexport interface FlamechartViewState {\n  hover: {\n    node: CallTreeNode\n    event: MouseEvent\n  } | null\n  selectedNode: CallTreeNode | null\n  logicalSpaceViewportSize: Vec2\n  configSpaceViewportRect: Rect\n}\n\nexport interface CallerCalleeState {\n  selectedFrame: Frame\n  invertedCallerFlamegraph: FlamechartViewState\n  calleeFlamegraph: FlamechartViewState\n}\n\nexport interface SandwichViewState {\n  callerCallee: CallerCalleeState | null\n}\n\nexport interface ProfileState {\n  profile: Profile\n  chronoViewState: FlamechartViewState\n  leftHeavyViewState: FlamechartViewState\n  sandwichViewState: SandwichViewState\n}\n\nexport type ProfileGroupState = {\n  name: string\n\n  // The index within the list of profiles currently being viewed\n  indexToView: number\n\n  profiles: ProfileState[]\n} | null\n\nexport enum FlamechartID {\n  LEFT_HEAVY = 'LEFT_HEAVY',\n  CHRONO = 'CHRONO',\n  SANDWICH_INVERTED_CALLERS = 'SANDWICH_INVERTED_CALLERS',\n  SANDWICH_CALLEES = 'SANDWICH_CALLEES',\n}\n\nlet initialFlameChartViewState: FlamechartViewState = {\n  hover: null,\n  selectedNode: null,\n  configSpaceViewportRect: Rect.empty,\n  logicalSpaceViewportSize: Vec2.zero,\n}\n\nexport class ProfileGroupAtom extends Atom<ProfileGroupState> {\n  set(newState: ProfileGroupState) {\n    const oldState = this.state\n    if (oldState != null && newState != null && objectsHaveShallowEquality(oldState, newState)) {\n      return\n    }\n    super.set(newState)\n  }\n\n  getActiveProfile(): ProfileState | null {\n    if (this.state == null) return null\n    return this.state.profiles[this.state?.indexToView] || null\n  }\n\n  setProfileGroup = (group: ProfileGroup) => {\n    this.set({\n      name: group.name,\n      indexToView: group.indexToView,\n      profiles: group.profiles.map(p => ({\n        profile: p,\n        chronoViewState: initialFlameChartViewState,\n        leftHeavyViewState: initialFlameChartViewState,\n        sandwichViewState: {callerCallee: null},\n      })),\n    })\n  }\n\n  setProfileIndexToView = (indexToView: number) => {\n    if (this.state == null) return\n\n    indexToView = clamp(indexToView, 0, this.state.profiles.length - 1)\n\n    this.set({\n      ...this.state,\n      indexToView,\n    })\n  }\n\n  private updateActiveProfileState(fn: (profileState: ProfileState) => ProfileState) {\n    if (this.state == null) return\n    const {indexToView, profiles} = this.state\n    this.set({\n      ...this.state,\n      profiles: profiles.map((p, i) => {\n        if (i != indexToView) return p\n        return fn(p)\n      }),\n    })\n  }\n\n  private updateActiveSandwichViewState(\n    fn: (sandwichViewState: SandwichViewState) => SandwichViewState,\n  ) {\n    this.updateActiveProfileState(p => ({\n      ...p,\n      sandwichViewState: fn(p.sandwichViewState),\n    }))\n  }\n\n  setSelectedFrame = (frame: Frame | null) => {\n    if (this.state == null) return\n\n    const profile = this.getActiveProfile()\n    if (profile == null) {\n      return\n    }\n\n    this.updateActiveSandwichViewState(sandwichViewState => {\n      if (frame == null) {\n        return {callerCallee: null}\n      }\n      return {\n        callerCallee: {\n          invertedCallerFlamegraph: initialFlameChartViewState,\n          calleeFlamegraph: initialFlameChartViewState,\n          selectedFrame: frame,\n        },\n      }\n    })\n  }\n\n  private updateFlamechartState(\n    id: FlamechartID,\n    fn: (flamechartViewState: FlamechartViewState) => FlamechartViewState,\n  ) {\n    switch (id) {\n      case FlamechartID.CHRONO: {\n        this.updateActiveProfileState(p => ({\n          ...p,\n          chronoViewState: fn(p.chronoViewState),\n        }))\n        break\n      }\n\n      case FlamechartID.LEFT_HEAVY: {\n        this.updateActiveProfileState(p => ({\n          ...p,\n          leftHeavyViewState: fn(p.leftHeavyViewState),\n        }))\n        break\n      }\n\n      case FlamechartID.SANDWICH_CALLEES: {\n        this.updateActiveSandwichViewState(s => ({\n          ...s,\n          callerCallee:\n            s.callerCallee == null\n              ? null\n              : {\n                  ...s.callerCallee,\n                  calleeFlamegraph: fn(s.callerCallee.calleeFlamegraph),\n                },\n        }))\n        break\n      }\n\n      case FlamechartID.SANDWICH_INVERTED_CALLERS: {\n        this.updateActiveSandwichViewState(s => ({\n          ...s,\n          callerCallee:\n            s.callerCallee == null\n              ? null\n              : {\n                  ...s.callerCallee,\n                  invertedCallerFlamegraph: fn(s.callerCallee.invertedCallerFlamegraph),\n                },\n        }))\n        break\n      }\n    }\n  }\n\n  setFlamechartHoveredNode(\n    id: FlamechartID,\n    hover: {node: CallTreeNode; event: MouseEvent} | null,\n  ) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      hover,\n    }))\n  }\n\n  setSelectedNode(id: FlamechartID, selectedNode: CallTreeNode | null) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      selectedNode,\n    }))\n  }\n\n  setConfigSpaceViewportRect(id: FlamechartID, configSpaceViewportRect: Rect) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      configSpaceViewportRect,\n    }))\n  }\n\n  setLogicalSpaceViewportSize(id: FlamechartID, logicalSpaceViewportSize: Vec2) {\n    this.updateFlamechartState(id, f => ({\n      ...f,\n      logicalSpaceViewportSize,\n    }))\n  }\n\n  clearHoverNode() {\n    // TODO(jlfwong): This causes 4 separate observer events. This is probably\n    // fine, since I hope that Preact/React are smart about batching re-renders?\n    this.setFlamechartHoveredNode(FlamechartID.CHRONO, null)\n    this.setFlamechartHoveredNode(FlamechartID.LEFT_HEAVY, null)\n    this.setFlamechartHoveredNode(FlamechartID.SANDWICH_CALLEES, null)\n    this.setFlamechartHoveredNode(FlamechartID.SANDWICH_INVERTED_CALLERS, null)\n  }\n}\n", "import {Atom} from '../lib/atom'\nimport {ViewMode} from '../lib/view-mode'\nimport {getHashParams, HashParams} from '../lib/hash-params'\nimport {ProfileGroupAtom} from './profile-group'\nimport {Vec2} from '../lib/math'\n\n// True if recursion should be flattened when viewing flamegraphs\nexport const flattenRecursionAtom = new Atom<boolean>(false, 'flattenRecursion')\n\n// The query used in top-level views\n//\n// An empty string indicates that the search is open by no filter is applied.\n// searchIsActive is stored separately, because we may choose to persist the\n// query even when the search input is closed.\nexport const searchIsActiveAtom = new Atom<boolean>(false, 'searchIsActive')\nexport const searchQueryAtom = new Atom<string>('', 'searchQueryAtom')\n\n// Which top-level view should be displayed\nexport const viewModeAtom = new Atom<ViewMode>(ViewMode.CHRONO_FLAME_CHART, 'viewMode')\n\n// The top-level profile group from which most other data will be derived\nexport const profileGroupAtom = new ProfileGroupAtom(null, 'profileGroup')\n\nviewModeAtom.subscribe(() => {\n  // If we switch views, the hover information is no longer relevant\n  profileGroupAtom.clearHoverNode()\n})\n\n// Parameters defined by the URL encoded k=v pairs after the # in the URL\nconst hashParams = getHashParams()\nexport const hashParamsAtom = new Atom<HashParams>(hashParams, 'hashParams')\n\n// The <canvas> element used for WebGL\nexport const glCanvasAtom = new Atom<HTMLCanvasElement | null>(null, 'glCanvas')\n\n// True when a file drag is currently active. Used to indicate that the\n// application is a valid drop target.\nexport const dragActiveAtom = new Atom<boolean>(false, 'dragActive')\n\n// True when the application is currently in a loading state. Used to\n// display a loading progress bar.\n\n// Speedscope is usable both from a local HTML file being served\n// from a file:// URL, and via websites. In the case of file:// URLs,\n// however, XHR will be unavailable to fetching files in adjacent directories.\nconst protocol = window.location.protocol\nexport const canUseXHR = protocol === 'http:' || protocol === 'https:'\nconst isImmediatelyLoading = canUseXHR && hashParams.profileURL != null\nexport const loadingAtom = new Atom<boolean>(isImmediatelyLoading, 'loading')\n\n// True when the application is an error state, e.g. because the profile\n// imported was invalid.\nexport const errorAtom = new Atom<boolean>(false, 'error')\n\n// Minimap mouse position so we can zoom around mouse origin relative to minimap\nexport const minimapMousePositionAtom = new Atom<Vec2 | null>(null, 'minimapMousePosition')\n\nexport enum SortField {\n  SYMBOL_NAME,\n  SELF,\n  TOTAL,\n}\n\nexport enum SortDirection {\n  ASCENDING,\n  DESCENDING,\n}\n\nexport interface SortMethod {\n  field: SortField\n  direction: SortDirection\n}\n\n// The table sorting method using for the sandwich view, specifying the column\n// to sort by, and the direction to sort that clumn.\nexport const tableSortMethodAtom = new Atom<SortMethod>(\n  {\n    field: SortField.SELF,\n    direction: SortDirection.DESCENDING,\n  },\n  'tableSortMethod',\n)\n", "import {Profile} from '../lib/profile'\nimport {getProfileToView} from './getters'\nimport {flattenRecursionAtom, profileGroupAtom} from '.'\nimport {FlamechartViewState, SandwichViewState} from './profile-group'\nimport {useAtom} from '../lib/atom'\n\nexport interface ApplicationState {}\n\nexport interface ActiveProfileState {\n  profile: Profile\n  index: number\n  chronoViewState: FlamechartViewState\n  leftHeavyViewState: FlamechartViewState\n  sandwichViewState: SandwichViewState\n}\n\nexport function useActiveProfileState(): ActiveProfileState | null {\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const profileGroupState = useAtom(profileGroupAtom)\n\n  if (!profileGroupState) return null\n  if (profileGroupState.indexToView >= profileGroupState.profiles.length) return null\n\n  const index = profileGroupState.indexToView\n  const profileState = profileGroupState.profiles[index]\n  return {\n    ...profileGroupState.profiles[profileGroupState.indexToView],\n    profile: getProfileToView({\n      profile: profileState.profile,\n      flattenRecursion,\n    }),\n    index: profileGroupState.indexToView,\n  }\n}\n", "import {Atom} from '../lib/atom'\n\nexport const enum ColorScheme {\n  // Default: respect prefers-color-schema\n  SYSTEM,\n\n  // Use dark theme\n  DARK,\n\n  // use light theme\n  LIGHT,\n}\n\nconst localStorageKey = 'speedscope-color-scheme'\n\nfunction getStoredPreference(): ColorScheme {\n  const storedPreference = window.localStorage && window.localStorage[localStorageKey]\n  if (storedPreference === 'DARK') {\n    return ColorScheme.DARK\n  } else if (storedPreference === 'LIGHT') {\n    return ColorScheme.LIGHT\n  } else {\n    return ColorScheme.SYSTEM\n  }\n}\n\nfunction matchMediaDarkColorScheme(): MediaQueryList {\n  return matchMedia('(prefers-color-scheme: dark)')\n}\n\nfunction nextColorScheme(scheme: ColorScheme): ColorScheme {\n  const systemPrefersDarkMode = matchMediaDarkColorScheme().matches\n\n  // We'll use a different cycling order for changing the color scheme depending\n  // on what the *current* system preference is. This should guarantee that when\n  // a user interacts with the color scheme toggle for the first time, it always\n  // changes the color scheme.\n  if (systemPrefersDarkMode) {\n    switch (scheme) {\n      case ColorScheme.SYSTEM: {\n        return ColorScheme.LIGHT\n      }\n      case ColorScheme.LIGHT: {\n        return ColorScheme.DARK\n      }\n      case ColorScheme.DARK: {\n        return ColorScheme.SYSTEM\n      }\n    }\n  } else {\n    switch (scheme) {\n      case ColorScheme.SYSTEM: {\n        return ColorScheme.DARK\n      }\n      case ColorScheme.DARK: {\n        return ColorScheme.LIGHT\n      }\n      case ColorScheme.LIGHT: {\n        return ColorScheme.SYSTEM\n      }\n    }\n  }\n}\n\nclass ColorSchemeAtom extends Atom<ColorScheme> {\n  cycleToNextColorScheme = () => {\n    this.set(nextColorScheme(this.get()))\n  }\n}\n\nexport const colorSchemeAtom = new ColorSchemeAtom(getStoredPreference(), 'colorScheme')\n\ncolorSchemeAtom.subscribe(() => {\n  const value = colorSchemeAtom.get()\n\n  switch (value) {\n    case ColorScheme.DARK: {\n      window.localStorage[localStorageKey] = 'DARK'\n      break\n    }\n    case ColorScheme.LIGHT: {\n      window.localStorage[localStorageKey] = 'LIGHT'\n      break\n    }\n    case ColorScheme.SYSTEM: {\n      delete window.localStorage[localStorageKey]\n      break\n    }\n    default: {\n      const _exhaustiveCheck: never = value\n      return _exhaustiveCheck\n    }\n  }\n  return value\n})\n", "import {Color} from '../../lib/color'\nimport {triangle} from '../../lib/utils'\nimport {Theme} from './theme'\n\n// These colors are intentionally not exported from this file, because these\n// colors are theme specific, and we want all color values to come from the\n// active theme.\nenum Colors {\n  LIGHTER_GRAY = '#D0D0D0',\n  LIGHT_GRAY = '#BDBDBD',\n  GRAY = '#666666',\n  DARK_GRAY = '#222222',\n  DARKER_GRAY = '#0C0C0C',\n  OFF_BLACK = '#060606',\n  BLACK = '#000000',\n  BLUE = '#00769B',\n  PALE_BLUE = '#004E75',\n  GREEN = '#0F8A42',\n  LIGHT_BROWN = '#D6AE24',\n  BROWN = '#A66F1C',\n}\n\nconst C_0 = 0.2\nconst C_d = 0.1\nconst L_0 = 0.2\nconst L_d = 0.1\n\nconst colorForBucket = (t: number) => {\n  const x = triangle(30.0 * t)\n  const H = 360.0 * (0.9 * t)\n  const C = C_0 + C_d * x\n  const L = L_0 - L_d * x\n  return Color.fromLumaChromaHue(L, C, H)\n}\nconst colorForBucketGLSL = `\n  vec3 colorForBucket(float t) {\n    float x = triangle(30.0 * t);\n    float H = 360.0 * (0.9 * t);\n    float C = ${C_0.toFixed(1)} + ${C_d.toFixed(1)} * x;\n    float L = ${L_0.toFixed(1)} - ${L_d.toFixed(1)} * x;\n    return hcl2rgb(H, C, L);\n  }\n`\n\nexport const darkTheme: Theme = {\n  fgPrimaryColor: Colors.LIGHTER_GRAY,\n  fgSecondaryColor: Colors.GRAY,\n\n  bgPrimaryColor: Colors.OFF_BLACK,\n  bgSecondaryColor: Colors.DARKER_GRAY,\n\n  altFgPrimaryColor: Colors.LIGHTER_GRAY,\n  altFgSecondaryColor: Colors.GRAY,\n\n  altBgPrimaryColor: Colors.BLACK,\n  altBgSecondaryColor: Colors.DARKER_GRAY,\n\n  selectionPrimaryColor: Colors.BLUE,\n  selectionSecondaryColor: Colors.PALE_BLUE,\n\n  weightColor: Colors.GREEN,\n\n  searchMatchTextColor: Colors.DARKER_GRAY,\n  searchMatchPrimaryColor: Colors.BROWN,\n  searchMatchSecondaryColor: Colors.LIGHT_BROWN,\n\n  colorForBucket,\n  colorForBucketGLSL,\n}\n", "import {Color} from '../../lib/color'\nimport {triangle} from '../../lib/utils'\nimport {Theme} from './theme'\n\n// These colors are intentionally not exported from this file, because these\n// colors are theme specific, and we want all color values to come from the\n// active theme.\nenum Colors {\n  WHITE = '#FFFFFF',\n  OFF_WHITE = '#F6F6F6',\n  LIGHT_GRAY = '#BDBDBD',\n  GRAY = '#666666',\n  DARK_GRAY = '#222222',\n  OFF_BLACK = '#111111',\n  BLACK = '#000000',\n  DARK_BLUE = '#2F80ED',\n  PALE_DARK_BLUE = '#8EB7ED',\n  GREEN = '#6FCF97',\n  YELLOW = '#FEDC62',\n  ORANGE = '#FFAC02',\n}\n\nconst C_0 = 0.25\nconst C_d = 0.2\nconst L_0 = 0.8\nconst L_d = 0.15\n\nconst colorForBucket = (t: number) => {\n  const x = triangle(30.0 * t)\n  const H = 360.0 * (0.9 * t)\n  const C = C_0 + C_d * x\n  const L = L_0 - L_d * x\n  return Color.fromLumaChromaHue(L, C, H)\n}\nconst colorForBucketGLSL = `\n  vec3 colorForBucket(float t) {\n    float x = triangle(30.0 * t);\n    float H = 360.0 * (0.9 * t);\n    float C = ${C_0.toFixed(1)} + ${C_d.toFixed(1)} * x;\n    float L = ${L_0.toFixed(1)} - ${L_d.toFixed(1)} * x;\n    return hcl2rgb(H, C, L);\n  }\n`\n\nexport const lightTheme: Theme = {\n  fgPrimaryColor: Colors.BLACK,\n  fgSecondaryColor: Colors.LIGHT_GRAY,\n\n  bgPrimaryColor: Colors.WHITE,\n  bgSecondaryColor: Colors.OFF_WHITE,\n\n  altFgPrimaryColor: Colors.WHITE,\n  altFgSecondaryColor: Colors.LIGHT_GRAY,\n\n  altBgPrimaryColor: Colors.BLACK,\n  altBgSecondaryColor: Colors.DARK_GRAY,\n\n  selectionPrimaryColor: Colors.DARK_BLUE,\n  selectionSecondaryColor: Colors.PALE_DARK_BLUE,\n\n  weightColor: Colors.GREEN,\n\n  searchMatchTextColor: Colors.BLACK,\n  searchMatchPrimaryColor: Colors.ORANGE,\n  searchMatchSecondaryColor: Colors.YELLOW,\n\n  colorForBucket,\n  colorForBucketGLSL,\n}\n", "import {h, ComponentChildren, createContext} from 'preact'\nimport {useCallback, useContext, useEffect, useState} from 'preact/hooks'\nimport {ColorScheme, colorSchemeAtom} from '../../app-state/color-scheme'\nimport {useAtom} from '../../lib/atom'\nimport {Color} from '../../lib/color'\nimport {memoizeByReference} from '../../lib/utils'\nimport {darkTheme} from './dark-theme'\nimport {lightTheme} from './light-theme'\n\nexport interface Theme {\n  fgPrimaryColor: string\n  fgSecondaryColor: string\n  bgPrimaryColor: string\n  bgSecondaryColor: string\n\n  altFgPrimaryColor: string\n  altFgSecondaryColor: string\n  altBgPrimaryColor: string\n  altBgSecondaryColor: string\n\n  selectionPrimaryColor: string\n  selectionSecondaryColor: string\n\n  weightColor: string\n\n  searchMatchTextColor: string\n  searchMatchPrimaryColor: string\n  searchMatchSecondaryColor: string\n\n  colorForBucket: (t: number) => Color\n  colorForBucketGLSL: string\n}\n\nexport const ThemeContext = createContext<Theme>(lightTheme)\n\nexport function useTheme(): Theme {\n  return useContext(ThemeContext)\n}\n\nexport function withTheme<T>(cb: (theme: Theme) => T) {\n  return memoizeByReference(cb)\n}\n\nfunction matchMediaDarkColorScheme(): MediaQueryList {\n  return matchMedia('(prefers-color-scheme: dark)')\n}\n\nexport function colorSchemeToString(scheme: ColorScheme): string {\n  switch (scheme) {\n    case ColorScheme.SYSTEM: {\n      return 'System'\n    }\n    case ColorScheme.DARK: {\n      return 'Dark'\n    }\n    case ColorScheme.LIGHT: {\n      return 'Light'\n    }\n  }\n}\n\nfunction getTheme(colorScheme: ColorScheme, systemPrefersDarkMode: boolean) {\n  switch (colorScheme) {\n    case ColorScheme.SYSTEM: {\n      return systemPrefersDarkMode ? darkTheme : lightTheme\n    }\n    case ColorScheme.DARK: {\n      return darkTheme\n    }\n    case ColorScheme.LIGHT: {\n      return lightTheme\n    }\n  }\n}\n\nexport function ThemeProvider(props: {children: ComponentChildren}) {\n  const [systemPrefersDarkMode, setSystemPrefersDarkMode] = useState(\n    () => matchMediaDarkColorScheme().matches,\n  )\n\n  const matchMediaListener = useCallback(\n    (event: MediaQueryListEvent) => {\n      setSystemPrefersDarkMode(event.matches)\n    },\n    [setSystemPrefersDarkMode],\n  )\n\n  useEffect(() => {\n    const media = matchMediaDarkColorScheme()\n    media.addEventListener('change', matchMediaListener)\n    return () => {\n      media.removeEventListener('change', matchMediaListener)\n    }\n  }, [matchMediaListener])\n\n  const colorScheme = useAtom(colorSchemeAtom)\n  const theme = getTheme(colorScheme, systemPrefersDarkMode)\n  return <ThemeContext.Provider value={theme} children={props.children} />\n}\n", "import calc from 'inline-style-prefixer/static/plugins/calc';\nimport crossFade from 'inline-style-prefixer/static/plugins/crossFade';\nimport cursor from 'inline-style-prefixer/static/plugins/cursor';\nimport filter from 'inline-style-prefixer/static/plugins/filter';\nimport flex from 'inline-style-prefixer/static/plugins/flex';\nimport flexboxIE from 'inline-style-prefixer/static/plugins/flexboxIE';\nimport flexboxOld from 'inline-style-prefixer/static/plugins/flexboxOld';\nimport gradient from 'inline-style-prefixer/static/plugins/gradient';\nimport imageSet from 'inline-style-prefixer/static/plugins/imageSet';\nimport position from 'inline-style-prefixer/static/plugins/position';\nimport sizing from 'inline-style-prefixer/static/plugins/sizing';\nimport transition from 'inline-style-prefixer/static/plugins/transition';\nimport stringHash from 'string-hash';\nimport createPrefixer from 'inline-style-prefixer/static/createPrefixer';\nimport asap from 'asap';\n\nvar w = [\"Webkit\"];\nvar m = [\"Moz\"];\nvar ms = [\"ms\"];\nvar wm = [\"Webkit\", \"Moz\"];\nvar wms = [\"Webkit\", \"ms\"];\nvar wmms = [\"Webkit\", \"Moz\", \"ms\"];\n\nvar staticPrefixData = {\n  plugins: [calc, crossFade, cursor, filter, flex, flexboxIE, flexboxOld, gradient, imageSet, position, sizing, transition],\n  prefixMap: { \"transform\": wms, \"transformOrigin\": wms, \"transformOriginX\": wms, \"transformOriginY\": wms, \"backfaceVisibility\": w, \"perspective\": w, \"perspectiveOrigin\": w, \"transformStyle\": w, \"transformOriginZ\": w, \"animation\": w, \"animationDelay\": w, \"animationDirection\": w, \"animationFillMode\": w, \"animationDuration\": w, \"animationIterationCount\": w, \"animationName\": w, \"animationPlayState\": w, \"animationTimingFunction\": w, \"appearance\": wm, \"userSelect\": wmms, \"fontKerning\": w, \"textEmphasisPosition\": w, \"textEmphasis\": w, \"textEmphasisStyle\": w, \"textEmphasisColor\": w, \"boxDecorationBreak\": w, \"clipPath\": w, \"maskImage\": w, \"maskMode\": w, \"maskRepeat\": w, \"maskPosition\": w, \"maskClip\": w, \"maskOrigin\": w, \"maskSize\": w, \"maskComposite\": w, \"mask\": w, \"maskBorderSource\": w, \"maskBorderMode\": w, \"maskBorderSlice\": w, \"maskBorderWidth\": w, \"maskBorderOutset\": w, \"maskBorderRepeat\": w, \"maskBorder\": w, \"maskType\": w, \"textDecorationStyle\": wm, \"textDecorationSkip\": wm, \"textDecorationLine\": wm, \"textDecorationColor\": wm, \"filter\": w, \"fontFeatureSettings\": wm, \"breakAfter\": wmms, \"breakBefore\": wmms, \"breakInside\": wmms, \"columnCount\": wm, \"columnFill\": wm, \"columnGap\": wm, \"columnRule\": wm, \"columnRuleColor\": wm, \"columnRuleStyle\": wm, \"columnRuleWidth\": wm, \"columns\": wm, \"columnSpan\": wm, \"columnWidth\": wm, \"writingMode\": wms, \"flex\": wms, \"flexBasis\": w, \"flexDirection\": wms, \"flexGrow\": w, \"flexFlow\": wms, \"flexShrink\": w, \"flexWrap\": wms, \"alignContent\": w, \"alignItems\": w, \"alignSelf\": w, \"justifyContent\": w, \"order\": w, \"transitionDelay\": w, \"transitionDuration\": w, \"transitionProperty\": w, \"transitionTimingFunction\": w, \"backdropFilter\": w, \"scrollSnapType\": wms, \"scrollSnapPointsX\": wms, \"scrollSnapPointsY\": wms, \"scrollSnapDestination\": wms, \"scrollSnapCoordinate\": wms, \"shapeImageThreshold\": w, \"shapeImageMargin\": w, \"shapeImageOutside\": w, \"hyphens\": wmms, \"flowInto\": wms, \"flowFrom\": wms, \"regionFragment\": wms, \"boxSizing\": m, \"textAlignLast\": m, \"tabSize\": m, \"wrapFlow\": ms, \"wrapThrough\": ms, \"wrapMargin\": ms, \"touchAction\": ms, \"gridTemplateColumns\": ms, \"gridTemplateRows\": ms, \"gridTemplateAreas\": ms, \"gridTemplate\": ms, \"gridAutoColumns\": ms, \"gridAutoRows\": ms, \"gridAutoFlow\": ms, \"grid\": ms, \"gridRowStart\": ms, \"gridColumnStart\": ms, \"gridRowEnd\": ms, \"gridRow\": ms, \"gridColumn\": ms, \"gridColumnEnd\": ms, \"gridColumnGap\": ms, \"gridRowGap\": ms, \"gridArea\": ms, \"gridGap\": ms, \"textSizeAdjust\": wms, \"borderImage\": w, \"borderImageOutset\": w, \"borderImageRepeat\": w, \"borderImageSlice\": w, \"borderImageSource\": w, \"borderImageWidth\": w }\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MAP_EXISTS = typeof Map !== 'undefined';\n\nvar OrderedElements = function () {\n    /* ::\n    elements: {[string]: any};\n    keyOrder: string[];\n    */\n\n    function OrderedElements() {\n        _classCallCheck(this, OrderedElements);\n\n        this.elements = {};\n        this.keyOrder = [];\n    }\n\n    _createClass(OrderedElements, [{\n        key: 'forEach',\n        value: function () {\n            function forEach(callback /* : (string, any) => void */) {\n                for (var i = 0; i < this.keyOrder.length; i++) {\n                    // (value, key) to match Map's API\n                    callback(this.elements[this.keyOrder[i]], this.keyOrder[i]);\n                }\n            }\n\n            return forEach;\n        }()\n    }, {\n        key: 'set',\n        value: function () {\n            function set(key /* : string */, value /* : any */, shouldReorder /* : ?boolean */) {\n                if (!this.elements.hasOwnProperty(key)) {\n                    this.keyOrder.push(key);\n                } else if (shouldReorder) {\n                    var index = this.keyOrder.indexOf(key);\n                    this.keyOrder.splice(index, 1);\n                    this.keyOrder.push(key);\n                }\n\n                if (value == null) {\n                    this.elements[key] = value;\n                    return;\n                }\n\n                if (MAP_EXISTS && value instanceof Map || value instanceof OrderedElements) {\n                    // We have found a nested Map, so we need to recurse so that all\n                    // of the nested objects and Maps are merged properly.\n                    var nested = this.elements.hasOwnProperty(key) ? this.elements[key] : new OrderedElements();\n                    value.forEach(function (value, key) {\n                        nested.set(key, value, shouldReorder);\n                    });\n                    this.elements[key] = nested;\n                    return;\n                }\n\n                if (!Array.isArray(value) && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') {\n                    // We have found a nested object, so we need to recurse so that all\n                    // of the nested objects and Maps are merged properly.\n                    var _nested = this.elements.hasOwnProperty(key) ? this.elements[key] : new OrderedElements();\n                    var keys = Object.keys(value);\n                    for (var i = 0; i < keys.length; i += 1) {\n                        _nested.set(keys[i], value[keys[i]], shouldReorder);\n                    }\n                    this.elements[key] = _nested;\n                    return;\n                }\n\n                this.elements[key] = value;\n            }\n\n            return set;\n        }()\n    }, {\n        key: 'get',\n        value: function () {\n            function get(key /* : string */) /* : any */{\n                return this.elements[key];\n            }\n\n            return get;\n        }()\n    }, {\n        key: 'has',\n        value: function () {\n            function has(key /* : string */) /* : boolean */{\n                return this.elements.hasOwnProperty(key);\n            }\n\n            return has;\n        }()\n    }, {\n        key: 'addStyleType',\n        value: function () {\n            function addStyleType(styleType /* : any */) /* : void */{\n                var _this = this;\n\n                if (MAP_EXISTS && styleType instanceof Map || styleType instanceof OrderedElements) {\n                    styleType.forEach(function (value, key) {\n                        _this.set(key, value, true);\n                    });\n                } else {\n                    var keys = Object.keys(styleType);\n                    for (var i = 0; i < keys.length; i++) {\n                        this.set(keys[i], styleType[keys[i]], true);\n                    }\n                }\n            }\n\n            return addStyleType;\n        }()\n    }]);\n\n    return OrderedElements;\n}();\n\n/* ::\ntype ObjectMap = { [id:string]: any };\n*/\n\nvar UPPERCASE_RE = /([A-Z])/g;\nvar UPPERCASE_RE_TO_KEBAB = function UPPERCASE_RE_TO_KEBAB(match /* : string */) {\n    return (/* : string */'-' + String(match.toLowerCase())\n    );\n};\n\nvar kebabifyStyleName = function kebabifyStyleName(string /* : string */) /* : string */{\n    var result = string.replace(UPPERCASE_RE, UPPERCASE_RE_TO_KEBAB);\n    if (result[0] === 'm' && result[1] === 's' && result[2] === '-') {\n        return '-' + String(result);\n    }\n    return result;\n};\n\n/**\n * CSS properties which accept numbers but are not in units of \"px\".\n * Taken from React's CSSProperty.js\n */\nvar isUnitlessNumber = {\n    animationIterationCount: true,\n    borderImageOutset: true,\n    borderImageSlice: true,\n    borderImageWidth: true,\n    boxFlex: true,\n    boxFlexGroup: true,\n    boxOrdinalGroup: true,\n    columnCount: true,\n    flex: true,\n    flexGrow: true,\n    flexPositive: true,\n    flexShrink: true,\n    flexNegative: true,\n    flexOrder: true,\n    gridRow: true,\n    gridColumn: true,\n    fontWeight: true,\n    lineClamp: true,\n    lineHeight: true,\n    opacity: true,\n    order: true,\n    orphans: true,\n    tabSize: true,\n    widows: true,\n    zIndex: true,\n    zoom: true,\n\n    // SVG-related properties\n    fillOpacity: true,\n    floodOpacity: true,\n    stopOpacity: true,\n    strokeDasharray: true,\n    strokeDashoffset: true,\n    strokeMiterlimit: true,\n    strokeOpacity: true,\n    strokeWidth: true\n};\n\n/**\n * Taken from React's CSSProperty.js\n *\n * @param {string} prefix vendor-specific prefix, eg: Webkit\n * @param {string} key style name, eg: transitionDuration\n * @return {string} style name prefixed with `prefix`, properly camelCased, eg:\n * WebkitTransitionDuration\n */\nfunction prefixKey(prefix, key) {\n    return prefix + key.charAt(0).toUpperCase() + key.substring(1);\n}\n\n/**\n * Support style names that may come passed in prefixed by adding permutations\n * of vendor prefixes.\n * Taken from React's CSSProperty.js\n */\nvar prefixes = ['Webkit', 'ms', 'Moz', 'O'];\n\n// Using Object.keys here, or else the vanilla for-in loop makes IE8 go into an\n// infinite loop, because it iterates over the newly added props too.\n// Taken from React's CSSProperty.js\nObject.keys(isUnitlessNumber).forEach(function (prop) {\n    prefixes.forEach(function (prefix) {\n        isUnitlessNumber[prefixKey(prefix, prop)] = isUnitlessNumber[prop];\n    });\n});\n\nvar stringifyValue = function stringifyValue(key /* : string */\n, prop /* : any */\n) /* : string */{\n    if (typeof prop === \"number\") {\n        if (isUnitlessNumber[key]) {\n            return \"\" + prop;\n        } else {\n            return prop + \"px\";\n        }\n    } else {\n        return '' + prop;\n    }\n};\n\nvar stringifyAndImportantifyValue = function stringifyAndImportantifyValue(key /* : string */\n, prop /* : any */\n) {\n    return (/* : string */importantify(stringifyValue(key, prop))\n    );\n};\n\n// Turn a string into a hash string of base-36 values (using letters and numbers)\n// eslint-disable-next-line no-unused-vars\nvar hashString = function hashString(string /* : string */, key /* : ?string */) {\n    return (/* string */stringHash(string).toString(36)\n    );\n};\n\n// Hash a javascript object using JSON.stringify. This is very fast, about 3\n// microseconds on my computer for a sample object:\n// http://jsperf.com/test-hashfnv32a-hash/5\n//\n// Note that this uses JSON.stringify to stringify the objects so in order for\n// this to produce consistent hashes browsers need to have a consistent\n// ordering of objects. Ben Alpert says that Facebook depends on this, so we\n// can probably depend on this too.\nvar hashObject = function hashObject(object /* : ObjectMap */) {\n    return (/* : string */hashString(JSON.stringify(object))\n    );\n};\n\n// Given a single style value string like the \"b\" from \"a: b;\", adds !important\n// to generate \"b !important\".\nvar importantify = function importantify(string /* : string */) {\n    return (/* : string */\n        // Bracket string character access is very fast, and in the default case we\n        // normally don't expect there to be \"!important\" at the end of the string\n        // so we can use this simple check to take an optimized path. If there\n        // happens to be a \"!\" in this position, we follow up with a more thorough\n        // check.\n        string[string.length - 10] === '!' && string.slice(-11) === ' !important' ? string : String(string) + ' !important'\n    );\n};\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar prefixAll = createPrefixer(staticPrefixData);\n\n/* ::\nimport type { SheetDefinition } from './index.js';\ntype StringHandlers = { [id:string]: Function };\ntype SelectorCallback = (selector: string) => string[];\nexport type SelectorHandler = (\n    selector: string,\n    baseSelector: string,\n    callback: SelectorCallback\n) => string[] | string | null;\n*/\n\n/**\n * `selectorHandlers` are functions which handle special selectors which act\n * differently than normal style definitions. These functions look at the\n * current selector and can generate CSS for the styles in their subtree by\n * calling the callback with a new selector.\n *\n * For example, when generating styles with a base selector of '.foo' and the\n * following styles object:\n *\n *   {\n *     ':nth-child(2n)': {\n *       ':hover': {\n *         color: 'red'\n *       }\n *     }\n *   }\n *\n * when we reach the ':hover' style, we would call our selector handlers like\n *\n *   handler(':hover', '.foo:nth-child(2n)', callback)\n *\n * Since our `pseudoSelectors` handles ':hover' styles, that handler would call\n * the callback like\n *\n *   callback('.foo:nth-child(2n):hover')\n *\n * to generate its subtree `{ color: 'red' }` styles with a\n * '.foo:nth-child(2n):hover' selector. The callback would return an array of CSS\n * rules like\n *\n *   ['.foo:nth-child(2n):hover{color:red !important;}']\n *\n * and the handler would then return that resulting CSS.\n *\n * `defaultSelectorHandlers` is the list of default handlers used in a call to\n * `generateCSS`.\n *\n * @name SelectorHandler\n * @function\n * @param {string} selector: The currently inspected selector. ':hover' in the\n *     example above.\n * @param {string} baseSelector: The selector of the parent styles.\n *     '.foo:nth-child(2n)' in the example above.\n * @param {function} generateSubtreeStyles: A function which can be called to\n *     generate CSS for the subtree of styles corresponding to the selector.\n *     Accepts a new baseSelector to use for generating those styles.\n * @returns {string[] | string | null} The generated CSS for this selector, or\n *     null if we don't handle this selector.\n */\nvar defaultSelectorHandlers /* : SelectorHandler[] */ = [\n// Handle pseudo-selectors, like :hover and :nth-child(3n)\nfunction () {\n    function pseudoSelectors(selector, baseSelector, generateSubtreeStyles) {\n        if (selector[0] !== \":\") {\n            return null;\n        }\n        return generateSubtreeStyles(baseSelector + selector);\n    }\n\n    return pseudoSelectors;\n}(),\n\n// Handle media queries (or font-faces)\nfunction () {\n    function mediaQueries(selector, baseSelector, generateSubtreeStyles) {\n        if (selector[0] !== \"@\") {\n            return null;\n        }\n        // Generate the styles normally, and then wrap them in the media query.\n        var generated = generateSubtreeStyles(baseSelector);\n        return [String(selector) + '{' + String(generated.join('')) + '}'];\n    }\n\n    return mediaQueries;\n}()];\n\n/**\n * Generate CSS for a selector and some styles.\n *\n * This function handles the media queries and pseudo selectors that can be used\n * in aphrodite styles.\n *\n * @param {string} selector: A base CSS selector for the styles to be generated\n *     with.\n * @param {Object} styleTypes: A list of properties of the return type of\n *     StyleSheet.create, e.g. [styles.red, styles.blue].\n * @param {Array.<SelectorHandler>} selectorHandlers: A list of selector\n *     handlers to use for handling special selectors. See\n *     `defaultSelectorHandlers`.\n * @param stringHandlers: See `generateCSSRuleset`\n * @param useImportant: See `generateCSSRuleset`\n *\n * To actually generate the CSS special-construct-less styles are passed to\n * `generateCSSRuleset`.\n *\n * For instance, a call to\n *\n *     generateCSS(\".foo\", [{\n *       color: \"red\",\n *       \"@media screen\": {\n *         height: 20,\n *         \":hover\": {\n *           backgroundColor: \"black\"\n *         }\n *       },\n *       \":active\": {\n *         fontWeight: \"bold\"\n *       }\n *     }], defaultSelectorHandlers);\n *\n * with the default `selectorHandlers` will make 5 calls to\n * `generateCSSRuleset`:\n *\n *     generateCSSRuleset(\".foo\", { color: \"red\" }, ...)\n *     generateCSSRuleset(\".foo:active\", { fontWeight: \"bold\" }, ...)\n *     // These 2 will be wrapped in @media screen {}\n *     generateCSSRuleset(\".foo\", { height: 20 }, ...)\n *     generateCSSRuleset(\".foo:hover\", { backgroundColor: \"black\" }, ...)\n */\nvar generateCSS = function generateCSS(selector /* : string */\n, styleTypes /* : SheetDefinition[] */\n, selectorHandlers /* : SelectorHandler[] */\n, stringHandlers /* : StringHandlers */\n, useImportant /* : boolean */\n) /* : string[] */{\n    var merged = new OrderedElements();\n\n    for (var i = 0; i < styleTypes.length; i++) {\n        merged.addStyleType(styleTypes[i]);\n    }\n\n    var plainDeclarations = new OrderedElements();\n    var generatedStyles = [];\n\n    // TODO(emily): benchmark this to see if a plain for loop would be faster.\n    merged.forEach(function (val, key) {\n        // For each key, see if one of the selector handlers will handle these\n        // styles.\n        var foundHandler = selectorHandlers.some(function (handler) {\n            var result = handler(key, selector, function (newSelector) {\n                return generateCSS(newSelector, [val], selectorHandlers, stringHandlers, useImportant);\n            });\n            if (result != null) {\n                // If the handler returned something, add it to the generated\n                // CSS and stop looking for another handler.\n                if (Array.isArray(result)) {\n                    generatedStyles.push.apply(generatedStyles, _toConsumableArray(result));\n                } else {\n                    // eslint-disable-next-line\n                    console.warn('WARNING: Selector handlers should return an array of rules.' + 'Returning a string containing multiple rules is deprecated.', handler);\n                    generatedStyles.push('@media all {' + String(result) + '}');\n                }\n                return true;\n            }\n        });\n        // If none of the handlers handled it, add it to the list of plain\n        // style declarations.\n        if (!foundHandler) {\n            plainDeclarations.set(key, val, true);\n        }\n    });\n    var generatedRuleset = generateCSSRuleset(selector, plainDeclarations, stringHandlers, useImportant, selectorHandlers);\n\n    if (generatedRuleset) {\n        generatedStyles.unshift(generatedRuleset);\n    }\n\n    return generatedStyles;\n};\n\n/**\n * Helper method of generateCSSRuleset to facilitate custom handling of certain\n * CSS properties. Used for e.g. font families.\n *\n * See generateCSSRuleset for usage and documentation of paramater types.\n */\nvar runStringHandlers = function runStringHandlers(declarations /* : OrderedElements */\n, stringHandlers /* : StringHandlers */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : void */{\n    if (!stringHandlers) {\n        return;\n    }\n\n    var stringHandlerKeys = Object.keys(stringHandlers);\n    for (var i = 0; i < stringHandlerKeys.length; i++) {\n        var key = stringHandlerKeys[i];\n        if (declarations.has(key)) {\n            // A declaration exists for this particular string handler, so we\n            // need to let the string handler interpret the declaration first\n            // before proceeding.\n            //\n            // TODO(emily): Pass in a callback which generates CSS, similar to\n            // how our selector handlers work, instead of passing in\n            // `selectorHandlers` and have them make calls to `generateCSS`\n            // themselves. Right now, this is impractical because our string\n            // handlers are very specialized and do complex things.\n            declarations.set(key, stringHandlers[key](declarations.get(key), selectorHandlers),\n\n            // Preserve order here, since we are really replacing an\n            // unprocessed style with a processed style, not overriding an\n            // earlier style\n            false);\n        }\n    }\n};\n\nvar transformRule = function transformRule(key /* : string */\n, value /* : string */\n, transformValue /* : function */\n) {\n    return (/* : string */String(kebabifyStyleName(key)) + ':' + String(transformValue(key, value)) + ';'\n    );\n};\n\nvar arrayToObjectKeysReducer = function arrayToObjectKeysReducer(acc, val) {\n    acc[val] = true;\n    return acc;\n};\n\n/**\n * Generate a CSS ruleset with the selector and containing the declarations.\n *\n * This function assumes that the given declarations don't contain any special\n * children (such as media queries, pseudo-selectors, or descendant styles).\n *\n * Note that this method does not deal with nesting used for e.g.\n * psuedo-selectors or media queries. That responsibility is left to  the\n * `generateCSS` function.\n *\n * @param {string} selector: the selector associated with the ruleset\n * @param {Object} declarations: a map from camelCased CSS property name to CSS\n *     property value.\n * @param {Object.<string, function>} stringHandlers: a map from camelCased CSS\n *     property name to a function which will map the given value to the value\n *     that is output.\n * @param {bool} useImportant: A boolean saying whether to append \"!important\"\n *     to each of the CSS declarations.\n * @returns {string} A string of raw CSS.\n *\n * Examples:\n *\n *    generateCSSRuleset(\".blah\", { color: \"red\" })\n *    -> \".blah{color: red !important;}\"\n *    generateCSSRuleset(\".blah\", { color: \"red\" }, {}, false)\n *    -> \".blah{color: red}\"\n *    generateCSSRuleset(\".blah\", { color: \"red\" }, {color: c => c.toUpperCase})\n *    -> \".blah{color: RED}\"\n *    generateCSSRuleset(\".blah:hover\", { color: \"red\" })\n *    -> \".blah:hover{color: red}\"\n */\nvar generateCSSRuleset = function generateCSSRuleset(selector /* : string */\n, declarations /* : OrderedElements */\n, stringHandlers /* : StringHandlers */\n, useImportant /* : boolean */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : string */{\n    // Mutates declarations\n    runStringHandlers(declarations, stringHandlers, selectorHandlers);\n\n    var originalElements = Object.keys(declarations.elements).reduce(arrayToObjectKeysReducer, Object.create(null));\n\n    // NOTE(emily): This mutates handledDeclarations.elements.\n    var prefixedElements = prefixAll(declarations.elements);\n\n    var elementNames = Object.keys(prefixedElements);\n    if (elementNames.length !== declarations.keyOrder.length) {\n        // There are some prefixed values, so we need to figure out how to sort\n        // them.\n        //\n        // Loop through prefixedElements, looking for anything that is not in\n        // sortOrder, which means it was added by prefixAll. This means that we\n        // need to figure out where it should appear in the sortOrder.\n        for (var i = 0; i < elementNames.length; i++) {\n            if (!originalElements[elementNames[i]]) {\n                // This element is not in the sortOrder, which means it is a prefixed\n                // value that was added by prefixAll. Let's try to figure out where it\n                // goes.\n                var originalStyle = void 0;\n                if (elementNames[i][0] === 'W') {\n                    // This is a Webkit-prefixed style, like \"WebkitTransition\". Let's\n                    // find its original style's sort order.\n                    originalStyle = elementNames[i][6].toLowerCase() + elementNames[i].slice(7);\n                } else if (elementNames[i][1] === 'o') {\n                    // This is a Moz-prefixed style, like \"MozTransition\". We check\n                    // the second character to avoid colliding with Ms-prefixed\n                    // styles. Let's find its original style's sort order.\n                    originalStyle = elementNames[i][3].toLowerCase() + elementNames[i].slice(4);\n                } else {\n                    // if (elementNames[i][1] === 's') {\n                    // This is a Ms-prefixed style, like \"MsTransition\".\n                    originalStyle = elementNames[i][2].toLowerCase() + elementNames[i].slice(3);\n                }\n\n                if (originalStyle && originalElements[originalStyle]) {\n                    var originalIndex = declarations.keyOrder.indexOf(originalStyle);\n                    declarations.keyOrder.splice(originalIndex, 0, elementNames[i]);\n                } else {\n                    // We don't know what the original style was, so sort it to\n                    // top. This can happen for styles that are added that don't\n                    // have the same base name as the original style.\n                    declarations.keyOrder.unshift(elementNames[i]);\n                }\n            }\n        }\n    }\n\n    var transformValue = useImportant === false ? stringifyValue : stringifyAndImportantifyValue;\n\n    var rules = [];\n    for (var _i = 0; _i < declarations.keyOrder.length; _i++) {\n        var key = declarations.keyOrder[_i];\n        var value = prefixedElements[key];\n        if (Array.isArray(value)) {\n            // inline-style-prefixer returns an array when there should be\n            // multiple rules for the same key. Here we flatten to multiple\n            // pairs with the same key.\n            for (var j = 0; j < value.length; j++) {\n                rules.push(transformRule(key, value[j], transformValue));\n            }\n        } else {\n            rules.push(transformRule(key, value, transformValue));\n        }\n    }\n\n    if (rules.length) {\n        return String(selector) + '{' + String(rules.join(\"\")) + '}';\n    } else {\n        return \"\";\n    }\n};\n\nvar _typeof$1 = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _toConsumableArray$1(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n/* ::\nimport type { SheetDefinition, SheetDefinitions } from './index.js';\nimport type { MaybeSheetDefinition } from './exports.js';\nimport type { SelectorHandler } from './generate.js';\n*/\n\n// The current <style> tag we are inserting into, or null if we haven't\n// inserted anything yet. We could find this each time using\n// `document.querySelector(\"style[data-aphrodite\"])`, but holding onto it is\n// faster.\nvar styleTag /* : ?HTMLStyleElement */ = null;\n\n// Inject a set of rules into a <style> tag in the head of the document. This\n// will automatically create a style tag and then continue to use it for\n// multiple injections. It will also use a style tag with the `data-aphrodite`\n// tag on it if that exists in the DOM. This could be used for e.g. reusing the\n// same style tag that server-side rendering inserts.\nvar injectStyleTag = function injectStyleTag(cssRules /* : string[] */) {\n    if (styleTag == null) {\n        // Try to find a style tag with the `data-aphrodite` attribute first.\n        styleTag = document.querySelector(\"style[data-aphrodite]\") /* : any */;\n\n        // If that doesn't work, generate a new style tag.\n        if (styleTag == null) {\n            // Taken from\n            // http://stackoverflow.com/questions/524696/how-to-create-a-style-tag-with-javascript\n            var head = document.head || document.getElementsByTagName('head')[0];\n            styleTag = document.createElement('style');\n\n            styleTag.type = 'text/css';\n            styleTag.setAttribute(\"data-aphrodite\", \"\");\n            head.appendChild(styleTag);\n        }\n    }\n\n    var sheet = styleTag.styleSheet || styleTag.sheet /* : any */;\n\n    if (sheet.insertRule) {\n        var numRules = sheet.cssRules.length;\n        cssRules.forEach(function (rule) {\n            try {\n                sheet.insertRule(rule, numRules);\n                numRules += 1;\n            } catch (e) {\n                // The selector for this rule wasn't compatible with the browser\n            }\n        });\n    } else {\n        styleTag.innerText = (styleTag.innerText || '') + cssRules.join('');\n    }\n};\n\n// Custom handlers for stringifying CSS values that have side effects\n// (such as fontFamily, which can cause @font-face rules to be injected)\nvar stringHandlers = {\n    // With fontFamily we look for objects that are passed in and interpret\n    // them as @font-face rules that we need to inject. The value of fontFamily\n    // can either be a string (as normal), an object (a single font face), or\n    // an array of objects and strings.\n    fontFamily: function () {\n        function fontFamily(val) {\n            if (Array.isArray(val)) {\n                return val.map(fontFamily).join(\",\");\n            } else if ((typeof val === 'undefined' ? 'undefined' : _typeof$1(val)) === \"object\") {\n                injectStyleOnce(val.src, \"@font-face\", [val], false);\n                return '\"' + String(val.fontFamily) + '\"';\n            } else {\n                return val;\n            }\n        }\n\n        return fontFamily;\n    }(),\n\n    // With animationName we look for an object that contains keyframes and\n    // inject them as an `@keyframes` block, returning a uniquely generated\n    // name. The keyframes object should look like\n    //  animationName: {\n    //    from: {\n    //      left: 0,\n    //      top: 0,\n    //    },\n    //    '50%': {\n    //      left: 15,\n    //      top: 5,\n    //    },\n    //    to: {\n    //      left: 20,\n    //      top: 20,\n    //    }\n    //  }\n    // TODO(emily): `stringHandlers` doesn't let us rename the key, so I have\n    // to use `animationName` here. Improve that so we can call this\n    // `animation` instead of `animationName`.\n    animationName: function () {\n        function animationName(val, selectorHandlers) {\n            if (Array.isArray(val)) {\n                return val.map(function (v) {\n                    return animationName(v, selectorHandlers);\n                }).join(\",\");\n            } else if ((typeof val === 'undefined' ? 'undefined' : _typeof$1(val)) === \"object\") {\n                // Generate a unique name based on the hash of the object. We can't\n                // just use the hash because the name can't start with a number.\n                // TODO(emily): this probably makes debugging hard, allow a custom\n                // name?\n                var name = 'keyframe_' + String(hashObject(val));\n\n                // Since keyframes need 3 layers of nesting, we use `generateCSS` to\n                // build the inner layers and wrap it in `@keyframes` ourselves.\n                var finalVal = '@keyframes ' + name + '{';\n\n                // TODO see if we can find a way where checking for OrderedElements\n                // here is not necessary. Alternatively, perhaps we should have a\n                // utility method that can iterate over either a plain object, an\n                // instance of OrderedElements, or a Map, and then use that here and\n                // elsewhere.\n                if (val instanceof OrderedElements) {\n                    val.forEach(function (valVal, valKey) {\n                        finalVal += generateCSS(valKey, [valVal], selectorHandlers, stringHandlers, false).join('');\n                    });\n                } else {\n                    Object.keys(val).forEach(function (key) {\n                        finalVal += generateCSS(key, [val[key]], selectorHandlers, stringHandlers, false).join('');\n                    });\n                }\n                finalVal += '}';\n\n                injectGeneratedCSSOnce(name, [finalVal]);\n\n                return name;\n            } else {\n                return val;\n            }\n        }\n\n        return animationName;\n    }()\n};\n\n// This is a map from Aphrodite's generated class names to `true` (acting as a\n// set of class names)\nvar alreadyInjected = {};\n\n// This is the buffer of styles which have not yet been flushed.\nvar injectionBuffer /* : string[] */ = [];\n\n// A flag to tell if we are already buffering styles. This could happen either\n// because we scheduled a flush call already, so newly added styles will\n// already be flushed, or because we are statically buffering on the server.\nvar isBuffering = false;\n\nvar injectGeneratedCSSOnce = function injectGeneratedCSSOnce(key, generatedCSS) {\n    var _injectionBuffer;\n\n    if (alreadyInjected[key]) {\n        return;\n    }\n\n    if (!isBuffering) {\n        // We should never be automatically buffering on the server (or any\n        // place without a document), so guard against that.\n        if (typeof document === \"undefined\") {\n            throw new Error(\"Cannot automatically buffer without a document\");\n        }\n\n        // If we're not already buffering, schedule a call to flush the\n        // current styles.\n        isBuffering = true;\n        asap(flushToStyleTag);\n    }\n\n    (_injectionBuffer = injectionBuffer).push.apply(_injectionBuffer, _toConsumableArray$1(generatedCSS));\n    alreadyInjected[key] = true;\n};\n\nvar injectStyleOnce = function injectStyleOnce(key /* : string */\n, selector /* : string */\n, definitions /* : SheetDefinition[] */\n, useImportant /* : boolean */\n) {\n    var selectorHandlers /* : SelectorHandler[] */ = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : [];\n\n    if (alreadyInjected[key]) {\n        return;\n    }\n\n    var generated = generateCSS(selector, definitions, selectorHandlers, stringHandlers, useImportant);\n\n    injectGeneratedCSSOnce(key, generated);\n};\n\nvar reset = function reset() {\n    injectionBuffer = [];\n    alreadyInjected = {};\n    isBuffering = false;\n    styleTag = null;\n};\n\nvar getBufferedStyles = function getBufferedStyles() {\n    return injectionBuffer;\n};\n\nvar startBuffering = function startBuffering() {\n    if (isBuffering) {\n        throw new Error(\"Cannot buffer while already buffering\");\n    }\n    isBuffering = true;\n};\n\nvar flushToArray = function flushToArray() {\n    isBuffering = false;\n    var ret = injectionBuffer;\n    injectionBuffer = [];\n    return ret;\n};\n\nvar flushToString = function flushToString() {\n    return flushToArray().join('');\n};\n\nvar flushToStyleTag = function flushToStyleTag() {\n    var cssRules = flushToArray();\n    if (cssRules.length > 0) {\n        injectStyleTag(cssRules);\n    }\n};\n\nvar getRenderedClassNames = function getRenderedClassNames() {\n    return Object.keys(alreadyInjected);\n};\n\nvar addRenderedClassNames = function addRenderedClassNames(classNames /* : string[] */) {\n    classNames.forEach(function (className) {\n        alreadyInjected[className] = true;\n    });\n};\n\nvar processStyleDefinitions = function processStyleDefinitions(styleDefinitions /* : any[] */\n, classNameBits /* : string[] */\n, definitionBits /* : Object[] */\n, length /* : number */\n) /* : number */{\n    for (var i = 0; i < styleDefinitions.length; i += 1) {\n        // Filter out falsy values from the input, to allow for\n        // `css(a, test && c)`\n        if (styleDefinitions[i]) {\n            if (Array.isArray(styleDefinitions[i])) {\n                // We've encountered an array, so let's recurse\n                length += processStyleDefinitions(styleDefinitions[i], classNameBits, definitionBits, length);\n            } else {\n                classNameBits.push(styleDefinitions[i]._name);\n                definitionBits.push(styleDefinitions[i]._definition);\n                length += styleDefinitions[i]._len;\n            }\n        }\n    }\n    return length;\n};\n\n/**\n * Inject styles associated with the passed style definition objects, and return\n * an associated CSS class name.\n *\n * @param {boolean} useImportant If true, will append !important to generated\n *     CSS output. e.g. {color: red} -> \"color: red !important\".\n * @param {(Object|Object[])[]} styleDefinitions style definition objects, or\n *     arbitrarily nested arrays of them, as returned as properties of the\n *     return value of StyleSheet.create().\n */\nvar injectAndGetClassName = function injectAndGetClassName(useImportant /* : boolean */\n, styleDefinitions /* : MaybeSheetDefinition[] */\n, selectorHandlers /* : SelectorHandler[] */\n) /* : string */{\n    var classNameBits = [];\n    var definitionBits = [];\n\n    // Mutates classNameBits and definitionBits and returns a length which we\n    // will append to the hash to decrease the chance of hash collisions.\n    var length = processStyleDefinitions(styleDefinitions, classNameBits, definitionBits, 0);\n\n    // Break if there aren't any valid styles.\n    if (classNameBits.length === 0) {\n        return \"\";\n    }\n\n    var className = void 0;\n    if (process.env.NODE_ENV === 'production') {\n        className = classNameBits.length === 1 ? '_' + String(classNameBits[0]) : '_' + String(hashString(classNameBits.join())) + String((length % 36).toString(36));\n    } else {\n        className = classNameBits.join(\"-o_O-\");\n    }\n\n    injectStyleOnce(className, '.' + String(className), definitionBits, useImportant, selectorHandlers);\n\n    return className;\n};\n\n/* ::\nimport type { SelectorHandler } from './generate.js';\nexport type SheetDefinition = { [id:string]: any };\nexport type SheetDefinitions = SheetDefinition | SheetDefinition[];\ntype RenderFunction = () => string;\ntype Extension = {\n    selectorHandler: SelectorHandler\n};\nexport type MaybeSheetDefinition = SheetDefinition | false | null | void\n*/\n\nvar unminifiedHashFn = function unminifiedHashFn(str /* : string */, key /* : string */) {\n    return String(key) + '_' + String(hashString(str));\n};\n\n// StyleSheet.create is in a hot path so we want to keep as much logic out of it\n// as possible. So, we figure out which hash function to use once, and only\n// switch it out via minify() as necessary.\n//\n// This is in an exported function to make it easier to test.\nvar initialHashFn = function initialHashFn() {\n    return process.env.NODE_ENV === 'production' ? hashString : unminifiedHashFn;\n};\n\nvar hashFn = initialHashFn();\n\nvar StyleSheet = {\n    create: function () {\n        function create(sheetDefinition /* : SheetDefinition */) /* : Object */{\n            var mappedSheetDefinition = {};\n            var keys = Object.keys(sheetDefinition);\n\n            for (var i = 0; i < keys.length; i += 1) {\n                var key = keys[i];\n                var val = sheetDefinition[key];\n                var stringVal = JSON.stringify(val);\n\n                mappedSheetDefinition[key] = {\n                    _len: stringVal.length,\n                    _name: hashFn(stringVal, key),\n                    _definition: val\n                };\n            }\n\n            return mappedSheetDefinition;\n        }\n\n        return create;\n    }(),\n    rehydrate: function () {\n        function rehydrate() {\n            var renderedClassNames /* : string[] */ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n            addRenderedClassNames(renderedClassNames);\n        }\n\n        return rehydrate;\n    }()\n};\n\n/**\n * Utilities for using Aphrodite server-side.\n *\n * This can be minified out in client-only bundles by replacing `typeof window`\n * with `\"object\"`, e.g. via Webpack's DefinePlugin:\n *\n *   new webpack.DefinePlugin({\n *     \"typeof window\": JSON.stringify(\"object\")\n *   })\n */\nvar StyleSheetServer = typeof window !== 'undefined' ? null : {\n    renderStatic: function () {\n        function renderStatic(renderFunc /* : RenderFunction */) {\n            reset();\n            startBuffering();\n            var html = renderFunc();\n            var cssContent = flushToString();\n\n            return {\n                html: html,\n                css: {\n                    content: cssContent,\n                    renderedClassNames: getRenderedClassNames()\n                }\n            };\n        }\n\n        return renderStatic;\n    }()\n};\n\n/**\n * Utilities for using Aphrodite in tests.\n *\n * Not meant to be used in production.\n */\nvar StyleSheetTestUtils = process.env.NODE_ENV === 'production' ? null : {\n    /**\n    * Prevent styles from being injected into the DOM.\n    *\n    * This is useful in situations where you'd like to test rendering UI\n    * components which use Aphrodite without any of the side-effects of\n    * Aphrodite happening. Particularly useful for testing the output of\n    * components when you have no DOM, e.g. testing in Node without a fake DOM.\n    *\n    * Should be paired with a subsequent call to\n    * clearBufferAndResumeStyleInjection.\n    */\n    suppressStyleInjection: function () {\n        function suppressStyleInjection() {\n            reset();\n            startBuffering();\n        }\n\n        return suppressStyleInjection;\n    }(),\n\n\n    /**\n    * Opposite method of preventStyleInject.\n    */\n    clearBufferAndResumeStyleInjection: function () {\n        function clearBufferAndResumeStyleInjection() {\n            reset();\n        }\n\n        return clearBufferAndResumeStyleInjection;\n    }(),\n\n\n    /**\n    * Returns a string of buffered styles which have not been flushed\n    *\n    * @returns {string}  Buffer of styles which have not yet been flushed.\n    */\n    getBufferedStyles: function () {\n        function getBufferedStyles$$1() {\n            return getBufferedStyles();\n        }\n\n        return getBufferedStyles$$1;\n    }()\n};\n\n/**\n * Generate the Aphrodite API exports, with given `selectorHandlers` and\n * `useImportant` state.\n */\nfunction makeExports(useImportant /* : boolean */\n, selectorHandlers /* : SelectorHandler[] */\n) {\n    return {\n        StyleSheet: Object.assign({}, StyleSheet, {\n\n            /**\n             * Returns a version of the exports of Aphrodite (i.e. an object\n             * with `css` and `StyleSheet` properties) which have some\n             * extensions included.\n             *\n             * @param {Array.<Object>} extensions: An array of extensions to\n             *     add to this instance of Aphrodite. Each object should have a\n             *     single property on it, defining which kind of extension to\n             *     add.\n             * @param {SelectorHandler} [extensions[].selectorHandler]: A\n             *     selector handler extension. See `defaultSelectorHandlers` in\n             *     generate.js.\n             *\n             * @returns {Object} An object containing the exports of the new\n             *     instance of Aphrodite.\n             */\n            extend: function () {\n                function extend(extensions /* : Extension[] */) {\n                    var extensionSelectorHandlers = extensions\n                    // Pull out extensions with a selectorHandler property\n                    .map(function (extension) {\n                        return extension.selectorHandler;\n                    })\n                    // Remove nulls (i.e. extensions without a selectorHandler\n                    // property).\n                    .filter(function (handler) {\n                        return handler;\n                    });\n\n                    return makeExports(useImportant, selectorHandlers.concat(extensionSelectorHandlers));\n                }\n\n                return extend;\n            }()\n        }),\n\n        StyleSheetServer: StyleSheetServer,\n        StyleSheetTestUtils: StyleSheetTestUtils,\n\n        minify: function () {\n            function minify(shouldMinify /* : boolean */) {\n                hashFn = shouldMinify ? hashString : unminifiedHashFn;\n            }\n\n            return minify;\n        }(),\n        css: function () {\n            function css() /* : MaybeSheetDefinition[] */{\n                for (var _len = arguments.length, styleDefinitions = Array(_len), _key = 0; _key < _len; _key++) {\n                    styleDefinitions[_key] = arguments[_key];\n                }\n\n                return injectAndGetClassName(useImportant, styleDefinitions, selectorHandlers);\n            }\n\n            return css;\n        }()\n    };\n}\n\nvar useImportant = true; // Add !important to all style definitions\n\nvar Aphrodite = makeExports(useImportant, defaultSelectorHandlers);\n\nvar StyleSheet$1 = Aphrodite.StyleSheet,\n    StyleSheetServer$1 = Aphrodite.StyleSheetServer,\n    StyleSheetTestUtils$1 = Aphrodite.StyleSheetTestUtils,\n    css = Aphrodite.css,\n    minify = Aphrodite.minify;\n\nexport { StyleSheet$1 as StyleSheet, StyleSheetServer$1 as StyleSheetServer, StyleSheetTestUtils$1 as StyleSheetTestUtils, css, minify, flushToStyleTag };\n", "import {StyleSheet} from 'aphrodite'\n\nexport enum FontFamily {\n  MONOSPACE = '\"Source Code Pro\", Courier, monospace',\n}\n\nexport enum FontSize {\n  LABEL = 10,\n  TITLE = 12,\n  BIG_BUTTON = 36,\n}\n\nexport enum Sizes {\n  MINIMAP_HEIGHT = 100,\n  DETAIL_VIEW_HEIGHT = 150,\n  TOOLTIP_WIDTH_MAX = 900,\n  TOOLTIP_HEIGHT_MAX = 80,\n  SEPARATOR_HEIGHT = 2,\n  FRAME_HEIGHT = 20,\n  TOOLBAR_HEIGHT = 20,\n  TOOLBAR_TAB_HEIGHT = TOOLBAR_HEIGHT - SEPARATOR_HEIGHT,\n}\n\nexport enum Duration {\n  HOVER_CHANGE = '0.07s',\n}\n\nexport enum ZIndex {\n  PROFILE_SELECT = 1,\n  HOVERTIP = 2,\n}\n\nexport const commonStyle = StyleSheet.create({\n  fillY: {\n    height: '100%',\n  },\n  fillX: {\n    width: '100%',\n  },\n  hbox: {\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'relative',\n    overflow: 'hidden',\n  },\n  vbox: {\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'relative',\n    overflow: 'hidden',\n  },\n})\n", "import {Profile, Frame, CallTreeNode} from './profile'\nimport {Flamechart, FlamechartFrame} from './flamechart'\nimport {Rect, Vec2} from './math'\n\nexport enum FlamechartType {\n  CHRONO_FLAME_CHART,\n  LEFT_HEAVY_FLAME_GRAPH,\n}\n\n// In previous versions of speedscope, searching for strings within the profile\n// was done using fuzzy finding. As it turns out, this was surprising behavior\n// to most people, so we've switched to a more traditional substring search that\n// more closely mimics browser behavior.\n//\n// This is case insensitive for both the needle & the haystack. This means\n// searching for \"hello\" will match \"Hello\" and \"HELLO\", and searching for\n// \"HELLO\" will match both \"hello\" and \"Hello\". This matches Chrome's behavior\n// as far as I can tell.\n//\n// See https://github.com/jlfwong/speedscope/issues/352\n//\n// Return ranges for all matches in order to highlight them.\nexport function exactMatchStrings(text: string, pattern: string): [number, number][] {\n  const lowerText = text.toLocaleLowerCase()\n  const lowerPattern = pattern.toLocaleLowerCase()\n\n  let lastIndex = 0\n  const matchedRanges: Array<[number, number]> = []\n  while (true) {\n    let index = lowerText.indexOf(lowerPattern, lastIndex)\n    if (index === -1) {\n      return matchedRanges\n    }\n    matchedRanges.push([index, index + pattern.length])\n    lastIndex = index + pattern.length\n  }\n}\n\n// A utility class for storing cached search results to avoid recomputation when\n// the search results & profile did not change.\nexport class ProfileSearchResults {\n  constructor(\n    readonly profile: Profile,\n    readonly searchQuery: string,\n  ) {}\n\n  private matches: Map<Frame, [number, number][] | null> | null = null\n  getMatchForFrame(frame: Frame): [number, number][] | null {\n    if (!this.matches) {\n      this.matches = new Map()\n      this.profile.forEachFrame(frame => {\n        const match = exactMatchStrings(frame.name, this.searchQuery)\n        this.matches!.set(frame, match.length === 0 ? null : match)\n      })\n    }\n    return this.matches.get(frame) || null\n  }\n}\n\nexport interface FlamechartSearchMatch {\n  configSpaceBounds: Rect\n  node: CallTreeNode\n}\n\ninterface CachedFlamechartResult {\n  matches: FlamechartSearchMatch[]\n  indexForNode: Map<CallTreeNode, number>\n}\n\nexport class FlamechartSearchResults {\n  constructor(\n    readonly flamechart: Flamechart,\n    readonly profileResults: ProfileSearchResults,\n  ) {}\n\n  private matches: CachedFlamechartResult | null = null\n  private getResults(): CachedFlamechartResult {\n    if (this.matches == null) {\n      const matches: FlamechartSearchMatch[] = []\n      const indexForNode = new Map<CallTreeNode, number>()\n      const visit = (frame: FlamechartFrame, depth: number) => {\n        const {node} = frame\n        if (this.profileResults.getMatchForFrame(node.frame)) {\n          const configSpaceBounds = new Rect(\n            new Vec2(frame.start, depth),\n            new Vec2(frame.end - frame.start, 1),\n          )\n          indexForNode.set(node, matches.length)\n          matches.push({configSpaceBounds, node})\n        }\n\n        frame.children.forEach(child => {\n          visit(child, depth + 1)\n        })\n      }\n\n      const layers = this.flamechart.getLayers()\n      if (layers.length > 0) {\n        layers[0].forEach(frame => visit(frame, 0))\n      }\n\n      this.matches = {matches, indexForNode}\n    }\n    return this.matches\n  }\n\n  count(): number {\n    return this.getResults().matches.length\n  }\n\n  indexOf(node: CallTreeNode): number | null {\n    const result = this.getResults().indexForNode.get(node)\n    return result === undefined ? null : result\n  }\n\n  at(index: number): FlamechartSearchMatch {\n    const matches = this.getResults().matches\n    if (index < 0 || index >= matches.length) {\n      throw new Error(`Index ${index} out of bounds in list of ${matches.length} matches.`)\n    }\n    return matches[index]\n  }\n}\n", "import {StyleSheet, css} from 'aphrodite'\nimport {h, createContext, ComponentChildren, Fragment} from 'preact'\nimport {useCallback, useRef, useEffect, useMemo} from 'preact/hooks'\nimport {memo} from 'preact/compat'\nimport {Sizes, FontSize} from './style'\nimport {ProfileSearchResults} from '../lib/profile-search'\nimport {Profile} from '../lib/profile'\nimport {useActiveProfileState} from '../app-state/active-profile-state'\nimport {useTheme, withTheme} from './themes/theme'\nimport {searchIsActiveAtom, searchQueryAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\nfunction stopPropagation(ev: Event) {\n  ev.stopPropagation()\n}\n\nexport const ProfileSearchContext = createContext<ProfileSearchResults | null>(null)\n\nexport const ProfileSearchContextProvider = ({children}: {children: ComponentChildren}) => {\n  const activeProfileState = useActiveProfileState()\n  const profile: Profile | null = activeProfileState ? activeProfileState.profile : null\n  const searchIsActive = useAtom(searchIsActiveAtom)\n  const searchQuery = useAtom(searchQueryAtom)\n\n  const searchResults = useMemo(() => {\n    if (!profile || !searchIsActive || searchQuery.length === 0) {\n      return null\n    }\n    return new ProfileSearchResults(profile, searchQuery)\n  }, [searchIsActive, searchQuery, profile])\n\n  return (\n    <ProfileSearchContext.Provider value={searchResults}>{children}</ProfileSearchContext.Provider>\n  )\n}\n\ninterface SearchViewProps {\n  resultIndex: number | null\n  numResults: number | null\n  selectNext: () => void\n  selectPrev: () => void\n}\n\nexport const SearchView = memo(\n  ({numResults, resultIndex, selectNext, selectPrev}: SearchViewProps) => {\n    const theme = useTheme()\n    const style = getStyle(theme)\n    const searchIsActive = useAtom(searchIsActiveAtom)\n    const searchQuery = useAtom(searchQueryAtom)\n    const setSearchQuery = searchQueryAtom.set\n    const setSearchIsActive = searchIsActiveAtom.set\n\n    const onInput = useCallback(\n      (ev: Event) => {\n        const value = (ev.target as HTMLInputElement).value\n        setSearchQuery(value)\n      },\n      [setSearchQuery],\n    )\n\n    const inputRef = useRef<HTMLInputElement | null>(null)\n\n    const close = useCallback(() => setSearchIsActive(false), [setSearchIsActive])\n\n    const selectPrevOrNextResult = useCallback(\n      (ev: KeyboardEvent) => {\n        if (ev.shiftKey) {\n          selectPrev()\n        } else {\n          selectNext()\n        }\n      },\n      [selectPrev, selectNext],\n    )\n\n    const onKeyDown = useCallback(\n      (ev: KeyboardEvent) => {\n        ev.stopPropagation()\n\n        // Hitting Esc should close the search box\n        if (ev.key === 'Escape') {\n          setSearchIsActive(false)\n        }\n\n        if (ev.key === 'Enter') {\n          selectPrevOrNextResult(ev)\n        }\n\n        if (ev.key == 'f' && (ev.metaKey || ev.ctrlKey)) {\n          if (inputRef.current) {\n            // If the input is already focused, select all\n            inputRef.current.select()\n          }\n\n          // It seems like when an input is focused, the browser find menu pops\n          // up without this line. It seems like it's not sufficient to only\n          // preventDefault in the window keydown handler.\n          ev.preventDefault()\n        }\n      },\n      [setSearchIsActive, selectPrevOrNextResult],\n    )\n\n    useEffect(() => {\n      const onWindowKeyDown = (ev: KeyboardEvent) => {\n        // Cmd+F or Ctrl+F open the search box\n        if (ev.key == 'f' && (ev.metaKey || ev.ctrlKey)) {\n          // Prevent the browser's search menu from appearing\n          ev.preventDefault()\n\n          if (inputRef.current) {\n            // If the search box is already open, then re-select it immediately.\n            inputRef.current.select()\n          } else {\n            // Otherwise, focus the search, then focus the input on the next\n            // frame, when the search box should have mounted.\n            setSearchIsActive(true)\n            requestAnimationFrame(() => {\n              if (inputRef.current) {\n                inputRef.current.select()\n              }\n            })\n          }\n        }\n      }\n\n      window.addEventListener('keydown', onWindowKeyDown)\n      return () => {\n        window.removeEventListener('keydown', onWindowKeyDown)\n      }\n    }, [setSearchIsActive])\n\n    if (!searchIsActive) return null\n\n    return (\n      <div className={css(style.searchView)}>\n        <span className={css(style.icon)}>\uD83D\uDD0D</span>\n        <span className={css(style.inputContainer)}>\n          <input\n            className={css(style.input)}\n            value={searchQuery}\n            onInput={onInput}\n            onKeyDown={onKeyDown}\n            onKeyUp={stopPropagation}\n            onKeyPress={stopPropagation}\n            ref={inputRef}\n          />\n        </span>\n        {numResults != null && (\n          <Fragment>\n            <span className={css(style.resultCount)}>\n              {resultIndex == null ? '?' : resultIndex + 1}/{numResults}\n            </span>\n            <button className={css(style.icon, style.button)} onClick={selectPrev}>\n              \u2B05\uFE0F\n            </button>\n            <button className={css(style.icon, style.button)} onClick={selectNext}>\n              \u27A1\uFE0F\n            </button>\n          </Fragment>\n        )}\n        <svg\n          className={css(style.icon)}\n          onClick={close}\n          width=\"16\"\n          height=\"16\"\n          viewBox=\"0 0 16 16\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M4.99999 4.16217L11.6427 10.8048M11.6427 4.16217L4.99999 10.8048\"\n            stroke={theme.altFgSecondaryColor}\n          />\n        </svg>\n      </div>\n    )\n  },\n)\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    searchView: {\n      position: 'absolute',\n      top: 0,\n      right: 10,\n      height: Sizes.TOOLBAR_HEIGHT,\n      width: 16 * 13,\n      borderWidth: 2,\n      borderColor: theme.altFgPrimaryColor,\n      borderStyle: 'solid',\n      fontSize: FontSize.LABEL,\n      boxSizing: 'border-box',\n      background: theme.altBgSecondaryColor,\n      color: theme.altFgPrimaryColor,\n      display: 'flex',\n      alignItems: 'center',\n    },\n    inputContainer: {\n      flexShrink: 1,\n      flexGrow: 1,\n      display: 'flex',\n    },\n    input: {\n      width: '100%',\n      border: 'none',\n      background: 'none',\n      fontSize: FontSize.LABEL,\n      lineHeight: `${Sizes.TOOLBAR_HEIGHT}px`,\n      color: theme.altFgPrimaryColor,\n      ':focus': {\n        border: 'none',\n        outline: 'none',\n      },\n      '::selection': {\n        color: theme.altFgPrimaryColor,\n        background: theme.selectionPrimaryColor,\n      },\n    },\n    resultCount: {\n      verticalAlign: 'middle',\n    },\n    icon: {\n      flexShrink: 0,\n      verticalAlign: 'middle',\n      height: '100%',\n      margin: '0px 2px 0px 2px',\n      fontSize: FontSize.LABEL,\n    },\n    button: {\n      display: 'inline',\n      background: 'none',\n      border: 'none',\n      padding: 0,\n      ':focus': {\n        outline: 'none',\n      },\n    },\n  }),\n)\n", "// Returns `input` with hex escapes expanded (e.g. `\\20` becomes ` `.)\n//\n\nimport {Frame, SymbolRemapper} from './profile'\n\n// NOTE: This will fail to ignore escaped backslahes (e.g. `\\\\20`).\nfunction unescapeHex(input: string): string {\n  return input.replace(/\\\\([a-fA-F0-9]{2})/g, (_match, group) => {\n    const scalar = parseInt(group, 16)\n    return String.fromCharCode(scalar)\n  })\n}\n\n// This imports symbol maps generated by emscripten using the \"--emit-symbol-map\" flag.\n// It allows you to visualize a profile captured in a release build as long as you also\n// have the associated symbol map. To do this, first drop the profile into speedscope\n// and then drop the symbol map. After the second drop, the symbols will be remapped to\n// their original names.\nexport function importEmscriptenSymbolMap(contents: string): SymbolRemapper | null {\n  const lines = contents.split('\\n')\n  if (!lines.length) return null\n\n  // Remove a trailing blank line if there is one\n  if (lines[lines.length - 1] === '') lines.pop()\n  if (!lines.length) return null\n\n  const map = new Map<string, string>()\n  const intRegex = /^(\\d+):(.+)$/\n  const idRegex = /^([\\$\\w]+):([\\$\\w-]+)$/\n\n  for (const line of lines) {\n    // Match lines like \"103:__ZN8tinyxml210XMLCommentD0Ev\"\n    const intMatch = intRegex.exec(line)\n    if (intMatch) {\n      map.set(`wasm-function[${intMatch[1]}]`, unescapeHex(intMatch[2]))\n      continue\n    }\n\n    // Match lines like \"u6:__ZN8tinyxml210XMLCommentD0Ev\"\n    const idMatch = idRegex.exec(line)\n    if (idMatch) {\n      map.set(idMatch[1], unescapeHex(idMatch[2]))\n      continue\n    }\n\n    return null\n  }\n\n  return (frame: Frame) => {\n    if (!map.has(frame.name)) {\n      return null\n    }\n\n    return {name: map.get(frame.name)}\n  }\n}\n", "import {Frame, CallTreeNode} from './profile'\n\nimport {lastOf} from './utils'\nimport {clamp, Rect, Vec2} from './math'\n\nexport interface FlamechartFrame {\n  node: CallTreeNode\n  start: number\n  end: number\n  parent: FlamechartFrame | null\n  children: FlamechartFrame[]\n}\n\ntype StackLayer = FlamechartFrame[]\n\ninterface FlamechartDataSource {\n  getTotalWeight(): number\n\n  formatValue(v: number): string\n\n  forEachCall(\n    openFrame: (node: CallTreeNode, value: number) => void,\n    closeFrame: (node: CallTreeNode, value: number) => void,\n  ): void\n\n  getColorBucketForFrame(f: Frame): number\n}\n\nexport class Flamechart {\n  // Bottom to top\n  private layers: StackLayer[] = []\n  private totalWeight: number = 0\n  private minFrameWidth: number = 1\n\n  getTotalWeight() {\n    return this.totalWeight\n  }\n  getLayers() {\n    return this.layers\n  }\n  getColorBucketForFrame(frame: Frame) {\n    return this.source.getColorBucketForFrame(frame)\n  }\n  getMinFrameWidth() {\n    return this.minFrameWidth\n  }\n  formatValue(v: number) {\n    return this.source.formatValue(v)\n  }\n\n  getClampedViewportWidth(viewportWidth: number) {\n    const maxWidth = this.getTotalWeight()\n\n    // In order to avoid floating point error, we cap the maximum zoom. In\n    // particular, it's important that at the maximum zoom level, the total\n    // trace size + a viewport width is not equal to the trace size due to\n    // floating point rounding.\n    //\n    // For instance, if the profile's total weight is 2^60, and the viewport\n    // size is 1, trying to move one viewport width right will result in no\n    // change because 2^60 + 1 = 2^60 in floating point arithmetic. JavaScript\n    // numbers are 64 bit floats, and therefore have 53 mantissa bits. You can\n    // see this for yourself in the console. Try:\n    //\n    //   > Math.pow(2, 60) + 1 === Math.pow(2, 60)\n    //   true\n    //   > Math.pow(2, 53) + 1 === Math.pow(2, 53)\n    //   true\n    //   > Math.pow(2, 52) + 1 === Math.pow(2, 52)\n    //   false\n    //\n    // We use 2^40 as a cap instead, since we want to be able to make small\n    // adjustments within a viewport width.\n    //\n    // For reference, this will still allow you to zoom until 1 nanosecond fills\n    // the screen in a profile with a duration of over 18 minutes.\n    //\n    //   > Math.pow(2, 40) / (60 * Math.pow(10, 9))\n    //   18.325193796266667\n    //\n    const maxZoom = Math.pow(2, 40)\n\n    // In addition to capping zoom to avoid floating point error, we further cap\n    // zoom to avoid letting you zoom in so that the smallest element more than\n    // fills the screen, since that probably isn't useful. The final zoom cap is\n    // determined by the minimum zoom of either 2^40x zoom or the necessary zoom\n    // for the smallest frame to fill the screen three times.\n    const minWidth = clamp(3 * this.getMinFrameWidth(), maxWidth / maxZoom, maxWidth)\n\n    return clamp(viewportWidth, minWidth, maxWidth)\n  }\n\n  // Given a desired config-space viewport rectangle, clamp the rectangle so\n  // that it fits within the given flamechart. This prevents the viewport from\n  // extending past the bounds of the flamechart or zooming in too far.\n  getClampedConfigSpaceViewportRect({\n    configSpaceViewportRect,\n    renderInverted,\n  }: {\n    configSpaceViewportRect: Rect\n    renderInverted?: boolean\n  }) {\n    const configSpaceSize = new Vec2(this.getTotalWeight(), this.getLayers().length)\n    const width = this.getClampedViewportWidth(configSpaceViewportRect.size.x)\n    const size = configSpaceViewportRect.size.withX(width)\n    const origin = Vec2.clamp(\n      configSpaceViewportRect.origin,\n      new Vec2(0, renderInverted ? 0 : -1),\n      Vec2.max(Vec2.zero, configSpaceSize.minus(size).plus(new Vec2(0, 1))),\n    )\n    return new Rect(origin, configSpaceViewportRect.size.withX(width))\n  }\n\n  constructor(private source: FlamechartDataSource) {\n    const stack: FlamechartFrame[] = []\n    const openFrame = (node: CallTreeNode, value: number) => {\n      const parent = lastOf(stack)\n      const frame: FlamechartFrame = {\n        node,\n        parent,\n        children: [],\n        start: value,\n        end: value,\n      }\n      if (parent) {\n        parent.children.push(frame)\n      }\n      stack.push(frame)\n    }\n\n    this.minFrameWidth = Infinity\n    const closeFrame = (node: CallTreeNode, value: number) => {\n      console.assert(stack.length > 0)\n      const stackTop = stack.pop()!\n      stackTop.end = value\n      if (stackTop.end - stackTop.start === 0) return\n      const layerIndex = stack.length\n      while (this.layers.length <= layerIndex) this.layers.push([])\n      this.layers[layerIndex].push(stackTop)\n      this.minFrameWidth = Math.min(this.minFrameWidth, stackTop.end - stackTop.start)\n    }\n\n    this.totalWeight = source.getTotalWeight()\n    source.forEachCall(openFrame, closeFrame)\n\n    if (!isFinite(this.minFrameWidth)) this.minFrameWidth = 1\n  }\n}\n", "import {Flamechart} from '../lib/flamechart'\nimport {RectangleBatch, RectangleBatchRenderer} from './rectangle-batch-renderer'\nimport {Vec2, Rect, AffineTransform} from '../lib/math'\nimport {Color} from '../lib/color'\nimport {KeyedSet} from '../lib/utils'\nimport {RowAtlas} from './row-atlas'\nimport {Graphics} from './graphics'\nimport {FlamechartColorPassRenderer} from './flamechart-color-pass-renderer'\nimport {renderInto} from './utils'\n\nconst MAX_BATCH_SIZE = 10000\n\ninterface RangeTreeNode {\n  getBounds(): Rect\n  getRectCount(): number\n  getChildren(): RangeTreeNode[]\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void): void\n}\n\nclass RangeTreeLeafNode implements RangeTreeNode {\n  private children: RangeTreeNode[] = []\n\n  constructor(\n    private batch: RectangleBatch,\n    private bounds: Rect,\n    private numPrecedingRectanglesInRow: number,\n  ) {}\n\n  getBatch() {\n    return this.batch\n  }\n  getBounds() {\n    return this.bounds\n  }\n  getRectCount() {\n    return this.batch.getRectCount()\n  }\n  getChildren() {\n    return this.children\n  }\n  getParity() {\n    return this.numPrecedingRectanglesInRow % 2\n  }\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void) {\n    if (!this.bounds.hasIntersectionWith(configSpaceBounds)) return\n    cb(this)\n  }\n}\n\nclass RangeTreeInteriorNode implements RangeTreeNode {\n  private rectCount: number = 0\n  private bounds: Rect\n  constructor(private children: RangeTreeNode[]) {\n    if (children.length === 0) {\n      throw new Error('Empty interior node')\n    }\n    let minLeft = Infinity\n    let maxRight = -Infinity\n    let minTop = Infinity\n    let maxBottom = -Infinity\n    for (let child of children) {\n      this.rectCount += child.getRectCount()\n      const bounds = child.getBounds()\n      minLeft = Math.min(minLeft, bounds.left())\n      maxRight = Math.max(maxRight, bounds.right())\n      minTop = Math.min(minTop, bounds.top())\n      maxBottom = Math.max(maxBottom, bounds.bottom())\n    }\n    this.bounds = new Rect(\n      new Vec2(minLeft, minTop),\n      new Vec2(maxRight - minLeft, maxBottom - minTop),\n    )\n  }\n\n  getBounds() {\n    return this.bounds\n  }\n  getRectCount() {\n    return this.rectCount\n  }\n  getChildren() {\n    return this.children\n  }\n\n  forEachLeafNodeWithinBounds(configSpaceBounds: Rect, cb: (leaf: RangeTreeLeafNode) => void) {\n    if (!this.bounds.hasIntersectionWith(configSpaceBounds)) return\n    for (let child of this.children) {\n      child.forEachLeafNodeWithinBounds(configSpaceBounds, cb)\n    }\n  }\n}\n\nexport interface FlamechartRendererProps {\n  configSpaceSrcRect: Rect\n  physicalSpaceDstRect: Rect\n  renderOutlines: boolean\n}\n\ninterface FlamechartRowAtlasKeyInfo {\n  stackDepth: number\n  zoomLevel: number\n  index: number\n}\n\nexport class FlamechartRowAtlasKey {\n  readonly stackDepth: number\n  readonly zoomLevel: number\n  readonly index: number\n\n  get key() {\n    return `${this.stackDepth}_${this.index}_${this.zoomLevel}`\n  }\n  private constructor(options: FlamechartRowAtlasKeyInfo) {\n    this.stackDepth = options.stackDepth\n    this.zoomLevel = options.zoomLevel\n    this.index = options.index\n  }\n  static getOrInsert(set: KeyedSet<FlamechartRowAtlasKey>, info: FlamechartRowAtlasKeyInfo) {\n    return set.getOrInsert(new FlamechartRowAtlasKey(info))\n  }\n}\n\nexport interface FlamechartRendererOptions {\n  inverted: boolean\n}\n\nexport class FlamechartRenderer {\n  private layers: RangeTreeNode[] = []\n\n  constructor(\n    private gl: Graphics.Context,\n    private rowAtlas: RowAtlas<FlamechartRowAtlasKey>,\n    private flamechart: Flamechart,\n    private rectangleBatchRenderer: RectangleBatchRenderer,\n    private colorPassRenderer: FlamechartColorPassRenderer,\n    private options: FlamechartRendererOptions = {inverted: false},\n  ) {\n    const nLayers = flamechart.getLayers().length\n    for (let stackDepth = 0; stackDepth < nLayers; stackDepth++) {\n      const leafNodes: RangeTreeLeafNode[] = []\n      const y = options.inverted ? nLayers - 1 - stackDepth : stackDepth\n\n      let minLeft = Infinity\n      let maxRight = -Infinity\n      let batch = new RectangleBatch(this.gl)\n\n      let rectCount = 0\n\n      const layer = flamechart.getLayers()[stackDepth]\n\n      for (let i = 0; i < layer.length; i++) {\n        const frame = layer[i]\n        if (batch.getRectCount() >= MAX_BATCH_SIZE) {\n          leafNodes.push(\n            new RangeTreeLeafNode(\n              batch,\n              new Rect(new Vec2(minLeft, y), new Vec2(maxRight - minLeft, 1)),\n              rectCount,\n            ),\n          )\n          minLeft = Infinity\n          maxRight = -Infinity\n          batch = new RectangleBatch(this.gl)\n        }\n        const configSpaceBounds = new Rect(\n          new Vec2(frame.start, y),\n          new Vec2(frame.end - frame.start, 1),\n        )\n        minLeft = Math.min(minLeft, configSpaceBounds.left())\n        maxRight = Math.max(maxRight, configSpaceBounds.right())\n\n        // We'll use the red channel to indicate the index to allow\n        // us to separate adjacent rectangles within a row from one another,\n        // the green channel to indicate the row,\n        // and the blue channel to indicate the color bucket to render.\n        // We add one to each so we have zero reserved for the background color.\n        const color = new Color(\n          (1 + (i % 255)) / 256,\n          (1 + (stackDepth % 255)) / 256,\n          (1 + this.flamechart.getColorBucketForFrame(frame.node.frame)) / 256,\n        )\n        batch.addRect(configSpaceBounds, color)\n        rectCount++\n      }\n\n      if (batch.getRectCount() > 0) {\n        leafNodes.push(\n          new RangeTreeLeafNode(\n            batch,\n            new Rect(new Vec2(minLeft, y), new Vec2(maxRight - minLeft, 1)),\n            rectCount,\n          ),\n        )\n      }\n\n      // TODO(jlfwong): Making this into a binary tree\n      // range than a tree of always-height-two might make this run faster\n      this.layers.push(new RangeTreeInteriorNode(leafNodes))\n    }\n  }\n\n  private rectInfoTexture: Graphics.Texture | null = null\n  getRectInfoTexture(width: number, height: number): Graphics.Texture {\n    if (this.rectInfoTexture) {\n      const texture = this.rectInfoTexture\n      if (texture.width != width || texture.height != height) {\n        texture.resize(width, height)\n      }\n    } else {\n      this.rectInfoTexture = this.gl.createTexture(\n        Graphics.TextureFormat.NEAREST_CLAMP,\n        width,\n        height,\n      )\n    }\n    return this.rectInfoTexture\n  }\n\n  private rectInfoRenderTarget: Graphics.RenderTarget | null = null\n  getRectInfoRenderTarget(width: number, height: number): Graphics.RenderTarget {\n    const texture = this.getRectInfoTexture(width, height)\n    if (this.rectInfoRenderTarget) {\n      if (this.rectInfoRenderTarget.texture != texture) {\n        this.rectInfoRenderTarget.texture.free()\n        this.rectInfoRenderTarget.setColor(texture)\n      }\n    }\n    if (!this.rectInfoRenderTarget) {\n      this.rectInfoRenderTarget = this.gl.createRenderTarget(texture)\n    }\n    return this.rectInfoRenderTarget\n  }\n\n  free() {\n    if (this.rectInfoRenderTarget) {\n      this.rectInfoRenderTarget.free()\n    }\n    if (this.rectInfoTexture) {\n      this.rectInfoTexture.free()\n    }\n  }\n\n  private atlasKeys = new KeyedSet<FlamechartRowAtlasKey>()\n\n  configSpaceBoundsForKey(key: FlamechartRowAtlasKey): Rect {\n    const {stackDepth, zoomLevel, index} = key\n    const configSpaceContentWidth = this.flamechart.getTotalWeight()\n\n    const width = configSpaceContentWidth / Math.pow(2, zoomLevel)\n\n    const nLayers = this.flamechart.getLayers().length\n    const y = this.options.inverted ? nLayers - 1 - stackDepth : stackDepth\n    return new Rect(new Vec2(width * index, y), new Vec2(width, 1))\n  }\n\n  render(props: FlamechartRendererProps) {\n    const {configSpaceSrcRect, physicalSpaceDstRect} = props\n\n    const atlasKeysToRender: FlamechartRowAtlasKey[] = []\n\n    // We want to render the lowest resolution we can while still guaranteeing that the\n    // atlas line is higher resolution than its corresponding destination rectangle on\n    // the screen.\n    const configToPhysical = AffineTransform.betweenRects(configSpaceSrcRect, physicalSpaceDstRect)\n    if (configSpaceSrcRect.isEmpty()) {\n      // Prevent an infinite loop\n      return\n    }\n\n    let zoomLevel = 0\n    while (true) {\n      const key = FlamechartRowAtlasKey.getOrInsert(this.atlasKeys, {\n        stackDepth: 0,\n        zoomLevel,\n        index: 0,\n      })\n      const configSpaceBounds = this.configSpaceBoundsForKey(key)\n      const physicalBounds = configToPhysical.transformRect(configSpaceBounds)\n      if (physicalBounds.width() < this.rowAtlas.getResolution()) {\n        break\n      }\n      zoomLevel++\n    }\n\n    const top = Math.max(0, Math.floor(configSpaceSrcRect.top()))\n    const bottom = Math.min(this.layers.length, Math.ceil(configSpaceSrcRect.bottom()))\n\n    const configSpaceContentWidth = this.flamechart.getTotalWeight()\n    const numAtlasEntriesPerLayer = Math.pow(2, zoomLevel)\n    const left = Math.floor(\n      (numAtlasEntriesPerLayer * configSpaceSrcRect.left()) / configSpaceContentWidth,\n    )\n    const right = Math.ceil(\n      (numAtlasEntriesPerLayer * configSpaceSrcRect.right()) / configSpaceContentWidth,\n    )\n\n    const nLayers = this.flamechart.getLayers().length\n\n    for (let y = top; y < bottom; y++) {\n      for (let index = left; index <= right; index++) {\n        const stackDepth = this.options.inverted ? nLayers - 1 - y : y\n        const key = FlamechartRowAtlasKey.getOrInsert(this.atlasKeys, {\n          stackDepth,\n          zoomLevel,\n          index,\n        })\n        const configSpaceBounds = this.configSpaceBoundsForKey(key)\n        if (!configSpaceBounds.hasIntersectionWith(configSpaceSrcRect)) continue\n        atlasKeysToRender.push(key)\n      }\n    }\n\n    // TODO(jlfwong): When I switched the GL backend from regl to the port from\n    // evanw/sky, rendering uncached even for massive documents seemed fast\n    // enough. It's possible that the row cache is now unnecessary, but I'll\n    // leave it around for now since it's not causing issues.\n\n    const cacheCapacity = this.rowAtlas.getCapacity()\n    const keysToRenderCached = atlasKeysToRender.slice(0, cacheCapacity)\n    const keysToRenderUncached = atlasKeysToRender.slice(cacheCapacity)\n\n    // Fill the cache\n    this.rowAtlas.writeToAtlasIfNeeded(keysToRenderCached, (textureDstRect, key) => {\n      const configSpaceBounds = this.configSpaceBoundsForKey(key)\n      this.layers[key.stackDepth].forEachLeafNodeWithinBounds(configSpaceBounds, leaf => {\n        this.rectangleBatchRenderer.render({\n          batch: leaf.getBatch(),\n          configSpaceSrcRect: configSpaceBounds,\n          physicalSpaceDstRect: textureDstRect,\n        })\n      })\n    })\n\n    const renderTarget = this.getRectInfoRenderTarget(\n      physicalSpaceDstRect.width(),\n      physicalSpaceDstRect.height(),\n    )\n\n    renderInto(this.gl, renderTarget, () => {\n      this.gl.clear(new Graphics.Color(0, 0, 0, 0))\n\n      const viewportRect = new Rect(\n        Vec2.zero,\n        new Vec2(this.gl.viewport.width, this.gl.viewport.height),\n      )\n      const configToViewport = AffineTransform.betweenRects(configSpaceSrcRect, viewportRect)\n\n      // Render from the cache\n      for (let key of keysToRenderCached) {\n        const configSpaceSrcRect = this.configSpaceBoundsForKey(key)\n        this.rowAtlas.renderViaAtlas(key, configToViewport.transformRect(configSpaceSrcRect))\n      }\n\n      // Render entries that didn't make it into the cache\n      for (let key of keysToRenderUncached) {\n        const configSpaceBounds = this.configSpaceBoundsForKey(key)\n        const physicalBounds = configToViewport.transformRect(configSpaceBounds)\n        this.layers[key.stackDepth].forEachLeafNodeWithinBounds(configSpaceBounds, leaf => {\n          this.rectangleBatchRenderer.render({\n            batch: leaf.getBatch(),\n            configSpaceSrcRect: configSpaceBounds,\n            physicalSpaceDstRect: physicalBounds,\n          })\n        })\n      }\n    })\n\n    const rectInfoTexture = this.getRectInfoTexture(\n      physicalSpaceDstRect.width(),\n      physicalSpaceDstRect.height(),\n    )\n\n    this.colorPassRenderer.render({\n      rectInfoTexture,\n      srcRect: new Rect(Vec2.zero, new Vec2(rectInfoTexture.width, rectInfoTexture.height)),\n      dstRect: physicalSpaceDstRect,\n      renderOutlines: props.renderOutlines,\n    })\n  }\n}\n", "import {StyleSheet} from 'aphrodite'\nimport {FontSize, Sizes} from './style'\nimport {withTheme} from './themes/theme'\n\nexport const getFlamechartStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverCount: {\n      color: theme.weightColor,\n    },\n    fill: {\n      width: '100%',\n      height: '100%',\n      position: 'absolute',\n      left: 0,\n      top: 0,\n    },\n    minimap: {\n      height: Sizes.MINIMAP_HEIGHT,\n      borderBottom: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n    },\n    panZoomView: {\n      flex: 1,\n    },\n\n    detailView: {\n      display: 'grid',\n      height: Sizes.DETAIL_VIEW_HEIGHT,\n      overflow: 'hidden',\n      gridTemplateColumns: '120px 120px 1fr',\n      gridTemplateRows: 'repeat(4, 1fr)',\n      borderTop: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n      fontSize: FontSize.LABEL,\n      position: 'absolute',\n      background: theme.bgPrimaryColor,\n      width: '100vw',\n      bottom: 0,\n    },\n    stackTraceViewPadding: {\n      padding: 5,\n    },\n    stackTraceView: {\n      height: Sizes.DETAIL_VIEW_HEIGHT,\n      lineHeight: `${FontSize.LABEL + 2}px`,\n      overflow: 'auto',\n      '::-webkit-scrollbar': {\n        background: theme.bgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.fgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.bgPrimaryColor}`,\n        ':hover': {\n          background: theme.fgPrimaryColor,\n        },\n      },\n    },\n    stackLine: {\n      whiteSpace: 'nowrap',\n    },\n    stackFileLine: {\n      color: theme.fgSecondaryColor,\n    },\n    statsTable: {\n      display: 'grid',\n      gridTemplateColumns: '1fr 1fr',\n      gridTemplateRows: `repeat(3, ${FontSize.LABEL + 10}px)`,\n      gridGap: '1px 1px',\n      textAlign: 'center',\n      paddingRight: 1,\n    },\n    statsTableHeader: {\n      gridColumn: '1 / 3',\n    },\n    statsTableCell: {\n      position: 'relative',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n    },\n    thisInstanceCell: {\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    allInstancesCell: {\n      background: theme.selectionSecondaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    barDisplay: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      background: 'rgba(0, 0, 0, 0.2)',\n      width: '100%',\n    },\n  }),\n)\n", "import {findValueBisect} from './utils'\n\nexport const ELLIPSIS = '\\u2026'\n\n// NOTE: This blindly assumes the same result across contexts.\nconst measureTextCache = new Map<string, number>()\n\nlet lastDevicePixelRatio = -1\nexport function cachedMeasureTextWidth(ctx: CanvasRenderingContext2D, text: string): number {\n  if (window.devicePixelRatio !== lastDevicePixelRatio) {\n    // This cache is no longer valid!\n    measureTextCache.clear()\n    lastDevicePixelRatio = window.devicePixelRatio\n  }\n  if (!measureTextCache.has(text)) {\n    measureTextCache.set(text, ctx.measureText(text).width)\n  }\n  return measureTextCache.get(text)!\n}\n\ninterface TrimmedTextResult {\n  trimmedString: string\n  trimmedLength: number\n  prefixLength: number\n  suffixLength: number\n  originalLength: number\n  originalString: string\n}\n\n// Trim text, placing an ellipsis in the middle, with a slight bias towards\n// keeping text from the beginning rather than the end\nexport function buildTrimmedText(text: string, length: number): TrimmedTextResult {\n  if (text.length <= length) {\n    return {\n      trimmedString: text,\n      trimmedLength: text.length,\n      prefixLength: text.length,\n      suffixLength: 0,\n      originalString: text,\n      originalLength: text.length,\n    }\n  }\n\n  let prefixLength = Math.floor(length / 2)\n  const suffixLength = length - prefixLength - 1\n  const prefix = text.substring(0, prefixLength)\n  const suffix = text.substring(text.length - suffixLength, text.length)\n  const trimmedString = prefix + ELLIPSIS + suffix\n  return {\n    trimmedString,\n    trimmedLength: trimmedString.length,\n    prefixLength: prefix.length,\n    suffixLength: suffix.length,\n    originalString: text,\n    originalLength: text.length,\n  }\n}\n\n// Trim text to fit within the given number of pixels on the canvas\nexport function trimTextMid(\n  ctx: CanvasRenderingContext2D,\n  text: string,\n  maxWidth: number,\n): TrimmedTextResult {\n  if (cachedMeasureTextWidth(ctx, text) <= maxWidth) {\n    return buildTrimmedText(text, text.length)\n  }\n  const [lo] = findValueBisect(\n    0,\n    text.length,\n    n => {\n      return cachedMeasureTextWidth(ctx, buildTrimmedText(text, Math.floor(n)).trimmedString)\n    },\n    maxWidth,\n  )\n  return buildTrimmedText(text, Math.floor(lo))\n}\n\nenum IndexTypeInTrimmed {\n  IN_PREFIX,\n  IN_SUFFIX,\n  ELIDED,\n}\n\nfunction getIndexTypeInTrimmed(result: TrimmedTextResult, index: number): IndexTypeInTrimmed {\n  if (index < result.prefixLength) {\n    return IndexTypeInTrimmed.IN_PREFIX\n  } else if (index < result.originalLength - result.suffixLength) {\n    return IndexTypeInTrimmed.ELIDED\n  } else {\n    return IndexTypeInTrimmed.IN_SUFFIX\n  }\n}\n\nexport function remapRangesToTrimmedText(\n  trimmedText: TrimmedTextResult,\n  ranges: [number, number][],\n): [number, number][] {\n  // We intentionally don't just re-run fuzzy matching on the trimmed\n  // text, beacuse if the search query is \"helloWorld\", the frame name\n  // is \"application::helloWorld\", and that gets trimmed down to\n  // \"appl...oWorld\", we still want \"oWorld\" to be highlighted, even\n  // though the string \"appl...oWorld\" is not matched by the query\n  // \"helloWorld\".\n  //\n  // There's a weird case to consider here: what if the trimmedText is\n  // also matched by the query, but results in a different match than\n  // the original query? Consider, e.g. the search string of \"ab\". The\n  // string \"hello ab shabby\" will be matched at the first \"ab\", but\n  // may be trimmed to \"hello...shabby\". In this case, should we\n  // highlight the \"ab\" hidden by the ellipsis, or the \"ab\" in\n  // \"shabby\"? The code below highlights the ellipsis so that the\n  // matched characters don't change as you zoom in and out.\n\n  const rangesToHighlightInTrimmedText: [number, number][] = []\n  const lengthLoss = trimmedText.originalLength - trimmedText.trimmedLength\n  let highlightedEllipsis = false\n\n  for (let [origStart, origEnd] of ranges) {\n    let startPosType = getIndexTypeInTrimmed(trimmedText, origStart)\n    let endPosType = getIndexTypeInTrimmed(trimmedText, origEnd - 1)\n\n    switch (startPosType) {\n      case IndexTypeInTrimmed.IN_PREFIX: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // The entire range fits in the prefix. Add it unmodified.\n            rangesToHighlightInTrimmedText.push([origStart, origEnd])\n            break\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // The range starts in the prefix, but ends in the elided\n            // section. Add just the prefix + one char for the ellipsis.\n            rangesToHighlightInTrimmedText.push([origStart, trimmedText.prefixLength + 1])\n            highlightedEllipsis = true\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // The range crosses from the prefix to the suffix.\n            // Highlight everything including the ellipsis.\n            rangesToHighlightInTrimmedText.push([origStart, origEnd - lengthLoss])\n            break\n          }\n        }\n        break\n      }\n      case IndexTypeInTrimmed.ELIDED: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in elided and ends in prefix')\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // The match starts & ends within the elided section.\n            if (!highlightedEllipsis) {\n              rangesToHighlightInTrimmedText.push([\n                trimmedText.prefixLength,\n                trimmedText.prefixLength + 1,\n              ])\n              highlightedEllipsis = true\n            }\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // The match starts in elided, but ends in suffix.\n            if (highlightedEllipsis) {\n              rangesToHighlightInTrimmedText.push([\n                trimmedText.trimmedLength - trimmedText.suffixLength,\n                origEnd - lengthLoss,\n              ])\n            } else {\n              rangesToHighlightInTrimmedText.push([trimmedText.prefixLength, origEnd - lengthLoss])\n              highlightedEllipsis = true\n            }\n            break\n          }\n        }\n        break\n      }\n      case IndexTypeInTrimmed.IN_SUFFIX: {\n        switch (endPosType) {\n          case IndexTypeInTrimmed.IN_PREFIX: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in suffix and ends in prefix')\n          }\n          case IndexTypeInTrimmed.ELIDED: {\n            // This should be impossible\n            throw new Error('Unexpected highlight range starts in suffix and ends in elided')\n            break\n          }\n          case IndexTypeInTrimmed.IN_SUFFIX: {\n            // Match starts & ends in suffix\n            rangesToHighlightInTrimmedText.push([origStart - lengthLoss, origEnd - lengthLoss])\n            break\n          }\n        }\n        break\n      }\n    }\n  }\n  return rangesToHighlightInTrimmedText\n}\n", "import {h, Component} from 'preact'\nimport {css} from 'aphrodite'\nimport {Flamechart} from '../lib/flamechart'\nimport {Rect, Vec2, AffineTransform, clamp} from '../lib/math'\nimport {FlamechartRenderer} from '../gl/flamechart-renderer'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {FontFamily, FontSize, Sizes, commonStyle} from './style'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {cachedMeasureTextWidth} from '../lib/text-utils'\nimport {Color} from '../lib/color'\nimport {Theme} from './themes/theme'\nimport {minimapMousePositionAtom} from '../app-state'\n\ninterface FlamechartMinimapViewProps {\n  theme: Theme\n\n  flamechart: Flamechart\n  configSpaceViewportRect: Rect\n\n  canvasContext: CanvasContext\n  flamechartRenderer: FlamechartRenderer\n\n  transformViewport: (transform: AffineTransform) => void\n  setConfigSpaceViewportRect: (rect: Rect) => void\n}\n\nenum DraggingMode {\n  DRAW_NEW_VIEWPORT,\n  TRANSLATE_VIEWPORT,\n}\n\nexport class FlamechartMinimapView extends Component<FlamechartMinimapViewProps, {}> {\n  container: Element | null = null\n  containerRef = (element: Element | null) => {\n    this.container = element || null\n  }\n\n  overlayCanvas: HTMLCanvasElement | null = null\n  overlayCtx: CanvasRenderingContext2D | null = null\n\n  private physicalViewSize() {\n    return new Vec2(\n      this.overlayCanvas ? this.overlayCanvas.width : 0,\n      this.overlayCanvas ? this.overlayCanvas.height : 0,\n    )\n  }\n\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private minimapOrigin() {\n    return new Vec2(0, Sizes.FRAME_HEIGHT * window.devicePixelRatio)\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private configSpaceToPhysicalViewSpace() {\n    const minimapOrigin = this.minimapOrigin()\n\n    return AffineTransform.betweenRects(\n      new Rect(new Vec2(0, 0), this.configSpaceSize()),\n      new Rect(minimapOrigin, this.physicalViewSize().minus(minimapOrigin)),\n    )\n  }\n\n  private logicalToPhysicalViewSpace() {\n    return AffineTransform.withScale(new Vec2(window.devicePixelRatio, window.devicePixelRatio))\n  }\n\n  private windowToLogicalViewSpace() {\n    if (!this.container) return new AffineTransform()\n    const bounds = this.container.getBoundingClientRect()\n    return AffineTransform.withTranslation(new Vec2(-bounds.left, -bounds.top))\n  }\n\n  private renderRects() {\n    if (!this.container) return\n\n    // Hasn't resized yet -- no point in rendering yet\n    if (this.physicalViewSize().x < 2) return\n\n    this.props.canvasContext.renderBehind(this.container, () => {\n      this.props.flamechartRenderer.render({\n        configSpaceSrcRect: new Rect(new Vec2(0, 0), this.configSpaceSize()),\n        physicalSpaceDstRect: new Rect(\n          this.minimapOrigin(),\n          this.physicalViewSize().minus(this.minimapOrigin()),\n        ),\n        renderOutlines: false,\n      })\n\n      this.props.canvasContext.viewportRectangleRenderer.render({\n        configSpaceViewportRect: this.props.configSpaceViewportRect,\n        configSpaceToPhysicalViewSpace: this.configSpaceToPhysicalViewSpace(),\n      })\n    })\n  }\n\n  private renderOverlays() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n    const physicalViewSize = this.physicalViewSize()\n    ctx.clearRect(0, 0, physicalViewSize.x, physicalViewSize.y)\n\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n\n    const left = 0\n    const right = this.configSpaceSize().x\n\n    // TODO(jlfwong): There's a huge amount of code duplication here between\n    // this and the FlamechartView.renderOverlays(). Consolidate.\n\n    // We want about 10 gridlines to be visible, and want the unit to be\n    // 1eN, 2eN, or 5eN for some N\n\n    // Ideally, we want an interval every 100 logical screen pixels\n    const logicalToConfig = (\n      this.configSpaceToPhysicalViewSpace().inverted() || new AffineTransform()\n    ).times(this.logicalToPhysicalViewSpace())\n    const targetInterval = logicalToConfig.transformVector(new Vec2(200, 1)).x\n\n    const physicalViewSpaceFrameHeight = Sizes.FRAME_HEIGHT * window.devicePixelRatio\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const labelPaddingPx = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2\n\n    ctx.font = `${physicalViewSpaceFontSize}px/${physicalViewSpaceFrameHeight}px ${FontFamily.MONOSPACE}`\n    ctx.textBaseline = 'top'\n\n    const minInterval = Math.pow(10, Math.floor(Math.log10(targetInterval)))\n    let interval = minInterval\n\n    if (targetInterval / interval > 5) {\n      interval *= 5\n    } else if (targetInterval / interval > 2) {\n      interval *= 2\n    }\n\n    const theme = this.props.theme\n\n    {\n      ctx.fillStyle = Color.fromCSSHex(theme.bgPrimaryColor).withAlpha(0.8).toCSS()\n      ctx.fillRect(0, 0, physicalViewSize.x, physicalViewSpaceFrameHeight)\n      ctx.textBaseline = 'top'\n\n      for (let x = Math.ceil(left / interval) * interval; x < right; x += interval) {\n        // TODO(jlfwong): Ensure that labels do not overlap\n        const pos = Math.round(configToPhysical.transformPosition(new Vec2(x, 0)).x)\n        const labelText = this.props.flamechart.formatValue(x)\n        const textWidth = Math.ceil(cachedMeasureTextWidth(ctx, labelText))\n\n        ctx.fillStyle = theme.fgPrimaryColor\n        ctx.fillText(labelText, pos - textWidth - labelPaddingPx, labelPaddingPx)\n        ctx.fillStyle = theme.fgSecondaryColor\n        ctx.fillRect(pos, 0, 1, physicalViewSize.y)\n      }\n    }\n  }\n\n  onWindowResize = () => {\n    this.onBeforeFrame()\n  }\n\n  componentWillReceiveProps(nextProps: FlamechartMinimapViewProps) {\n    if (this.props.flamechart !== nextProps.flamechart) {\n      this.renderCanvas()\n    } else if (this.props.configSpaceViewportRect != nextProps.configSpaceViewportRect) {\n      this.renderCanvas()\n    } else if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('resize', this.onWindowResize)\n    this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onWindowResize)\n    this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n  }\n\n  private resizeOverlayCanvasIfNeeded() {\n    if (!this.overlayCanvas) return\n    let {width, height} = this.overlayCanvas.getBoundingClientRect()\n    {\n      /*\n      We render text at a higher resolution then scale down to\n      ensure we're rendering at 1:1 device pixel ratio.\n      This ensures our text is rendered crisply.\n    */\n    }\n    width = Math.floor(width)\n    height = Math.floor(height)\n\n    // Still initializing: don't resize yet\n    if (width === 0 || height === 0) return\n\n    const scaledWidth = width * window.devicePixelRatio\n    const scaledHeight = height * window.devicePixelRatio\n\n    if (scaledWidth === this.overlayCanvas.width && scaledHeight === this.overlayCanvas.height)\n      return\n\n    this.overlayCanvas.width = scaledWidth\n    this.overlayCanvas.height = scaledHeight\n  }\n\n  private onBeforeFrame = () => {\n    this.maybeClearInteractionLock()\n    this.resizeOverlayCanvasIfNeeded()\n    this.renderRects()\n    this.renderOverlays()\n  }\n\n  private renderCanvas = () => {\n    this.props.canvasContext.requestFrame()\n  }\n\n  // Inertial scrolling introduces tricky interaction problems.\n  // Namely, if you start panning, and hit the edge of the scrollable\n  // area, the browser continues to receive WheelEvents from inertial\n  // scrolling. If we start zooming by holding Cmd + scrolling, then\n  // release the Cmd key, this can cause us to interpret the incoming\n  // inertial scrolling events as panning. To prevent this, we introduce\n  // a concept of an \"Interaction Lock\". Once a certain interaction has\n  // begun, we don't allow the other type of interaction to begin until\n  // we've received two frames with no inertial wheel events. This\n  // prevents us from accidentally switching between panning & zooming.\n  private frameHadWheelEvent = false\n  private framesWithoutWheelEvents = 0\n  private interactionLock: 'pan' | 'zoom' | null = null\n  private maybeClearInteractionLock = () => {\n    if (this.interactionLock) {\n      if (!this.frameHadWheelEvent) {\n        this.framesWithoutWheelEvents++\n        if (this.framesWithoutWheelEvents >= 2) {\n          this.interactionLock = null\n          this.framesWithoutWheelEvents = 0\n        }\n      }\n      this.props.canvasContext.requestFrame()\n    }\n    this.frameHadWheelEvent = false\n  }\n\n  private pan(logicalViewSpaceDelta: Vec2) {\n    this.interactionLock = 'pan'\n    const physicalDelta = this.logicalToPhysicalViewSpace().transformVector(logicalViewSpaceDelta)\n    const configDelta = this.configSpaceToPhysicalViewSpace().inverseTransformVector(physicalDelta)\n\n    if (!configDelta) return\n    this.props.transformViewport(AffineTransform.withTranslation(configDelta))\n  }\n\n  private zoom(multiplier: number) {\n    this.interactionLock = 'zoom'\n    const configSpaceViewport = this.props.configSpaceViewportRect\n    const configSpaceCenter = configSpaceViewport.origin.plus(configSpaceViewport.size.times(1 / 2))\n    if (!configSpaceCenter) return\n\n    const zoomTransform = AffineTransform.withTranslation(configSpaceCenter.times(-1))\n      .scaledBy(new Vec2(multiplier, 1))\n      .translatedBy(configSpaceCenter)\n\n    this.props.transformViewport(zoomTransform)\n  }\n\n  private onWheel = (ev: WheelEvent) => {\n    ev.preventDefault()\n\n    this.frameHadWheelEvent = true\n\n    const isZoom = ev.metaKey || ev.ctrlKey\n\n    if (isZoom && this.interactionLock !== 'pan') {\n      let multiplier = 1 + ev.deltaY / 100\n\n      // On Chrome & Firefox, pinch-to-zoom maps to\n      // WheelEvent + Ctrl Key. We'll accelerate it in\n      // this case, since it feels a bit sluggish otherwise.\n      if (ev.ctrlKey) {\n        multiplier = 1 + ev.deltaY / 40\n      }\n\n      multiplier = clamp(multiplier, 0.1, 10.0)\n\n      this.zoom(multiplier)\n    } else if (this.interactionLock !== 'zoom') {\n      this.pan(new Vec2(ev.deltaX, ev.deltaY))\n    }\n\n    this.renderCanvas()\n  }\n\n  private configSpaceMouse(ev: MouseEvent): Vec2 | null {\n    const logicalSpaceMouse = this.windowToLogicalViewSpace().transformPosition(\n      new Vec2(ev.clientX, ev.clientY),\n    )\n    const physicalSpaceMouse =\n      this.logicalToPhysicalViewSpace().transformPosition(logicalSpaceMouse)\n    return this.configSpaceToPhysicalViewSpace().inverseTransformPosition(physicalSpaceMouse)\n  }\n\n  private dragStartConfigSpaceMouse: Vec2 | null = null\n  private dragConfigSpaceViewportOffset: Vec2 | null = null\n  private draggingMode: DraggingMode | null = null\n  private onMouseDown = (ev: MouseEvent) => {\n    const configSpaceMouse = this.configSpaceMouse(ev)\n\n    if (configSpaceMouse) {\n      if (this.props.configSpaceViewportRect.contains(configSpaceMouse)) {\n        // If dragging starting inside the viewport rectangle,\n        // we'll move the existing viewport\n        this.draggingMode = DraggingMode.TRANSLATE_VIEWPORT\n        this.dragConfigSpaceViewportOffset = configSpaceMouse.minus(\n          this.props.configSpaceViewportRect.origin,\n        )\n      } else {\n        // If dragging starts outside the the viewport rectangle,\n        // we'll start drawing a new viewport\n        this.draggingMode = DraggingMode.DRAW_NEW_VIEWPORT\n      }\n\n      this.dragStartConfigSpaceMouse = configSpaceMouse\n      window.addEventListener('mousemove', this.onWindowMouseMove)\n      window.addEventListener('mouseup', this.onWindowMouseUp)\n      this.updateCursor(configSpaceMouse)\n    }\n  }\n\n  private onWindowMouseMove = (ev: MouseEvent) => {\n    if (!this.dragStartConfigSpaceMouse) return\n    let configSpaceMouse = this.configSpaceMouse(ev)\n\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n\n    // Clamp the mouse position to avoid weird behavior when outside the canvas bounds\n    configSpaceMouse = new Rect(new Vec2(0, 0), this.configSpaceSize()).closestPointTo(\n      configSpaceMouse,\n    )\n\n    if (this.draggingMode === DraggingMode.DRAW_NEW_VIEWPORT) {\n      const configStart = this.dragStartConfigSpaceMouse\n      let configEnd = configSpaceMouse\n\n      if (!configStart || !configEnd) return\n      const left = Math.min(configStart.x, configEnd.x)\n      const right = Math.max(configStart.x, configEnd.x)\n\n      const width = right - left\n      const height = this.props.configSpaceViewportRect.height()\n\n      this.props.setConfigSpaceViewportRect(\n        new Rect(new Vec2(left, configEnd.y - height / 2), new Vec2(width, height)),\n      )\n    } else if (this.draggingMode === DraggingMode.TRANSLATE_VIEWPORT) {\n      if (!this.dragConfigSpaceViewportOffset) return\n\n      const newOrigin = configSpaceMouse.minus(this.dragConfigSpaceViewportOffset)\n      this.props.setConfigSpaceViewportRect(\n        this.props.configSpaceViewportRect.withOrigin(newOrigin),\n      )\n    }\n  }\n\n  private updateCursor = (configSpaceMouse: Vec2) => {\n    if (this.draggingMode === DraggingMode.TRANSLATE_VIEWPORT) {\n      document.body.style.cursor = 'grabbing'\n      document.body.style.cursor = '-webkit-grabbing'\n    } else if (this.draggingMode === DraggingMode.DRAW_NEW_VIEWPORT) {\n      document.body.style.cursor = 'col-resize'\n    } else if (this.props.configSpaceViewportRect.contains(configSpaceMouse)) {\n      document.body.style.cursor = 'grab'\n      document.body.style.cursor = '-webkit-grab'\n    } else {\n      document.body.style.cursor = 'col-resize'\n    }\n  }\n\n  private onMouseLeave = () => {\n    if (this.draggingMode == null) {\n      document.body.style.cursor = 'default'\n    }\n    // Clear the minimap mouse position when leaving the minimap\n    minimapMousePositionAtom.set(null)\n  }\n\n  private onMouseMove = (ev: MouseEvent) => {\n    const configSpaceMouse = this.configSpaceMouse(ev)\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n    // Update the global minimap mouse position for zoom origin\n    minimapMousePositionAtom.set(configSpaceMouse)\n  }\n\n  private onWindowMouseUp = (ev: MouseEvent) => {\n    this.draggingMode = null\n    window.removeEventListener('mousemove', this.onWindowMouseMove)\n    window.removeEventListener('mouseup', this.onWindowMouseUp)\n\n    const configSpaceMouse = this.configSpaceMouse(ev)\n    if (!configSpaceMouse) return\n    this.updateCursor(configSpaceMouse)\n  }\n\n  private overlayCanvasRef = (element: Element | null) => {\n    if (element) {\n      this.overlayCanvas = element as HTMLCanvasElement\n      this.overlayCtx = this.overlayCanvas.getContext('2d')\n      this.renderCanvas()\n    } else {\n      this.overlayCanvas = null\n      this.overlayCtx = null\n    }\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div\n        ref={this.containerRef}\n        onWheel={this.onWheel}\n        onMouseDown={this.onMouseDown}\n        onMouseMove={this.onMouseMove}\n        onMouseLeave={this.onMouseLeave}\n        className={css(style.minimap, commonStyle.vbox)}\n      >\n        <canvas width={1} height={1} ref={this.overlayCanvasRef} className={css(style.fill)} />\n      </div>\n    )\n  }\n}\n", "import {h} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\nimport {FontSize} from './style'\nimport {useTheme, withTheme} from './themes/theme'\n\ninterface ColorChitProps {\n  color: string\n}\n\nexport function ColorChit(props: ColorChitProps) {\n  const style = getStyle(useTheme())\n  return <span className={css(style.stackChit)} style={{backgroundColor: props.color}} />\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    stackChit: {\n      position: 'relative',\n      top: -1,\n      display: 'inline-block',\n      verticalAlign: 'middle',\n      marginRight: '0.5em',\n      border: `1px solid ${theme.fgSecondaryColor}`,\n      width: FontSize.LABEL - 2,\n      height: FontSize.LABEL - 2,\n    },\n  }),\n)\n", "import {StyleDeclarationValue, css} from 'aphrodite'\nimport {h, JSX} from 'preact'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {formatPercent} from '../lib/utils'\nimport {Frame, CallTreeNode} from '../lib/profile'\nimport {ColorChit} from './color-chit'\nimport {Flamechart} from '../lib/flamechart'\nimport {useTheme} from './themes/theme'\n\ninterface StatisticsTableProps {\n  title: string\n  grandTotal: number\n  selectedTotal: number\n  selectedSelf: number\n  cellStyle: StyleDeclarationValue\n  formatter: (v: number) => string\n}\n\nfunction StatisticsTable(props: StatisticsTableProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const total = props.formatter(props.selectedTotal)\n  const self = props.formatter(props.selectedSelf)\n  const totalPerc = (100.0 * props.selectedTotal) / props.grandTotal\n  const selfPerc = (100.0 * props.selectedSelf) / props.grandTotal\n\n  return (\n    <div className={css(style.statsTable)}>\n      <div className={css(props.cellStyle, style.statsTableCell, style.statsTableHeader)}>\n        {props.title}\n      </div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>Total</div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>Self</div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>{total}</div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>{self}</div>\n\n      <div className={css(props.cellStyle, style.statsTableCell)}>\n        {formatPercent(totalPerc)}\n        <div className={css(style.barDisplay)} style={{height: `${totalPerc}%`}} />\n      </div>\n      <div className={css(props.cellStyle, style.statsTableCell)}>\n        {formatPercent(selfPerc)}\n        <div className={css(style.barDisplay)} style={{height: `${selfPerc}%`}} />\n      </div>\n    </div>\n  )\n}\n\ninterface StackTraceViewProps {\n  getFrameColor: (frame: Frame) => string\n  node: CallTreeNode\n}\nfunction StackTraceView(props: StackTraceViewProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const rows: JSX.Element[] = []\n  let node: CallTreeNode | null = props.node\n  for (; node && !node.isRoot(); node = node.parent) {\n    const row: (JSX.Element | string)[] = []\n    const {frame} = node\n\n    row.push(<ColorChit color={props.getFrameColor(frame)} />)\n\n    if (rows.length) {\n      row.push(<span className={css(style.stackFileLine)}>&gt; </span>)\n    }\n    row.push(frame.name)\n\n    if (frame.file) {\n      let pos = frame.file\n      if (frame.line != null) {\n        pos += `:${frame.line}`\n        if (frame.col != null) {\n          pos += `:${frame.col}`\n        }\n      }\n      row.push(<span className={css(style.stackFileLine)}> ({pos})</span>)\n    }\n    rows.push(<div className={css(style.stackLine)}>{row}</div>)\n  }\n  return (\n    <div className={css(style.stackTraceView)}>\n      <div className={css(style.stackTraceViewPadding)}>{rows}</div>\n    </div>\n  )\n}\n\ninterface FlamechartDetailViewProps {\n  flamechart: Flamechart\n  getCSSColorForFrame: (frame: Frame) => string\n  selectedNode: CallTreeNode\n}\n\nexport function FlamechartDetailView(props: FlamechartDetailViewProps) {\n  const style = getFlamechartStyle(useTheme())\n\n  const {flamechart, selectedNode} = props\n  const {frame} = selectedNode\n\n  return (\n    <div className={css(style.detailView)}>\n      <StatisticsTable\n        title={'This Instance'}\n        cellStyle={style.thisInstanceCell}\n        grandTotal={flamechart.getTotalWeight()}\n        selectedTotal={selectedNode.getTotalWeight()}\n        selectedSelf={selectedNode.getSelfWeight()}\n        formatter={flamechart.formatValue.bind(flamechart)}\n      />\n      <StatisticsTable\n        title={'All Instances'}\n        cellStyle={style.allInstancesCell}\n        grandTotal={flamechart.getTotalWeight()}\n        selectedTotal={frame.getTotalWeight()}\n        selectedSelf={frame.getSelfWeight()}\n        formatter={flamechart.formatValue.bind(flamechart)}\n      />\n      <StackTraceView node={selectedNode} getFrameColor={props.getCSSColorForFrame} />\n    </div>\n  )\n}\n", "// This file contains a collection of classes which make it easier to perform\n// batch rendering of Canvas2D primitives. The advantage of this over just doing\n// ctx.beginPath() ... ctx.rect(...) ... ctx.endPath() is that you can construct\n// several different batch renderers are the same time, then decide on their\n// paint order at the end.\n//\n// See FlamechartPanZoomView.renderOverlays for an example of how this is used.\n\nexport interface TextArgs {\n  text: string\n  x: number\n  y: number\n}\n\nexport class BatchCanvasTextRenderer {\n  private argsBatch: TextArgs[] = []\n\n  text(args: TextArgs) {\n    this.argsBatch.push(args)\n  }\n\n  fill(ctx: CanvasRenderingContext2D, color: string) {\n    if (this.argsBatch.length === 0) return\n    ctx.fillStyle = color\n    for (let args of this.argsBatch) {\n      ctx.fillText(args.text, args.x, args.y)\n    }\n    this.argsBatch = []\n  }\n}\n\nexport interface RectArgs {\n  x: number\n  y: number\n  w: number\n  h: number\n}\n\nexport class BatchCanvasRectRenderer {\n  private argsBatch: RectArgs[] = []\n\n  rect(args: RectArgs) {\n    this.argsBatch.push(args)\n  }\n\n  private drawPath(ctx: CanvasRenderingContext2D) {\n    ctx.beginPath()\n    for (let args of this.argsBatch) {\n      ctx.rect(args.x, args.y, args.w, args.h)\n    }\n    ctx.closePath()\n    this.argsBatch = []\n  }\n\n  fill(ctx: CanvasRenderingContext2D, color: string) {\n    if (this.argsBatch.length === 0) return\n    ctx.fillStyle = color\n    this.drawPath(ctx)\n    ctx.fill()\n  }\n\n  stroke(ctx: CanvasRenderingContext2D, color: string, lineWidth: number) {\n    if (this.argsBatch.length === 0) return\n    ctx.strokeStyle = color\n    ctx.lineWidth = lineWidth\n    this.drawPath(ctx)\n    ctx.stroke()\n  }\n}\n", "import {Rect, AffineTransform, Vec2, clamp} from '../lib/math'\nimport {CallTreeNode} from '../lib/profile'\nimport {Flamechart, FlamechartFrame} from '../lib/flamechart'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {FlamechartRenderer} from '../gl/flamechart-renderer'\nimport {Sizes, FontSize, FontFamily, commonStyle} from './style'\nimport {\n  cachedMeasureTextWidth,\n  ELLIPSIS,\n  trimTextMid,\n  remapRangesToTrimmedText,\n} from '../lib/text-utils'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {h, Component} from 'preact'\nimport {css} from 'aphrodite'\nimport {ProfileSearchResults} from '../lib/profile-search'\nimport {BatchCanvasTextRenderer, BatchCanvasRectRenderer} from '../lib/canvas-2d-batch-renderers'\nimport {Color} from '../lib/color'\nimport {Theme} from './themes/theme'\nimport {minimapMousePositionAtom} from '../app-state'\n\ninterface FlamechartFrameLabel {\n  configSpaceBounds: Rect\n  node: CallTreeNode\n}\n\n/**\n * Component to visualize a Flamechart and interact with it via hovering,\n * zooming, and panning.\n *\n * There are 3 vector spaces involved:\n * - Configuration Space: In this space, the horizontal unit is ms, and the\n *   vertical unit is stack depth. Each stack frame is one unit high.\n * - Logical view space: Origin is top-left, with +y downwards. This represents\n *   the coordinate space of the view as specified in CSS: horizontal and vertical\n *   units are both \"logical\" pixels.\n * - Physical view space: Origin is top-left, with +y downwards. This represents\n *   the coordinate space of the view as specified in hardware pixels: horizontal\n *   and vertical units are both \"physical\" pixels.\n *\n * We use two canvases to draw the flamechart itself: one for the rectangles,\n * which we render via WebGL, and one for the labels, which we render via 2D\n * canvas primitives.\n */\nexport interface FlamechartPanZoomViewProps {\n  flamechart: Flamechart\n  canvasContext: CanvasContext\n  flamechartRenderer: FlamechartRenderer\n  renderInverted: boolean\n  selectedNode: CallTreeNode | null\n  theme: Theme\n\n  onNodeHover: (hover: {node: CallTreeNode; event: MouseEvent} | null) => void\n  onNodeSelect: (node: CallTreeNode | null) => void\n\n  configSpaceViewportRect: Rect\n  transformViewport: (transform: AffineTransform) => void\n  setConfigSpaceViewportRect: (rect: Rect) => void\n\n  logicalSpaceViewportSize: Vec2\n  setLogicalSpaceViewportSize: (size: Vec2) => void\n\n  searchResults: ProfileSearchResults | null\n}\n\nexport class FlamechartPanZoomView extends Component<FlamechartPanZoomViewProps, {}> {\n  private container: Element | null = null\n  private containerRef = (element: Element | null) => {\n    this.container = element || null\n  }\n\n  private overlayCanvas: HTMLCanvasElement | null = null\n  private overlayCtx: CanvasRenderingContext2D | null = null\n\n  private hoveredLabel: FlamechartFrameLabel | null = null\n\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private setConfigSpaceViewportRect(r: Rect) {\n    this.props.setConfigSpaceViewportRect(r)\n  }\n\n  private overlayCanvasRef = (element: Element | null) => {\n    if (element) {\n      this.overlayCanvas = element as HTMLCanvasElement\n      this.overlayCtx = this.overlayCanvas.getContext('2d')\n      this.renderCanvas()\n    } else {\n      this.overlayCanvas = null\n      this.overlayCtx = null\n    }\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private physicalViewSize() {\n    return new Vec2(\n      this.overlayCanvas ? this.overlayCanvas.width : 0,\n      this.overlayCanvas ? this.overlayCanvas.height : 0,\n    )\n  }\n\n  private physicalBounds(): Rect {\n    if (this.props.renderInverted) {\n      // If we're rendering inverted and the flamegraph won't fill the viewport,\n      // we want to stick the flamegraph to the bottom of the viewport, not the top.\n\n      const physicalViewportHeight = this.physicalViewSize().y\n      const physicalFlamegraphHeight =\n        (this.configSpaceSize().y + 1) *\n        this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT *\n        window.devicePixelRatio\n\n      if (physicalFlamegraphHeight < physicalViewportHeight) {\n        return new Rect(\n          new Vec2(0, physicalViewportHeight - physicalFlamegraphHeight),\n          this.physicalViewSize(),\n        )\n      }\n    }\n\n    return new Rect(new Vec2(0, 0), this.physicalViewSize())\n  }\n\n  private LOGICAL_VIEW_SPACE_FRAME_HEIGHT = Sizes.FRAME_HEIGHT\n\n  private configSpaceToPhysicalViewSpace() {\n    return AffineTransform.betweenRects(this.props.configSpaceViewportRect, this.physicalBounds())\n  }\n\n  private logicalToPhysicalViewSpace() {\n    return AffineTransform.withScale(new Vec2(window.devicePixelRatio, window.devicePixelRatio))\n  }\n\n  private resizeOverlayCanvasIfNeeded() {\n    if (!this.overlayCanvas) return\n    let {width, height} = this.overlayCanvas.getBoundingClientRect()\n    {\n      /*\n      We render text at a higher resolution then scale down to\n      ensure we're rendering at 1:1 device pixel ratio.\n      This ensures our text is rendered crisply.\n    */\n    }\n    width = Math.floor(width)\n    height = Math.floor(height)\n\n    // Still initializing: don't resize yet\n    if (width === 0 || height === 0) return\n\n    const scaledWidth = width * window.devicePixelRatio\n    const scaledHeight = height * window.devicePixelRatio\n\n    if (scaledWidth === this.overlayCanvas.width && scaledHeight === this.overlayCanvas.height)\n      return\n\n    this.overlayCanvas.width = scaledWidth\n    this.overlayCanvas.height = scaledHeight\n  }\n\n  private renderOverlays() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n    if (this.props.configSpaceViewportRect.isEmpty()) return\n\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const physicalViewSpaceFrameHeight =\n      this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT * window.devicePixelRatio\n\n    const physicalViewSize = this.physicalViewSize()\n\n    ctx.clearRect(0, 0, physicalViewSize.x, physicalViewSize.y)\n\n    ctx.font = `${physicalViewSpaceFontSize}px/${physicalViewSpaceFrameHeight}px ${FontFamily.MONOSPACE}`\n    ctx.textBaseline = 'alphabetic'\n\n    const minWidthToRender = cachedMeasureTextWidth(ctx, 'M' + ELLIPSIS + 'M')\n    const minConfigSpaceWidthToRender = (\n      configToPhysical.inverseTransformVector(new Vec2(minWidthToRender, 0)) || new Vec2(0, 0)\n    ).x\n\n    const LABEL_PADDING_PX = 5 * window.devicePixelRatio\n\n    const labelBatch = new BatchCanvasTextRenderer()\n    const fadedLabelBatch = new BatchCanvasTextRenderer()\n    const matchedTextHighlightBatch = new BatchCanvasRectRenderer()\n    const directlySelectedOutlineBatch = new BatchCanvasRectRenderer()\n    const indirectlySelectedOutlineBatch = new BatchCanvasRectRenderer()\n    const matchedFrameBatch = new BatchCanvasRectRenderer()\n\n    const renderFrameLabelAndChildren = (frame: FlamechartFrame, depth = 0) => {\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n\n      if (width < minConfigSpaceWidthToRender) return\n      if (configSpaceBounds.left() > this.props.configSpaceViewportRect.right()) return\n      if (configSpaceBounds.right() < this.props.configSpaceViewportRect.left()) return\n\n      if (this.props.renderInverted) {\n        if (configSpaceBounds.bottom() < this.props.configSpaceViewportRect.top()) return\n      } else {\n        if (configSpaceBounds.top() > this.props.configSpaceViewportRect.bottom()) return\n      }\n\n      if (configSpaceBounds.hasIntersectionWith(this.props.configSpaceViewportRect)) {\n        let physicalLabelBounds = configToPhysical.transformRect(configSpaceBounds)\n\n        if (physicalLabelBounds.left() < 0) {\n          physicalLabelBounds = physicalLabelBounds\n            .withOrigin(physicalLabelBounds.origin.withX(0))\n            .withSize(\n              physicalLabelBounds.size.withX(\n                physicalLabelBounds.size.x + physicalLabelBounds.left(),\n              ),\n            )\n        }\n        if (physicalLabelBounds.right() > physicalViewSize.x) {\n          physicalLabelBounds = physicalLabelBounds.withSize(\n            physicalLabelBounds.size.withX(physicalViewSize.x - physicalLabelBounds.left()),\n          )\n        }\n\n        if (physicalLabelBounds.width() > minWidthToRender) {\n          const match = this.props.searchResults?.getMatchForFrame(frame.node.frame)\n\n          const trimmedText = trimTextMid(\n            ctx,\n            frame.node.frame.name,\n            physicalLabelBounds.width() - 2 * LABEL_PADDING_PX,\n          )\n\n          if (match) {\n            const rangesToHighlightInTrimmedText = remapRangesToTrimmedText(trimmedText, match)\n\n            // Once we have the character ranges to highlight, we need to\n            // actually do the highlighting.\n            let lastEndIndex = 0\n            let left = physicalLabelBounds.left() + LABEL_PADDING_PX\n\n            const padding = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2 - 2\n            for (let [startIndex, endIndex] of rangesToHighlightInTrimmedText) {\n              left += cachedMeasureTextWidth(\n                ctx,\n                trimmedText.trimmedString.substring(lastEndIndex, startIndex),\n              )\n              const highlightWidth = cachedMeasureTextWidth(\n                ctx,\n                trimmedText.trimmedString.substring(startIndex, endIndex),\n              )\n              matchedTextHighlightBatch.rect({\n                x: left,\n                y: physicalLabelBounds.top() + padding,\n                w: highlightWidth,\n                h: physicalViewSpaceFrameHeight - 2 * padding,\n              })\n\n              left += highlightWidth\n              lastEndIndex = endIndex\n            }\n          }\n\n          const batch = this.props.searchResults != null && !match ? fadedLabelBatch : labelBatch\n          batch.text({\n            text: trimmedText.trimmedString,\n\n            // This is specifying the position of the starting text baseline.\n            x: physicalLabelBounds.left() + LABEL_PADDING_PX,\n            y: Math.round(\n              physicalLabelBounds.bottom() -\n                (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2,\n            ),\n          })\n        }\n      }\n      for (let child of frame.children) {\n        renderFrameLabelAndChildren(child, depth + 1)\n      }\n    }\n\n    const frameOutlineWidth = 2 * window.devicePixelRatio\n    ctx.strokeStyle = this.props.theme.selectionSecondaryColor\n    const minConfigSpaceWidthToRenderOutline = (\n      configToPhysical.inverseTransformVector(new Vec2(1, 0)) || new Vec2(0, 0)\n    ).x\n\n    const renderSpecialFrameOutlines = (frame: FlamechartFrame, depth = 0) => {\n      if (!this.props.selectedNode && this.props.searchResults == null) return\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n\n      if (width < minConfigSpaceWidthToRenderOutline) return\n      if (configSpaceBounds.left() > this.props.configSpaceViewportRect.right()) return\n      if (configSpaceBounds.right() < this.props.configSpaceViewportRect.left()) return\n      if (configSpaceBounds.top() > this.props.configSpaceViewportRect.bottom()) return\n\n      if (configSpaceBounds.hasIntersectionWith(this.props.configSpaceViewportRect)) {\n        if (this.props.searchResults?.getMatchForFrame(frame.node.frame)) {\n          const physicalRectBounds = configToPhysical.transformRect(configSpaceBounds)\n          matchedFrameBatch.rect({\n            x: Math.round(physicalRectBounds.left() + frameOutlineWidth / 2),\n            y: Math.round(physicalRectBounds.top() + frameOutlineWidth / 2),\n            w: Math.round(Math.max(0, physicalRectBounds.width() - frameOutlineWidth)),\n            h: Math.round(Math.max(0, physicalRectBounds.height() - frameOutlineWidth)),\n          })\n        }\n\n        if (this.props.selectedNode != null && frame.node.frame === this.props.selectedNode.frame) {\n          let batch =\n            frame.node === this.props.selectedNode\n              ? directlySelectedOutlineBatch\n              : indirectlySelectedOutlineBatch\n\n          const physicalRectBounds = configToPhysical.transformRect(configSpaceBounds)\n          batch.rect({\n            x: Math.round(physicalRectBounds.left() + 1 + frameOutlineWidth / 2),\n            y: Math.round(physicalRectBounds.top() + 1 + frameOutlineWidth / 2),\n            w: Math.round(Math.max(0, physicalRectBounds.width() - 2 - frameOutlineWidth)),\n            h: Math.round(Math.max(0, physicalRectBounds.height() - 2 - frameOutlineWidth)),\n          })\n        }\n      }\n      for (let child of frame.children) {\n        renderSpecialFrameOutlines(child, depth + 1)\n      }\n    }\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      renderSpecialFrameOutlines(frame)\n    }\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      renderFrameLabelAndChildren(frame)\n    }\n\n    const theme = this.props.theme\n\n    matchedFrameBatch.fill(ctx, theme.searchMatchPrimaryColor)\n    matchedTextHighlightBatch.fill(ctx, theme.searchMatchSecondaryColor)\n    fadedLabelBatch.fill(ctx, theme.fgSecondaryColor)\n    labelBatch.fill(\n      ctx,\n      this.props.searchResults != null ? theme.searchMatchTextColor : theme.fgPrimaryColor,\n    )\n    indirectlySelectedOutlineBatch.stroke(ctx, theme.selectionSecondaryColor, frameOutlineWidth)\n    directlySelectedOutlineBatch.stroke(ctx, theme.selectionPrimaryColor, frameOutlineWidth)\n\n    if (this.hoveredLabel) {\n      let color: string = theme.fgPrimaryColor\n      if (this.props.selectedNode === this.hoveredLabel.node) {\n        color = theme.selectionPrimaryColor\n      }\n\n      ctx.lineWidth = 2 * devicePixelRatio\n      ctx.strokeStyle = color\n\n      const physicalViewBounds = configToPhysical.transformRect(this.hoveredLabel.configSpaceBounds)\n      ctx.strokeRect(\n        Math.round(physicalViewBounds.left()),\n        Math.round(physicalViewBounds.top()),\n        Math.round(Math.max(0, physicalViewBounds.width())),\n        Math.round(Math.max(0, physicalViewBounds.height())),\n      )\n    }\n\n    this.renderTimeIndicators()\n  }\n\n  private renderTimeIndicators() {\n    const ctx = this.overlayCtx\n    if (!ctx) return\n\n    const physicalViewSpaceFrameHeight =\n      this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT * window.devicePixelRatio\n    const physicalViewSize = this.physicalViewSize()\n    const configToPhysical = this.configSpaceToPhysicalViewSpace()\n    const physicalViewSpaceFontSize = FontSize.LABEL * window.devicePixelRatio\n    const labelPaddingPx = (physicalViewSpaceFrameHeight - physicalViewSpaceFontSize) / 2\n\n    const left = this.props.configSpaceViewportRect.left()\n    const right = this.props.configSpaceViewportRect.right()\n    // We want about 10 gridlines to be visible, and want the unit to be\n    // 1eN, 2eN, or 5eN for some N\n    // Ideally, we want an interval every 100 logical screen pixels\n    const logicalToConfig = (\n      this.configSpaceToPhysicalViewSpace().inverted() || new AffineTransform()\n    ).times(this.logicalToPhysicalViewSpace())\n    const targetInterval = logicalToConfig.transformVector(new Vec2(200, 1)).x\n    const minInterval = Math.pow(10, Math.floor(Math.log10(targetInterval)))\n    let interval = minInterval\n    if (targetInterval / interval > 5) {\n      interval *= 5\n    } else if (targetInterval / interval > 2) {\n      interval *= 2\n    }\n\n    const theme = this.props.theme\n\n    {\n      const y = this.props.renderInverted ? physicalViewSize.y - physicalViewSpaceFrameHeight : 0\n\n      ctx.fillStyle = Color.fromCSSHex(theme.bgPrimaryColor).withAlpha(0.8).toCSS()\n      ctx.fillRect(0, y, physicalViewSize.x, physicalViewSpaceFrameHeight)\n      ctx.textBaseline = 'top'\n      for (let x = Math.ceil(left / interval) * interval; x < right; x += interval) {\n        // TODO(jlfwong): Ensure that labels do not overlap\n        const pos = Math.round(configToPhysical.transformPosition(new Vec2(x, 0)).x)\n        const labelText = this.props.flamechart.formatValue(x)\n        const textWidth = cachedMeasureTextWidth(ctx, labelText)\n        ctx.fillStyle = theme.fgPrimaryColor\n        ctx.fillText(labelText, pos - textWidth - labelPaddingPx, y + labelPaddingPx)\n        ctx.fillStyle = theme.fgSecondaryColor\n        ctx.fillRect(pos, 0, 1, physicalViewSize.y)\n      }\n    }\n  }\n\n  private updateConfigSpaceViewport() {\n    if (!this.container) return\n    const {logicalSpaceViewportSize} = this.props\n    const bounds = this.container.getBoundingClientRect()\n    const {width, height} = bounds\n\n    // Still initializing: don't resize yet\n    if (width < 2 || height < 2) return\n\n    if (this.props.configSpaceViewportRect.isEmpty()) {\n      const configSpaceViewportHeight = height / this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n      if (this.props.renderInverted) {\n        this.setConfigSpaceViewportRect(\n          new Rect(\n            new Vec2(0, this.configSpaceSize().y - configSpaceViewportHeight + 1),\n            new Vec2(this.configSpaceSize().x, configSpaceViewportHeight),\n          ),\n        )\n      } else {\n        this.setConfigSpaceViewportRect(\n          new Rect(new Vec2(0, -1), new Vec2(this.configSpaceSize().x, configSpaceViewportHeight)),\n        )\n      }\n    } else if (\n      !logicalSpaceViewportSize.equals(Vec2.zero) &&\n      (logicalSpaceViewportSize.x !== width || logicalSpaceViewportSize.y !== height)\n    ) {\n      // Resize the viewport rectangle to match the window size aspect\n      // ratio.\n      this.setConfigSpaceViewportRect(\n        this.props.configSpaceViewportRect.withSize(\n          this.props.configSpaceViewportRect.size.timesPointwise(\n            new Vec2(width / logicalSpaceViewportSize.x, height / logicalSpaceViewportSize.y),\n          ),\n        ),\n      )\n    }\n\n    const newSize = new Vec2(width, height)\n    if (!newSize.equals(logicalSpaceViewportSize)) {\n      this.props.setLogicalSpaceViewportSize(newSize)\n    }\n  }\n\n  onWindowResize = () => {\n    this.updateConfigSpaceViewport()\n    this.onBeforeFrame()\n  }\n\n  private renderRects() {\n    if (!this.container) return\n    this.updateConfigSpaceViewport()\n\n    if (this.props.configSpaceViewportRect.isEmpty()) return\n\n    this.props.canvasContext.renderBehind(this.container, () => {\n      this.props.flamechartRenderer.render({\n        physicalSpaceDstRect: this.physicalBounds(),\n        configSpaceSrcRect: this.props.configSpaceViewportRect,\n        renderOutlines: true,\n      })\n    })\n  }\n\n  // Inertial scrolling introduces tricky interaction problems.\n  // Namely, if you start panning, and hit the edge of the scrollable\n  // area, the browser continues to receive WheelEvents from inertial\n  // scrolling. If we start zooming by holding Cmd + scrolling, then\n  // release the Cmd key, this can cause us to interpret the incoming\n  // inertial scrolling events as panning. To prevent this, we introduce\n  // a concept of an \"Interaction Lock\". Once a certain interaction has\n  // begun, we don't allow the other type of interaction to begin until\n  // we've received two frames with no inertial wheel events. This\n  // prevents us from accidentally switching between panning & zooming.\n  private frameHadWheelEvent = false\n  private framesWithoutWheelEvents = 0\n  private interactionLock: 'pan' | 'zoom' | null = null\n  private maybeClearInteractionLock = () => {\n    if (this.interactionLock) {\n      if (!this.frameHadWheelEvent) {\n        this.framesWithoutWheelEvents++\n        if (this.framesWithoutWheelEvents >= 2) {\n          this.interactionLock = null\n          this.framesWithoutWheelEvents = 0\n        }\n      }\n      this.props.canvasContext.requestFrame()\n    }\n    this.frameHadWheelEvent = false\n  }\n\n  private onBeforeFrame = () => {\n    this.resizeOverlayCanvasIfNeeded()\n    this.renderRects()\n    this.renderOverlays()\n    this.maybeClearInteractionLock()\n  }\n\n  private renderCanvas = () => {\n    this.props.canvasContext.requestFrame()\n  }\n\n  private pan(logicalViewSpaceDelta: Vec2) {\n    this.interactionLock = 'pan'\n\n    const physicalDelta = this.logicalToPhysicalViewSpace().transformVector(logicalViewSpaceDelta)\n    const configDelta = this.configSpaceToPhysicalViewSpace().inverseTransformVector(physicalDelta)\n\n    if (this.hoveredLabel) {\n      this.props.onNodeHover(null)\n    }\n\n    if (!configDelta) return\n    this.props.transformViewport(AffineTransform.withTranslation(configDelta))\n  }\n\n  private zoom(logicalViewSpaceCenter: Vec2, multiplier: number) {\n    this.interactionLock = 'zoom'\n\n    const physicalCenter =\n      this.logicalToPhysicalViewSpace().transformPosition(logicalViewSpaceCenter)\n    const configSpaceCenter =\n      this.configSpaceToPhysicalViewSpace().inverseTransformPosition(physicalCenter)\n    if (!configSpaceCenter) return\n\n    const zoomTransform = AffineTransform.withTranslation(configSpaceCenter.times(-1))\n      .scaledBy(new Vec2(multiplier, 1))\n      .translatedBy(configSpaceCenter)\n\n    this.props.transformViewport(zoomTransform)\n  }\n\n  private lastDragPos: Vec2 | null = null\n  private mouseDownPos: Vec2 | null = null\n  private currentMousePos: Vec2 | null = null\n  private onMouseDown = (ev: MouseEvent) => {\n    this.mouseDownPos = this.lastDragPos = new Vec2(ev.offsetX, ev.offsetY)\n    this.updateCursor()\n    window.addEventListener('mouseup', this.onWindowMouseUp)\n  }\n\n  private onMouseDrag = (ev: MouseEvent) => {\n    if (!this.lastDragPos) return\n    const logicalMousePos = new Vec2(ev.offsetX, ev.offsetY)\n    this.pan(this.lastDragPos.minus(logicalMousePos))\n    this.lastDragPos = logicalMousePos\n\n    // When panning by scrolling, the element under\n    // the cursor will change, so clear the hovered label.\n    if (this.hoveredLabel) {\n      this.props.onNodeHover(null)\n    }\n  }\n\n  private onDblClick = (ev: MouseEvent) => {\n    if (this.hoveredLabel) {\n      const hoveredBounds = this.hoveredLabel.configSpaceBounds\n      const viewportRect = new Rect(\n        hoveredBounds.origin.minus(new Vec2(0, 1)),\n        hoveredBounds.size.withY(this.props.configSpaceViewportRect.height()),\n      )\n      this.props.setConfigSpaceViewportRect(viewportRect)\n    }\n  }\n\n  private onClick = (ev: MouseEvent) => {\n    const logicalMousePos = new Vec2(ev.offsetX, ev.offsetY)\n    const mouseDownPos = this.mouseDownPos\n    this.mouseDownPos = null\n\n    if (mouseDownPos && logicalMousePos.minus(mouseDownPos).length() > 5) {\n      // If the cursor is more than 5 logical space pixels away from the mouse\n      // down location, then don't interpret this event as a click.\n      return\n    }\n\n    if (this.hoveredLabel) {\n      this.props.onNodeSelect(this.hoveredLabel.node)\n      this.renderCanvas()\n    } else {\n      this.props.onNodeSelect(null)\n    }\n  }\n\n  private updateCursor() {\n    if (this.lastDragPos) {\n      document.body.style.cursor = 'grabbing'\n      document.body.style.cursor = '-webkit-grabbing'\n    } else {\n      document.body.style.cursor = 'default'\n    }\n  }\n\n  private onWindowMouseUp = (ev: MouseEvent) => {\n    this.lastDragPos = null\n    this.updateCursor()\n    window.removeEventListener('mouseup', this.onWindowMouseUp)\n  }\n\n  private onMouseMove = (ev: MouseEvent) => {\n    this.currentMousePos = new Vec2(ev.offsetX, ev.offsetY)\n    this.updateCursor()\n    if (this.lastDragPos) {\n      ev.preventDefault()\n      this.onMouseDrag(ev)\n      return\n    }\n\n    const logicalViewSpaceMouse = new Vec2(ev.offsetX, ev.offsetY)\n    const physicalViewSpaceMouse =\n      this.logicalToPhysicalViewSpace().transformPosition(logicalViewSpaceMouse)\n    const configSpaceMouse =\n      this.configSpaceToPhysicalViewSpace().inverseTransformPosition(physicalViewSpaceMouse)\n\n    if (!configSpaceMouse) return\n\n    const setHoveredLabel = (frame: FlamechartFrame, depth = 0) => {\n      const width = frame.end - frame.start\n      const y = this.props.renderInverted ? this.configSpaceSize().y - 1 - depth : depth\n      const configSpaceBounds = new Rect(new Vec2(frame.start, y), new Vec2(width, 1))\n      if (configSpaceMouse.x < configSpaceBounds.left()) return null\n      if (configSpaceMouse.x > configSpaceBounds.right()) return null\n\n      if (configSpaceBounds.contains(configSpaceMouse)) {\n        this.hoveredLabel = {\n          configSpaceBounds,\n          node: frame.node,\n        }\n      }\n\n      for (let child of frame.children) {\n        setHoveredLabel(child, depth + 1)\n      }\n    }\n\n    // This is a dumb hack to get around what appears to be a bug in\n    // TypeScript's reachability analysis. If I do the this.hoveredLabel = null\n    // in the outer function body, the code below accessing\n    // this.hoveredLabel!.node inside of the `if (this.hoveredLabel) {`\n    // complains that \"no property node on never\", indicating that it thinks\n    // that codepath is unreachable.\n    //\n    // Because this.hoveredLabel is accessed in the bound function\n    // setHoveredLabel, the codepath is obviously reachable, but the type\n    // checker is confused about this for some reason.\n    const clearHoveredLabel = () => {\n      this.hoveredLabel = null\n    }\n    clearHoveredLabel()\n\n    for (let frame of this.props.flamechart.getLayers()[0] || []) {\n      setHoveredLabel(frame)\n    }\n\n    if (this.hoveredLabel) {\n      this.props.onNodeHover({node: this.hoveredLabel!.node, event: ev})\n    } else {\n      this.props.onNodeHover(null)\n    }\n\n    this.renderCanvas()\n  }\n\n  private onMouseLeave = (ev: MouseEvent) => {\n    this.currentMousePos = null\n    this.hoveredLabel = null\n    this.props.onNodeHover(null)\n    this.renderCanvas()\n  }\n\n  private onWheel = (ev: WheelEvent) => {\n    ev.preventDefault()\n    this.frameHadWheelEvent = true\n\n    const isZoom = ev.metaKey || ev.ctrlKey\n\n    let deltaY = ev.deltaY\n    let deltaX = ev.deltaX\n    if (ev.deltaMode === ev.DOM_DELTA_LINE) {\n      deltaY *= this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n      deltaX *= this.LOGICAL_VIEW_SPACE_FRAME_HEIGHT\n    }\n\n    if (isZoom && this.interactionLock !== 'pan') {\n      let multiplier = 1 + deltaY / 100\n\n      // On Chrome & Firefox, pinch-to-zoom maps to\n      // WheelEvent + Ctrl Key. We'll accelerate it in\n      // this case, since it feels a bit sluggish otherwise.\n      if (ev.ctrlKey) {\n        multiplier = 1 + deltaY / 40\n      }\n\n      multiplier = clamp(multiplier, 0.1, 10.0)\n\n      this.zoom(new Vec2(ev.offsetX, ev.offsetY), multiplier)\n    } else if (this.interactionLock !== 'zoom') {\n      this.pan(new Vec2(deltaX, deltaY))\n    }\n\n    this.renderCanvas()\n  }\n\n  onWindowKeyPress = (ev: KeyboardEvent) => {\n    if (!this.container) return\n    const {width, height} = this.container.getBoundingClientRect()\n\n    // Check if we have a minimap mouse position (user is hovering over minimap)\n    // if we do, then pan the mouse to the minimap mouse position and then\n    // perform zoom from the center of the main view\n    //\n    // If we aren't hovering over the minimap, then use the main view and\n    // zoom around the mouse position, falling back to the center of\n    // the main view if it's not available.\n    const minimapMousePos = minimapMousePositionAtom.get()\n    let zoomCenter: Vec2\n    let shouldZoom = true\n\n    if (minimapMousePos) {\n      const currentViewport = this.props.configSpaceViewportRect\n\n      // Check if the minimap mouse position is within the current viewport bounds\n      const isWithinViewport =\n        minimapMousePos.x >= currentViewport.left() &&\n        minimapMousePos.x <= currentViewport.right() &&\n        minimapMousePos.y >= currentViewport.top() &&\n        minimapMousePos.y <= currentViewport.bottom()\n\n      // Pan to the minimap mouse position\n      const newOrigin = new Vec2(\n        minimapMousePos.x - currentViewport.width() / 2,\n        minimapMousePos.y - currentViewport.height() / 2,\n      )\n      this.props.setConfigSpaceViewportRect(currentViewport.withOrigin(newOrigin))\n\n      // If the position was outside the viewport, just pan without zooming\n      // Next +/- press will do the zoom\n      if (!isWithinViewport) {\n        shouldZoom = false\n      }\n\n      zoomCenter = new Vec2(width / 2, height / 2)\n    } else {\n      zoomCenter = this.currentMousePos || new Vec2(width / 2, height / 2)\n    }\n\n    // By default the zoom multiplier is 1 (no transformation), if\n    // we are zooming in, scale the transform down by 0.5, else\n    // scale up by 2 (this moves us 1 full grid line chunk at a time)\n    let zoomMultiplier = 1\n\n    switch (ev.key) {\n      case '=':\n      case '+':\n        zoomMultiplier = 0.5\n        break\n      case '-':\n      case '_':\n        zoomMultiplier = 2\n        break\n    }\n\n    if (shouldZoom) {\n      // Slight delay to ensure we pan before zooming\n      requestAnimationFrame(() => {\n        this.zoom(zoomCenter, zoomMultiplier)\n        ev.preventDefault()\n      })\n    }\n\n    if (ev.ctrlKey || ev.shiftKey || ev.metaKey) return\n\n    // NOTE: We intentionally use ev.code rather than ev.key for\n    // WASD in order to have the keys retain the same layout even\n    // if the keyboard layout is not QWERTY.\n    //\n    // See: https://github.com/jlfwong/speedscope/pull/184\n    if (ev.key === '0') {\n      this.zoom(zoomCenter, 1e9)\n    } else if (ev.key === 'ArrowRight' || ev.code === 'KeyD') {\n      this.pan(new Vec2(100, 0))\n    } else if (ev.key === 'ArrowLeft' || ev.code === 'KeyA') {\n      this.pan(new Vec2(-100, 0))\n    } else if (ev.key === 'ArrowUp' || ev.code === 'KeyW') {\n      this.pan(new Vec2(0, -100))\n    } else if (ev.key === 'ArrowDown' || ev.code === 'KeyS') {\n      this.pan(new Vec2(0, 100))\n    } else if (ev.key === 'Escape') {\n      this.props.onNodeSelect(null)\n      this.renderCanvas()\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false\n  }\n  componentWillReceiveProps(nextProps: FlamechartPanZoomViewProps) {\n    if (this.props.flamechart !== nextProps.flamechart) {\n      this.hoveredLabel = null\n      this.renderCanvas()\n    } else if (this.props.searchResults !== nextProps.searchResults) {\n      this.renderCanvas()\n    } else if (this.props.selectedNode !== nextProps.selectedNode) {\n      this.renderCanvas()\n    } else if (this.props.configSpaceViewportRect !== nextProps.configSpaceViewportRect) {\n      this.renderCanvas()\n    } else if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n  componentDidMount() {\n    this.props.canvasContext.addBeforeFrameHandler(this.onBeforeFrame)\n    window.addEventListener('resize', this.onWindowResize)\n    window.addEventListener('keydown', this.onWindowKeyPress)\n  }\n  componentWillUnmount() {\n    this.props.canvasContext.removeBeforeFrameHandler(this.onBeforeFrame)\n    window.removeEventListener('resize', this.onWindowResize)\n    window.removeEventListener('keydown', this.onWindowKeyPress)\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div\n        className={css(style.panZoomView, commonStyle.vbox)}\n        onMouseDown={this.onMouseDown}\n        onMouseMove={this.onMouseMove}\n        onMouseLeave={this.onMouseLeave}\n        onClick={this.onClick}\n        onDblClick={this.onDblClick}\n        onWheel={this.onWheel}\n        ref={this.containerRef}\n      >\n        <canvas width={1} height={1} ref={this.overlayCanvasRef} className={css(style.fill)} />\n      </div>\n    )\n  }\n}\n", "import {Vec2} from '../lib/math'\nimport {Sizes, FontSize, FontFamily, ZIndex} from './style'\nimport {css, StyleSheet} from 'aphrodite'\nimport {ComponentChildren, h} from 'preact'\nimport {useTheme, withTheme} from './themes/theme'\nimport {useCallback} from 'preact/hooks'\n\ninterface HovertipProps {\n  containerSize: Vec2\n  offset: Vec2\n  children?: ComponentChildren\n}\n\nexport function Hovertip(props: HovertipProps) {\n  const style = getStyle(useTheme())\n\n  const {containerSize, offset} = props\n  const containerWidth = containerSize.x\n  const containerHeight = containerSize.y\n\n  const OFFSET_FROM_MOUSE = 7\n\n  const updateLocation = useCallback(\n    (el: HTMLDivElement | null) => {\n      if (!el) return\n\n      const clientRect = el.getBoundingClientRect()\n\n      // Place the hovertip to the right of the cursor.\n      let leftEdgeX = offset.x + OFFSET_FROM_MOUSE\n\n      // If this would cause it to overflow the container, align the right\n      // edge of the hovertip with the right edge of the container.\n      if (leftEdgeX + clientRect.width > containerWidth - 1) {\n        leftEdgeX = containerWidth - clientRect.width - 1\n\n        // If aligning the right edge overflows the container, align the left edge\n        // of the hovertip with the left edge of the container.\n        if (leftEdgeX < 1) {\n          leftEdgeX = 1\n        }\n      }\n      el.style.left = `${leftEdgeX}px`\n\n      // Place the tooltip below the cursor\n      let topEdgeY = offset.y + OFFSET_FROM_MOUSE\n\n      // If this would cause it to overflow the container, place the hovertip\n      // above the cursor instead. This intentionally differs from the horizontal\n      // axis logic to avoid the cursor being in the middle of a hovertip when\n      // possible.\n      if (topEdgeY + clientRect.height > containerHeight - 1) {\n        topEdgeY = offset.y - clientRect.height - 1\n\n        // If placing the hovertip above the cursor overflows the container, align\n        // the top edge of the hovertip with the top edge of the container.\n        if (topEdgeY < 1) {\n          topEdgeY = 1\n        }\n      }\n      el.style.top = `${topEdgeY}px`\n    },\n    [containerWidth, containerHeight, offset.x, offset.y],\n  )\n\n  return (\n    <div className={css(style.hoverTip)} ref={updateLocation}>\n      <div className={css(style.hoverTipRow)}>{props.children}</div>\n    </div>\n  )\n}\n\nconst HOVERTIP_PADDING = 2\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverTip: {\n      position: 'absolute',\n      background: theme.bgPrimaryColor,\n      border: '1px solid black',\n      maxWidth: Sizes.TOOLTIP_WIDTH_MAX,\n      paddingTop: HOVERTIP_PADDING,\n      paddingBottom: HOVERTIP_PADDING,\n      pointerEvents: 'none',\n      userSelect: 'none',\n      fontSize: FontSize.LABEL,\n      fontFamily: FontFamily.MONOSPACE,\n      zIndex: ZIndex.HOVERTIP,\n    },\n    hoverTipRow: {\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      overflowX: 'hidden',\n      paddingLeft: HOVERTIP_PADDING,\n      paddingRight: HOVERTIP_PADDING,\n      maxWidth: Sizes.TOOLTIP_WIDTH_MAX,\n    },\n  }),\n)\n", "import {memo} from 'preact/compat'\nimport {useContext, useMemo, useCallback} from 'preact/hooks'\nimport {SearchView, ProfileSearchContext} from './search-view'\nimport {\n  FlamechartSearchMatch,\n  FlamechartSearchResults,\n  ProfileSearchResults,\n} from '../lib/profile-search'\nimport {Rect, Vec2} from '../lib/math'\nimport {h, createContext, ComponentChildren} from 'preact'\nimport {Flamechart} from '../lib/flamechart'\nimport {CallTreeNode} from '../lib/profile'\n\nexport const FlamechartSearchContext = createContext<FlamechartSearchData | null>(null)\n\nexport interface FlamechartSearchProps {\n  flamechart: Flamechart\n  selectedNode: CallTreeNode | null\n  setSelectedNode: (node: CallTreeNode | null) => void\n  configSpaceViewportRect: Rect\n  setConfigSpaceViewportRect: (rect: Rect) => void\n  children: ComponentChildren\n}\n\ninterface FlamechartSearchData {\n  results: FlamechartSearchResults | null\n  flamechart: Flamechart\n  selectedNode: CallTreeNode | null\n  setSelectedNode: (node: CallTreeNode | null) => void\n  configSpaceViewportRect: Rect\n  setConfigSpaceViewportRect: (rect: Rect) => void\n}\n\nexport const FlamechartSearchContextProvider = ({\n  flamechart,\n  selectedNode,\n  setSelectedNode,\n  configSpaceViewportRect,\n  setConfigSpaceViewportRect,\n  children,\n}: FlamechartSearchProps) => {\n  const profileSearchResults: ProfileSearchResults | null = useContext(ProfileSearchContext)\n  const flamechartSearchResults: FlamechartSearchResults | null = useMemo(() => {\n    if (profileSearchResults == null) {\n      return null\n    }\n    return new FlamechartSearchResults(flamechart, profileSearchResults)\n  }, [flamechart, profileSearchResults])\n\n  return (\n    <FlamechartSearchContext.Provider\n      value={{\n        results: flamechartSearchResults,\n        flamechart,\n        selectedNode,\n        setSelectedNode,\n        configSpaceViewportRect,\n        setConfigSpaceViewportRect,\n      }}\n    >\n      {children}\n    </FlamechartSearchContext.Provider>\n  )\n}\n\nexport const FlamechartSearchView = memo(() => {\n  const flamechartData = useContext(FlamechartSearchContext)\n\n  // TODO(jlfwong): This pattern is pretty gross, but I really don't want values\n  // that can be undefined or null.\n  const searchResults = flamechartData == null ? null : flamechartData.results\n  const selectedNode = flamechartData == null ? null : flamechartData.selectedNode\n  const setSelectedNode = flamechartData == null ? null : flamechartData.setSelectedNode\n  const configSpaceViewportRect =\n    flamechartData == null ? null : flamechartData.configSpaceViewportRect\n  const setConfigSpaceViewportRect =\n    flamechartData == null ? null : flamechartData.setConfigSpaceViewportRect\n  const flamechart = flamechartData == null ? null : flamechartData.flamechart\n\n  const numResults = searchResults == null ? null : searchResults.count()\n  const resultIndex: number | null = useMemo(() => {\n    if (searchResults == null) return null\n    if (selectedNode == null) return null\n    return searchResults.indexOf(selectedNode)\n  }, [searchResults, selectedNode])\n\n  const selectAndZoomToMatch = useCallback(\n    (match: FlamechartSearchMatch) => {\n      if (!setSelectedNode) return\n      if (!flamechart) return\n      if (!configSpaceViewportRect) return\n      if (!setConfigSpaceViewportRect) return\n\n      // After the node is selected, we want to set the viewport so that the new\n      // node can be seen clearly.\n      //\n      // TODO(jlfwong): The lack of animation here can be kind of jarring. It\n      // would be nice to have some easier way for people to orient themselves\n      // after the viewport shifted.\n      const configSpaceResultBounds = match.configSpaceBounds\n\n      const viewportRect = new Rect(\n        configSpaceResultBounds.origin.minus(new Vec2(0, 1)),\n        configSpaceResultBounds.size.withY(configSpaceViewportRect.height()),\n      )\n\n      setSelectedNode(match.node)\n      setConfigSpaceViewportRect(\n        flamechart.getClampedConfigSpaceViewportRect({configSpaceViewportRect: viewportRect}),\n      )\n    },\n    [configSpaceViewportRect, setConfigSpaceViewportRect, setSelectedNode, flamechart],\n  )\n\n  const {selectPrev, selectNext} = useMemo(() => {\n    if (numResults == null || numResults === 0 || searchResults == null) {\n      return {selectPrev: () => {}, selectNext: () => {}}\n    }\n\n    return {\n      selectPrev: () => {\n        if (!searchResults?.at) return\n        if (numResults == null || numResults === 0) return\n\n        let index = resultIndex == null ? numResults - 1 : resultIndex - 1\n        if (index < 0) index = numResults - 1\n        const result = searchResults.at(index)\n        selectAndZoomToMatch(result)\n      },\n\n      selectNext: () => {\n        if (!searchResults?.at) return\n        if (numResults == null || numResults === 0) return\n\n        let index = resultIndex == null ? 0 : resultIndex + 1\n        if (index >= numResults) index = 0\n        const result = searchResults.at(index)\n        selectAndZoomToMatch(result)\n      },\n    }\n  }, [numResults, resultIndex, searchResults, selectAndZoomToMatch])\n\n  return (\n    <SearchView\n      resultIndex={resultIndex}\n      numResults={numResults}\n      selectPrev={selectPrev}\n      selectNext={selectNext}\n    />\n  )\n})\n", "import {Component} from 'preact'\n\nexport type VoidState = {\n  __dummyField: void\n}\nexport abstract class StatelessComponent<P> extends Component<P, VoidState> {}\n", "import {h, Fragment} from 'preact'\nimport {css} from 'aphrodite'\n\nimport {CallTreeNode} from '../lib/profile'\n\nimport {Rect, Vec2, AffineTransform} from '../lib/math'\nimport {formatPercent} from '../lib/utils'\nimport {FlamechartMinimapView} from './flamechart-minimap-view'\n\nimport {Sizes, commonStyle} from './style'\nimport {FlamechartDetailView} from './flamechart-detail-view'\nimport {FlamechartPanZoomView} from './flamechart-pan-zoom-view'\nimport {Hovertip} from './hovertip'\nimport {FlamechartViewProps} from './flamechart-view-container'\nimport {ProfileSearchContext} from './search-view'\nimport {FlamechartSearchView} from './flamechart-search-view'\nimport {getFlamechartStyle} from './flamechart-style'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\nexport class FlamechartView extends StatelessComponent<FlamechartViewProps> {\n  private getStyle() {\n    return getFlamechartStyle(this.props.theme)\n  }\n\n  private configSpaceSize() {\n    return new Vec2(\n      this.props.flamechart.getTotalWeight(),\n      this.props.flamechart.getLayers().length,\n    )\n  }\n\n  private setConfigSpaceViewportRect = (viewportRect: Rect): void => {\n    const configSpaceDetailViewHeight = Sizes.DETAIL_VIEW_HEIGHT / Sizes.FRAME_HEIGHT\n\n    const configSpaceSize = this.configSpaceSize()\n\n    const width = this.props.flamechart.getClampedViewportWidth(viewportRect.size.x)\n    const size = viewportRect.size.withX(width)\n\n    const origin = Vec2.clamp(\n      viewportRect.origin,\n      new Vec2(0, -1),\n      Vec2.max(\n        Vec2.zero,\n        configSpaceSize.minus(size).plus(new Vec2(0, configSpaceDetailViewHeight + 1)),\n      ),\n    )\n\n    this.props.setConfigSpaceViewportRect(new Rect(origin, viewportRect.size.withX(width)))\n  }\n\n  private setLogicalSpaceViewportSize = (logicalSpaceViewportSize: Vec2): void => {\n    this.props.setLogicalSpaceViewportSize(logicalSpaceViewportSize)\n  }\n\n  private transformViewport = (transform: AffineTransform): void => {\n    const viewportRect = transform.transformRect(this.props.configSpaceViewportRect)\n    this.setConfigSpaceViewportRect(viewportRect)\n  }\n\n  private onNodeHover = (hover: {node: CallTreeNode; event: MouseEvent} | null) => {\n    this.props.setNodeHover(hover)\n  }\n\n  onNodeClick = (node: CallTreeNode | null) => {\n    this.props.setSelectedNode(node)\n  }\n\n  formatValue(weight: number) {\n    const totalWeight = this.props.flamechart.getTotalWeight()\n    const percent = (100 * weight) / totalWeight\n    const formattedPercent = formatPercent(percent)\n    return `${this.props.flamechart.formatValue(weight)} (${formattedPercent})`\n  }\n\n  renderTooltip() {\n    if (!this.container) return null\n\n    const {hover} = this.props\n    if (!hover) return null\n    const {width, height, left, top} = this.container.getBoundingClientRect()\n    const offset = new Vec2(hover.event.clientX - left, hover.event.clientY - top)\n    const frame = hover.node.frame\n\n    const style = this.getStyle()\n\n    return (\n      <Hovertip containerSize={new Vec2(width, height)} offset={offset}>\n        <span className={css(style.hoverCount)}>\n          {this.formatValue(hover.node.getTotalWeight())}\n        </span>{' '}\n        {frame.name}\n        {frame.file ? (\n          <div>\n            {frame.file}:{frame.line}\n          </div>\n        ) : undefined}\n      </Hovertip>\n    )\n  }\n\n  container: HTMLDivElement | null = null\n  containerRef = (container: Element | null) => {\n    this.container = (container as HTMLDivElement) || null\n  }\n\n  render() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.fill, commonStyle.vbox)} ref={this.containerRef}>\n        <FlamechartMinimapView\n          theme={this.props.theme}\n          configSpaceViewportRect={this.props.configSpaceViewportRect}\n          transformViewport={this.transformViewport}\n          flamechart={this.props.flamechart}\n          flamechartRenderer={this.props.flamechartRenderer}\n          canvasContext={this.props.canvasContext}\n          setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n        />\n        <ProfileSearchContext.Consumer>\n          {searchResults => (\n            <Fragment>\n              <FlamechartPanZoomView\n                theme={this.props.theme}\n                canvasContext={this.props.canvasContext}\n                flamechart={this.props.flamechart}\n                flamechartRenderer={this.props.flamechartRenderer}\n                renderInverted={false}\n                onNodeHover={this.onNodeHover}\n                onNodeSelect={this.onNodeClick}\n                selectedNode={this.props.selectedNode}\n                transformViewport={this.transformViewport}\n                configSpaceViewportRect={this.props.configSpaceViewportRect}\n                setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n                logicalSpaceViewportSize={this.props.logicalSpaceViewportSize}\n                setLogicalSpaceViewportSize={this.setLogicalSpaceViewportSize}\n                searchResults={searchResults}\n              />\n              <FlamechartSearchView />\n            </Fragment>\n          )}\n        </ProfileSearchContext.Consumer>\n        {this.renderTooltip()}\n        {this.props.selectedNode && (\n          <FlamechartDetailView\n            flamechart={this.props.flamechart}\n            getCSSColorForFrame={this.props.getCSSColorForFrame}\n            selectedNode={this.props.selectedNode}\n          />\n        )}\n      </div>\n    )\n  }\n}\n", "import {h} from 'preact'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {Flamechart} from '../lib/flamechart'\nimport {FlamechartRenderer, FlamechartRendererOptions} from '../gl/flamechart-renderer'\nimport {Frame, Profile, CallTreeNode} from '../lib/profile'\nimport {memoizeByShallowEquality} from '../lib/utils'\nimport {FlamechartView} from './flamechart-view'\nimport {\n  getRowAtlas,\n  createGetColorBucketForFrame,\n  getCanvasContext,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {Vec2, Rect} from '../lib/math'\nimport {memo, useCallback} from 'preact/compat'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {FlamechartSearchContextProvider} from './flamechart-search-view'\nimport {Theme, useTheme} from './themes/theme'\nimport {FlamechartID, FlamechartViewState} from '../app-state/profile-group'\nimport {profileGroupAtom} from '../app-state'\n\ninterface FlamechartSetters {\n  setLogicalSpaceViewportSize: (logicalSpaceViewportSize: Vec2) => void\n  setConfigSpaceViewportRect: (configSpaceViewportRect: Rect) => void\n  setNodeHover: (hover: {node: CallTreeNode; event: MouseEvent} | null) => void\n  setSelectedNode: (node: CallTreeNode | null) => void\n}\n\nexport function useFlamechartSetters(id: FlamechartID): FlamechartSetters {\n  return {\n    setNodeHover: useCallback(\n      (hover: {node: CallTreeNode; event: MouseEvent} | null) => {\n        profileGroupAtom.setFlamechartHoveredNode(id, hover)\n      },\n      [id],\n    ),\n    setLogicalSpaceViewportSize: useCallback(\n      (logicalSpaceViewportSize: Vec2) => {\n        profileGroupAtom.setLogicalSpaceViewportSize(id, logicalSpaceViewportSize)\n      },\n      [id],\n    ),\n    setConfigSpaceViewportRect: useCallback(\n      (configSpaceViewportRect: Rect) => {\n        profileGroupAtom.setConfigSpaceViewportRect(id, configSpaceViewportRect)\n      },\n      [id],\n    ),\n    setSelectedNode: useCallback(\n      (selectedNode: CallTreeNode | null) => {\n        profileGroupAtom.setSelectedNode(id, selectedNode)\n      },\n      [id],\n    ),\n  }\n}\n\nexport type FlamechartViewProps = {\n  theme: Theme\n  canvasContext: CanvasContext\n  flamechart: Flamechart\n  flamechartRenderer: FlamechartRenderer\n  renderInverted: boolean\n  getCSSColorForFrame: (frame: Frame) => string\n} & FlamechartSetters &\n  FlamechartViewState\n\nexport const getChronoViewFlamechart = memoizeByShallowEquality(\n  ({\n    profile,\n    getColorBucketForFrame,\n  }: {\n    profile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: profile.getTotalWeight.bind(profile),\n      forEachCall: profile.forEachCall.bind(profile),\n      formatValue: profile.formatValue.bind(profile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nexport const createMemoizedFlamechartRenderer = (options?: FlamechartRendererOptions) =>\n  memoizeByShallowEquality(\n    ({\n      canvasContext,\n      flamechart,\n    }: {\n      canvasContext: CanvasContext\n      flamechart: Flamechart\n    }): FlamechartRenderer => {\n      return new FlamechartRenderer(\n        canvasContext.gl,\n        getRowAtlas(canvasContext),\n        flamechart,\n        canvasContext.rectangleBatchRenderer,\n        canvasContext.flamechartColorPassRenderer,\n        options,\n      )\n    },\n  )\n\nconst getChronoViewFlamechartRenderer = createMemoizedFlamechartRenderer()\n\nexport interface FlamechartViewContainerProps {\n  activeProfileState: ActiveProfileState\n  glCanvas: HTMLCanvasElement\n}\n\nexport const ChronoFlamechartView = memo((props: FlamechartViewContainerProps) => {\n  const {activeProfileState, glCanvas} = props\n  const {profile, chronoViewState} = activeProfileState\n\n  const theme = useTheme()\n\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const flamechart = getChronoViewFlamechart({profile, getColorBucketForFrame})\n  const flamechartRenderer = getChronoViewFlamechartRenderer({\n    canvasContext,\n    flamechart,\n  })\n\n  const setters = useFlamechartSetters(FlamechartID.CHRONO)\n\n  return (\n    <FlamechartSearchContextProvider\n      flamechart={flamechart}\n      selectedNode={chronoViewState.selectedNode}\n      setSelectedNode={setters.setSelectedNode}\n      configSpaceViewportRect={chronoViewState.configSpaceViewportRect}\n      setConfigSpaceViewportRect={setters.setConfigSpaceViewportRect}\n    >\n      <FlamechartView\n        theme={theme}\n        renderInverted={false}\n        flamechart={flamechart}\n        flamechartRenderer={flamechartRenderer}\n        canvasContext={canvasContext}\n        getCSSColorForFrame={getCSSColorForFrame}\n        {...chronoViewState}\n        {...setters}\n      />\n    </FlamechartSearchContextProvider>\n  )\n})\n\nexport const getLeftHeavyFlamechart = memoizeByShallowEquality(\n  ({\n    profile,\n    getColorBucketForFrame,\n  }: {\n    profile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: profile.getTotalNonIdleWeight.bind(profile),\n      forEachCall: profile.forEachCallGrouped.bind(profile),\n      formatValue: profile.formatValue.bind(profile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nconst getLeftHeavyFlamechartRenderer = createMemoizedFlamechartRenderer()\n\nexport const LeftHeavyFlamechartView = memo((ownProps: FlamechartViewContainerProps) => {\n  const {activeProfileState, glCanvas} = ownProps\n\n  const {profile, leftHeavyViewState} = activeProfileState\n\n  const theme = useTheme()\n\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const flamechart = getLeftHeavyFlamechart({\n    profile,\n    getColorBucketForFrame,\n  })\n  const flamechartRenderer = getLeftHeavyFlamechartRenderer({\n    canvasContext,\n    flamechart,\n  })\n\n  const setters = useFlamechartSetters(FlamechartID.LEFT_HEAVY)\n\n  return (\n    <FlamechartSearchContextProvider\n      flamechart={flamechart}\n      selectedNode={leftHeavyViewState.selectedNode}\n      setSelectedNode={setters.setSelectedNode}\n      configSpaceViewportRect={leftHeavyViewState.configSpaceViewportRect}\n      setConfigSpaceViewportRect={setters.setConfigSpaceViewportRect}\n    >\n      <FlamechartView\n        theme={theme}\n        renderInverted={false}\n        flamechart={flamechart}\n        flamechartRenderer={flamechartRenderer}\n        canvasContext={canvasContext}\n        getCSSColorForFrame={getCSSColorForFrame}\n        {...leftHeavyViewState}\n        {...setters}\n      />\n    </FlamechartSearchContextProvider>\n  )\n})\n", "/**\n * This file contains an implementation of fuzzy string matching.\n */\n\nexport interface FuzzyMatch {\n  // List of [start, end] indices in the haystack string that match the needle string\n  matchedRanges: [number, number][]\n\n  // The score of the match for relative ranking. Higher scores indicate\n  // \"better\" matches.\n  score: number\n}\n\nexport function fuzzyMatchStrings(text: string, pattern: string): FuzzyMatch | null {\n  return fzfFuzzyMatchV1(text, pattern)\n}\n\n// The implementation here is based on FuzzyMatchV1, as described here:\n// https://github.com/junegunn/fzf/blob/f81feb1e69e5cb75797d50817752ddfe4933cd68/src/algo/algo.go#L8-L15\n//\n// This is a hand-port to better understand what the code is doing and for added\n// clarity.\n//\n// Capitalized letters only match capitalized letters, but lower-case letters\n// match both.\n//\n// Note: fzf includes a normalization table for homoglyphs. I'm going to ignore that too\n// https://github.com/junegunn/fzf/blob/master/src/algo/normalize.go\nconst charCodeLowerA = 'a'.charCodeAt(0)\nconst charCodeLowerZ = 'z'.charCodeAt(0)\nconst charCodeUpperA = 'A'.charCodeAt(0)\nconst charCodeUpperZ = 'Z'.charCodeAt(0)\nconst charCodeDigit0 = '0'.charCodeAt(0)\nconst charCodeDigit9 = '9'.charCodeAt(0)\n\nenum fzfCharClass {\n  charNonWord,\n  charLower,\n  charUpper,\n  charNumber,\n}\n\nfunction fzfCharClassOf(char: string): fzfCharClass {\n  const code = char.charCodeAt(0)\n  if (charCodeLowerA <= code && code <= charCodeLowerZ) {\n    return fzfCharClass.charLower\n  } else if (charCodeUpperA <= code && code <= charCodeUpperZ) {\n    return fzfCharClass.charUpper\n  } else if (charCodeDigit0 <= code && code <= charCodeDigit9) {\n    return fzfCharClass.charNumber\n  }\n  return fzfCharClass.charNonWord\n}\n\nfunction charsMatch(textChar: string, patternChar: string): boolean {\n  if (textChar === patternChar) return true\n\n  const patternCharCode = patternChar.charCodeAt(0)\n  if (charCodeLowerA <= patternCharCode && patternCharCode <= charCodeLowerZ) {\n    return textChar.charCodeAt(0) === patternCharCode - charCodeLowerA + charCodeUpperA\n  }\n  return false\n}\n\nfunction fzfFuzzyMatchV1(text: string, pattern: string): FuzzyMatch | null {\n  if (pattern.length == 0) {\n    return {matchedRanges: [], score: 0}\n  }\n\n  // I removed the fzfAsciiFuzzyIndex code because it's not actually clear to\n  // me that it's a very helpful optimization.\n\n  let pidx = 0\n  let sidx = -1\n  let eidx = -1\n\n  let lenRunes = text.length\n  let lenPattern = pattern.length\n\n  // Forward pass: scan over the text pattern, identifying the earliest start\n  // and the latest end to consider.\n  for (let index = 0; index < lenRunes; index++) {\n    let char = text[index]\n    let pchar = pattern[pidx]\n    if (charsMatch(char, pchar)) {\n      if (sidx < 0) {\n        sidx = index\n      }\n      pidx++\n      if (pidx == lenPattern) {\n        // We found the last character in the pattern! eidx is exclusive, so\n        // we'll set it to the current index + 1.\n        eidx = index + 1\n        break\n      }\n    }\n  }\n\n  if (eidx == -1) {\n    // We couldn't find all the characters in the pattern. No match.\n    return null\n  }\n\n  // Assuming we found all the characters in the pattern, perform the backwards\n  // pass.\n  pidx--\n  for (let index = eidx - 1; index >= sidx; index--) {\n    const char = text[index]\n    const pchar = pattern[pidx]\n    if (charsMatch(char, pchar)) {\n      pidx--\n      if (pidx < 0) {\n        // We found the first character of the pattern, scanning\n        // backwards. This *may* have narrowed the match further.\n        // For example, for the following inputs:\n        //\n        //    text = \"xxx a b c abc xxx\"\n        // pattern = \"abc\"\n        //\n        // For the forward pass, you get:\n        //\n        //    \"xxx a b c abc xxx\"\n        //    start^        ^end\n        //\n        // But after the backward pass, we can narrow this to:\n        //\n        //    \"xxx a b c abc xxx\"\n        //          start^  ^end\n        sidx = index\n        return fzfCalculateScore(text, pattern, sidx, eidx)\n      }\n    }\n  }\n\n  // This should be unreachable.\n  throw new Error('Implementation error. This must be a bug in fzfFuzzyMatchV1')\n}\n\nconst fzfScoreMatch = 16\nconst fzfScoreGapStart = -3\nconst fzfScoreGapExtension = -1\nconst fzfBonusBoundary = fzfScoreMatch / 2\nconst fzfBonusNonWord = fzfScoreMatch / 2\nconst fzfBonusCamel123 = fzfBonusBoundary + fzfScoreGapExtension\nconst fzfBonusConsecutive = -(fzfScoreGapStart + fzfScoreGapExtension)\nconst fzfBonusFirstCharMultiplier = 2\n\nfunction bonusFor(prevClass: fzfCharClass, curClass: fzfCharClass): number {\n  if (prevClass === fzfCharClass.charNonWord && curClass !== fzfCharClass.charNonWord) {\n    // Prefer matching at word boundaries\n    //\n    // This should prefer \"a c\" over \"abc\" for a pattern of \"ac\".\n    return fzfBonusBoundary\n  }\n\n  if (\n    (prevClass === fzfCharClass.charLower && curClass == fzfCharClass.charUpper) ||\n    (prevClass !== fzfCharClass.charNumber && curClass == fzfCharClass.charNumber)\n  ) {\n    // Prefer matching at the transition point between lower & upper for camelCase,\n    // and from transition from letter to number for identifiers like letter123.\n    //\n    // This should prefer \"OutNode\" over \"phone\" for a pattern of \"n\",\n    // and \"abc123\" over \"x211\" for a pattern of \"1\".\n    return fzfBonusCamel123\n  }\n\n  if (curClass === fzfCharClass.charNonWord) {\n    return fzfBonusNonWord\n  }\n  return 0\n}\n\nfunction fzfCalculateScore(text: string, pattern: string, sidx: number, eidx: number): FuzzyMatch {\n  let pidx = 0\n  let score = 0\n  let inGap = false\n  let consecutive = 0\n  let firstBonus = 0\n  let pos: number[] = new Array(pattern.length)\n  let prevClass = fzfCharClass.charNonWord\n\n  if (sidx > 0) {\n    prevClass = fzfCharClassOf(text[sidx - 1])\n  }\n  for (let idx = sidx; idx < eidx; idx++) {\n    let char = text[idx]\n    let curClass = fzfCharClassOf(char)\n    if (charsMatch(char, pattern[pidx])) {\n      pos[pidx] = idx\n      score += fzfScoreMatch\n      let bonus = bonusFor(prevClass, curClass)\n      if (consecutive == 0) {\n        firstBonus = bonus\n      } else {\n        // Break consecutive chunk\n        if (bonus === fzfBonusBoundary) {\n          firstBonus = bonus\n        }\n        bonus = Math.max(bonus, firstBonus, fzfBonusConsecutive)\n      }\n      if (pidx === 0) {\n        score += bonus * fzfBonusFirstCharMultiplier\n      } else {\n        score += bonus\n      }\n      inGap = false\n      consecutive++\n      pidx++\n    } else {\n      if (inGap) {\n        // Penalize gaps (this bonus is negative)\n        score += fzfScoreGapExtension\n      } else {\n        // Penalize the beginning of gaps more harshly\n        score += fzfScoreGapStart\n      }\n      inGap = true\n      consecutive = 0\n      firstBonus = 0\n    }\n    prevClass = curClass\n  }\n\n  if (pidx !== pattern.length) {\n    throw new Error(\n      'fzfCalculateScore should only be called when pattern is found between sidx and eidx',\n    )\n  }\n\n  let matchedRanges: [number, number][] = [[pos[0], pos[0] + 1]]\n  for (let i = 1; i < pos.length; i++) {\n    const curPos = pos[i]\n    const curRange = matchedRanges[matchedRanges.length - 1]\n    if (curRange[1] === curPos) {\n      curRange[1] = curPos + 1\n    } else {\n      matchedRanges.push([curPos, curPos + 1])\n    }\n  }\n\n  return {\n    score,\n    matchedRanges,\n  }\n}\n", "import {Profile} from '../lib/profile'\nimport {h, JSX, ComponentChild, Ref} from 'preact'\nimport {useCallback, useState, useMemo, useEffect, useRef} from 'preact/hooks'\nimport {StyleSheet, css} from 'aphrodite'\nimport {ZIndex, Sizes, FontSize} from './style'\nimport {fuzzyMatchStrings} from '../lib/fuzzy-find'\nimport {sortBy} from '../lib/utils'\nimport {useTheme, withTheme} from './themes/theme'\n\nenum SortField {\n  NAME = 'name',\n  WEIGHT = 'weight',\n  INDEX = 'index',\n}\n\nenum SortDirection {\n  ASCENDING = 'ascending',\n  DESCENDING = 'descending',\n}\n\ninterface SortMethod {\n  field: SortField\n  direction: SortDirection\n}\n\ninterface ProfileSelectRowProps {\n  setProfileIndexToView: (profileIndex: number) => void\n  setHoveredProfileIndex: (profileIndex: number) => void\n  profile: Profile\n  matchedRanges: [number, number][]\n  hovered: boolean\n  selected: boolean\n  indexInProfileGroup: number\n  indexInFilteredListView: number\n  nodeRef?: Ref<HTMLTableRowElement>\n  closeProfileSelect: () => void\n}\n\nfunction highlightRanges(\n  text: string,\n  ranges: [number, number][],\n  highlightedClassName: string,\n): JSX.Element {\n  const spans: ComponentChild[] = []\n  let last = 0\n  for (let range of ranges) {\n    spans.push(text.slice(last, range[0]))\n    spans.push(<span className={highlightedClassName}>{text.slice(range[0], range[1])}</span>)\n    last = range[1]\n  }\n  spans.push(text.slice(last))\n\n  return <span>{spans}</span>\n}\n\nfunction SortIcon({activeDirection}: {activeDirection: SortDirection | null}) {\n  const theme = useTheme()\n  const style = getStyle(theme)\n\n  const upFill =\n    activeDirection === SortDirection.ASCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n  const downFill =\n    activeDirection === SortDirection.DESCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n\n  return (\n    <svg\n      width=\"8\"\n      height=\"10\"\n      viewBox=\"0 0 8 10\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      className={css(style.sortIcon)}\n    >\n      <path d=\"M0 4L4 0L8 4H0Z\" fill={upFill} />\n      <path d=\"M0 4L4 0L8 4H0Z\" transform=\"translate(0 10) scale(1 -1)\" fill={downFill} />\n    </svg>\n  )\n}\n\nexport function ProfileSelectRow({\n  setProfileIndexToView,\n  setHoveredProfileIndex,\n  profile,\n  selected,\n  hovered,\n  nodeRef,\n  closeProfileSelect,\n  indexInProfileGroup,\n  matchedRanges,\n  indexInFilteredListView,\n}: ProfileSelectRowProps) {\n  const style = getStyle(useTheme())\n\n  const onMouseUp = useCallback(() => {\n    closeProfileSelect()\n    setProfileIndexToView(indexInProfileGroup)\n  }, [closeProfileSelect, setProfileIndexToView, indexInProfileGroup])\n\n  const onMouseEnter = useCallback(\n    (ev: Event) => {\n      setHoveredProfileIndex(indexInProfileGroup)\n    },\n    [setHoveredProfileIndex, indexInProfileGroup],\n  )\n\n  const name = profile.getName()\n  const weight = profile.getTotalNonIdleWeight()\n\n  const highlightedClassName = css(style.highlighted)\n  const highlighted = useMemo(() => {\n    const result = highlightRanges(name, matchedRanges, highlightedClassName)\n    return result\n  }, [name, matchedRanges, highlightedClassName])\n\n  return (\n    <tr\n      ref={nodeRef}\n      onMouseUp={onMouseUp}\n      onMouseEnter={onMouseEnter}\n      title={name}\n      className={css(\n        style.profileRow,\n        indexInFilteredListView % 2 === 0 && style.profileRowEven,\n        selected && style.profileRowSelected,\n        hovered && style.profileRowHovered,\n      )}\n    >\n      <td className={css(style.indexCell)}>{indexInProfileGroup + 1}</td>\n      <td className={css(style.nameCell)}>{highlighted}</td>\n      <td className={css(style.weightCell)}>{profile.formatValue(weight)}</td>\n    </tr>\n  )\n}\n\ninterface ProfileSelectProps {\n  setProfileIndexToView: (profileIndex: number) => void\n  indexToView: number\n  profiles: Profile[]\n  closeProfileSelect: () => void\n  visible: boolean\n}\n\nfunction stopPropagation(ev: Event) {\n  ev.stopPropagation()\n}\n\ninterface FilteredProfile {\n  indexInProfileGroup: number\n  profile: Profile\n  matchedRanges: [number, number][]\n  score: number\n}\n\nfunction getSortedFilteredProfiles(\n  profiles: Profile[],\n  filterText: string,\n  sortMethod: SortMethod,\n): FilteredProfile[] {\n  const filtered: FilteredProfile[] = []\n  for (let i = 0; i < profiles.length; i++) {\n    const profile = profiles[i]\n    const match = fuzzyMatchStrings(profile.getName(), filterText)\n    if (!match) continue\n    filtered.push({\n      indexInProfileGroup: i,\n      profile,\n      ...match,\n    })\n  }\n\n  // Apply sorting\n  if (sortMethod.field === SortField.NAME) {\n    filtered.sort((a, b) => {\n      const nameA = a.profile.getName().toLowerCase()\n      const nameB = b.profile.getName().toLowerCase()\n      if (sortMethod.direction === SortDirection.ASCENDING) {\n        return nameA.localeCompare(nameB)\n      } else {\n        return nameB.localeCompare(nameA)\n      }\n    })\n  } else if (sortMethod.field === SortField.WEIGHT) {\n    sortBy(filtered, p =>\n      sortMethod.direction === SortDirection.ASCENDING\n        ? p.profile.getTotalNonIdleWeight()\n        : -p.profile.getTotalNonIdleWeight(),\n    )\n  } else if (sortMethod.field === SortField.INDEX) {\n    sortBy(filtered, p =>\n      sortMethod.direction === SortDirection.ASCENDING\n        ? p.indexInProfileGroup\n        : -p.indexInProfileGroup,\n    )\n  } else {\n    // Default to fuzzy search score\n    sortBy(filtered, p => -p.score)\n  }\n\n  return filtered\n}\n\nexport function ProfileSelect({\n  profiles,\n  closeProfileSelect,\n  indexToView,\n  visible,\n  setProfileIndexToView,\n}: ProfileSelectProps) {\n  const style = getStyle(useTheme())\n\n  const [filterText, setFilterText] = useState('')\n  const [sortMethod, setSortMethod] = useState<SortMethod>({\n    field: SortField.INDEX,\n    direction: SortDirection.ASCENDING,\n  })\n\n  const onFilterTextChange = useCallback(\n    (ev: Event) => {\n      const value = (ev.target as HTMLInputElement).value\n      setFilterText(value)\n    },\n    [setFilterText],\n  )\n\n  const focusFilterInput = useCallback(\n    (node: HTMLInputElement | null) => {\n      if (node) {\n        if (visible) {\n          node.select()\n        } else {\n          node.blur()\n        }\n      }\n    },\n    [visible],\n  )\n\n  const onSortClick = useCallback(\n    (field: SortField, ev: MouseEvent) => {\n      ev.preventDefault()\n      ev.stopPropagation()\n\n      if (sortMethod.field === field) {\n        // Toggle direction\n        setSortMethod({\n          field,\n          direction:\n            sortMethod.direction === SortDirection.ASCENDING\n              ? SortDirection.DESCENDING\n              : SortDirection.ASCENDING,\n        })\n      } else {\n        // Set new field with default direction\n        const direction =\n          field === SortField.NAME || field === SortField.INDEX\n            ? SortDirection.ASCENDING\n            : SortDirection.DESCENDING\n        setSortMethod({field, direction})\n      }\n    },\n    [sortMethod, setSortMethod],\n  )\n\n  const filteredProfiles = useMemo(() => {\n    return getSortedFilteredProfiles(profiles, filterText, sortMethod)\n  }, [profiles, filterText, sortMethod])\n\n  const [hoveredProfileIndex, setHoveredProfileIndex] = useState<number | null>(0)\n\n  const selectedNodeRef = useRef<HTMLTableRowElement | null>(null)\n  useEffect(() => {\n    if (visible) {\n      // Whenever the profile select becomes visible...\n\n      // Clear any hovered element\n      setHoveredProfileIndex(null)\n\n      // And scroll the selected profile into view, if possible\n      if (selectedNodeRef.current !== null) {\n        selectedNodeRef.current.scrollIntoView({\n          behavior: 'auto',\n          block: 'nearest',\n          inline: 'nearest',\n        })\n      }\n    }\n  }, [visible])\n\n  // TODO(jlfwong): Hi-jacking the behavior of enter and the arrow keys won't\n  // work well for some composition methods (e.g. a Chinese character\n  // composition keyboard input method).\n  const onFilterKeyUp = useCallback(\n    (ev: KeyboardEvent) => {\n      // Prevent the key-press from propagating to other keyboard shortcut\n      // handlers in other components.\n      ev.stopPropagation()\n\n      let newHoveredIndexInFilteredList: number | null = null\n\n      switch (ev.key) {\n        case 'Enter': {\n          if (hoveredProfileIndex != null) {\n            closeProfileSelect()\n            setProfileIndexToView(hoveredProfileIndex)\n          }\n          break\n        }\n        case 'Escape': {\n          closeProfileSelect()\n          break\n        }\n        case 'ArrowDown': {\n          ev.preventDefault()\n          newHoveredIndexInFilteredList = 0\n          if (hoveredProfileIndex != null) {\n            const indexInFilteredList = filteredProfiles.findIndex(\n              p => p.indexInProfileGroup === hoveredProfileIndex,\n            )\n            if (indexInFilteredList !== -1) {\n              newHoveredIndexInFilteredList = indexInFilteredList + 1\n            }\n          }\n          break\n        }\n        case 'ArrowUp': {\n          ev.preventDefault()\n          newHoveredIndexInFilteredList = filteredProfiles.length - 1\n          if (hoveredProfileIndex != null) {\n            const indexInFilteredList = filteredProfiles.findIndex(\n              p => p.indexInProfileGroup === hoveredProfileIndex,\n            )\n            if (indexInFilteredList !== -1) {\n              newHoveredIndexInFilteredList = indexInFilteredList - 1\n            }\n          }\n          break\n        }\n      }\n\n      if (\n        newHoveredIndexInFilteredList != null &&\n        newHoveredIndexInFilteredList >= 0 &&\n        newHoveredIndexInFilteredList < filteredProfiles.length\n      ) {\n        const indexInProfileGroup =\n          filteredProfiles[newHoveredIndexInFilteredList].indexInProfileGroup\n        setHoveredProfileIndex(indexInProfileGroup)\n        setPendingForcedScroll(true)\n      }\n    },\n    [closeProfileSelect, setProfileIndexToView, hoveredProfileIndex, filteredProfiles],\n  )\n\n  const [pendingForcedScroll, setPendingForcedScroll] = useState(false)\n  useEffect(() => {\n    // Whenever the list of filtered profiles changes, set the first element hovered.\n    if (filteredProfiles.length > 0) {\n      setHoveredProfileIndex(filteredProfiles[0].indexInProfileGroup)\n      setPendingForcedScroll(true)\n    }\n  }, [setHoveredProfileIndex, filteredProfiles])\n\n  const hoveredNodeRef = useCallback(\n    (hoveredNode: HTMLTableRowElement | null) => {\n      if (pendingForcedScroll && hoveredNode) {\n        hoveredNode.scrollIntoView({\n          behavior: 'auto',\n          block: 'nearest',\n          inline: 'nearest',\n        })\n        setPendingForcedScroll(false)\n      }\n    },\n    [pendingForcedScroll, setPendingForcedScroll],\n  )\n\n  const selectedHoveredRef = useCallback(\n    (node: HTMLTableRowElement | null) => {\n      selectedNodeRef.current = node\n      hoveredNodeRef(node)\n    },\n    [selectedNodeRef, hoveredNodeRef],\n  )\n\n  const onNameClick = useCallback(\n    (ev: MouseEvent) => onSortClick(SortField.NAME, ev),\n    [onSortClick],\n  )\n\n  const onWeightClick = useCallback(\n    (ev: MouseEvent) => onSortClick(SortField.WEIGHT, ev),\n    [onSortClick],\n  )\n\n  const onIndexClick = useCallback(\n    (ev: MouseEvent) => onSortClick(SortField.INDEX, ev),\n    [onSortClick],\n  )\n\n  // We allow ProfileSelect to be aware of its own visibility in order to retain\n  // its scroll offset state between times when it's hidden & shown, and also to\n  // scroll the selected node into view once it becomes shown again after the\n  // selected profile has changed.\n  return (\n    <div className={css(style.profileSelectOuter)}>\n      <div className={css(style.caret)} />\n      <div className={css(style.profileSelectBox)}>\n        {/* We stop event propagation for key events on the input to prevent\n            this from triggering keyboard shortcuts. */}\n        <div className={css(style.filterInputContainer)}>\n          <input\n            type=\"text\"\n            className={css(style.filterInput)}\n            ref={focusFilterInput}\n            placeholder={'Filter...'}\n            value={filterText}\n            onInput={onFilterTextChange}\n            onKeyDown={onFilterKeyUp}\n            onKeyUp={stopPropagation}\n            onKeyPress={stopPropagation}\n          />\n        </div>\n        <div className={css(style.profileSelectScrolling)}>\n          <table className={css(style.tableView)}>\n            <thead className={css(style.tableHeader)}>\n              <tr>\n                <th className={css(style.indexHeaderCell)} onClick={onIndexClick}>\n                  <SortIcon\n                    activeDirection={\n                      sortMethod.field === SortField.INDEX ? sortMethod.direction : null\n                    }\n                  />\n                  #\n                </th>\n                <th className={css(style.nameHeaderCell)} onClick={onNameClick}>\n                  <SortIcon\n                    activeDirection={\n                      sortMethod.field === SortField.NAME ? sortMethod.direction : null\n                    }\n                  />\n                  Name\n                </th>\n                <th className={css(style.weightHeaderCell)} onClick={onWeightClick}>\n                  <SortIcon\n                    activeDirection={\n                      sortMethod.field === SortField.WEIGHT ? sortMethod.direction : null\n                    }\n                  />\n                  Total Weight\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              {filteredProfiles.map(\n                ({profile, matchedRanges, indexInProfileGroup}, indexInList) => {\n                  let ref: Ref<HTMLTableRowElement> | undefined = undefined\n                  const selected = indexInProfileGroup === indexToView\n                  const hovered = indexInProfileGroup === hoveredProfileIndex\n                  if (selected && hovered) {\n                    ref = selectedHoveredRef\n                  } else if (selected) {\n                    ref = selectedNodeRef\n                  } else if (hovered) {\n                    ref = hoveredNodeRef\n                  }\n                  return (\n                    <ProfileSelectRow\n                      key={indexInList}\n                      setHoveredProfileIndex={setHoveredProfileIndex}\n                      indexInProfileGroup={indexInProfileGroup}\n                      indexInFilteredListView={indexInList}\n                      hovered={indexInProfileGroup == hoveredProfileIndex}\n                      selected={indexInProfileGroup === indexToView}\n                      profile={profile}\n                      nodeRef={ref}\n                      matchedRanges={matchedRanges}\n                      setProfileIndexToView={setProfileIndexToView}\n                      closeProfileSelect={closeProfileSelect}\n                    />\n                  )\n                },\n              )}\n              {filteredProfiles.length === 0 ? (\n                <tr>\n                  <td colSpan={3} className={css(style.noResultsRow)}>\n                    No results match filter \"{filterText}\"\n                  </td>\n                </tr>\n              ) : null}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nconst paddingHeight = 10\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    filterInputContainer: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: 5,\n      alignItems: 'stretch',\n    },\n    filterInput: {\n      color: theme.altFgPrimaryColor,\n      background: theme.altBgSecondaryColor,\n      borderRadius: 5,\n      padding: 5,\n      border: 'none',\n      ':focus': {\n        outline: 'none',\n      },\n      '::selection': {\n        color: theme.altFgPrimaryColor,\n        background: theme.selectionPrimaryColor,\n      },\n    },\n    caret: {\n      width: 0,\n      height: 0,\n      borderLeft: '5px solid transparent',\n      borderRight: '5px solid transparent',\n      borderBottom: '5px solid black',\n    },\n    highlighted: {\n      background: theme.selectionSecondaryColor,\n    },\n    padding: {\n      height: paddingHeight,\n      background: theme.altBgPrimaryColor,\n    },\n    tableView: {\n      width: '100%',\n      fontSize: FontSize.LABEL,\n      background: theme.altBgPrimaryColor,\n      borderCollapse: 'collapse',\n    },\n    tableHeader: {\n      borderBottom: `2px solid ${theme.altBgSecondaryColor}`,\n      textAlign: 'left',\n      color: theme.altFgPrimaryColor,\n      userSelect: 'none',\n    },\n    indexHeaderCell: {\n      cursor: 'pointer',\n      padding: '8px 10px',\n      textAlign: 'right',\n      fontWeight: 'bold',\n      width: '20px',\n    },\n    nameHeaderCell: {\n      cursor: 'pointer',\n      padding: '8px 10px',\n      textAlign: 'left',\n      fontWeight: 'bold',\n    },\n    weightHeaderCell: {\n      cursor: 'pointer',\n      padding: '8px 10px',\n      textAlign: 'right',\n      fontWeight: 'bold',\n      width: '150px',\n    },\n    sortIcon: {\n      position: 'relative',\n      top: 1,\n      marginRight: 4,\n    },\n    profileRow: {\n      height: Sizes.FRAME_HEIGHT - 2,\n      background: theme.altBgPrimaryColor,\n      cursor: 'pointer',\n      ':hover': {\n        background: theme.altBgSecondaryColor,\n      },\n    },\n    profileRowHovered: {\n      background: theme.altBgSecondaryColor,\n    },\n    profileRowSelected: {\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    profileRowEven: {\n      background: theme.altBgSecondaryColor,\n    },\n    indexCell: {\n      padding: '4px 10px',\n      textAlign: 'right',\n      whiteSpace: 'nowrap',\n      width: '20px',\n      fontFamily: 'monospace',\n      color: theme.altFgSecondaryColor,\n    },\n    nameCell: {\n      padding: '4px 10px',\n      textAlign: 'left',\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      maxWidth: '300px',\n    },\n    weightCell: {\n      padding: '4px 10px',\n      textAlign: 'right',\n      whiteSpace: 'nowrap',\n      width: '150px',\n      fontFamily: 'monospace',\n    },\n    noResultsRow: {\n      padding: '20px',\n      textAlign: 'center',\n      color: theme.altFgSecondaryColor,\n      fontStyle: 'italic',\n    },\n    profileSelectScrolling: {\n      maxHeight: `min(calc(100vh - ${Sizes.TOOLBAR_HEIGHT - 2 * paddingHeight}px), ${\n        20 * Sizes.FRAME_HEIGHT\n      }px)`,\n      overflow: 'auto',\n      '::-webkit-scrollbar': {\n        background: theme.altBgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.altFgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.altBgPrimaryColor}`,\n        ':hover': {\n          background: theme.altBgPrimaryColor,\n        },\n      },\n    },\n    profileSelectBox: {\n      width: '100%',\n      paddingBottom: 10,\n      background: theme.altBgPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    profileSelectOuter: {\n      width: '100%',\n      maxWidth: 600,\n      margin: '0 auto',\n      position: 'relative',\n      zIndex: ZIndex.PROFILE_SELECT,\n      alignItems: 'center',\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    profileIndex: {\n      textAlign: 'right',\n      display: 'inline-block',\n      color: theme.altFgSecondaryColor,\n    },\n    profileIndexSelected: {\n      color: theme.altFgPrimaryColor,\n    },\n  }),\n)\n", "import {ApplicationProps} from './application'\nimport {h, JSX, Fragment} from 'preact'\nimport {useCallback, useState, useEffect} from 'preact/hooks'\nimport {StyleSheet, css} from 'aphrodite'\nimport {Sizes, FontFamily, FontSize, Duration} from './style'\nimport {ProfileSelect} from './profile-select'\nimport {Profile} from '../lib/profile'\nimport {objectsHaveShallowEquality} from '../lib/utils'\nimport {colorSchemeToString, useTheme, withTheme} from './themes/theme'\nimport {ViewMode} from '../lib/view-mode'\nimport {viewModeAtom} from '../app-state'\nimport {ProfileGroupState} from '../app-state/profile-group'\nimport {colorSchemeAtom} from '../app-state/color-scheme'\nimport {useAtom} from '../lib/atom'\n\ninterface ToolbarProps extends ApplicationProps {\n  browseForFile(): void\n  saveFile(): void\n}\n\nfunction useSetViewMode(setViewMode: (viewMode: ViewMode) => void, viewMode: ViewMode) {\n  return useCallback(() => setViewMode(viewMode), [setViewMode, viewMode])\n}\n\nfunction ToolbarLeftContent(props: ToolbarProps) {\n  const style = getStyle(useTheme())\n  const setChronoFlameChart = useSetViewMode(viewModeAtom.set, ViewMode.CHRONO_FLAME_CHART)\n  const setLeftHeavyFlameGraph = useSetViewMode(viewModeAtom.set, ViewMode.LEFT_HEAVY_FLAME_GRAPH)\n  const setSandwichView = useSetViewMode(viewModeAtom.set, ViewMode.SANDWICH_VIEW)\n\n  if (!props.activeProfileState) return null\n\n  return (\n    <div className={css(style.toolbarLeft)}>\n      <div\n        className={css(\n          style.toolbarTab,\n          props.viewMode === ViewMode.CHRONO_FLAME_CHART && style.toolbarTabActive,\n        )}\n        onClick={setChronoFlameChart}\n      >\n        <span className={css(style.emoji)}>\uD83D\uDD70</span>Time Order\n      </div>\n      <div\n        className={css(\n          style.toolbarTab,\n          props.viewMode === ViewMode.LEFT_HEAVY_FLAME_GRAPH && style.toolbarTabActive,\n        )}\n        onClick={setLeftHeavyFlameGraph}\n      >\n        <span className={css(style.emoji)}>\u2B05\uFE0F</span>Left Heavy\n      </div>\n      <div\n        className={css(\n          style.toolbarTab,\n          props.viewMode === ViewMode.SANDWICH_VIEW && style.toolbarTabActive,\n        )}\n        onClick={setSandwichView}\n      >\n        <span className={css(style.emoji)}>\uD83E\uDD6A</span>Sandwich\n      </div>\n    </div>\n  )\n}\n\nconst getCachedProfileList = (() => {\n  // TODO(jlfwong): It would be nice to just implement this as useMemo, but if\n  // we do that using profileGroup or profileGroup.profiles as the cache key,\n  // then it will invalidate whenever *anything* changes, because\n  // profileGroup.profiles is ProfileState[], which contains component state\n  // information for each tab for each profile. So whenever any property in any\n  // persisted view state changes for *any* view in *any* profile, the profiles\n  // list will get re-generated.\n  let cachedProfileList: Profile[] | null = null\n\n  return (profileGroup: ProfileGroupState): Profile[] | null => {\n    let nextProfileList = profileGroup?.profiles.map(p => p.profile) || null\n\n    if (\n      cachedProfileList === null ||\n      (nextProfileList != null && !objectsHaveShallowEquality(cachedProfileList, nextProfileList))\n    ) {\n      cachedProfileList = nextProfileList\n    }\n\n    return cachedProfileList\n  }\n})()\n\nfunction ToolbarCenterContent(props: ToolbarProps): JSX.Element {\n  const style = getStyle(useTheme())\n\n  const {activeProfileState, profileGroup} = props\n  const profiles = getCachedProfileList(profileGroup)\n  const [profileSelectShown, setProfileSelectShown] = useState(false)\n\n  const openProfileSelect = useCallback(() => {\n    setProfileSelectShown(true)\n  }, [setProfileSelectShown])\n\n  const closeProfileSelect = useCallback(() => {\n    setProfileSelectShown(false)\n  }, [setProfileSelectShown])\n\n  useEffect(() => {\n    const onWindowKeyPress = (ev: KeyboardEvent) => {\n      if (ev.key === 't') {\n        ev.preventDefault()\n        setProfileSelectShown(true)\n      }\n    }\n    window.addEventListener('keypress', onWindowKeyPress)\n    return () => {\n      window.removeEventListener('keypress', onWindowKeyPress)\n    }\n  }, [setProfileSelectShown])\n\n  useEffect(() => {\n    const onWindowKeyPress = (ev: KeyboardEvent) => {\n      if (ev.key === 't') {\n        ev.preventDefault()\n        setProfileSelectShown(true)\n      }\n    }\n    window.addEventListener('keypress', onWindowKeyPress)\n    return () => {\n      window.removeEventListener('keypress', onWindowKeyPress)\n    }\n  }, [setProfileSelectShown])\n\n  if (activeProfileState && profileGroup && profiles) {\n    if (profileGroup.profiles.length === 1) {\n      return <Fragment>{activeProfileState.profile.getName()}</Fragment>\n    } else {\n      return (\n        <div className={css(style.toolbarCenter)} onMouseLeave={closeProfileSelect}>\n          <span onMouseOver={openProfileSelect}>\n            {activeProfileState.profile.getName()}{' '}\n            <span className={css(style.toolbarProfileIndex)}>\n              ({activeProfileState.index + 1}/{profileGroup.profiles.length})\n            </span>\n          </span>\n          <div style={{display: profileSelectShown ? 'block' : 'none'}}>\n            <ProfileSelect\n              setProfileIndexToView={props.setProfileIndexToView}\n              indexToView={profileGroup.indexToView}\n              profiles={profiles}\n              closeProfileSelect={closeProfileSelect}\n              visible={profileSelectShown}\n            />\n          </div>\n        </div>\n      )\n    }\n  }\n  return <Fragment>{'\uD83D\uDD2Cspeedscope'}</Fragment>\n}\n\nfunction ToolbarRightContent(props: ToolbarProps) {\n  const style = getStyle(useTheme())\n  const colorScheme = useAtom(colorSchemeAtom)\n\n  const exportFile = (\n    <div className={css(style.toolbarTab)} onClick={props.saveFile}>\n      <span className={css(style.emoji)}>\u2934\uFE0F</span>Export\n    </div>\n  )\n  const importFile = (\n    <div className={css(style.toolbarTab)} onClick={props.browseForFile}>\n      <span className={css(style.emoji)}>\u2935\uFE0F</span>Import\n    </div>\n  )\n\n  const colorSchemeToggle = (\n    <div className={css(style.toolbarTab)} onClick={colorSchemeAtom.cycleToNextColorScheme}>\n      <span className={css(style.emoji)}>\uD83C\uDFA8</span>\n      <span className={css(style.toolbarTabColorSchemeToggle)}>\n        {colorSchemeToString(colorScheme)}\n      </span>\n    </div>\n  )\n\n  const help = (\n    <div className={css(style.toolbarTab)}>\n      <a\n        href=\"https://github.com/jlfwong/speedscope#usage\"\n        className={css(style.noLinkStyle)}\n        target=\"_blank\"\n      >\n        <span className={css(style.emoji)}>\u2753</span>Help\n      </a>\n    </div>\n  )\n\n  return (\n    <div className={css(style.toolbarRight)}>\n      {props.activeProfileState && exportFile}\n      {importFile}\n      {colorSchemeToggle}\n      {help}\n    </div>\n  )\n}\n\nexport function Toolbar(props: ToolbarProps) {\n  const style = getStyle(useTheme())\n  return (\n    <div className={css(style.toolbar)}>\n      <ToolbarLeftContent {...props} />\n      <ToolbarCenterContent {...props} />\n      <ToolbarRightContent {...props} />\n    </div>\n  )\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    toolbar: {\n      height: Sizes.TOOLBAR_HEIGHT,\n      flexShrink: 0,\n      background: theme.altBgPrimaryColor,\n      color: theme.altFgPrimaryColor,\n      textAlign: 'center',\n      fontFamily: FontFamily.MONOSPACE,\n      fontSize: FontSize.TITLE,\n      lineHeight: `${Sizes.TOOLBAR_TAB_HEIGHT}px`,\n      userSelect: 'none',\n    },\n    toolbarLeft: {\n      position: 'absolute',\n      height: Sizes.TOOLBAR_HEIGHT,\n      overflow: 'hidden',\n      top: 0,\n      left: 0,\n      marginRight: 2,\n      textAlign: 'left',\n    },\n    toolbarCenter: {\n      paddingTop: 1,\n      height: Sizes.TOOLBAR_HEIGHT,\n    },\n    toolbarRight: {\n      height: Sizes.TOOLBAR_HEIGHT,\n      overflow: 'hidden',\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      marginRight: 2,\n      textAlign: 'right',\n    },\n    toolbarProfileIndex: {\n      color: theme.altFgSecondaryColor,\n    },\n    toolbarTab: {\n      background: theme.altBgSecondaryColor,\n      marginTop: Sizes.SEPARATOR_HEIGHT,\n      height: Sizes.TOOLBAR_TAB_HEIGHT,\n      lineHeight: `${Sizes.TOOLBAR_TAB_HEIGHT}px`,\n      paddingLeft: 2,\n      paddingRight: 8,\n      display: 'inline-block',\n      marginLeft: 2,\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      ':hover': {\n        background: theme.selectionSecondaryColor,\n      },\n    },\n    toolbarTabActive: {\n      background: theme.selectionPrimaryColor,\n      ':hover': {\n        background: theme.selectionPrimaryColor,\n      },\n    },\n    toolbarTabColorSchemeToggle: {\n      display: 'inline-block',\n      textAlign: 'center',\n      minWidth: '50px',\n    },\n    emoji: {\n      display: 'inline-block',\n      verticalAlign: 'middle',\n      paddingTop: '0px',\n      marginRight: '0.3em',\n    },\n    noLinkStyle: {\n      textDecoration: 'none',\n      color: 'inherit',\n    },\n  }),\n)\n", "// This file contains code to allow profiles to be remapped by JavaScript source maps.\n//\n// As of writing, this is using an out-of-date version of source-map, because the\n// source-map library migrated to using web-assembly. This requires loading the\n// web-assembly ball. The easiest way to do this is to load it from a third-party\n// URL, but I want speedscope to work standalone offline. This means that the remaining\n// options require some way of having a local URL that corresponds the .wasm file.\n//\n// This is rarely used, so let's load it async to avoid bloating the initial\n// bundle.\n//\n// TODO(jlfwong): Revisit using the newer, wasm-based version of source-map now\n// that we're using esbuild for bundling.\nimport type {MappingItem, RawSourceMap, SourceMapConsumer} from 'source-map'\nconst sourceMapModule = import('source-map')\n\nimport {Frame, SymbolRemapper} from './profile'\nimport {findIndexBisect} from './utils'\n\nconst DEBUG = false\n\nexport async function importJavaScriptSourceMapSymbolRemapper(\n  contentsString: string,\n  sourceMapFileName: string,\n): Promise<SymbolRemapper | null> {\n  const sourceMap = await sourceMapModule\n\n  let consumer: SourceMapConsumer | null = null\n  let contents: RawSourceMap | null = null\n\n  try {\n    contents = JSON.parse(contentsString)\n    consumer = new sourceMap.default.SourceMapConsumer(contents!)\n  } catch (e) {\n    return null\n  }\n\n  const mappingItems: MappingItem[] = []\n\n  consumer.eachMapping(\n    function (m: MappingItem) {\n      // The sourcemap library uses 1-based line numbers, and 0-based column\n      // numbers. speedscope uses 1-based line-numbers, and 1-based column\n      // numbers for its in-memory representation, so we'll normalize that\n      // here too.\n      mappingItems.push({\n        ...m,\n        generatedColumn: m.generatedColumn + 1,\n        originalColumn: m.originalColumn + 1,\n      })\n    },\n    {},\n\n    // We're going to binary search through these later, so make sure they're\n    // sorted by their order in the generated file.\n    sourceMap.default.SourceMapConsumer.GENERATED_ORDER,\n  )\n\n  const sourceMapFileNameWithoutExt = sourceMapFileName.replace(/\\.[^/]*$/, '')\n\n  return (frame: Frame) => {\n    let fileMatches = false\n    if (contents?.file && contents?.file === frame.file) {\n      fileMatches = true\n    } else if (\n      ('/' + frame.file?.replace(/\\.[^/]*$/, '')).endsWith('/' + sourceMapFileNameWithoutExt)\n    ) {\n      fileMatches = true\n    }\n    if (!fileMatches) {\n      // The source-map doesn't apply to the file this frame is defined in.\n      return null\n    }\n\n    if (frame.line == null || frame.col == null) {\n      // If we don't have a line & column number for the frame, we can't\n      // remap it.\n      return null\n    }\n\n    // If we got here, then we hopefully have an remapping.\n    //\n    // Ideally, we'd look up a symbol whose generatedLine & generatedColumn\n    // match what we have in our profile, but unfortunately browsers don't do\n    // this.\n    //\n    // Browsers set the column number for a function to the index of the\n    // opening paren for the argument list, rather than the beginning of the\n    // index of the name.\n    //\n    // function alpha() { ... }\n    //               ^\n    //\n    // const beta = function() { ... }\n    //                      ^\n    //\n    // const gamma = () => { ... }\n    //               ^\n    //\n    // Since we don't have the source code being profiled, we unfortunately\n    // can't normalize this to set the column to the first character of the\n    // actual name.\n    //\n    // To work around this limitation, we'll search backwards from the first\n    // mapping whose generatedLine & generatedColumn are beyond the location\n    // in the profile.\n    let mappingIndex = findIndexBisect(mappingItems, m => {\n      if (m.generatedLine > frame.line!) return true\n      if (m.generatedLine < frame.line!) return false\n      if (m.generatedColumn >= frame.col!) return true\n      return false\n    })\n\n    if (mappingIndex === -1) {\n      // There are no symbols following the given profile frame symbol, so try\n      // to apply the very last mapping.\n      mappingIndex = mappingItems.length - 1\n    } else if (mappingIndex === 0) {\n      // If the very first index in mappingItems is beyond the location in the\n      // profile, it means the name we're looking for doesn't have a\n      // corresponding entry in the source-map (this can happen if the\n      // source-map isn't the right source-map)\n      return null\n    } else {\n      mappingIndex--\n    }\n\n    const sourceMapItem = mappingItems[mappingIndex]\n    const remappedFrameInfo: {name?: string; file?: string; line?: number; col?: number} = {}\n\n    if (sourceMapItem.name != null) {\n      remappedFrameInfo.name = sourceMapItem.name\n    } else if (sourceMapItem.source != null) {\n      // HACK: If the item name isn't specified, but the source is present, then\n      // we're going to try to guess what the name is by using the originalLine\n      // and originalColumn.\n\n      // The second argument here is \"returnNullOnMissing\". Without this, it\n      // throws instead of returning null.\n      const content = consumer?.sourceContentFor(sourceMapItem.source, true)\n      if (content) {\n        const lines = content.split('\\n')\n        const line = lines[sourceMapItem.originalLine - 1]\n        if (line) {\n          // It's possible this source map entry will contain stuff other than\n          // the name, so let's only consider word-ish characters that are part\n          // of the prefix.\n          const identifierMatch = /\\w+/.exec(line.substr(sourceMapItem.originalColumn - 1))\n          if (identifierMatch) {\n            remappedFrameInfo.name = identifierMatch[0]\n          }\n        }\n      }\n    }\n\n    switch (remappedFrameInfo.name) {\n      case 'constructor': {\n        // If the name was remapped to \"constructor\", then let's use the\n        // original name, since \"constructor\" isn't very helpful.\n        //\n        // TODO(jlfwong): Search backwards for the class keyword and see if we\n        // can guess the right name.\n        remappedFrameInfo.name = frame.name + ' constructor'\n        break\n      }\n\n      case 'function': {\n        // If the name is just \"function\", it probably means we either messed up\n        // the remapping, or that we matched an anonymous function. In either\n        // case, this isn't helpful, so put this back.\n        remappedFrameInfo.name = frame.name\n        break\n      }\n\n      case 'const':\n      case 'export': {\n        // If we got this, we probably just did a bad job leveraging the hack\n        // looking through the source code. Let's fall-back to whatever the\n        // original name was.\n        remappedFrameInfo.name = frame.name\n        break\n      }\n    }\n\n    if (remappedFrameInfo.name && frame.name.includes(remappedFrameInfo.name)) {\n      // If the remapped name is a substring of the original name, the original\n      // name probably contains more useful information. In that case, just use\n      // the original name instead.\n      //\n      // This can happen, for example, when remapping method names. If a\n      // call stack says the symbol name is \"n.zap\" and we remapped it to a\n      // function just called \"zap\", we might as well use the original name\n      // instead.\n      remappedFrameInfo.name = frame.name\n    }\n\n    if (sourceMapItem.source != null) {\n      remappedFrameInfo.file = sourceMapItem.source\n      remappedFrameInfo.line = sourceMapItem.originalLine\n      remappedFrameInfo.col = sourceMapItem.originalColumn\n    }\n\n    if (DEBUG) {\n      console.groupCollapsed(`Remapping \"${frame.name}\" -> \"${remappedFrameInfo.name}\"`)\n      console.log('before', {...frame})\n      console.log('item @ index', sourceMapItem)\n      console.log('item @ index + 1', mappingItems[mappingIndex + 1])\n      console.log('after', remappedFrameInfo)\n      console.groupEnd()\n    }\n\n    return remappedFrameInfo\n  }\n}\n", "// A simple implementation of an efficient scrolling list view which\n// renders only items within the viewport + a couple extra items.\n\nimport {h, JSX} from 'preact'\nimport {useState, useCallback, useRef, useMemo, useEffect} from 'preact/hooks'\n\nexport interface ListItem {\n  size: number\n}\n\ninterface RangeResult {\n  firstVisibleIndex: number\n  lastVisibleIndex: number\n  invisiblePrefixSize: number\n}\n\ninterface ScrollableListViewProps {\n  items: ListItem[]\n  axis: 'x' | 'y'\n  renderItems: (\n    firstVisibleIndex: number,\n    lastVisibleIndex: number,\n  ) => JSX.Element | JSX.Element[] | null\n  className?: string\n  initialIndexInView?: number | null\n}\n\nexport const ScrollableListView = ({\n  items,\n  axis,\n  renderItems,\n  className,\n  initialIndexInView,\n}: ScrollableListViewProps) => {\n  const [viewportSize, setViewportSize] = useState<number | null>(null)\n  const [viewportScrollOffset, setViewportScrollOffset] = useState<number>(0)\n\n  const viewportRef = useRef<HTMLDivElement | null>(null)\n\n  const widthOrHeight = axis === 'x' ? 'width' : 'height'\n  const leftOrTop = axis === 'x' ? 'left' : 'top'\n  const scrollLeftOrScrollTop = axis === 'x' ? 'scrollLeft' : 'scrollTop'\n\n  // This is kind of a weird hack, but I'm not sure what the better of doing something like this is.\n  const offset = initialIndexInView\n    ? items.reduce((a, b, i) => (i < initialIndexInView ? a + b.size : a), 0)\n    : 0\n  const initialScroll = useRef<number | null>(offset)\n\n  const viewportCallback = useCallback(\n    (viewport: HTMLDivElement | null) => {\n      if (viewport) {\n        requestAnimationFrame(() => {\n          setViewportSize(viewport.getBoundingClientRect()[widthOrHeight])\n          if (initialScroll.current != null) {\n            viewport.scrollTo({[leftOrTop]: initialScroll.current})\n            initialScroll.current = null\n          }\n        })\n      } else {\n        setViewportSize(null)\n      }\n      viewportRef.current = viewport\n    },\n    [setViewportSize, widthOrHeight, leftOrTop],\n  )\n\n  const rangeResult: RangeResult | null = useMemo(() => {\n    if (viewportRef.current == null || viewportSize == null || viewportScrollOffset == null) {\n      return null\n    }\n\n    // We render items up to a quarter viewport height outside of the\n    // viewport both above and below to prevent flickering.\n    const minY = viewportScrollOffset - viewportSize / 4\n    const maxY = viewportScrollOffset + viewportSize + viewportSize / 4\n\n    let total = 0\n    let invisiblePrefixSize = 0\n\n    let i = 0\n    for (; i < items.length; i++) {\n      const item = items[i]\n      invisiblePrefixSize = total\n      total += item.size\n      if (total >= minY) {\n        break\n      }\n    }\n\n    const firstVisibleIndex = i\n\n    for (; i < items.length; i++) {\n      const item = items[i]\n      total += item.size\n      if (total >= maxY) {\n        break\n      }\n    }\n\n    const lastVisibleIndex = Math.min(i, items.length - 1)\n\n    return {\n      firstVisibleIndex,\n      lastVisibleIndex,\n      invisiblePrefixSize,\n    }\n  }, [viewportSize, viewportScrollOffset, items])\n\n  const totalSize = useMemo(() => items.reduce((a, b) => a + b.size, 0), [items])\n\n  const onViewportScroll = useCallback(() => {\n    if (viewportRef.current != null) {\n      setViewportScrollOffset(viewportRef.current[scrollLeftOrScrollTop])\n    }\n  }, [scrollLeftOrScrollTop])\n\n  useEffect(() => {\n    const resizeListener = () => {\n      if (viewportRef.current != null) {\n        setViewportSize(viewportRef.current.getBoundingClientRect()[widthOrHeight])\n      }\n    }\n\n    window.addEventListener('resize', resizeListener)\n    return () => {\n      window.removeEventListener('resize', resizeListener)\n    }\n  }, [widthOrHeight])\n\n  const visibleItems = useMemo(() => {\n    return rangeResult\n      ? renderItems(rangeResult.firstVisibleIndex, rangeResult.lastVisibleIndex)\n      : null\n  }, [renderItems, rangeResult])\n\n  const content = useMemo(() => {\n    return (\n      <div style={{height: totalSize}}>\n        <div style={{transform: `translateY(${rangeResult?.invisiblePrefixSize || 0}px)`}}>\n          {visibleItems}\n        </div>\n      </div>\n    )\n  }, [rangeResult, visibleItems, totalSize])\n\n  return (\n    <div className={className} ref={viewportCallback} onScroll={onViewportScroll}>\n      {content}\n    </div>\n  )\n}\n", "import {h, JSX, ComponentChild} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\nimport {Profile, Frame} from '../lib/profile'\nimport {formatPercent} from '../lib/utils'\nimport {FontSize, Sizes, commonStyle} from './style'\nimport {ColorChit} from './color-chit'\nimport {ListItem, ScrollableListView} from './scrollable-list-view'\nimport {createGetCSSColorForFrame, getFrameToColorBucket} from '../app-state/getters'\nimport {memo} from 'preact/compat'\nimport {useCallback, useMemo, useContext} from 'preact/hooks'\nimport {SandwichViewContext} from './sandwich-view'\nimport {Color} from '../lib/color'\nimport {useTheme, withTheme} from './themes/theme'\nimport {\n  SortDirection,\n  SortMethod,\n  SortField,\n  profileGroupAtom,\n  tableSortMethodAtom,\n  searchIsActiveAtom,\n  searchQueryAtom,\n} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\n\ninterface HBarProps {\n  perc: number\n}\n\nfunction HBarDisplay(props: HBarProps) {\n  const style = getStyle(useTheme())\n\n  return (\n    <div className={css(style.hBarDisplay)}>\n      <div className={css(style.hBarDisplayFilled)} style={{width: `${props.perc}%`}} />\n    </div>\n  )\n}\n\ninterface SortIconProps {\n  activeDirection: SortDirection | null\n}\n\nfunction SortIcon(props: SortIconProps) {\n  const theme = useTheme()\n  const style = getStyle(theme)\n\n  const {activeDirection} = props\n  const upFill =\n    activeDirection === SortDirection.ASCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n  const downFill =\n    activeDirection === SortDirection.DESCENDING ? theme.fgPrimaryColor : theme.fgSecondaryColor\n\n  return (\n    <svg\n      width=\"8\"\n      height=\"10\"\n      viewBox=\"0 0 8 10\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      className={css(style.sortIcon)}\n    >\n      <path d=\"M0 4L4 0L8 4H0Z\" fill={upFill} />\n      <path d=\"M0 4L4 0L8 4H0Z\" transform=\"translate(0 10) scale(1 -1)\" fill={downFill} />\n    </svg>\n  )\n}\n\ninterface ProfileTableRowViewProps {\n  frame: Frame\n  matchedRanges: [number, number][] | null\n  index: number\n  profile: Profile\n  selectedFrame: Frame | null\n  setSelectedFrame: (f: Frame) => void\n  getCSSColorForFrame: (frame: Frame) => string\n}\n\nfunction highlightRanges(\n  text: string,\n  ranges: [number, number][],\n  highlightedClassName: string,\n): JSX.Element {\n  const spans: ComponentChild[] = []\n  let last = 0\n  for (let range of ranges) {\n    spans.push(text.slice(last, range[0]))\n    spans.push(<span className={highlightedClassName}>{text.slice(range[0], range[1])}</span>)\n    last = range[1]\n  }\n  spans.push(text.slice(last))\n\n  return <span>{spans}</span>\n}\n\nconst ProfileTableRowView = ({\n  frame,\n  matchedRanges,\n  profile,\n  index,\n  selectedFrame,\n  setSelectedFrame,\n  getCSSColorForFrame,\n}: ProfileTableRowViewProps) => {\n  const style = getStyle(useTheme())\n\n  const totalWeight = frame.getTotalWeight()\n  const selfWeight = frame.getSelfWeight()\n  const totalPerc = (100.0 * totalWeight) / profile.getTotalNonIdleWeight()\n  const selfPerc = (100.0 * selfWeight) / profile.getTotalNonIdleWeight()\n\n  const selected = frame === selectedFrame\n\n  // We intentionally use index rather than frame.key here as the tr key\n  // in order to re-use rows when sorting rather than creating all new elements.\n  return (\n    <tr\n      key={`${index}`}\n      onClick={setSelectedFrame.bind(null, frame)}\n      className={css(\n        style.tableRow,\n        index % 2 == 0 && style.tableRowEven,\n        selected && style.tableRowSelected,\n      )}\n    >\n      <td className={css(style.numericCell)}>\n        {profile.formatValue(totalWeight)} ({formatPercent(totalPerc)})\n        <HBarDisplay perc={totalPerc} />\n      </td>\n      <td className={css(style.numericCell)}>\n        {profile.formatValue(selfWeight)} ({formatPercent(selfPerc)})\n        <HBarDisplay perc={selfPerc} />\n      </td>\n      <td title={frame.file} className={css(style.textCell)}>\n        <ColorChit color={getCSSColorForFrame(frame)} />\n        {matchedRanges\n          ? highlightRanges(\n              frame.name,\n              matchedRanges,\n              css(style.matched, selected && style.matchedSelected),\n            )\n          : frame.name}\n      </td>\n    </tr>\n  )\n}\n\ninterface ProfileTableViewProps {\n  profile: Profile\n  selectedFrame: Frame | null\n  getCSSColorForFrame: (frame: Frame) => string\n  sortMethod: SortMethod\n  setSelectedFrame: (frame: Frame | null) => void\n  setSortMethod: (sortMethod: SortMethod) => void\n  searchQuery: string\n  searchIsActive: boolean\n}\n\nexport const ProfileTableView = memo(\n  ({\n    profile,\n    sortMethod,\n    setSortMethod,\n    selectedFrame,\n    setSelectedFrame,\n    getCSSColorForFrame,\n    searchQuery,\n    searchIsActive,\n  }: ProfileTableViewProps) => {\n    const style = getStyle(useTheme())\n\n    const onSortClick = useCallback(\n      (field: SortField, ev: MouseEvent) => {\n        ev.preventDefault()\n\n        if (sortMethod.field == field) {\n          // Toggle\n          setSortMethod({\n            field,\n            direction:\n              sortMethod.direction === SortDirection.ASCENDING\n                ? SortDirection.DESCENDING\n                : SortDirection.ASCENDING,\n          })\n        } else {\n          // Set a sane default\n          switch (field) {\n            case SortField.SYMBOL_NAME: {\n              setSortMethod({field, direction: SortDirection.ASCENDING})\n              break\n            }\n            case SortField.SELF: {\n              setSortMethod({field, direction: SortDirection.DESCENDING})\n              break\n            }\n            case SortField.TOTAL: {\n              setSortMethod({field, direction: SortDirection.DESCENDING})\n              break\n            }\n          }\n        }\n      },\n      [sortMethod, setSortMethod],\n    )\n\n    const sandwichContext = useContext(SandwichViewContext)\n\n    const renderItems = useCallback(\n      (firstIndex: number, lastIndex: number) => {\n        if (!sandwichContext) return null\n\n        const rows: JSX.Element[] = []\n\n        for (let i = firstIndex; i <= lastIndex; i++) {\n          const frame = sandwichContext.rowList[i]\n          const match = sandwichContext.getSearchMatchForFrame(frame)\n          rows.push(\n            ProfileTableRowView({\n              frame,\n              matchedRanges: match == null ? null : match,\n              index: i,\n              profile: profile,\n              selectedFrame: selectedFrame,\n              setSelectedFrame: setSelectedFrame,\n              getCSSColorForFrame: getCSSColorForFrame,\n            }),\n          )\n        }\n\n        if (rows.length === 0) {\n          if (searchIsActive) {\n            rows.push(\n              <tr>\n                <td className={css(style.emptyState)}>\n                  No symbol names match query \"{searchQuery}\".\n                </td>\n              </tr>,\n            )\n          } else {\n            rows.push(\n              <tr>\n                <td className={css(style.emptyState)}>No symbols found.</td>\n              </tr>,\n            )\n          }\n        }\n\n        return <table className={css(style.tableView)}>{rows}</table>\n      },\n      [\n        sandwichContext,\n        profile,\n        selectedFrame,\n        setSelectedFrame,\n        getCSSColorForFrame,\n        searchIsActive,\n        searchQuery,\n        style.emptyState,\n        style.tableView,\n      ],\n    )\n\n    const listItems: ListItem[] = useMemo(\n      () =>\n        sandwichContext == null\n          ? []\n          : sandwichContext.rowList.map(f => ({size: Sizes.FRAME_HEIGHT})),\n      [sandwichContext],\n    )\n\n    const onTotalClick = useCallback(\n      (ev: MouseEvent) => onSortClick(SortField.TOTAL, ev),\n      [onSortClick],\n    )\n    const onSelfClick = useCallback(\n      (ev: MouseEvent) => onSortClick(SortField.SELF, ev),\n      [onSortClick],\n    )\n    const onSymbolNameClick = useCallback(\n      (ev: MouseEvent) => onSortClick(SortField.SYMBOL_NAME, ev),\n      [onSortClick],\n    )\n\n    return (\n      <div className={css(commonStyle.vbox, style.profileTableView)}>\n        <table className={css(style.tableView)}>\n          <thead className={css(style.tableHeader)}>\n            <tr>\n              <th className={css(style.numericCell)} onClick={onTotalClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.TOTAL ? sortMethod.direction : null\n                  }\n                />\n                Total\n              </th>\n              <th className={css(style.numericCell)} onClick={onSelfClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.SELF ? sortMethod.direction : null\n                  }\n                />\n                Self\n              </th>\n              <th className={css(style.textCell)} onClick={onSymbolNameClick}>\n                <SortIcon\n                  activeDirection={\n                    sortMethod.field === SortField.SYMBOL_NAME ? sortMethod.direction : null\n                  }\n                />\n                Symbol Name\n              </th>\n            </tr>\n          </thead>\n        </table>\n        <ScrollableListView\n          axis={'y'}\n          items={listItems}\n          className={css(style.scrollView)}\n          renderItems={renderItems}\n          initialIndexInView={\n            selectedFrame == null ? null : sandwichContext?.getIndexForFrame(selectedFrame)\n          }\n        />\n      </div>\n    )\n  },\n)\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    profileTableView: {\n      background: theme.bgPrimaryColor,\n      height: '100%',\n    },\n    scrollView: {\n      overflowY: 'auto',\n      overflowX: 'hidden',\n      flexGrow: 1,\n      '::-webkit-scrollbar': {\n        background: theme.bgPrimaryColor,\n      },\n      '::-webkit-scrollbar-thumb': {\n        background: theme.fgSecondaryColor,\n        borderRadius: 20,\n        border: `3px solid ${theme.bgPrimaryColor}`,\n        ':hover': {\n          background: theme.fgPrimaryColor,\n        },\n      },\n    },\n    tableView: {\n      width: '100%',\n      fontSize: FontSize.LABEL,\n      background: theme.bgPrimaryColor,\n    },\n    tableHeader: {\n      borderBottom: `2px solid ${theme.bgSecondaryColor}`,\n      textAlign: 'left',\n      color: theme.fgPrimaryColor,\n      userSelect: 'none',\n    },\n    sortIcon: {\n      position: 'relative',\n      top: 1,\n      marginRight: Sizes.FRAME_HEIGHT / 4,\n    },\n    tableRow: {\n      background: theme.bgPrimaryColor,\n      height: Sizes.FRAME_HEIGHT,\n    },\n    tableRowEven: {\n      background: theme.bgSecondaryColor,\n    },\n    tableRowSelected: {\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n    },\n    numericCell: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      position: 'relative',\n      textAlign: 'right',\n      paddingRight: Sizes.FRAME_HEIGHT,\n      width: 6 * Sizes.FRAME_HEIGHT,\n      minWidth: 6 * Sizes.FRAME_HEIGHT,\n    },\n    textCell: {\n      textOverflow: 'ellipsis',\n      overflow: 'hidden',\n      whiteSpace: 'nowrap',\n      width: '100%',\n      maxWidth: 0,\n    },\n    hBarDisplay: {\n      position: 'absolute',\n      background: Color.fromCSSHex(theme.weightColor).withAlpha(0.2).toCSS(),\n      bottom: 2,\n      height: 2,\n      width: `calc(100% - ${2 * Sizes.FRAME_HEIGHT}px)`,\n      right: Sizes.FRAME_HEIGHT,\n    },\n    hBarDisplayFilled: {\n      height: '100%',\n      position: 'absolute',\n      background: theme.weightColor,\n      right: 0,\n    },\n    matched: {\n      borderBottom: `2px solid ${theme.fgPrimaryColor}`,\n    },\n    matchedSelected: {\n      borderColor: theme.altFgPrimaryColor,\n    },\n    emptyState: {\n      textAlign: 'center',\n      fontWeight: 'bold',\n    },\n  }),\n)\n\ninterface ProfileTableViewContainerProps {\n  activeProfileState: ActiveProfileState\n}\n\nexport const ProfileTableViewContainer = memo((ownProps: ProfileTableViewContainerProps) => {\n  const {activeProfileState} = ownProps\n  const {profile, sandwichViewState} = activeProfileState\n  if (!profile) throw new Error('profile missing')\n  const tableSortMethod = useAtom(tableSortMethodAtom)\n  const theme = useTheme()\n  const {callerCallee} = sandwichViewState\n  const selectedFrame = callerCallee ? callerCallee.selectedFrame : null\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n\n  const setSelectedFrame = useCallback((selectedFrame: Frame | null) => {\n    profileGroupAtom.setSelectedFrame(selectedFrame)\n  }, [])\n  const searchIsActive = useAtom(searchIsActiveAtom)\n  const searchQuery = useAtom(searchQueryAtom)\n\n  return (\n    <ProfileTableView\n      profile={profile}\n      selectedFrame={selectedFrame}\n      getCSSColorForFrame={getCSSColorForFrame}\n      sortMethod={tableSortMethod}\n      setSelectedFrame={setSelectedFrame}\n      setSortMethod={tableSortMethodAtom.set}\n      searchIsActive={searchIsActive}\n      searchQuery={searchQuery}\n    />\n  )\n})\n", "import {CallTreeNode} from '../lib/profile'\nimport {StyleSheet, css} from 'aphrodite'\nimport {h} from 'preact'\nimport {commonStyle} from './style'\nimport {Rect, AffineTransform, Vec2} from '../lib/math'\nimport {FlamechartPanZoomView} from './flamechart-pan-zoom-view'\nimport {noop, formatPercent} from '../lib/utils'\nimport {Hovertip} from './hovertip'\nimport {FlamechartViewProps} from './flamechart-view-container'\nimport {withTheme} from './themes/theme'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\nexport class FlamechartWrapper extends StatelessComponent<FlamechartViewProps> {\n  private clampViewportToFlamegraph(viewportRect: Rect) {\n    const {flamechart, renderInverted} = this.props\n    return flamechart.getClampedConfigSpaceViewportRect({\n      configSpaceViewportRect: viewportRect,\n      renderInverted,\n    })\n  }\n  private setConfigSpaceViewportRect = (configSpaceViewportRect: Rect) => {\n    this.props.setConfigSpaceViewportRect(this.clampViewportToFlamegraph(configSpaceViewportRect))\n  }\n  private setLogicalSpaceViewportSize = (logicalSpaceViewportSize: Vec2): void => {\n    this.props.setLogicalSpaceViewportSize(logicalSpaceViewportSize)\n  }\n\n  private transformViewport = (transform: AffineTransform) => {\n    this.setConfigSpaceViewportRect(transform.transformRect(this.props.configSpaceViewportRect))\n  }\n  private formatValue(weight: number) {\n    const totalWeight = this.props.flamechart.getTotalWeight()\n    const percent = (100 * weight) / totalWeight\n    const formattedPercent = formatPercent(percent)\n    return `${this.props.flamechart.formatValue(weight)} (${formattedPercent})`\n  }\n  private renderTooltip() {\n    if (!this.container) return null\n    const {hover} = this.props\n    if (!hover) return null\n    const {width, height, left, top} = this.container.getBoundingClientRect()\n    const offset = new Vec2(hover.event.clientX - left, hover.event.clientY - top)\n    const style = getStyle(this.props.theme)\n    const frame = hover.node.frame\n\n    return (\n      <Hovertip containerSize={new Vec2(width, height)} offset={offset}>\n        <span className={css(style.hoverCount)}>\n          {this.formatValue(hover.node.getTotalWeight())}\n        </span>{' '}\n        {frame.name}\n        {frame.file ? (\n          <div>\n            {frame.file}:{frame.line}\n          </div>\n        ) : undefined}\n      </Hovertip>\n    )\n  }\n  container: HTMLDivElement | null = null\n  containerRef = (container: Element | null) => {\n    this.container = (container as HTMLDivElement) || null\n  }\n  private setNodeHover = (\n    hover: {\n      node: CallTreeNode\n      event: MouseEvent\n    } | null,\n  ) => {\n    this.props.setNodeHover(hover)\n  }\n  render() {\n    return (\n      <div\n        className={css(commonStyle.fillY, commonStyle.fillX, commonStyle.vbox)}\n        ref={this.containerRef}\n      >\n        <FlamechartPanZoomView\n          theme={this.props.theme}\n          selectedNode={null}\n          onNodeHover={this.setNodeHover}\n          onNodeSelect={noop}\n          configSpaceViewportRect={this.props.configSpaceViewportRect}\n          setConfigSpaceViewportRect={this.setConfigSpaceViewportRect}\n          transformViewport={this.transformViewport}\n          flamechart={this.props.flamechart}\n          flamechartRenderer={this.props.flamechartRenderer}\n          canvasContext={this.props.canvasContext}\n          renderInverted={this.props.renderInverted}\n          logicalSpaceViewportSize={this.props.logicalSpaceViewportSize}\n          setLogicalSpaceViewportSize={this.setLogicalSpaceViewportSize}\n          searchResults={null}\n        />\n        {this.renderTooltip()}\n      </div>\n    )\n  }\n}\n\nexport const getStyle = withTheme(theme =>\n  StyleSheet.create({\n    hoverCount: {\n      color: theme.weightColor,\n    },\n  }),\n)\n", "import {memoizeByShallowEquality, noop} from '../lib/utils'\nimport {Profile, Frame} from '../lib/profile'\nimport {Flamechart} from '../lib/flamechart'\nimport {\n  createMemoizedFlamechartRenderer,\n  FlamechartViewContainerProps,\n  useFlamechartSetters,\n} from './flamechart-view-container'\nimport {\n  getCanvasContext,\n  createGetColorBucketForFrame,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {FlamechartWrapper} from './flamechart-wrapper'\nimport {h} from 'preact'\nimport {memo} from 'preact/compat'\nimport {useTheme} from './themes/theme'\nimport {FlamechartID} from '../app-state/profile-group'\nimport {flattenRecursionAtom, glCanvasAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\nconst getInvertedCallerProfile = memoizeByShallowEquality(\n  ({\n    profile,\n    frame,\n    flattenRecursion,\n  }: {\n    profile: Profile\n    frame: Frame\n    flattenRecursion: boolean\n  }): Profile => {\n    let p = profile.getInvertedProfileForCallersOf(frame)\n    return flattenRecursion ? p.getProfileWithRecursionFlattened() : p\n  },\n)\n\nconst getInvertedCallerFlamegraph = memoizeByShallowEquality(\n  ({\n    invertedCallerProfile,\n    getColorBucketForFrame,\n  }: {\n    invertedCallerProfile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  }): Flamechart => {\n    return new Flamechart({\n      getTotalWeight: invertedCallerProfile.getTotalNonIdleWeight.bind(invertedCallerProfile),\n      forEachCall: invertedCallerProfile.forEachCallGrouped.bind(invertedCallerProfile),\n      formatValue: invertedCallerProfile.formatValue.bind(invertedCallerProfile),\n      getColorBucketForFrame,\n    })\n  },\n)\n\nconst getInvertedCallerFlamegraphRenderer = createMemoizedFlamechartRenderer({inverted: true})\n\nexport const InvertedCallerFlamegraphView = memo((ownProps: FlamechartViewContainerProps) => {\n  const {activeProfileState} = ownProps\n  let {profile, sandwichViewState} = activeProfileState\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const glCanvas = useAtom(glCanvasAtom)\n  const theme = useTheme()\n\n  if (!profile) throw new Error('profile missing')\n  if (!glCanvas) throw new Error('glCanvas missing')\n  const {callerCallee} = sandwichViewState\n  if (!callerCallee) throw new Error('callerCallee missing')\n  const {selectedFrame} = callerCallee\n\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n\n  const flamechart = getInvertedCallerFlamegraph({\n    invertedCallerProfile: getInvertedCallerProfile({\n      profile,\n      frame: selectedFrame,\n      flattenRecursion,\n    }),\n    getColorBucketForFrame,\n  })\n  const flamechartRenderer = getInvertedCallerFlamegraphRenderer({canvasContext, flamechart})\n\n  return (\n    <FlamechartWrapper\n      theme={theme}\n      renderInverted={true}\n      flamechart={flamechart}\n      flamechartRenderer={flamechartRenderer}\n      canvasContext={canvasContext}\n      getCSSColorForFrame={getCSSColorForFrame}\n      {...useFlamechartSetters(FlamechartID.SANDWICH_INVERTED_CALLERS)}\n      {...callerCallee.invertedCallerFlamegraph}\n      // This overrides the setSelectedNode specified in useFlamechartSettesr\n      setSelectedNode={noop}\n    />\n  )\n})\n", "import {memoizeByShallowEquality, noop} from '../lib/utils'\nimport {Profile, Frame} from '../lib/profile'\nimport {Flamechart} from '../lib/flamechart'\nimport {\n  createMemoizedFlamechartRenderer,\n  FlamechartViewContainerProps,\n  useFlamechartSetters,\n} from './flamechart-view-container'\nimport {\n  getCanvasContext,\n  createGetColorBucketForFrame,\n  createGetCSSColorForFrame,\n  getFrameToColorBucket,\n} from '../app-state/getters'\nimport {FlamechartWrapper} from './flamechart-wrapper'\nimport {h} from 'preact'\nimport {memo} from 'preact/compat'\nimport {useTheme} from './themes/theme'\nimport {FlamechartID} from '../app-state/profile-group'\nimport {flattenRecursionAtom, glCanvasAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\n\nconst getCalleeProfile = memoizeByShallowEquality<\n  {\n    profile: Profile\n    frame: Frame\n    flattenRecursion: boolean\n  },\n  Profile\n>(({profile, frame, flattenRecursion}) => {\n  let p = profile.getProfileForCalleesOf(frame)\n  return flattenRecursion ? p.getProfileWithRecursionFlattened() : p\n})\n\nconst getCalleeFlamegraph = memoizeByShallowEquality<\n  {\n    calleeProfile: Profile\n    getColorBucketForFrame: (frame: Frame) => number\n  },\n  Flamechart\n>(({calleeProfile, getColorBucketForFrame}) => {\n  return new Flamechart({\n    getTotalWeight: calleeProfile.getTotalNonIdleWeight.bind(calleeProfile),\n    forEachCall: calleeProfile.forEachCallGrouped.bind(calleeProfile),\n    formatValue: calleeProfile.formatValue.bind(calleeProfile),\n    getColorBucketForFrame,\n  })\n})\n\nconst getCalleeFlamegraphRenderer = createMemoizedFlamechartRenderer()\n\nexport const CalleeFlamegraphView = memo((ownProps: FlamechartViewContainerProps) => {\n  const {activeProfileState} = ownProps\n  const {profile, sandwichViewState} = activeProfileState\n  const flattenRecursion = useAtom(flattenRecursionAtom)\n  const glCanvas = useAtom(glCanvasAtom)\n  const theme = useTheme()\n\n  if (!profile) throw new Error('profile missing')\n  if (!glCanvas) throw new Error('glCanvas missing')\n  const {callerCallee} = sandwichViewState\n  if (!callerCallee) throw new Error('callerCallee missing')\n  const {selectedFrame} = callerCallee\n\n  const frameToColorBucket = getFrameToColorBucket(profile)\n  const getColorBucketForFrame = createGetColorBucketForFrame(frameToColorBucket)\n  const getCSSColorForFrame = createGetCSSColorForFrame({theme, frameToColorBucket})\n  const canvasContext = getCanvasContext({theme, canvas: glCanvas})\n\n  const flamechart = getCalleeFlamegraph({\n    calleeProfile: getCalleeProfile({profile, frame: selectedFrame, flattenRecursion}),\n    getColorBucketForFrame,\n  })\n  const flamechartRenderer = getCalleeFlamegraphRenderer({canvasContext, flamechart})\n\n  return (\n    <FlamechartWrapper\n      theme={theme}\n      renderInverted={false}\n      flamechart={flamechart}\n      flamechartRenderer={flamechartRenderer}\n      canvasContext={canvasContext}\n      getCSSColorForFrame={getCSSColorForFrame}\n      {...useFlamechartSetters(FlamechartID.SANDWICH_CALLEES)}\n      {...callerCallee.calleeFlamegraph}\n      // This overrides the setSelectedNode specified in useFlamechartSettesr\n      setSelectedNode={noop}\n    />\n  )\n})\n", "import {memo} from 'preact/compat'\nimport {useContext, useMemo} from 'preact/hooks'\nimport {SearchView} from './search-view'\nimport {h} from 'preact'\nimport {SandwichViewContext} from './sandwich-view'\n\nexport const SandwichSearchView = memo(() => {\n  const sandwichViewContext = useContext(SandwichViewContext)\n\n  const rowList = sandwichViewContext != null ? sandwichViewContext.rowList : null\n  const resultIndex =\n    sandwichViewContext?.selectedFrame != null\n      ? sandwichViewContext.getIndexForFrame(sandwichViewContext.selectedFrame)\n      : null\n  const numResults = rowList != null ? rowList.length : null\n\n  const {selectPrev, selectNext} = useMemo(() => {\n    if (rowList == null || numResults == null || numResults === 0 || sandwichViewContext == null) {\n      return {selectPrev: () => {}, selectNext: () => {}}\n    }\n\n    return {\n      selectPrev: () => {\n        let index = resultIndex == null ? numResults - 1 : resultIndex - 1\n        if (index < 0) index = numResults - 1\n        sandwichViewContext.setSelectedFrame(rowList[index])\n      },\n      selectNext: () => {\n        let index = resultIndex == null ? 0 : resultIndex + 1\n        if (index >= numResults) index = 0\n        sandwichViewContext.setSelectedFrame(rowList[index])\n      },\n    }\n  }, [resultIndex, rowList, numResults, sandwichViewContext])\n\n  return (\n    <SearchView\n      resultIndex={resultIndex}\n      numResults={numResults}\n      selectPrev={selectPrev}\n      selectNext={selectNext}\n    />\n  )\n})\n", "import {Frame} from '../lib/profile'\nimport {StyleSheet, css} from 'aphrodite'\nimport {ProfileTableViewContainer} from './profile-table-view'\nimport {h, JSX, createContext} from 'preact'\nimport {memo} from 'preact/compat'\nimport {useCallback, useMemo, useContext} from 'preact/hooks'\nimport {commonStyle, Sizes, FontSize} from './style'\nimport {InvertedCallerFlamegraphView} from './inverted-caller-flamegraph-view'\nimport {CalleeFlamegraphView} from './callee-flamegraph-view'\nimport {SandwichSearchView} from './sandwich-search-view'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {sortBy} from '../lib/utils'\nimport {ProfileSearchContext} from './search-view'\nimport {Theme, useTheme, withTheme} from './themes/theme'\nimport {SortField, SortDirection, profileGroupAtom, tableSortMethodAtom} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {StatelessComponent} from '../lib/preact-helpers'\n\ninterface SandwichViewProps {\n  selectedFrame: Frame | null\n  profileIndex: number\n  theme: Theme\n  activeProfileState: ActiveProfileState\n  setSelectedFrame: (selectedFrame: Frame | null) => void\n  glCanvas: HTMLCanvasElement\n}\n\nclass SandwichView extends StatelessComponent<SandwichViewProps> {\n  private setSelectedFrame = (selectedFrame: Frame | null) => {\n    this.props.setSelectedFrame(selectedFrame)\n  }\n\n  onWindowKeyPress = (ev: KeyboardEvent) => {\n    if (ev.key === 'Escape') {\n      this.setSelectedFrame(null)\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.onWindowKeyPress)\n  }\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onWindowKeyPress)\n  }\n\n  render() {\n    const style = getStyle(this.props.theme)\n\n    const {selectedFrame} = this.props\n    let flamegraphViews: JSX.Element | null = null\n\n    if (selectedFrame) {\n      flamegraphViews = (\n        <div className={css(commonStyle.fillY, style.callersAndCallees, commonStyle.vbox)}>\n          <div className={css(commonStyle.hbox, style.panZoomViewWraper)}>\n            <div className={css(style.flamechartLabelParent)}>\n              <div className={css(style.flamechartLabel)}>Callers</div>\n            </div>\n            <InvertedCallerFlamegraphView\n              glCanvas={this.props.glCanvas}\n              activeProfileState={this.props.activeProfileState}\n            />\n          </div>\n          <div className={css(style.divider)} />\n          <div className={css(commonStyle.hbox, style.panZoomViewWraper)}>\n            <div className={css(style.flamechartLabelParent, style.flamechartLabelParentBottom)}>\n              <div className={css(style.flamechartLabel, style.flamechartLabelBottom)}>Callees</div>\n            </div>\n            <CalleeFlamegraphView\n              glCanvas={this.props.glCanvas}\n              activeProfileState={this.props.activeProfileState}\n            />\n          </div>\n        </div>\n      )\n    }\n\n    return (\n      <div className={css(commonStyle.hbox, commonStyle.fillY)}>\n        <div className={css(style.tableView)}>\n          <ProfileTableViewContainer activeProfileState={this.props.activeProfileState} />\n          <SandwichSearchView />\n        </div>\n        {flamegraphViews}\n      </div>\n    )\n  }\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    tableView: {\n      position: 'relative',\n      flex: 1,\n    },\n    panZoomViewWraper: {\n      flex: 1,\n    },\n    flamechartLabelParent: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'flex-end',\n      alignItems: 'flex-start',\n      fontSize: FontSize.TITLE,\n      width: FontSize.TITLE * 1.2,\n      borderRight: `1px solid ${theme.fgSecondaryColor}`,\n    },\n    flamechartLabelParentBottom: {\n      justifyContent: 'flex-start',\n    },\n    flamechartLabel: {\n      transform: 'rotate(-90deg)',\n      transformOrigin: '50% 50% 0',\n      width: FontSize.TITLE * 1.2,\n      flexShrink: 1,\n    },\n    flamechartLabelBottom: {\n      transform: 'rotate(-90deg)',\n      display: 'flex',\n      justifyContent: 'flex-end',\n    },\n    callersAndCallees: {\n      flex: 1,\n      borderLeft: `${Sizes.SEPARATOR_HEIGHT}px solid ${theme.fgSecondaryColor}`,\n    },\n    divider: {\n      height: 2,\n      background: theme.fgSecondaryColor,\n    },\n  }),\n)\n\ninterface SandwichViewContainerProps {\n  activeProfileState: ActiveProfileState\n  glCanvas: HTMLCanvasElement\n}\n\ninterface SandwichViewContextData {\n  rowList: Frame[]\n  selectedFrame: Frame | null\n  setSelectedFrame: (frame: Frame | null) => void\n  getIndexForFrame: (frame: Frame) => number | null\n  getSearchMatchForFrame: (frame: Frame) => [number, number][] | null\n}\n\nexport const SandwichViewContext = createContext<SandwichViewContextData | null>(null)\n\nexport const SandwichViewContainer = memo((ownProps: SandwichViewContainerProps) => {\n  const {activeProfileState, glCanvas} = ownProps\n  const {sandwichViewState, index} = activeProfileState\n  const {callerCallee} = sandwichViewState\n\n  const theme = useTheme()\n  const setSelectedFrame = useCallback((selectedFrame: Frame | null) => {\n    profileGroupAtom.setSelectedFrame(selectedFrame)\n  }, [])\n\n  const profile = activeProfileState.profile\n  const tableSortMethod = useAtom(tableSortMethodAtom)\n  const profileSearchResults = useContext(ProfileSearchContext)\n\n  const selectedFrame = callerCallee ? callerCallee.selectedFrame : null\n\n  const rowList: Frame[] = useMemo(() => {\n    const rowList: Frame[] = []\n\n    profile.forEachFrame(frame => {\n      if (profileSearchResults && !profileSearchResults.getMatchForFrame(frame)) {\n        return\n      }\n      rowList.push(frame)\n    })\n\n    switch (tableSortMethod.field) {\n      case SortField.SYMBOL_NAME: {\n        sortBy(rowList, f => f.name.toLowerCase())\n        break\n      }\n      case SortField.SELF: {\n        sortBy(rowList, f => f.getSelfWeight())\n        break\n      }\n      case SortField.TOTAL: {\n        sortBy(rowList, f => f.getTotalWeight())\n        break\n      }\n    }\n    if (tableSortMethod.direction === SortDirection.DESCENDING) {\n      rowList.reverse()\n    }\n\n    return rowList\n  }, [profile, profileSearchResults, tableSortMethod])\n\n  const getIndexForFrame: (frame: Frame) => number | null = useMemo(() => {\n    const indexByFrame = new Map<Frame, number>()\n    for (let i = 0; i < rowList.length; i++) {\n      indexByFrame.set(rowList[i], i)\n    }\n    return (frame: Frame) => {\n      const index = indexByFrame.get(frame)\n      return index == null ? null : index\n    }\n  }, [rowList])\n\n  const getSearchMatchForFrame: (frame: Frame) => [number, number][] | null = useMemo(() => {\n    return (frame: Frame) => {\n      if (profileSearchResults == null) return null\n      return profileSearchResults.getMatchForFrame(frame)\n    }\n  }, [profileSearchResults])\n\n  const contextData: SandwichViewContextData = {\n    rowList,\n    selectedFrame,\n    setSelectedFrame,\n    getIndexForFrame,\n    getSearchMatchForFrame,\n  }\n\n  return (\n    <SandwichViewContext.Provider value={contextData}>\n      <SandwichView\n        theme={theme}\n        activeProfileState={activeProfileState}\n        glCanvas={glCanvas}\n        setSelectedFrame={setSelectedFrame}\n        selectedFrame={selectedFrame}\n        profileIndex={index}\n      />\n    </SandwichViewContext.Provider>\n  )\n})\n", "import '../../assets/reset.css'\nimport '../../assets/source-code-pro.css'\n\nimport {h} from 'preact'\nimport {StyleSheet, css} from 'aphrodite'\n\nimport {ProfileGroup, SymbolRemapper} from '../lib/profile'\nimport {FontFamily, FontSize, Duration} from './style'\nimport {importEmscriptenSymbolMap as importEmscriptenSymbolRemapper} from '../lib/emscripten'\nimport {saveToFile} from '../lib/file-format'\nimport {ActiveProfileState} from '../app-state/active-profile-state'\nimport {LeftHeavyFlamechartView, ChronoFlamechartView} from './flamechart-view-container'\nimport {CanvasContext} from '../gl/canvas-context'\nimport {Toolbar} from './toolbar'\nimport {importJavaScriptSourceMapSymbolRemapper} from '../lib/js-source-map'\nimport {Theme, withTheme} from './themes/theme'\nimport {ViewMode} from '../lib/view-mode'\nimport {canUseXHR} from '../app-state'\nimport {ProfileGroupState} from '../app-state/profile-group'\nimport {HashParams} from '../lib/hash-params'\nimport {StatelessComponent} from '../lib/preact-helpers'\nimport {SandwichViewContainer} from './sandwich-view'\n\nconst importModule = import('../import')\n\n// Force eager loading of a few code-split modules.\n//\n// We put them all in one place so we can directly control the relative priority\n// of these.\nimportModule.then(() => {})\nimport('../lib/demangle').then(() => {})\nimport('source-map').then(() => {})\n\nasync function importProfilesFromText(\n  fileName: string,\n  contents: string,\n): Promise<ProfileGroup | null> {\n  return (await importModule).importProfileGroupFromText(fileName, contents)\n}\n\nasync function importProfilesFromBase64(\n  fileName: string,\n  contents: string,\n): Promise<ProfileGroup | null> {\n  return (await importModule).importProfileGroupFromBase64(fileName, contents)\n}\n\nasync function importProfilesFromArrayBuffer(\n  fileName: string,\n  contents: ArrayBuffer,\n): Promise<ProfileGroup | null> {\n  return (await importModule).importProfilesFromArrayBuffer(fileName, contents)\n}\n\nasync function importProfilesFromFile(file: File): Promise<ProfileGroup | null> {\n  return (await importModule).importProfilesFromFile(file)\n}\nasync function importFromFileSystemDirectoryEntry(entry: FileSystemDirectoryEntry) {\n  return (await importModule).importFromFileSystemDirectoryEntry(entry)\n}\n\ndeclare function require(x: string): any\nconst exampleProfileURL = require('../../sample/profiles/stackcollapse/perf-vertx-stacks-01-collapsed-all.txt')\n\nfunction isFileSystemDirectoryEntry(entry: FileSystemEntry): entry is FileSystemDirectoryEntry {\n  return entry != null && entry.isDirectory\n}\n\ninterface GLCanvasProps {\n  canvasContext: CanvasContext | null\n  theme: Theme\n  setGLCanvas: (canvas: HTMLCanvasElement | null) => void\n}\nexport class GLCanvas extends StatelessComponent<GLCanvasProps> {\n  private canvas: HTMLCanvasElement | null = null\n\n  private ref = (canvas: Element | null) => {\n    if (canvas instanceof HTMLCanvasElement) {\n      this.canvas = canvas\n    } else {\n      this.canvas = null\n    }\n\n    this.props.setGLCanvas(this.canvas)\n  }\n\n  private container: HTMLElement | null = null\n  private containerRef = (container: Element | null) => {\n    if (container instanceof HTMLElement) {\n      this.container = container\n    } else {\n      this.container = null\n    }\n  }\n\n  private maybeResize = () => {\n    if (!this.container) return\n    if (!this.props.canvasContext) return\n\n    let {width, height} = this.container.getBoundingClientRect()\n\n    const widthInAppUnits = width\n    const heightInAppUnits = height\n    const widthInPixels = width * window.devicePixelRatio\n    const heightInPixels = height * window.devicePixelRatio\n\n    this.props.canvasContext.gl.resize(\n      widthInPixels,\n      heightInPixels,\n      widthInAppUnits,\n      heightInAppUnits,\n    )\n  }\n\n  onWindowResize = () => {\n    if (this.props.canvasContext) {\n      this.props.canvasContext.requestFrame()\n    }\n  }\n  componentWillReceiveProps(nextProps: GLCanvasProps) {\n    if (this.props.canvasContext !== nextProps.canvasContext) {\n      if (this.props.canvasContext) {\n        this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize)\n      }\n      if (nextProps.canvasContext) {\n        nextProps.canvasContext.addBeforeFrameHandler(this.maybeResize)\n        nextProps.canvasContext.requestFrame()\n      }\n    }\n  }\n  componentDidMount() {\n    window.addEventListener('resize', this.onWindowResize)\n  }\n  componentWillUnmount() {\n    if (this.props.canvasContext) {\n      this.props.canvasContext.removeBeforeFrameHandler(this.maybeResize)\n    }\n    window.removeEventListener('resize', this.onWindowResize)\n  }\n  render() {\n    const style = getStyle(this.props.theme)\n    return (\n      <div ref={this.containerRef} className={css(style.glCanvasView)}>\n        <canvas ref={this.ref} width={1} height={1} />\n      </div>\n    )\n  }\n}\n\nexport type ApplicationProps = {\n  setGLCanvas: (canvas: HTMLCanvasElement | null) => void\n  setLoading: (loading: boolean) => void\n  setError: (error: boolean) => void\n  setProfileGroup: (profileGroup: ProfileGroup) => void\n  setDragActive: (dragActive: boolean) => void\n  setViewMode: (viewMode: ViewMode) => void\n  setFlattenRecursion: (flattenRecursion: boolean) => void\n  setProfileIndexToView: (profileIndex: number) => void\n  activeProfileState: ActiveProfileState | null\n  canvasContext: CanvasContext | null\n  theme: Theme\n  profileGroup: ProfileGroupState\n  flattenRecursion: boolean\n  viewMode: ViewMode\n  hashParams: HashParams\n  dragActive: boolean\n  loading: boolean\n  glCanvas: HTMLCanvasElement | null\n  error: boolean\n}\n\nexport class Application extends StatelessComponent<ApplicationProps> {\n  private async loadProfile(loader: () => Promise<ProfileGroup | null>) {\n    this.props.setError(false)\n    this.props.setLoading(true)\n    await new Promise(resolve => setTimeout(resolve, 0))\n\n    if (!this.props.glCanvas) return\n\n    console.time('import')\n\n    let profileGroup: ProfileGroup | null = null\n    try {\n      profileGroup = await loader()\n    } catch (e) {\n      console.log('Failed to load format', e)\n      this.props.setError(true)\n      return\n    }\n\n    // TODO(jlfwong): Make these into nicer overlays\n    if (profileGroup == null) {\n      alert('Unrecognized format! See documentation about supported formats.')\n      this.props.setLoading(false)\n      return\n    } else if (profileGroup.profiles.length === 0) {\n      alert(\"Successfully imported profile, but it's empty!\")\n      this.props.setLoading(false)\n      return\n    }\n\n    if (this.props.hashParams.title) {\n      profileGroup = {\n        ...profileGroup,\n        name: this.props.hashParams.title,\n      }\n    }\n    document.title = `${profileGroup.name} - speedscope`\n\n    if (this.props.hashParams.viewMode) {\n      this.props.setViewMode(this.props.hashParams.viewMode)\n    }\n\n    for (let profile of profileGroup.profiles) {\n      await profile.demangle()\n    }\n\n    for (let profile of profileGroup.profiles) {\n      const title = this.props.hashParams.title || profile.getName()\n      profile.setName(title)\n    }\n\n    console.timeEnd('import')\n\n    this.props.setProfileGroup(profileGroup)\n    this.props.setLoading(false)\n  }\n\n  getStyle(): ReturnType<typeof getStyle> {\n    return getStyle(this.props.theme)\n  }\n\n  loadFromFile(file: File) {\n    this.loadProfile(async () => {\n      const profiles = await importProfilesFromFile(file)\n      if (profiles) {\n        for (let profile of profiles.profiles) {\n          if (!profile.getName()) {\n            profile.setName(file.name)\n          }\n        }\n        return profiles\n      }\n\n      if (this.props.profileGroup && this.props.activeProfileState) {\n        // If a profile is already loaded, it's possible the file being imported is\n        // a symbol map. If that's the case, we want to parse it, and apply the symbol\n        // mapping to the already loaded profile. This can be use to take an opaque\n        // profile and make it readable.\n        const reader = new FileReader()\n        const fileContentsPromise = new Promise<string>(resolve => {\n          reader.addEventListener('loadend', () => {\n            if (typeof reader.result !== 'string') {\n              throw new Error('Expected reader.result to be a string')\n            }\n            resolve(reader.result)\n          })\n        })\n        reader.readAsText(file)\n        const fileContents = await fileContentsPromise\n\n        let symbolRemapper: SymbolRemapper | null = null\n\n        const emscriptenSymbolRemapper = importEmscriptenSymbolRemapper(fileContents)\n        if (emscriptenSymbolRemapper) {\n          console.log('Importing as emscripten symbol map')\n          symbolRemapper = emscriptenSymbolRemapper\n        }\n\n        const jsSourceMapRemapper = await importJavaScriptSourceMapSymbolRemapper(\n          fileContents,\n          file.name,\n        )\n        if (!symbolRemapper && jsSourceMapRemapper) {\n          console.log('Importing as JavaScript source map')\n          symbolRemapper = jsSourceMapRemapper\n        }\n\n        if (symbolRemapper != null) {\n          return {\n            name: this.props.profileGroup.name || 'profile',\n            indexToView: this.props.profileGroup.indexToView,\n            profiles: this.props.profileGroup.profiles.map(profileState => {\n              // We do a shallow clone here to invalidate certain caches keyed\n              // on a reference to the profile group under the assumption that\n              // profiles are immutable. Symbol remapping is (at time of\n              // writing) the only exception to that immutability.\n              const p = profileState.profile.shallowClone()\n              p.remapSymbols(symbolRemapper!)\n              return p\n            }),\n          }\n        }\n      }\n\n      return null\n    })\n  }\n\n  loadExample = () => {\n    this.loadProfile(async () => {\n      const filename = 'perf-vertx-stacks-01-collapsed-all.txt'\n      const data = await fetch(exampleProfileURL).then(resp => resp.text())\n      return await importProfilesFromText(filename, data)\n    })\n  }\n\n  onDrop = (ev: DragEvent) => {\n    this.props.setDragActive(false)\n    ev.preventDefault()\n\n    if (!ev.dataTransfer) return\n\n    const firstItem = ev.dataTransfer.items[0]\n    if ('webkitGetAsEntry' in firstItem) {\n      const webkitEntry: FileSystemEntry | null = firstItem.webkitGetAsEntry()\n\n      // Instrument.app file format is actually a directory.\n      if (\n        webkitEntry &&\n        isFileSystemDirectoryEntry(webkitEntry) &&\n        webkitEntry.name.endsWith('.trace')\n      ) {\n        console.log('Importing as Instruments.app .trace file')\n        const webkitDirectoryEntry: FileSystemDirectoryEntry = webkitEntry\n        this.loadProfile(async () => {\n          return await importFromFileSystemDirectoryEntry(webkitDirectoryEntry)\n        })\n        return\n      }\n    }\n\n    let file: File | null = ev.dataTransfer.files.item(0)\n    if (file) {\n      this.loadFromFile(file)\n    }\n  }\n\n  onDragOver = (ev: DragEvent) => {\n    this.props.setDragActive(true)\n    ev.preventDefault()\n  }\n\n  onDragLeave = (ev: DragEvent) => {\n    this.props.setDragActive(false)\n    ev.preventDefault()\n  }\n\n  onWindowKeyPress = async (ev: KeyboardEvent) => {\n    if (ev.key === '1') {\n      this.props.setViewMode(ViewMode.CHRONO_FLAME_CHART)\n    } else if (ev.key === '2') {\n      this.props.setViewMode(ViewMode.LEFT_HEAVY_FLAME_GRAPH)\n    } else if (ev.key === '3') {\n      this.props.setViewMode(ViewMode.SANDWICH_VIEW)\n    } else if (ev.key === 'r') {\n      const {flattenRecursion} = this.props\n      this.props.setFlattenRecursion(!flattenRecursion)\n    } else if (ev.key === 'n') {\n      const {activeProfileState} = this.props\n      if (activeProfileState) {\n        this.props.setProfileIndexToView(activeProfileState.index + 1)\n      }\n    } else if (ev.key === 'p') {\n      const {activeProfileState} = this.props\n      if (activeProfileState) {\n        this.props.setProfileIndexToView(activeProfileState.index - 1)\n      }\n    }\n  }\n\n  private saveFile = () => {\n    if (this.props.profileGroup) {\n      const {name, indexToView, profiles} = this.props.profileGroup\n      const profileGroup: ProfileGroup = {\n        name,\n        indexToView,\n        profiles: profiles.map(p => p.profile),\n      }\n      saveToFile(profileGroup)\n    }\n  }\n\n  private browseForFile = () => {\n    const input = document.createElement('input')\n    input.type = 'file'\n    input.addEventListener('change', this.onFileSelect)\n    input.click()\n  }\n\n  private onWindowKeyDown = async (ev: KeyboardEvent) => {\n    // This has to be handled on key down in order to prevent the default\n    // page save action.\n    if (ev.key === 's' && (ev.ctrlKey || ev.metaKey)) {\n      ev.preventDefault()\n      this.saveFile()\n    } else if (ev.key === 'o' && (ev.ctrlKey || ev.metaKey)) {\n      ev.preventDefault()\n      this.browseForFile()\n    }\n  }\n\n  onDocumentPaste = (ev: Event) => {\n    if (document.activeElement != null && document.activeElement.nodeName === 'INPUT') return\n\n    ev.preventDefault()\n    ev.stopPropagation()\n\n    const clipboardData = (ev as ClipboardEvent).clipboardData\n    if (!clipboardData) return\n    const pasted = clipboardData.getData('text')\n    this.loadProfile(async () => {\n      return await importProfilesFromText('From Clipboard', pasted)\n    })\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.onWindowKeyDown)\n    window.addEventListener('keypress', this.onWindowKeyPress)\n    document.addEventListener('paste', this.onDocumentPaste)\n    this.maybeLoadHashParamProfile()\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.onWindowKeyDown)\n    window.removeEventListener('keypress', this.onWindowKeyPress)\n    document.removeEventListener('paste', this.onDocumentPaste)\n  }\n\n  async maybeLoadHashParamProfile() {\n    const {profileURL} = this.props.hashParams\n    if (profileURL) {\n      if (!canUseXHR) {\n        alert(\n          `Cannot load a profile URL when loading from \"${window.location.protocol}\" URL protocol`,\n        )\n        return\n      }\n      this.loadProfile(async () => {\n        const response: Response = await fetch(profileURL)\n        let filename = new URL(profileURL, window.location.href).pathname\n        if (filename.includes('/')) {\n          filename = filename.slice(filename.lastIndexOf('/') + 1)\n        }\n        return await importProfilesFromArrayBuffer(filename, await response.arrayBuffer())\n      })\n    } else if (this.props.hashParams.localProfilePath) {\n      // There isn't good cross-browser support for XHR of local files, even from\n      // other local files. To work around this restriction, we load the local profile\n      // as a JavaScript file which will invoke a global function.\n      ;(window as any)['speedscope'] = {\n        loadFileFromBase64: (filename: string, base64source: string) => {\n          this.loadProfile(() => importProfilesFromBase64(filename, base64source))\n        },\n      }\n\n      const script = document.createElement('script')\n      script.src = `file:///${this.props.hashParams.localProfilePath}`\n      document.head.appendChild(script)\n    }\n  }\n\n  onFileSelect = (ev: Event) => {\n    const file = (ev.target as HTMLInputElement).files!.item(0)\n    if (file) {\n      this.loadFromFile(file)\n    }\n  }\n\n  renderLanding() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.landingContainer)}>\n        <div className={css(style.landingMessage)}>\n          <p className={css(style.landingP)}>\n            \uD83D\uDC4B Hi there! Welcome to \uD83D\uDD2Cspeedscope, an interactive{' '}\n            <a\n              className={css(style.link)}\n              href=\"http://www.brendangregg.com/FlameGraphs/cpuflamegraphs.html\"\n            >\n              flamegraph\n            </a>{' '}\n            visualizer. Use it to help you make your software faster.\n          </p>\n          {canUseXHR ? (\n            <p className={css(style.landingP)}>\n              Drag and drop a profile file onto this window to get started, click the big blue\n              button below to browse for a profile to explore, or{' '}\n              <a tabIndex={0} className={css(style.link)} onClick={this.loadExample}>\n                click here\n              </a>{' '}\n              to load an example profile.\n            </p>\n          ) : (\n            <p className={css(style.landingP)}>\n              Drag and drop a profile file onto this window to get started, or click the big blue\n              button below to browse for a profile to explore.\n            </p>\n          )}\n          <div className={css(style.browseButtonContainer)}>\n            <input\n              type=\"file\"\n              name=\"file\"\n              id=\"file\"\n              onChange={this.onFileSelect}\n              className={css(style.hide)}\n            />\n            <label for=\"file\" className={css(style.browseButton)} tabIndex={0}>\n              Browse\n            </label>\n          </div>\n\n          <p className={css(style.landingP)}>\n            See the{' '}\n            <a\n              className={css(style.link)}\n              href=\"https://github.com/jlfwong/speedscope#usage\"\n              target=\"_blank\"\n            >\n              documentation\n            </a>{' '}\n            for information about supported file formats, keyboard shortcuts, and how to navigate\n            around the profile.\n          </p>\n\n          <p className={css(style.landingP)}>\n            speedscope is open source. Please{' '}\n            <a\n              className={css(style.link)}\n              target=\"_blank\"\n              href=\"https://github.com/jlfwong/speedscope/issues\"\n            >\n              report any issues on GitHub\n            </a>\n            .\n          </p>\n        </div>\n      </div>\n    )\n  }\n\n  renderError() {\n    const style = this.getStyle()\n\n    return (\n      <div className={css(style.error)}>\n        <div>\uD83D\uDE3F Something went wrong.</div>\n        <div>Check the JS console for more details.</div>\n      </div>\n    )\n  }\n\n  renderLoadingBar() {\n    const style = this.getStyle()\n    return <div className={css(style.loading)} />\n  }\n\n  renderContent() {\n    const {viewMode, activeProfileState, error, loading, glCanvas} = this.props\n\n    if (error) {\n      return this.renderError()\n    }\n\n    if (loading) {\n      return this.renderLoadingBar()\n    }\n\n    if (!activeProfileState || !glCanvas) {\n      return this.renderLanding()\n    }\n\n    switch (viewMode) {\n      case ViewMode.CHRONO_FLAME_CHART: {\n        return <ChronoFlamechartView activeProfileState={activeProfileState} glCanvas={glCanvas} />\n      }\n      case ViewMode.LEFT_HEAVY_FLAME_GRAPH: {\n        return (\n          <LeftHeavyFlamechartView activeProfileState={activeProfileState} glCanvas={glCanvas} />\n        )\n      }\n      case ViewMode.SANDWICH_VIEW: {\n        return <SandwichViewContainer activeProfileState={activeProfileState} glCanvas={glCanvas} />\n      }\n    }\n  }\n\n  render() {\n    const style = this.getStyle()\n    return (\n      <div\n        onDrop={this.onDrop}\n        onDragOver={this.onDragOver}\n        onDragLeave={this.onDragLeave}\n        className={css(style.root, this.props.dragActive && style.dragTargetRoot)}\n      >\n        <GLCanvas\n          setGLCanvas={this.props.setGLCanvas}\n          canvasContext={this.props.canvasContext}\n          theme={this.props.theme}\n        />\n        <Toolbar\n          saveFile={this.saveFile}\n          browseForFile={this.browseForFile}\n          {...(this.props as ApplicationProps)}\n        />\n        <div className={css(style.contentContainer)}>{this.renderContent()}</div>\n        {this.props.dragActive && <div className={css(style.dragTarget)} />}\n      </div>\n    )\n  }\n}\n\nconst getStyle = withTheme(theme =>\n  StyleSheet.create({\n    glCanvasView: {\n      position: 'absolute',\n      width: '100vw',\n      height: '100vh',\n      zIndex: -1,\n      pointerEvents: 'none',\n    },\n    error: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: '100%',\n    },\n    loading: {\n      height: 3,\n      marginBottom: -3,\n      background: theme.selectionPrimaryColor,\n      transformOrigin: '0% 50%',\n      animationName: [\n        {\n          from: {\n            transform: `scaleX(0)`,\n          },\n          to: {\n            transform: `scaleX(1)`,\n          },\n        },\n      ],\n      animationTimingFunction: 'cubic-bezier(0, 1, 0, 1)',\n      animationDuration: '30s',\n    },\n    root: {\n      width: '100vw',\n      height: '100vh',\n      overflow: 'hidden',\n      display: 'flex',\n      flexDirection: 'column',\n      position: 'relative',\n      fontFamily: FontFamily.MONOSPACE,\n      lineHeight: '20px',\n      color: theme.fgPrimaryColor,\n    },\n    dragTargetRoot: {\n      cursor: 'copy',\n    },\n    dragTarget: {\n      boxSizing: 'border-box',\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      border: `5px dashed ${theme.selectionPrimaryColor}`,\n      pointerEvents: 'none',\n    },\n    contentContainer: {\n      position: 'relative',\n      display: 'flex',\n      overflow: 'hidden',\n      flexDirection: 'column',\n      flex: 1,\n    },\n    landingContainer: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      flex: 1,\n    },\n    landingMessage: {\n      maxWidth: 600,\n    },\n    landingP: {\n      marginBottom: 16,\n    },\n    hide: {\n      display: 'none',\n    },\n    browseButtonContainer: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n    },\n    browseButton: {\n      marginBottom: 16,\n      height: 72,\n      flex: 1,\n      maxWidth: 256,\n      textAlign: 'center',\n      fontSize: FontSize.BIG_BUTTON,\n      lineHeight: '72px',\n      background: theme.selectionPrimaryColor,\n      color: theme.altFgPrimaryColor,\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      ':hover': {\n        background: theme.selectionSecondaryColor,\n      },\n    },\n    link: {\n      color: theme.selectionPrimaryColor,\n      cursor: 'pointer',\n      textDecoration: 'none',\n      transition: `all ${Duration.HOVER_CHANGE} ease-in`,\n      ':hover': {\n        color: theme.selectionSecondaryColor,\n      },\n    },\n  }),\n)\n", "import {h} from 'preact'\nimport {getCanvasContext} from '../app-state/getters'\nimport {memo, useMemo} from 'preact/compat'\nimport {useActiveProfileState} from '../app-state/active-profile-state'\nimport {useTheme} from './themes/theme'\nimport {\n  dragActiveAtom,\n  errorAtom,\n  flattenRecursionAtom,\n  glCanvasAtom,\n  hashParamsAtom,\n  loadingAtom,\n  profileGroupAtom,\n  viewModeAtom,\n} from '../app-state'\nimport {useAtom} from '../lib/atom'\nimport {ProfileSearchContextProvider} from './search-view'\nimport {Application} from './application'\n\nexport const ApplicationContainer = memo(() => {\n  const canvas = useAtom(glCanvasAtom)\n  const theme = useTheme()\n  const canvasContext = useMemo(\n    () => (canvas ? getCanvasContext({theme, canvas}) : null),\n    [theme, canvas],\n  )\n\n  return (\n    <ProfileSearchContextProvider>\n      <Application\n        activeProfileState={useActiveProfileState()}\n        canvasContext={canvasContext}\n        setGLCanvas={glCanvasAtom.set}\n        setLoading={loadingAtom.set}\n        setError={errorAtom.set}\n        setProfileGroup={profileGroupAtom.setProfileGroup}\n        setDragActive={dragActiveAtom.set}\n        setViewMode={viewModeAtom.set}\n        setFlattenRecursion={flattenRecursionAtom.set}\n        setProfileIndexToView={profileGroupAtom.setProfileIndexToView}\n        profileGroup={useAtom(profileGroupAtom)}\n        theme={theme}\n        flattenRecursion={useAtom(flattenRecursionAtom)}\n        viewMode={useAtom(viewModeAtom)}\n        hashParams={useAtom(hashParamsAtom)}\n        glCanvas={canvas}\n        dragActive={useAtom(dragActiveAtom)}\n        loading={useAtom(loadingAtom)}\n        error={useAtom(errorAtom)}\n      />\n    </ProfileSearchContextProvider>\n  )\n})\n", "import {h, render} from 'preact'\nimport {ApplicationContainer} from './views/application-container'\nimport {ThemeProvider} from './views/themes/theme'\n\nconsole.log(`speedscope v${require('../package.json').version}`)\n\n/*\nTODO(jlfwong): Fix this\ndeclare const module: any\nif (module.hot) {\n  module.hot.dispose(() => {\n    // Force the old component go through teardown steps\n    render(<div />, document.body, document.body.lastElementChild || undefined)\n  })\n  module.hot.accept()\n}\n*/\n\nrender(\n  <ThemeProvider>\n    <ApplicationContainer />\n  </ThemeProvider>,\n  document.body,\n  document.body.lastElementChild || undefined,\n)\n"],
  "mappings": "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",
  "names": ["require_isPrefixedValue", "__commonJSMin", "exports", "module", "isPrefixedValue", "regex", "value", "require_calc", "__commonJSMin", "exports", "module", "calc", "_isPrefixedValue", "_isPrefixedValue2", "_interopRequireDefault", "obj", "prefixes", "property", "value", "prefix", "require_crossFade", "__commonJSMin", "exports", "module", "crossFade", "_isPrefixedValue", "_isPrefixedValue2", "_interopRequireDefault", "obj", "prefixes", "property", "value", "prefix", "require_cursor", "__commonJSMin", "exports", "module", "cursor", "prefixes", "values", "property", "value", "prefix", "require_filter", "__commonJSMin", "exports", "module", "filter", "_isPrefixedValue", "_isPrefixedValue2", "_interopRequireDefault", "obj", "prefixes", "property", "value", "prefix", "require_flex", "__commonJSMin", "exports", "module", "flex", "values", "property", "value", "require_flexboxIE", "__commonJSMin", "exports", "module", "flexboxIE", "alternativeValues", "alternativeProps", "property", "value", "style", "require_flexboxOld", "__commonJSMin", "exports", "module", "flexboxOld", "alternativeValues", "alternativeProps", "property", "value", "style", "require_gradient", "__commonJSMin", "exports", "module", "gradient", "_isPrefixedValue", "_isPrefixedValue2", "_interopRequireDefault", "obj", "prefixes", "values", "property", "value", "prefix", "require_imageSet", "__commonJSMin", "exports", "module", "imageSet", "_isPrefixedValue", "_isPrefixedValue2", "_interopRequireDefault", "obj", "prefixes", "property", "value", "prefix", "require_position", "__commonJSMin", "exports", "module", "position", "property", "value", "require_sizing", "__commonJSMin", "exports", "module", "sizing", "prefixes", "properties", "values", "property", "value", "prefix", "require_hyphenate_style_name", "__commonJSMin", "exports", "module", "uppercasePattern", "msPattern", "cache", "hyphenateStyleName", "string", "require_hyphenateProperty", "__commonJSMin", "exports", "module", "hyphenateProperty", "_hyphenateStyleName", "_hyphenateStyleName2", "_interopRequireDefault", "obj", "property", "require_capitalizeString", "__commonJSMin", "exports", "module", "capitalizeString", "str", "require_transition", "__commonJSMin", "exports", "module", "transition", "_hyphenateProperty", "_hyphenateProperty2", "_interopRequireDefault", "_isPrefixedValue", "_isPrefixedValue2", "_capitalizeString", "_capitalizeString2", "obj", "properties", "prefixMapping", "prefixValue", "value", "propertyPrefixMap", "multipleValues", "i", "len", "singleValue", "values", "property", "dashCaseProperty", "prefixes", "j", "pLen", "style", "outputValue", "webkitOutput", "val", "mozOutput", "require_string_hash", "__commonJSMin", "exports", "module", "hash", "str", "i", "require_prefixProperty", "__commonJSMin", "exports", "module", "prefixProperty", "_capitalizeString", "_capitalizeString2", "_interopRequireDefault", "obj", "prefixProperties", "property", "style", "newStyle", "requiredPrefixes", "capitalizedProperty", "keys", "i", "styleProperty", "j", "require_prefixValue", "__commonJSMin", "exports", "module", "prefixValue", "plugins", "property", "value", "style", "metaData", "i", "len", "processedValue", "require_addNewValuesOnly", "__commonJSMin", "exports", "module", "addNewValuesOnly", "addIfNew", "list", "value", "values", "i", "len", "require_isObject", "__commonJSMin", "exports", "module", "isObject", "value", "require_createPrefixer", "__commonJSMin", "exports", "module", "createPrefixer", "_prefixProperty", "_prefixProperty2", "_interopRequireDefault", "_prefixValue", "_prefixValue2", "_addNewValuesOnly", "_addNewValuesOnly2", "_isObject", "_isObject2", "obj", "_ref", "prefixMap", "plugins", "prefixAll", "style", "property", "value", "combinedValue", "i", "len", "processedValue", "_processedValue", "require_browser_raw", "__commonJSMin", "exports", "module", "rawAsap", "task", "queue", "requestFlush", "flushing", "index", "capacity", "flush", "currentIndex", "scan", "newLength", "scope", "BrowserMutationObserver", "makeRequestCallFromMutationObserver", "makeRequestCallFromTimer", "callback", "toggle", "observer", "node", "timeoutHandle", "handleTimer", "intervalHandle", "require_browser_asap", "__commonJSMin", "exports", "module", "rawAsap", "freeTasks", "pendingErrors", "requestErrorThrow", "throwFirstError", "asap", "task", "rawTask", "RawTask", "error", "options", "isValidElement", "rerenderQueue", "rerenderCount", "defer", "prevDebounce", "IS_HYDRATE", "i", "EMPTY_OBJ", "EMPTY_ARR", "IS_NON_DIMENSIONAL", "assign", "obj", "props", "removeNode", "node", "parentNode", "removeChild", "createElement", "type", "children", "normalizedProps", "arguments", "length", "push", "defaultProps", "createVNode", "key", "ref", "original", "vnode", "_children", "_parent", "_depth", "_dom", "_nextDom", "_component", "constructor", "_original", "Fragment", "props", "children", "Component", "context", "getDomSibling", "vnode", "childIndex", "_parent", "_children", "indexOf", "sibling", "length", "_dom", "type", "updateParentDomPointers", "i", "child", "_component", "base", "enqueueRender", "c", "_dirty", "rerenderQueue", "push", "rerenderCount", "prevDebounce", "options", "debounceRendering", "defer", "process", "queue", "sort", "a", "b", "_vnode", "_depth", "some", "component", "commitQueue", "oldVNode", "newDom", "oldDom", "parentDom", "_parentDom", "assign", "_original", "diff", "_globalContext", "ownerSVGElement", "commitRoot", "diffChildren", "newParentVNode", "oldParentVNode", "globalContext", "isSvg", "excessDomChildren", "isHydrating", "j", "sibDom", "firstChildDom", "refs", "oldChildren", "EMPTY_ARR", "oldChildrenLength", "EMPTY_OBJ", "toChildArray", "childVNode", "key", "undefined", "ref", "nextDom", "_nextDom", "parentNode", "outer", "appendChild", "nextSibling", "insertBefore", "value", "removeNode", "unmount", "applyRef", "callback", "flattened", "Array", "isArray", "createVNode", "diffProps", "dom", "newProps", "oldProps", "hydrate", "setProperty", "setStyle", "style", "IS_NON_DIMENSIONAL", "test", "name", "oldValue", "s", "useCapture", "nameLower", "cssText", "replace", "toLowerCase", "slice", "addEventListener", "eventProxy", "_listeners", "removeEventListener", "removeAttributeNS", "setAttributeNS", "removeAttribute", "setAttribute", "e", "event", "newVNode", "tmp", "isNew", "oldState", "snapshot", "clearProcessingException", "provider", "componentContext", "newType", "constructor", "_diff", "contextType", "_id", "_defaultValue", "_processingException", "_pendingError", "prototype", "render", "doRender", "sub", "state", "_renderCallbacks", "_nextState", "getDerivedStateFromProps", "componentWillMount", "componentDidMount", "componentWillReceiveProps", "_force", "shouldComponentUpdate", "componentWillUpdate", "componentDidUpdate", "_render", "getChildContext", "getSnapshotBeforeUpdate", "diffElementNodes", "diffed", "_catchError", "root", "_commit", "cb", "call", "oldHtml", "newHtml", "nodeType", "localName", "document", "createTextNode", "createElementNS", "createElement", "is", "data", "childNodes", "dangerouslySetInnerHTML", "attributes", "__html", "innerHTML", "checked", "current", "parentVNode", "skipRemove", "r", "componentWillUnmount", "this", "replaceNode", "_root", "IS_HYDRATE", "createContext", "defaultValue", "ctx", "context", "_id", "i", "_defaultValue", "Consumer", "props", "children", "Provider", "subs", "this", "getChildContext", "_this", "shouldComponentUpdate", "_props", "value", "some", "c", "enqueueRender", "sub", "push", "old", "componentWillUnmount", "splice", "indexOf", "call", "contextType", "_contextRef", "options", "_catchError", "error", "vnode", "component", "hasCaught", "_parent", "_component", "_processingException", "constructor", "getDerivedStateFromError", "setState", "componentDidCatch", "_pendingError", "e", "isValidElement", "Component", "prototype", "update", "callback", "s", "_nextState", "state", "assign", "_vnode", "_renderCallbacks", "forceUpdate", "_force", "render", "Fragment", "rerenderQueue", "rerenderCount", "defer", "Promise", "then", "bind", "resolve", "setTimeout", "IS_HYDRATE", "EMPTY_OBJ", "ListNode", "data", "List", "node", "ret", "LRUCache", "capacity", "key", "value", "listNode", "f", "oldest", "clamp", "x", "minVal", "maxVal", "Vec2", "_Vec2", "y", "other", "scalar", "epsilon", "a", "b", "v", "min", "max", "AffineTransform", "_AffineTransform", "m00", "m01", "m02", "m10", "m11", "m12", "s", "from", "to", "m20", "m21", "m22", "a00", "a01", "a02", "a10", "a11", "a12", "det", "inv", "r", "size", "origin", "Rect", "_Rect", "p", "top", "left", "topLeft", "bottomRight", "RELEASE", "assert", "condition", "appendOne", "ts", "removeOne", "index", "TEXTURE_N", "gl", "Graphics", "Rect", "x", "y", "width", "height", "other", "Color", "redF", "greenF", "blueF", "alphaF", "BlendOperation", "Primitive", "Context", "callback", "AttributeType", "attributeByteLength", "type", "Attribute", "name", "count", "byteOffset", "VertexFormat", "VertexBuffer", "floats", "PixelFilter", "PixelWrap", "TextureFormat", "minFilter", "magFilter", "wrap", "WebGL", "canvas", "handler", "style", "e", "source", "target", "primitive", "material", "vertices", "Material", "widthInPixels", "heightInPixels", "widthInAppUnits", "heightInAppUnits", "bounds", "cb", "color", "renderTarget", "RenderTarget", "format", "vertexSource", "fragmentSource", "byteCount", "pixels", "Texture", "texture", "viewport", "operations", "oldOperations", "attributes", "i", "attribute", "isByte", "ext", "renderer", "vendor", "version", "context", "Uniform", "_material", "_name", "_generation", "_location", "_isDirty", "program", "ii", "info", "UniformFloat", "UniformMat3", "UniformVec2", "UniformVec3", "UniformVec4", "UniformInt", "UniformSampler", "z", "w", "m00", "m01", "m02", "m10", "m11", "m12", "m20", "m21", "m22", "swap", "_context", "_format", "_vertexSource", "_fragmentSource", "_uniformsMap", "_uniformsList", "_program", "uniform", "shader", "sourceByteOffset", "targetByteOffset", "bytes", "min", "max", "buffer", "_width", "_height", "_pixels", "_texture", "_isFormatDirty", "_isContentDirty", "_framebuffer", "_viewport", "setUniformAffineTransform", "material", "name", "transform", "m00", "m01", "m02", "m10", "m11", "m12", "setUniformVec2", "vec", "renderInto", "gl", "target", "cb", "vertexFormat", "Graphics", "vert", "frag", "RectangleBatch", "gl", "corners", "bytes", "floats", "idx", "i", "rect", "color", "corner", "RectangleBatchRenderer", "props", "setUniformAffineTransform", "configToPhysical", "AffineTransform", "viewportSize", "Vec2", "Color", "_Color", "r", "g", "b", "a", "L", "C", "H", "hPrime", "X", "R1", "G1", "B1", "m", "clamp", "hex", "RowAtlas", "gl", "rectangleBatchRenderer", "textureRenderer", "Graphics", "LRUCache", "RectangleBatch", "Rect", "Color", "key", "row", "keys", "render", "renderInto", "textureRect", "Vec2", "dstRect", "vert", "frag", "TextureRenderer", "gl", "vertexFormat", "Graphics", "vertices", "floats", "v", "props", "setUniformAffineTransform", "srcRect", "texture", "uvRect", "AffineTransform", "Vec2", "Rect", "dstRect", "viewport", "viewportSize", "ndcRect", "vertexFormat", "Graphics", "vert", "frag", "theme", "r", "g", "b", "Color", "rgb", "ViewportRectangleRenderer", "gl", "vertices", "floats", "v", "props", "setUniformAffineTransform", "setUniformVec2", "viewport", "vertexFormat", "Graphics", "vert", "frag", "colorForBucket", "FlamechartColorPassRenderer", "gl", "theme", "vertices", "floats", "v", "props", "srcRect", "rectInfoTexture", "uvRect", "AffineTransform", "Vec2", "Rect", "uvTransform", "dstRect", "viewportSize", "ndcRect", "positionTransform", "uvSpacePixelSize", "setUniformAffineTransform", "CanvasContext", "canvas", "theme", "color", "Color", "Graphics", "handler", "WebGL", "RectangleBatchRenderer", "TextureRenderer", "ViewportRectangleRenderer", "FlamechartColorPassRenderer", "webGLInfo", "callback", "physicalBounds", "cb", "origin", "size", "viewportBefore", "x", "y", "width", "height", "el", "bounds", "Rect", "Vec2", "createGetColorBucketForFrame", "memoizeByReference", "frameToColorBucket", "frame", "createGetCSSColorForFrame", "memoizeByShallowEquality", "theme", "getColorBucketForFrame", "t", "getCanvasContext", "canvas", "CanvasContext", "getRowAtlas", "canvasContext", "RowAtlas", "getProfileToView", "profile", "flattenRecursion", "getFrameToColorBucket", "frames", "f", "key", "compare", "a", "b", "i", "currentIndex", "currentComponent", "prevRaf", "currentHook", "afterPaintEffects", "oldBeforeRender", "options", "_render", "oldAfterDiff", "diffed", "oldCommit", "_commit", "oldBeforeUnmount", "unmount", "getHookState", "index", "type", "_hook", "hooks", "__hooks", "_list", "_pendingEffects", "length", "push", "useState", "initialState", "useReducer", "invokeOrReturn", "reducer", "init", "hookState", "_component", "_value", "action", "nextValue", "setState", "useEffect", "callback", "args", "state", "_skipEffects", "argsChanged", "_args", "useLayoutEffect", "_renderCallbacks", "useRef", "initialValue", "useMemo", "current", "useMemo", "factory", "args", "state", "getHookState", "currentIndex", "argsChanged", "_args", "_factory", "_value", "useCallback", "callback", "currentHook", "useContext", "context", "provider", "currentComponent", "_id", "_context", "sub", "props", "value", "_defaultValue", "flushAfterPaintEffects", "afterPaintEffects", "some", "component", "_parentDom", "__hooks", "_pendingEffects", "forEach", "invokeCleanup", "invokeEffect", "e", "options", "_catchError", "_vnode", "hook", "_cleanup", "result", "_value", "argsChanged", "oldArgs", "newArgs", "arg", "index", "invokeOrReturn", "f", "_render", "vnode", "oldBeforeRender", "currentIndex", "currentComponent", "_component", "diffed", "oldAfterDiff", "c", "hooks", "length", "push", "prevRaf", "requestAnimationFrame", "callback", "raf", "done", "clearTimeout", "timeout", "cancelAnimationFrame", "setTimeout", "window", "_commit", "commitQueue", "_renderCallbacks", "filter", "cb", "oldCommit", "unmount", "oldBeforeUnmount", "_list", "assign", "obj", "props", "i", "shallowDiffers", "a", "b", "PureComponent", "r", "isPureReactComponent", "e", "shouldComponentUpdate", "state", "this", "Component", "memo", "c", "comparer", "shouldUpdate", "nextProps", "ref", "updateRef", "call", "current", "Memoed", "createElement", "prototype", "isReactComponent", "displayName", "name", "_forwarded", "oldDiffHook", "options", "_diff", "options", "_diff", "vnode", "type", "_forwarded", "ref", "props", "oldDiffHook", "vnode", "oldCatchError", "options", "_catchError", "detachedClone", "assign", "_component", "_children", "map", "Suspense", "_pendingSuspensionCount", "_suspenders", "_detachOnNextRender", "suspended", "component", "_parent", "_suspended", "SuspenseList", "_next", "_map", "options", "_catchError", "error", "newVNode", "oldVNode", "then", "component", "vnode", "_parent", "_component", "_childDidSuspend", "oldCatchError", "Suspense", "prototype", "Component", "promise", "suspendingComponent", "c", "this", "_suspenders", "push", "resolve", "suspended", "_vnode", "resolved", "onResolved", "onSuspensionComplete", "_suspendedComponentWillUnmount", "componentWillUnmount", "_pendingSuspensionCount", "_children", "state", "_suspended", "setState", "_detachOnNextRender", "pop", "forceUpdate", "render", "props", "detachedClone", "createElement", "children", "fallback", "list", "child", "node", "delete", "revealOrder", "size", "length", "delegated", "get", "unsuspend", "wrappedUnsuspend", "Map", "toChildArray", "reverse", "i", "set", "componentDidUpdate", "componentDidMount", "forEach", "ContextProvider", "getChildContext", "context", "CAMEL_PROPS", "Component", "prototype", "isReactComponent", "REACT_ELEMENT_TYPE", "Symbol", "for", "oldEventHook", "options", "event", "setSafeDescriptor", "proto", "key", "Object", "defineProperty", "configurable", "get", "this", "set", "v", "e", "persist", "stoppedPropagating", "defaultPrevented", "origStopPropagation", "stopPropagation", "call", "origPreventDefault", "preventDefault", "isPropagationStopped", "isDefaultPrevented", "nativeEvent", "classNameDescriptor", "class", "oldVNodeHook", "vnode", "$$typeof", "REACT_ELEMENT_TYPE", "type", "props", "className", "enumerable", "shouldSanitize", "attrs", "i", "defaultValue", "value", "Array", "isArray", "multiple", "toChildArray", "children", "forEach", "child", "indexOf", "selected", "CAMEL_PROPS", "test", "replace", "toLowerCase", "t", "newProps", "ondoubleclick", "ondblclick", "onbeforeinput", "onchange", "normalized", "oninput", "applyEventNormalization", "_patchedLifecycles", "prototype", "Atom", "state", "debugKey", "fn", "listener", "index", "useAtom", "atom", "value", "setValue", "m", "y", "getViewMode", "value", "getHashParams", "hashContents", "components", "result", "component", "key", "mode", "e", "initialFlameChartViewState", "Rect", "Vec2", "ProfileGroupAtom", "Atom", "group", "p", "indexToView", "clamp", "frame", "sandwichViewState", "newState", "oldState", "objectsHaveShallowEquality", "fn", "profiles", "id", "s", "hover", "f", "selectedNode", "configSpaceViewportRect", "logicalSpaceViewportSize", "flattenRecursionAtom", "Atom", "searchIsActiveAtom", "searchQueryAtom", "viewModeAtom", "profileGroupAtom", "ProfileGroupAtom", "hashParams", "getHashParams", "hashParamsAtom", "glCanvasAtom", "dragActiveAtom", "protocol", "canUseXHR", "isImmediatelyLoading", "loadingAtom", "errorAtom", "minimapMousePositionAtom", "tableSortMethodAtom", "Atom", "useActiveProfileState", "flattenRecursion", "useAtom", "flattenRecursionAtom", "profileGroupState", "profileGroupAtom", "index", "profileState", "getProfileToView", "localStorageKey", "getStoredPreference", "storedPreference", "matchMediaDarkColorScheme", "nextColorScheme", "scheme", "ColorSchemeAtom", "Atom", "colorSchemeAtom", "value", "C_0", "C_d", "L_0", "L_d", "colorForBucket", "t", "x", "triangle", "H", "C", "L", "Color", "colorForBucketGLSL", "darkTheme", "C_0", "C_d", "L_0", "L_d", "colorForBucket", "t", "x", "triangle", "H", "C", "L", "Color", "colorForBucketGLSL", "lightTheme", "ThemeContext", "M", "lightTheme", "useTheme", "w", "withTheme", "cb", "memoizeByReference", "matchMediaDarkColorScheme", "colorSchemeToString", "scheme", "getTheme", "colorScheme", "systemPrefersDarkMode", "darkTheme", "ThemeProvider", "props", "setSystemPrefersDarkMode", "m", "matchMediaListener", "T", "event", "l", "media", "useAtom", "colorSchemeAtom", "theme", "h", "import_calc", "import_crossFade", "import_cursor", "import_filter", "import_flex", "import_flexboxIE", "import_flexboxOld", "import_gradient", "import_imageSet", "import_position", "import_sizing", "import_transition", "import_string_hash", "import_createPrefixer", "import_asap", "w", "m", "ms", "wm", "wms", "wmms", "staticPrefixData", "calc", "crossFade", "cursor", "filter", "flex", "flexboxIE", "flexboxOld", "gradient", "imageSet", "position", "sizing", "transition", "_typeof", "obj", "_createClass", "defineProperties", "target", "props", "i", "descriptor", "Constructor", "protoProps", "staticProps", "_classCallCheck", "instance", "MAP_EXISTS", "OrderedElements", "forEach", "callback", "set", "key", "value", "shouldReorder", "index", "nested", "_nested", "keys", "get", "has", "addStyleType", "styleType", "_this", "UPPERCASE_RE", "UPPERCASE_RE_TO_KEBAB", "match", "kebabifyStyleName", "string", "result", "isUnitlessNumber", "prefixKey", "prefix", "prefixes", "prop", "stringifyValue", "stringifyAndImportantifyValue", "importantify", "hashString", "stringHash", "hashObject", "object", "_toConsumableArray", "arr", "arr2", "prefixAll", "createPrefixer", "defaultSelectorHandlers", "pseudoSelectors", "selector", "baseSelector", "generateSubtreeStyles", "mediaQueries", "generated", "generateCSS", "styleTypes", "selectorHandlers", "stringHandlers", "useImportant", "merged", "plainDeclarations", "generatedStyles", "val", "foundHandler", "handler", "newSelector", "generatedRuleset", "generateCSSRuleset", "runStringHandlers", "declarations", "stringHandlerKeys", "transformRule", "transformValue", "arrayToObjectKeysReducer", "acc", "originalElements", "prefixedElements", "elementNames", "originalStyle", "originalIndex", "rules", "_i", "j", "_typeof$1", "_toConsumableArray$1", "styleTag", "injectStyleTag", "cssRules", "head", "sheet", "numRules", "rule", "fontFamily", "injectStyleOnce", "animationName", "v", "name", "finalVal", "valVal", "valKey", "injectGeneratedCSSOnce", "alreadyInjected", "injectionBuffer", "isBuffering", "generatedCSS", "_injectionBuffer", "asap", "flushToStyleTag", "definitions", "reset", "startBuffering", "isBuffering", "flushToArray", "ret", "injectionBuffer", "flushToString", "flushToStyleTag", "cssRules", "injectStyleTag", "getRenderedClassNames", "alreadyInjected", "addRenderedClassNames", "classNames", "className", "processStyleDefinitions", "styleDefinitions", "classNameBits", "definitionBits", "length", "i", "injectAndGetClassName", "useImportant", "selectorHandlers", "hashString", "injectStyleOnce", "unminifiedHashFn", "str", "key", "initialHashFn", "hashFn", "StyleSheet", "create", "sheetDefinition", "mappedSheetDefinition", "keys", "val", "stringVal", "rehydrate", "renderedClassNames", "StyleSheetServer", "renderStatic", "renderFunc", "reset", "html", "cssContent", "StyleSheetTestUtils", "makeExports", "extend", "extensions", "extensionSelectorHandlers", "extension", "handler", "minify", "shouldMinify", "css", "_len", "_key", "Aphrodite", "defaultSelectorHandlers", "StyleSheet$1", "StyleSheetServer$1", "StyleSheetTestUtils$1", "commonStyle", "StyleSheet$1", "exactMatchStrings", "text", "pattern", "lowerText", "lowerPattern", "lastIndex", "matchedRanges", "index", "ProfileSearchResults", "profile", "searchQuery", "frame", "match", "FlamechartSearchResults", "flamechart", "profileResults", "matches", "indexForNode", "visit", "depth", "node", "configSpaceBounds", "Rect", "Vec2", "child", "layers", "result", "stopPropagation", "ev", "ProfileSearchContext", "M", "ProfileSearchContextProvider", "children", "activeProfileState", "useActiveProfileState", "profile", "searchIsActive", "useAtom", "searchIsActiveAtom", "searchQuery", "searchQueryAtom", "searchResults", "h", "ProfileSearchResults", "SearchView", "_", "numResults", "resultIndex", "selectNext", "selectPrev", "theme", "useTheme", "style", "getStyle", "setSearchQuery", "setSearchIsActive", "onInput", "T", "value", "inputRef", "d", "close", "selectPrevOrNextResult", "onKeyDown", "l", "onWindowKeyDown", "css", "withTheme", "StyleSheet$1", "unescapeHex", "input", "_match", "group", "scalar", "importEmscriptenSymbolMap", "contents", "lines", "map", "intRegex", "idRegex", "line", "intMatch", "idMatch", "frame", "Flamechart", "source", "stack", "openFrame", "node", "value", "parent", "lastOf", "frame", "closeFrame", "stackTop", "layerIndex", "v", "viewportWidth", "maxWidth", "maxZoom", "minWidth", "clamp", "configSpaceViewportRect", "renderInverted", "configSpaceSize", "Vec2", "width", "size", "origin", "Rect", "MAX_BATCH_SIZE", "RangeTreeLeafNode", "batch", "bounds", "numPrecedingRectanglesInRow", "configSpaceBounds", "cb", "RangeTreeInteriorNode", "children", "minLeft", "maxRight", "minTop", "maxBottom", "child", "Rect", "Vec2", "FlamechartRowAtlasKey", "_FlamechartRowAtlasKey", "options", "set", "info", "FlamechartRenderer", "gl", "rowAtlas", "flamechart", "rectangleBatchRenderer", "colorPassRenderer", "KeyedSet", "nLayers", "stackDepth", "leafNodes", "y", "RectangleBatch", "rectCount", "layer", "i", "frame", "color", "Color", "width", "height", "texture", "Graphics", "key", "zoomLevel", "index", "props", "configSpaceSrcRect", "physicalSpaceDstRect", "atlasKeysToRender", "configToPhysical", "AffineTransform", "top", "bottom", "configSpaceContentWidth", "numAtlasEntriesPerLayer", "left", "right", "cacheCapacity", "keysToRenderCached", "keysToRenderUncached", "textureDstRect", "leaf", "renderTarget", "renderInto", "viewportRect", "configToViewport", "physicalBounds", "rectInfoTexture", "getFlamechartStyle", "withTheme", "theme", "StyleSheet$1", "ELLIPSIS", "measureTextCache", "lastDevicePixelRatio", "cachedMeasureTextWidth", "ctx", "text", "buildTrimmedText", "length", "prefixLength", "suffixLength", "prefix", "suffix", "trimmedString", "trimTextMid", "maxWidth", "lo", "findValueBisect", "n", "getIndexTypeInTrimmed", "result", "index", "remapRangesToTrimmedText", "trimmedText", "ranges", "rangesToHighlightInTrimmedText", "lengthLoss", "highlightedEllipsis", "origStart", "origEnd", "startPosType", "endPosType", "FlamechartMinimapView", "m", "element", "ev", "multiplier", "clamp", "Vec2", "configSpaceMouse", "Rect", "configStart", "configEnd", "left", "width", "height", "newOrigin", "minimapMousePositionAtom", "getFlamechartStyle", "minimapOrigin", "AffineTransform", "bounds", "ctx", "physicalViewSize", "configToPhysical", "right", "targetInterval", "physicalViewSpaceFrameHeight", "physicalViewSpaceFontSize", "labelPaddingPx", "interval", "theme", "Color", "x", "pos", "labelText", "textWidth", "cachedMeasureTextWidth", "nextProps", "scaledWidth", "scaledHeight", "logicalViewSpaceDelta", "physicalDelta", "configDelta", "configSpaceViewport", "configSpaceCenter", "zoomTransform", "logicalSpaceMouse", "physicalSpaceMouse", "style", "h", "css", "commonStyle", "ColorChit", "props", "style", "getStyle", "useTheme", "h", "css", "withTheme", "theme", "StyleSheet$1", "StatisticsTable", "props", "style", "getFlamechartStyle", "useTheme", "total", "self", "totalPerc", "selfPerc", "h", "css", "formatPercent", "StackTraceView", "rows", "node", "row", "frame", "ColorChit", "pos", "FlamechartDetailView", "flamechart", "selectedNode", "BatchCanvasTextRenderer", "args", "ctx", "color", "BatchCanvasRectRenderer", "lineWidth", "FlamechartPanZoomView", "m", "element", "ev", "Vec2", "logicalMousePos", "hoveredBounds", "viewportRect", "Rect", "mouseDownPos", "logicalViewSpaceMouse", "physicalViewSpaceMouse", "configSpaceMouse", "setHoveredLabel", "frame", "depth", "width", "y", "configSpaceBounds", "child", "isZoom", "deltaY", "deltaX", "multiplier", "clamp", "height", "minimapMousePos", "minimapMousePositionAtom", "zoomCenter", "shouldZoom", "currentViewport", "isWithinViewport", "newOrigin", "zoomMultiplier", "getFlamechartStyle", "r", "physicalViewportHeight", "physicalFlamegraphHeight", "AffineTransform", "scaledWidth", "scaledHeight", "ctx", "configToPhysical", "physicalViewSpaceFontSize", "physicalViewSpaceFrameHeight", "physicalViewSize", "minWidthToRender", "cachedMeasureTextWidth", "ELLIPSIS", "minConfigSpaceWidthToRender", "LABEL_PADDING_PX", "labelBatch", "BatchCanvasTextRenderer", "fadedLabelBatch", "matchedTextHighlightBatch", "BatchCanvasRectRenderer", "directlySelectedOutlineBatch", "indirectlySelectedOutlineBatch", "matchedFrameBatch", "renderFrameLabelAndChildren", "physicalLabelBounds", "match", "trimmedText", "trimTextMid", "rangesToHighlightInTrimmedText", "remapRangesToTrimmedText", "lastEndIndex", "left", "padding", "startIndex", "endIndex", "highlightWidth", "frameOutlineWidth", "minConfigSpaceWidthToRenderOutline", "renderSpecialFrameOutlines", "physicalRectBounds", "batch", "theme", "color", "physicalViewBounds", "labelPaddingPx", "right", "targetInterval", "interval", "Color", "x", "pos", "labelText", "textWidth", "logicalSpaceViewportSize", "bounds", "configSpaceViewportHeight", "newSize", "logicalViewSpaceDelta", "physicalDelta", "configDelta", "logicalViewSpaceCenter", "physicalCenter", "configSpaceCenter", "zoomTransform", "nextProps", "style", "h", "css", "commonStyle", "Hovertip", "props", "style", "getStyle", "useTheme", "containerSize", "offset", "containerWidth", "containerHeight", "OFFSET_FROM_MOUSE", "updateLocation", "T", "el", "clientRect", "leftEdgeX", "topEdgeY", "h", "css", "HOVERTIP_PADDING", "withTheme", "theme", "StyleSheet$1", "FlamechartSearchContext", "M", "FlamechartSearchContextProvider", "flamechart", "selectedNode", "setSelectedNode", "configSpaceViewportRect", "setConfigSpaceViewportRect", "children", "profileSearchResults", "w", "ProfileSearchContext", "flamechartSearchResults", "h", "FlamechartSearchResults", "FlamechartSearchView", "_", "flamechartData", "searchResults", "numResults", "resultIndex", "selectAndZoomToMatch", "T", "match", "configSpaceResultBounds", "viewportRect", "Rect", "Vec2", "selectPrev", "selectNext", "index", "result", "SearchView", "StatelessComponent", "m", "FlamechartView", "StatelessComponent", "viewportRect", "configSpaceDetailViewHeight", "configSpaceSize", "width", "size", "origin", "Vec2", "Rect", "logicalSpaceViewportSize", "transform", "hover", "node", "container", "getFlamechartStyle", "weight", "totalWeight", "percent", "formattedPercent", "formatPercent", "height", "left", "top", "offset", "frame", "style", "h", "Hovertip", "css", "commonStyle", "FlamechartMinimapView", "ProfileSearchContext", "searchResults", "d", "FlamechartPanZoomView", "FlamechartSearchView", "FlamechartDetailView", "useFlamechartSetters", "id", "T", "hover", "profileGroupAtom", "logicalSpaceViewportSize", "configSpaceViewportRect", "selectedNode", "getChronoViewFlamechart", "memoizeByShallowEquality", "profile", "getColorBucketForFrame", "Flamechart", "createMemoizedFlamechartRenderer", "options", "canvasContext", "flamechart", "FlamechartRenderer", "getRowAtlas", "getChronoViewFlamechartRenderer", "ChronoFlamechartView", "_", "props", "activeProfileState", "glCanvas", "chronoViewState", "theme", "useTheme", "getCanvasContext", "frameToColorBucket", "getFrameToColorBucket", "createGetColorBucketForFrame", "getCSSColorForFrame", "createGetCSSColorForFrame", "flamechartRenderer", "setters", "h", "FlamechartSearchContextProvider", "FlamechartView", "getLeftHeavyFlamechart", "getLeftHeavyFlamechartRenderer", "LeftHeavyFlamechartView", "ownProps", "leftHeavyViewState", "fuzzyMatchStrings", "text", "pattern", "fzfFuzzyMatchV1", "charCodeLowerA", "charCodeLowerZ", "charCodeUpperA", "charCodeUpperZ", "charCodeDigit0", "charCodeDigit9", "fzfCharClassOf", "char", "code", "charCodeLowerA", "charCodeLowerZ", "charCodeUpperA", "charCodeUpperZ", "charCodeDigit0", "charCodeDigit9", "charsMatch", "textChar", "patternChar", "patternCharCode", "fzfFuzzyMatchV1", "text", "pattern", "pidx", "sidx", "eidx", "lenRunes", "lenPattern", "index", "pchar", "fzfCalculateScore", "fzfScoreMatch", "fzfScoreGapStart", "fzfScoreGapExtension", "fzfBonusBoundary", "fzfBonusNonWord", "fzfBonusCamel123", "fzfBonusConsecutive", "fzfBonusFirstCharMultiplier", "bonusFor", "prevClass", "curClass", "score", "inGap", "consecutive", "firstBonus", "pos", "idx", "bonus", "matchedRanges", "i", "curPos", "curRange", "highlightRanges", "text", "ranges", "highlightedClassName", "spans", "last", "range", "h", "SortIcon", "activeDirection", "theme", "useTheme", "style", "getStyle", "upFill", "downFill", "css", "ProfileSelectRow", "setProfileIndexToView", "setHoveredProfileIndex", "profile", "selected", "hovered", "nodeRef", "closeProfileSelect", "indexInProfileGroup", "matchedRanges", "indexInFilteredListView", "onMouseUp", "T", "onMouseEnter", "ev", "name", "weight", "highlighted", "stopPropagation", "getSortedFilteredProfiles", "profiles", "filterText", "sortMethod", "filtered", "i", "match", "fuzzyMatchStrings", "a", "b", "nameA", "nameB", "sortBy", "p", "ProfileSelect", "indexToView", "visible", "setFilterText", "m", "setSortMethod", "onFilterTextChange", "value", "focusFilterInput", "node", "onSortClick", "field", "filteredProfiles", "hoveredProfileIndex", "selectedNodeRef", "d", "l", "onFilterKeyUp", "newHoveredIndexInFilteredList", "indexInFilteredList", "setPendingForcedScroll", "pendingForcedScroll", "hoveredNodeRef", "hoveredNode", "selectedHoveredRef", "onNameClick", "onWeightClick", "onIndexClick", "indexInList", "ref", "paddingHeight", "withTheme", "StyleSheet$1", "useSetViewMode", "setViewMode", "viewMode", "T", "ToolbarLeftContent", "props", "style", "getStyle", "useTheme", "setChronoFlameChart", "viewModeAtom", "setLeftHeavyFlameGraph", "setSandwichView", "h", "css", "getCachedProfileList", "cachedProfileList", "profileGroup", "nextProfileList", "p", "objectsHaveShallowEquality", "ToolbarCenterContent", "activeProfileState", "profiles", "profileSelectShown", "setProfileSelectShown", "m", "openProfileSelect", "closeProfileSelect", "l", "onWindowKeyPress", "ev", "d", "ProfileSelect", "ToolbarRightContent", "colorScheme", "useAtom", "colorSchemeAtom", "exportFile", "importFile", "colorSchemeToggle", "colorSchemeToString", "help", "Toolbar", "withTheme", "theme", "StyleSheet$1", "sourceMapModule", "DEBUG", "importJavaScriptSourceMapSymbolRemapper", "contentsString", "sourceMapFileName", "sourceMap", "consumer", "contents", "mappingItems", "m", "sourceMapFileNameWithoutExt", "frame", "fileMatches", "mappingIndex", "findIndexBisect", "sourceMapItem", "remappedFrameInfo", "content", "line", "identifierMatch", "ScrollableListView", "items", "axis", "renderItems", "className", "initialIndexInView", "viewportSize", "setViewportSize", "m", "viewportScrollOffset", "setViewportScrollOffset", "viewportRef", "d", "widthOrHeight", "leftOrTop", "scrollLeftOrScrollTop", "offset", "a", "b", "i", "initialScroll", "viewportCallback", "T", "viewport", "rangeResult", "h", "minY", "maxY", "total", "invisiblePrefixSize", "item", "firstVisibleIndex", "lastVisibleIndex", "totalSize", "onViewportScroll", "l", "resizeListener", "visibleItems", "content", "HBarDisplay", "props", "style", "getStyle", "useTheme", "h", "css", "SortIcon", "theme", "activeDirection", "upFill", "downFill", "highlightRanges", "text", "ranges", "highlightedClassName", "spans", "last", "range", "ProfileTableRowView", "frame", "matchedRanges", "profile", "index", "selectedFrame", "setSelectedFrame", "getCSSColorForFrame", "totalWeight", "selfWeight", "totalPerc", "selfPerc", "selected", "formatPercent", "ColorChit", "ProfileTableView", "_", "sortMethod", "setSortMethod", "searchQuery", "searchIsActive", "onSortClick", "T", "field", "ev", "sandwichContext", "w", "SandwichViewContext", "renderItems", "firstIndex", "lastIndex", "rows", "i", "match", "listItems", "f", "onTotalClick", "onSelfClick", "onSymbolNameClick", "commonStyle", "ScrollableListView", "withTheme", "StyleSheet$1", "Color", "ProfileTableViewContainer", "ownProps", "activeProfileState", "sandwichViewState", "tableSortMethod", "useAtom", "tableSortMethodAtom", "callerCallee", "frameToColorBucket", "getFrameToColorBucket", "createGetCSSColorForFrame", "profileGroupAtom", "searchIsActiveAtom", "searchQueryAtom", "FlamechartWrapper", "StatelessComponent", "configSpaceViewportRect", "logicalSpaceViewportSize", "transform", "container", "hover", "viewportRect", "flamechart", "renderInverted", "weight", "totalWeight", "percent", "formattedPercent", "formatPercent", "width", "height", "left", "top", "offset", "Vec2", "style", "getStyle", "frame", "h", "Hovertip", "css", "commonStyle", "FlamechartPanZoomView", "noop", "withTheme", "theme", "StyleSheet$1", "getInvertedCallerProfile", "memoizeByShallowEquality", "profile", "frame", "flattenRecursion", "p", "getInvertedCallerFlamegraph", "invertedCallerProfile", "getColorBucketForFrame", "Flamechart", "getInvertedCallerFlamegraphRenderer", "createMemoizedFlamechartRenderer", "InvertedCallerFlamegraphView", "_", "ownProps", "activeProfileState", "sandwichViewState", "useAtom", "flattenRecursionAtom", "glCanvas", "glCanvasAtom", "theme", "useTheme", "callerCallee", "selectedFrame", "frameToColorBucket", "getFrameToColorBucket", "createGetColorBucketForFrame", "getCSSColorForFrame", "createGetCSSColorForFrame", "canvasContext", "getCanvasContext", "flamechart", "flamechartRenderer", "h", "FlamechartWrapper", "useFlamechartSetters", "noop", "getCalleeProfile", "memoizeByShallowEquality", "profile", "frame", "flattenRecursion", "p", "getCalleeFlamegraph", "calleeProfile", "getColorBucketForFrame", "Flamechart", "getCalleeFlamegraphRenderer", "createMemoizedFlamechartRenderer", "CalleeFlamegraphView", "_", "ownProps", "activeProfileState", "sandwichViewState", "useAtom", "flattenRecursionAtom", "glCanvas", "glCanvasAtom", "theme", "useTheme", "callerCallee", "selectedFrame", "frameToColorBucket", "getFrameToColorBucket", "createGetColorBucketForFrame", "getCSSColorForFrame", "createGetCSSColorForFrame", "canvasContext", "getCanvasContext", "flamechart", "flamechartRenderer", "h", "FlamechartWrapper", "useFlamechartSetters", "noop", "SandwichSearchView", "_", "sandwichViewContext", "w", "SandwichViewContext", "rowList", "resultIndex", "numResults", "selectPrev", "selectNext", "h", "index", "SearchView", "SandwichView", "StatelessComponent", "selectedFrame", "ev", "style", "getStyle", "flamegraphViews", "h", "css", "commonStyle", "InvertedCallerFlamegraphView", "CalleeFlamegraphView", "ProfileTableViewContainer", "SandwichSearchView", "withTheme", "theme", "StyleSheet$1", "SandwichViewContext", "M", "SandwichViewContainer", "_", "ownProps", "activeProfileState", "glCanvas", "sandwichViewState", "index", "callerCallee", "useTheme", "setSelectedFrame", "T", "profileGroupAtom", "profile", "tableSortMethod", "useAtom", "tableSortMethodAtom", "profileSearchResults", "w", "ProfileSearchContext", "rowList", "frame", "sortBy", "f", "getIndexForFrame", "indexByFrame", "i", "getSearchMatchForFrame", "contextData", "importModule", "importProfilesFromText", "fileName", "contents", "importProfilesFromBase64", "importProfilesFromArrayBuffer", "importProfilesFromFile", "file", "importFromFileSystemDirectoryEntry", "entry", "exampleProfileURL", "isFileSystemDirectoryEntry", "GLCanvas", "StatelessComponent", "canvas", "container", "width", "height", "widthInAppUnits", "heightInAppUnits", "widthInPixels", "heightInPixels", "nextProps", "style", "getStyle", "h", "css", "Application", "filename", "data", "resp", "ev", "firstItem", "webkitEntry", "webkitDirectoryEntry", "flattenRecursion", "activeProfileState", "name", "indexToView", "profiles", "profileGroup", "p", "saveToFile", "input", "clipboardData", "pasted", "loader", "resolve", "e", "profile", "title", "reader", "fileContentsPromise", "fileContents", "symbolRemapper", "emscriptenSymbolRemapper", "importEmscriptenSymbolMap", "jsSourceMapRemapper", "importJavaScriptSourceMapSymbolRemapper", "profileState", "profileURL", "canUseXHR", "response", "base64source", "script", "viewMode", "error", "loading", "glCanvas", "ChronoFlamechartView", "LeftHeavyFlamechartView", "SandwichViewContainer", "Toolbar", "withTheme", "theme", "StyleSheet$1", "ApplicationContainer", "_", "canvas", "useAtom", "glCanvasAtom", "theme", "useTheme", "canvasContext", "h", "getCanvasContext", "ProfileSearchContextProvider", "Application", "useActiveProfileState", "loadingAtom", "errorAtom", "profileGroupAtom", "dragActiveAtom", "viewModeAtom", "flattenRecursionAtom", "hashParamsAtom", "H", "h", "ThemeProvider", "ApplicationContainer"]
}
